"use strict";(self.webpackChunk_grafana_ui=self.webpackChunk_grafana_ui||[]).push([[2014],{"../grafana-data/src/datetime/datemath.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{A_:function(){return isMathString},fn:function(){return isValid},qg:function(){return parse}});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/lodash/lodash.js"),_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../grafana-data/src/datetime/moment_wrapper.ts");const units=["y","M","w","d","h","m","s","Q"],isDurationUnit=value=>units.includes(value);function isMathString(text){return!!text&&!("string"!=typeof text||"now"!==text.substring(0,3)&&!text.includes("||"))}function parse(text,roundUp,timezone,fiscalYearStartMonth){if(text)return function toDateTime(dateTimeRep,options){if("string"!=typeof dateTimeRep)return(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.Ar)(dateTimeRep)?dateTimeRep:(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isDate)(dateTimeRep)?(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.KQ)(dateTimeRep):void 0;{let time,mathString="",index=-1,parseString="";return"now"===dateTimeRep.substring(0,3)?(time=(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.oZ)(options.timezone,options.now),mathString=dateTimeRep.substring(3)):(index=dateTimeRep.indexOf("||"),-1===index?(parseString=dateTimeRep,mathString=""):(parseString=dateTimeRep.substring(0,index),mathString=dateTimeRep.substring(index+2)),time=(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.KQ)(parseString,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.mt)),mathString.length?function parseDateMath(mathString,time,roundUp,fiscalYearStartMonth=0){const strippedMathString=mathString.replace(/\s/g,""),result=(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.KQ)(time);let i=0;const len=strippedMathString.length;for(;i<len;){const c=strippedMathString.charAt(i++);let type,num,unitString,isFiscal=!1;if("/"===c)type=0;else if("+"===c)type=1;else{if("-"!==c)return;type=2}if(isNaN(parseInt(strippedMathString.charAt(i),10)))num=1;else if(2===strippedMathString.length)num=parseInt(strippedMathString.charAt(i),10);else{const numFrom=i;for(;!isNaN(parseInt(strippedMathString.charAt(i),10));)if(i++,i>10)return;num=parseInt(strippedMathString.substring(numFrom,i),10)}if(0===type&&1!==num)return;unitString=strippedMathString.charAt(i++),"f"===unitString&&(unitString=strippedMathString.charAt(i++),isFiscal=!0);const unit=unitString;if(!isDurationUnit(unit))return;0===type?isFiscal?roundToFiscal(fiscalYearStartMonth,result,unit,roundUp):roundUp?result.endOf(unit):result.startOf(unit):1===type?result.add(num,unit):2===type&&result.subtract(num,unit)}return result}(mathString,time,options.roundUp,options.fiscalYearStartMonth):time}}(text,{roundUp:roundUp,timezone:timezone,fiscalYearStartMonth:fiscalYearStartMonth})}function isValid(text){const date=parse(text);return!!date&&(!!(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.Ar)(date)&&date.isValid())}function roundToFiscal(fyStartMonth,dateTime,unit,roundUp){switch(unit){case"y":return roundUp?roundToFiscal(fyStartMonth,dateTime,unit,!1)?.add(11,"M").endOf("M"):dateTime.subtract(((0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.AN)(dateTime).month()-fyStartMonth+12)%12,"M").startOf("M"),dateTime;case"Q":return roundUp?roundToFiscal(fyStartMonth,dateTime,unit,!1)?.add(2,"M").endOf("M"):dateTime.subtract(((0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_1__.AN)(dateTime).month()-fyStartMonth+12)%3,"M").startOf("M"),dateTime;default:return}}},"../grafana-data/src/datetime/parser.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{b:function(){return dateTimeParse}});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/lodash/lodash.js"),moment_timezone__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/moment-timezone/index.js"),moment_timezone__WEBPACK_IMPORTED_MODULE_1___default=__webpack_require__.n(moment_timezone__WEBPACK_IMPORTED_MODULE_1__),_common__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../grafana-data/src/datetime/common.ts"),_datemath__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../grafana-data/src/datetime/datemath.ts"),_formats__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../grafana-data/src/datetime/formats.ts"),_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../grafana-data/src/datetime/moment_wrapper.ts");const dateTimeParse=(value,options)=>(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.Ar)(value)?value:"string"==typeof value?parseString(value,options):parseOthers(value,options),parseString=(value,options)=>{if(-1!==value.indexOf("now")){if(!(0,_datemath__WEBPACK_IMPORTED_MODULE_3__.fn)(value))return(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.KQ)();return(0,_datemath__WEBPACK_IMPORTED_MODULE_3__.qg)(value,options?.roundUp,options?.timeZone,options?.fiscalYearStartMonth)||(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.KQ)()}let timeZone=(0,_common__WEBPACK_IMPORTED_MODULE_4__.O)(options),format=options?.format??_formats__WEBPACK_IMPORTED_MODULE_5__.WC.fullDate;value.endsWith("Z")&&(format="YYYY-MM-DDTHH:mm:ss.SSSZ",timeZone="utc");const zone=moment_timezone__WEBPACK_IMPORTED_MODULE_1___default().tz.zone(timeZone);return zone&&zone.name?(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.oZ)(zone.name,value,format):"utc"===(0,lodash__WEBPACK_IMPORTED_MODULE_0__.lowerCase)(timeZone)?(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.yT)(value,format):(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.KQ)(value,format)},parseOthers=(value,options)=>{const date=value,timeZone=(0,_common__WEBPACK_IMPORTED_MODULE_4__.O)(options),zone=moment_timezone__WEBPACK_IMPORTED_MODULE_1___default().tz.zone(timeZone);return zone&&zone.name?(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.oZ)(zone.name,date):"utc"===(0,lodash__WEBPACK_IMPORTED_MODULE_0__.lowerCase)(timeZone)?(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.yT)(date):(0,_moment_wrapper__WEBPACK_IMPORTED_MODULE_2__.KQ)(date)}},"../grafana-data/src/field/displayProcessor.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{J:function(){return getDisplayProcessor}});var lodash=__webpack_require__("../../node_modules/lodash/lodash.js"),moment_wrapper=__webpack_require__("../grafana-data/src/datetime/moment_wrapper.ts"),parser=__webpack_require__("../grafana-data/src/datetime/parser.ts"),dataFrame=__webpack_require__("../grafana-data/src/types/dataFrame.ts");function anyToNumber(value){return"number"==typeof value?value:""===value||null==value||Array.isArray(value)?NaN:"boolean"==typeof value?value?1:0:(0,lodash.toNumber)(value)}var string=__webpack_require__("../grafana-data/src/text/string.ts"),valueMapping_MappingType=function(MappingType){return MappingType.ValueToText="value",MappingType.RangeToText="range",MappingType.RegexToText="regex",MappingType.SpecialValue="special",MappingType}({}),valueMapping_SpecialValueMatch=function(SpecialValueMatch){return SpecialValueMatch.True="true",SpecialValueMatch.False="false",SpecialValueMatch.Null="null",SpecialValueMatch.NaN="nan",SpecialValueMatch.NullAndNaN="null+nan",SpecialValueMatch.Empty="empty",SpecialValueMatch}({});var valueFormats=__webpack_require__("../grafana-data/src/valueFormats/valueFormats.ts"),scale=__webpack_require__("../grafana-data/src/field/scale.ts");const timeFormats={dateTimeAsIso:!0,dateTimeAsIsoNoDateIfToday:!0,dateTimeAsUS:!0,dateTimeAsUSNoDateIfToday:!0,dateTimeAsLocal:!0,dateTimeAsLocalNoDateIfToday:!0,dateTimeFromNow:!0};function getDisplayProcessor(options){if(!options||(0,lodash.isEmpty)(options)||!options.field)return toStringProcessor;const field=options.field,config=field.config??{},{palette:palette}=options.theme.visualization;let unit=config.unit,hasDateUnit=unit&&(timeFormats[unit]||unit.startsWith("time:")),showMs=!1;if(field.type!==dataFrame.PU.time||hasDateUnit)field.type===dataFrame.PU.boolean?(0,valueFormats.j9)(unit)||(unit="bool"):unit||field.type!==dataFrame.PU.string||(unit="string");else if(unit="dateTimeAsSystem",hasDateUnit=!0,field.values&&field.values.length>1){let start=field.values[0],end=field.values[field.values.length-1];"string"==typeof start?(start=(0,parser.b)(start).unix(),end=(0,parser.b)(end).unix()):(start/=1e3,end/=1e3),showMs=Math.abs(end-start)<60}const hasCurrencyUnit=unit?.startsWith("currency"),hasBoolUnit=(0,valueFormats.j9)(unit),isNumType=field.type===dataFrame.PU.number,canTrimTrailingDecimalZeros=!hasDateUnit&&!hasCurrencyUnit&&!hasBoolUnit&&!("locale"===unit)&&isNumType&&null==config.decimals,formatFunc=(0,valueFormats.j_)(unit||"none"),scaleFunc=(0,scale.jc)(field,options.theme);return(value,adjacentDecimals)=>{const{mappings:mappings}=config,isStringUnit="string"===unit;hasDateUnit&&"string"==typeof value&&(value=(0,moment_wrapper.yT)(value).valueOf());let text,prefix,suffix,color,icon,percent,numeric=isStringUnit?NaN:anyToNumber(value);if(mappings&&mappings.length>0){const mappingResult=function getValueMappingResult(valueMappings,value){for(const vm of valueMappings)switch(vm.type){case valueMapping_MappingType.ValueToText:if(null==value)continue;const result=vm.options[value];if(result)return result;break;case valueMapping_MappingType.RangeToText:if(null==value)continue;const valueAsNumber=parseFloat(value);if(isNaN(valueAsNumber))continue;const from=vm.options.from??-1/0;if(!isNaN(from)&&valueAsNumber<from)continue;const to=vm.options.to??1/0;if(!isNaN(to)&&valueAsNumber>to)continue;return vm.options.result;case valueMapping_MappingType.RegexToText:if(null==value)continue;if("string"!=typeof value)continue;const regex=(0,string.dO)(vm.options.pattern);if(value.match(regex)){const res={...vm.options.result};return null!=res.text&&(res.text=value.replace(regex,vm.options.result.text||"")),res}case valueMapping_MappingType.SpecialValue:switch(vm.options.match){case valueMapping_SpecialValueMatch.Null:if(null==value)return vm.options.result;break;case valueMapping_SpecialValueMatch.NaN:if("number"==typeof value&&isNaN(value))return vm.options.result;break;case valueMapping_SpecialValueMatch.NullAndNaN:if("number"==typeof value&&isNaN(value)||null==value)return vm.options.result;break;case valueMapping_SpecialValueMatch.True:if(!0===value||"true"===value)return vm.options.result;break;case valueMapping_SpecialValueMatch.False:if(!1===value||"false"===value)return vm.options.result;break;case valueMapping_SpecialValueMatch.Empty:if(""===value)return vm.options.result}}return null}(mappings,value);mappingResult&&(null!=mappingResult.text&&(text=mappingResult.text),null!=mappingResult.color&&(color=options.theme.visualization.getColorByName(mappingResult.color)),null!=mappingResult.icon&&(icon=mappingResult.icon))}else if(field.type===dataFrame.PU.enum){if(null==value)return{text:"",numeric:NaN};const enumIndex=+value;if(config&&config.type&&config.type.enum){const{text:enumText,color:enumColor}=config.type.enum;if(text=enumText?enumText[enumIndex]:`${value}`,color=enumColor?enumColor[enumIndex]:void 0,null==color){const namedColor=palette[enumIndex%palette.length];color=options.theme.visualization.getColorByName(namedColor)}}}if(!Number.isNaN(numeric)){if(null==text&&!(0,lodash.isBoolean)(value)){let v;canTrimTrailingDecimalZeros&&null!=adjacentDecimals?(v=formatFunc(numeric,adjacentDecimals,null,options.timeZone,showMs),v.text=+v.text+""):v=formatFunc(numeric,config.decimals,null,options.timeZone,showMs),text=v.text,suffix=v.suffix,prefix=v.prefix}if(null==color){const scaleResult=scaleFunc(numeric);color=scaleResult.color,percent=scaleResult.percent}}if(null==text&&(0,lodash.isArray)(value)&&(text=(0,lodash.join)(value,", ")),null==text&&(text=(0,lodash.toString)(value),text||(text=config.noValue?config.noValue:"")),!color){const scaleResult=scaleFunc(-1/0);color=scaleResult.color,percent=scaleResult.percent}const display={text:text,numeric:numeric,prefix:prefix,suffix:suffix,color:color};return null!=icon&&(display.icon=icon),null!=percent&&(display.percent=percent),display}}function toStringProcessor(value){return{text:(0,lodash.toString)(value),numeric:anyToNumber(value)}}},"../grafana-data/src/field/fieldColor.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{Hs:function(){return getFieldColorMode},Qi:function(){return getFieldColorModeForField},uf:function(){return fieldColorModeRegistry}});var d3_interpolate__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("../../node_modules/d3-interpolate/src/rgb.js"),string_hash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/string-hash/index.js"),string_hash__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(string_hash__WEBPACK_IMPORTED_MODULE_0__),tinycolor2__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../../node_modules/tinycolor2/esm/tinycolor.js"),_themes_colorManipulator__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("../grafana-data/src/themes/colorManipulator.ts"),_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../grafana-data/src/types/fieldColor.ts"),_utils_Registry__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../grafana-data/src/utils/Registry.ts"),_thresholds__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../grafana-data/src/field/thresholds.ts");const fieldColorModeRegistry=new _utils_Registry__WEBPACK_IMPORTED_MODULE_2__.O((()=>[{id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.Fixed,name:"Single color",description:"Set a specific color",getCalculator:getFixedColor},{id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.Shades,name:"Shades of a color",description:"Select shades of a specific color",getCalculator:getShadedColor},{id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.Thresholds,name:"From thresholds",isByValue:!0,description:"Derive colors from thresholds",getCalculator:(_field,theme)=>(_value,_percent,threshold)=>{const thresholdSafe=threshold??_thresholds__WEBPACK_IMPORTED_MODULE_4__.QS;return theme.visualization.getColorByName(thresholdSafe.color)}},new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.PaletteClassic,name:"Classic palette",isContinuous:!1,isByValue:!1,getColors:theme=>theme.visualization.palette}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.PaletteClassicByName,name:"Classic palette (by series name)",isContinuous:!1,isByValue:!1,useSeriesName:!0,getColors:theme=>theme.visualization.palette.filter((color=>(0,_themes_colorManipulator__WEBPACK_IMPORTED_MODULE_5__.eM)(theme.visualization.getColorByName(color),theme.colors.background.primary)>=theme.colors.contrastThreshold))}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousGrYlRd,name:"Green-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:theme=>["green","yellow","red"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousRdYlGr,name:"Red-Yellow-Green",isContinuous:!0,isByValue:!0,getColors:theme=>["red","yellow","green"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousBlYlRd,name:"Blue-Yellow-Red",isContinuous:!0,isByValue:!0,getColors:theme=>["dark-blue","super-light-yellow","dark-red"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousYlRd,name:"Yellow-Red",isContinuous:!0,isByValue:!0,getColors:theme=>["super-light-yellow","dark-red"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousBlPu,name:"Blue-Purple",isContinuous:!0,isByValue:!0,getColors:theme=>["blue","purple"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousYlBl,name:"Yellow-Blue",isContinuous:!0,isByValue:!0,getColors:theme=>["super-light-yellow","dark-blue"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousBlues,name:"Blues",isContinuous:!0,isByValue:!0,getColors:theme=>["panel-bg","dark-blue"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousReds,name:"Reds",isContinuous:!0,isByValue:!0,getColors:theme=>["panel-bg","dark-red"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousGreens,name:"Greens",isContinuous:!0,isByValue:!0,getColors:theme=>["panel-bg","dark-green"]}),new FieldColorSchemeMode({id:_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.ContinuousPurples,name:"Purples",isContinuous:!0,isByValue:!0,getColors:theme=>["panel-bg","dark-purple"]})]));class FieldColorSchemeMode{id;name;description;isContinuous;isByValue;useSeriesName;colorCache;colorCacheTheme;interpolator;getNamedColors;constructor(options){this.id=options.id,this.name=options.name,this.description=options.description,this.getNamedColors=options.getColors,this.isContinuous=options.isContinuous,this.isByValue=options.isByValue,this.useSeriesName=options.useSeriesName}getColors(theme){return this.getNamedColors?(this.colorCache&&this.colorCacheTheme===theme||(this.colorCache=this.getNamedColors(theme).map(theme.visualization.getColorByName),this.colorCacheTheme=theme),this.colorCache):[]}getInterpolator(){return this.interpolator||(this.interpolator=(0,d3_interpolate__WEBPACK_IMPORTED_MODULE_6__.Ik)(this.colorCache)),this.interpolator}getCalculator(field,theme){const colors=this.getColors(theme);return this.isByValue?this.isContinuous?(_,percent,_threshold)=>this.getInterpolator()(percent):(_,percent,_threshold)=>colors[percent*(colors.length-1)]:this.useSeriesName?(_,_percent,_threshold)=>colors[Math.abs(string_hash__WEBPACK_IMPORTED_MODULE_0___default()(field.state?.displayName??field.name))%colors.length]:(_,_percent,_threshold)=>{const seriesIndex=field.state?.seriesIndex??0;return colors[seriesIndex%colors.length]}}}function getFieldColorModeForField(field){return fieldColorModeRegistry.get(field.config.color?.mode??_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.Thresholds)}function getFieldColorMode(mode){return fieldColorModeRegistry.get(mode??_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.Y.Thresholds)}function getFixedColor(field,theme){return()=>theme.visualization.getColorByName(field.config.color?.fixedColor??_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.F)}function getShadedColor(field,theme){return()=>{const baseColorString=theme.visualization.getColorByName(field.config.color?.fixedColor??_types_fieldColor__WEBPACK_IMPORTED_MODULE_3__.F),colors=[baseColorString];for(let i=1;i<6;i++)colors.push((0,tinycolor2__WEBPACK_IMPORTED_MODULE_1__.A)(baseColorString).spin(i/6*10).brighten(i/6*35).toHexString()),colors.push((0,tinycolor2__WEBPACK_IMPORTED_MODULE_1__.A)(baseColorString).spin(-i/6*10).darken(i/6*35).toHexString());return colors[(field.state?.seriesIndex??0)%colors.length]}}},"../grafana-data/src/field/scale.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{AP:function(){return getMinMaxAndDelta},jc:function(){return getScaleCalculator},xg:function(){return getFieldConfigWithMinMax}});var lodash__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/lodash/lodash.js"),_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("../grafana-data/src/transformations/fieldReducer.ts"),_types_dataFrame__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../grafana-data/src/types/dataFrame.ts"),_fieldColor__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("../grafana-data/src/field/fieldColor.ts"),_thresholds__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("../grafana-data/src/field/thresholds.ts");function getScaleCalculator(field,theme){if(field.type===_types_dataFrame__WEBPACK_IMPORTED_MODULE_1__.PU.boolean)return function getBooleanScaleCalculator(field,theme){const trueValue={color:theme.visualization.getColorByName("green"),percent:1,threshold:void 0},falseValue={color:theme.visualization.getColorByName("red"),percent:0,threshold:void 0},mode=(0,_fieldColor__WEBPACK_IMPORTED_MODULE_2__.Qi)(field);if(mode.isContinuous&&mode.getColors){const colors=mode.getColors(theme);trueValue.color=colors[colors.length-1],falseValue.color=colors[0]}return value=>Boolean(value)?trueValue:falseValue}(field,theme);const getColor=(0,_fieldColor__WEBPACK_IMPORTED_MODULE_2__.Qi)(field).getCalculator(field,theme),info=field.state?.range??getMinMaxAndDelta(field);return value=>{let percent=0;value!==-1/0&&(percent=(value-info.min)/info.delta,Number.isNaN(percent)&&(percent=0));const threshold=(0,_thresholds__WEBPACK_IMPORTED_MODULE_3__.k5)(field,value,percent);return{percent:percent,threshold:threshold,color:getColor(value,percent,threshold)}}}function getMinMaxAndDelta(field){if(field.type!==_types_dataFrame__WEBPACK_IMPORTED_MODULE_1__.PU.number)return{min:0,max:100,delta:100};let min=field.config.min,max=field.config.max;if(!(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(min)||!(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(max))if(field.values&&field.values.length){const stats=(0,_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__.Nw)({field:field,reducers:[_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__.gy.min,_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__.gy.max]});(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(min)||(min=stats[_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__.gy.min]),(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(max)||(max=stats[_transformations_fieldReducer__WEBPACK_IMPORTED_MODULE_4__.gy.max])}else min=0,max=100;return{min:min,max:max,delta:max-min}}function getFieldConfigWithMinMax(field,local){const{config:config}=field;let{min:min,max:max}=config;return(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(min)&&(0,lodash__WEBPACK_IMPORTED_MODULE_0__.isNumber)(max)?config:local||!field.state?.range?{...config,...getMinMaxAndDelta(field)}:{...config,...field.state.range}}},"../grafana-data/src/field/thresholds.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{QS:function(){return fallBackThreshold},k5:function(){return getActiveThresholdForValue}});var _types_fieldColor__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../grafana-data/src/types/fieldColor.ts"),_types_thresholds__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("../grafana-data/src/types/thresholds.ts");const fallBackThreshold={value:0,color:_types_fieldColor__WEBPACK_IMPORTED_MODULE_0__.F};function getActiveThreshold(value,thresholds){if(!thresholds||0===thresholds.length)return fallBackThreshold;let active=thresholds[0];for(const threshold of thresholds){if(!(value>=threshold.value))break;active=threshold}return active}function getActiveThresholdForValue(field,value,percent){const{thresholds:thresholds}=field.config;return thresholds?.mode===_types_thresholds__WEBPACK_IMPORTED_MODULE_1__.O.Percentage?getActiveThreshold(100*percent,thresholds?.steps):getActiveThreshold(value,thresholds?.steps)}},"../grafana-data/src/text/string.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{$f:function(){return escapeRegex},AP:function(){return stringStartsAsRegEx},dO:function(){return stringToJsRegex},jD:function(){return escapeStringForRegex},xb:function(){return unEscapeStringFromRegex}});__webpack_require__("../../node_modules/lodash/lodash.js");const specialMatcher="([\\"+["(","[","{","}","]",")","\\","|","*","+","-",".","?","<",">","#","&","^","$"].join("\\")+"])",specialCharEscape=new RegExp(specialMatcher,"g"),specialCharUnescape=new RegExp("(\\\\)"+specialMatcher,"g");function escapeStringForRegex(value){return value?value.replace(specialCharEscape,"\\$1"):value}function unEscapeStringFromRegex(value){return value?value.replace(specialCharUnescape,"$2"):value}function stringStartsAsRegEx(str){return!!str&&"/"===str[0]}function stringToJsRegex(str){if(!stringStartsAsRegEx(str))return new RegExp(`^${str}$`);const match=str.match(new RegExp("^/(.*?)/(g?i?m?y?s?)$"));if(!match)throw new Error(`'${str}' is not a valid regular expression.`);return new RegExp(match[1],match[2])}function escapeRegex(value){return value.replace(/[\\^$*+?.()|[\]{}\/]/g,"\\$&")}},"../grafana-data/src/types/thresholds.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{O:function(){return ThresholdsMode}});var ThresholdsMode=function(ThresholdsMode){return ThresholdsMode.Absolute="absolute",ThresholdsMode.Percentage="percentage",ThresholdsMode}({})},"./src/components/FormattedValueDisplay/FormattedValueDisplay.tsx":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.d(__webpack_exports__,{i:function(){return FormattedValueDisplay}});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../node_modules/react/jsx-runtime.js");const FormattedValueDisplay=({value:value,className:className,style:style,...htmlProps})=>{const hasPrefix=(value.prefix??"").length>0,hasSuffix=(value.suffix??"").length>0;let suffixStyle;if(style&&"number"==typeof style.fontSize&&!Number.isNaN(style.fontSize)){const fontSize=style.fontSize,reductionFactor=function fontSizeReductionFactor(fontSize){return fontSize<20?.9:fontSize<26?.8:.6}(fontSize);suffixStyle={fontSize:fontSize*reductionFactor}}return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:className,style:style,...htmlProps,children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{children:[hasPrefix&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:value.prefix}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:value.text}),hasSuffix&&(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{style:suffixStyle,children:value.suffix})]})})};FormattedValueDisplay.displayName="FormattedDisplayValue";try{FormattedValueDisplay.displayName="FormattedDisplayValue",FormattedValueDisplay.__docgenInfo={description:"",displayName:"FormattedDisplayValue",props:{value:{defaultValue:null,description:"",name:"value",required:!0,type:{name:"FormattedValue"}},className:{defaultValue:null,description:"",name:"className",required:!1,type:{name:"string"}},style:{defaultValue:null,description:"",name:"style",required:!1,type:{name:"CSSProperties"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/FormattedValueDisplay/FormattedValueDisplay.tsx#FormattedDisplayValue"]={docgenInfo:FormattedDisplayValue.__docgenInfo,name:"FormattedDisplayValue",path:"src/components/FormattedValueDisplay/FormattedValueDisplay.tsx#FormattedDisplayValue"})}catch(__react_docgen_typescript_loader_error){}},"./src/utils/measureText.ts":function(__unused_webpack_module,__webpack_exports__,__webpack_require__){let _context;__webpack_require__.d(__webpack_exports__,{Vr:function(){return calculateFontSize},Yc:function(){return getCanvasContext},kD:function(){return measureText}});const cache=new Map,cacheLimit=500;let ctxFontStyle="";function getCanvasContext(){return _context||(_context=document.createElement("canvas").getContext("2d")),_context}function measureText(text,fontSize,fontWeight=400){const fontStyle=`${fontWeight} ${fontSize}px 'Inter'`,cacheKey=text+fontStyle,fromCache=cache.get(cacheKey);if(fromCache)return fromCache;const context=getCanvasContext();ctxFontStyle!==fontStyle&&(context.font=ctxFontStyle=fontStyle);const metrics=context.measureText(text);return cache.size===cacheLimit&&cache.clear(),cache.set(cacheKey,metrics),metrics}function calculateFontSize(text,width,height,lineHeight,maxSize,fontWeight){const fontSizeBasedOnWidth=width/(measureText(text,14,fontWeight).width+2)*14,fontSizeBasedOnHeight=height/lineHeight,optimalSize=Math.min(fontSizeBasedOnHeight,fontSizeBasedOnWidth);return Math.min(optimalSize,maxSize??optimalSize)}}}]);