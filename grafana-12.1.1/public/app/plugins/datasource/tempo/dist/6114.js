"use strict";(globalThis.webpackChunktempo=globalThis.webpackChunktempo||[]).push([[6114],{6114:(e,t,n)=>{n.r(t),n.d(t,{default:()=>_e});var r=n(9728),o=n(6089),a=n(5959),i=n(364),s=n(8290),l=n(8531),c=n(2007),u=n(8580);const p=/^(-?\d+(?:\.\d+)?)(ms|[Mwdhmsy])$/,d=(e,t=p)=>!(e.match(t)||!e);function h(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function g(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const f=e=>{const[t,n]=(0,a.useState)((()=>!!e.value&&d(e.value,e.validationRegex)));var o;(0,u.A)((()=>{n(d(e.value,e.validationRegex))}),500,[e.value]);const i={labelWidth:26,disabled:null!==(o=e.disabled)&&void 0!==o&&o,invalid:t,error:e.isInvalidError};return e.label&&(i.label=e.label,i.tooltip=e.tooltip||""),(0,r.jsx)(c.InlineField,g(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){h(e,t,n[t])}))}return e}({},i),{children:(0,r.jsx)(c.Input,{type:"text",placeholder:e.placeholder||"0",width:e.width||40,onChange:t=>{e.onChange(t.currentTarget.value)},value:e.value,"aria-label":e.ariaLabel||"interval input"})}))};function b(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){b(e,t,n[t])}))}return e}function j(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const O=({values:e,onChange:t,id:n})=>{const a=(0,c.useStyles2)(v);return(0,r.jsx)("div",{className:a.wrapper,children:e.length?e.map(((i,s)=>(0,r.jsxs)("div",{className:a.pair,children:[(0,r.jsx)(c.SegmentInput,{id:`${n}-key-${s}`,placeholder:"Tag name",value:i.key,onChange:n=>{t(e.map(((e,t)=>t===s?j(y({},e),{key:String(n)}):e)))}}),(0,r.jsx)(c.InlineLabel,{"aria-label":"equals",className:a.operator,children:"as"}),(0,r.jsx)(c.SegmentInput,{id:`${n}-value-${s}`,placeholder:"New name (optional)",value:i.value||"",onChange:n=>{t(e.map(((e,t)=>t===s?j(y({},e),{value:String(n)}):e)))}}),(0,r.jsx)(c.ToolbarButton,{onClick:()=>t([...e.slice(0,s),...e.slice(s+1)]),className:(0,o.cx)(a.removeTag,"query-part"),"aria-label":"Remove tag",type:"button",icon:"times"}),s===e.length-1?(0,r.jsx)(c.ToolbarButton,{onClick:()=>t([...e,{key:"",value:""}]),className:"query-part","aria-label":"Add tag",type:"button",icon:"plus"}):null]},s))):(0,r.jsx)(c.ToolbarButton,{icon:"plus",onClick:()=>t([...e,{key:"",value:""}]),className:"query-part","aria-label":"Add tag",type:"button"})})},v=e=>({wrapper:(0,o.css)({display:"flex",flexDirection:"column",gap:`${e.spacing(.5)} 0`}),pair:(0,o.css)({display:"flex",justifyContent:"start",alignItems:"center"}),operator:(0,o.css)({color:e.v1.palette.orange,width:"auto"}),removeTag:(0,o.css)({marginRight:e.spacing(.5)})});function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){m(e,t,n[t])}))}return e}function D(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function x({options:e,onOptionsChange:t}){const n=["loki","elasticsearch","grafana-splunk-datasource","grafana-opensearch-datasource","grafana-falconlogscale-datasource","googlecloud-logging-datasource"],i=(0,a.useMemo)((()=>function(e){var t;if(null==e?void 0:e.tracesToLogsV2)return e.tracesToLogsV2;if(!(null==e?void 0:e.tracesToLogs))return;const n={customQuery:!1};return n.datasourceUid=e.tracesToLogs.datasourceUid,n.tags=e.tracesToLogs.mapTagNamesEnabled?e.tracesToLogs.mappedTags:null===(t=e.tracesToLogs.tags)||void 0===t?void 0:t.map((e=>({key:e}))),n.filterByTraceID=e.tracesToLogs.filterByTraceID,n.filterBySpanID=e.tracesToLogs.filterBySpanID,n.spanStartTimeShift=e.tracesToLogs.spanStartTimeShift,n.spanEndTimeShift=e.tracesToLogs.spanEndTimeShift,n}(e.jsonData)||{customQuery:!1}),[e.jsonData]),{query:s="",tags:u,customQuery:p}=i,d=(0,a.useCallback)((n=>{t(D(w({},e),{jsonData:D(w({},e.jsonData),{tracesToLogsV2:w({},i,n),tracesToLogs:void 0})}))}),[t,e,i]);return(0,r.jsxs)("div",{className:(0,o.css)({width:"100%"}),children:[(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"The logs data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:(0,r.jsx)(l.DataSourcePicker,{inputId:"trace-to-logs-data-source-picker",filter:e=>n.includes(e.type),current:i.datasourceUid,noDefault:!0,width:40,onChange:e=>d({datasourceUid:e.uid}),onClear:()=>d({datasourceUid:void 0})})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(f,{label:T("start"),tooltip:S("start","0"),value:i.spanStartTimeShift||"",onChange:e=>{d({spanStartTimeShift:e})},isInvalidError:C})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(f,{label:T("end"),tooltip:S("end","0"),value:i.spanEndTimeShift||"",onChange:e=>{d({spanEndTimeShift:e})},isInvalidError:C})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'cluster', 'hostname', 'namespace', 'pod', 'service.name', 'service.namespace'",label:"Tags",labelWidth:26,children:(0,r.jsx)(O,{values:null!=u?u:[],onChange:e=>d({tags:e})})})}),(0,r.jsx)(P,{disabled:p,type:"trace",id:"filterByTraceID",value:Boolean(i.filterByTraceID),onChange:e=>d({filterByTraceID:e})}),(0,r.jsx)(P,{disabled:p,type:"span",id:"filterBySpanID",value:Boolean(i.filterBySpanID),onChange:e=>d({filterBySpanID:e})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"customQuerySwitch",value:p,onChange:e=>d({customQuery:e.currentTarget.checked})})})}),p&&(0,r.jsx)(c.InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to logs data source. Interpolate tags using the `$__tags` keyword",grow:!0,children:(0,r.jsx)(c.Input,{label:"Query",type:"text",allowFullScreen:!0,value:s,onChange:e=>d({query:e.currentTarget.value})})})]})}function P(e){return(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{disabled:e.disabled,label:`Filter by ${e.type} ID`,labelWidth:26,grow:!0,tooltip:`Filters logs by ${e.type} ID, where the ${e.type} ID should be part of the log line`,children:(0,r.jsx)(c.InlineSwitch,{id:e.id,value:e.value,onChange:t=>e.onChange(t.currentTarget.checked)})})})}const T=e=>`Span ${e} time shift`,S=(e,t)=>`Shifts the ${e} time of the span. Default: ${t} (Time units can be used here, for example: 5s, -1m, 3h)`,C="Invalid time shift. See tooltip for examples.",I=({options:e,onOptionsChange:t})=>{let n=e.type;return n+="tempo"===e.type?"/configure-tempo-data-source/#trace-to-logs":"/#trace-to-logs",(0,r.jsx)(i.A,{title:"Trace to logs",description:(0,r.jsx)(s.H,{description:"Navigate from a trace span to the selected data source's logs.",suffix:n,feature:"trace to logs"}),isCollapsible:!0,isInitiallyOpen:!0,children:(0,r.jsx)(x,{options:e,onOptionsChange:t})})};var k=n(7781);function E(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function F(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){E(e,t,n[t])}))}return e}function q(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function M({options:e,onOptionsChange:t}){var n,a,i,s,u,p;const d=(0,c.useStyles2)(R);var h;return(0,r.jsxs)("div",{className:(0,o.css)({width:"100%"}),children:[(0,r.jsx)(c.InlineFieldRow,{className:d.row,children:(0,r.jsx)(c.InlineField,{tooltip:"The Prometheus data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:(0,r.jsx)(l.DataSourcePicker,{inputId:"trace-to-metrics-data-source-picker",pluginId:"prometheus",current:null===(n=e.jsonData.tracesToMetrics)||void 0===n?void 0:n.datasourceUid,noDefault:!0,width:40,onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{datasourceUid:n.uid})),onClear:()=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{datasourceUid:void 0}))})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(f,{label:T("start"),tooltip:S("start","-2m"),value:(null===(a=e.jsonData.tracesToMetrics)||void 0===a?void 0:a.spanStartTimeShift)||"",onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{spanStartTimeShift:n}))},placeholder:"-2m",isInvalidError:C})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(f,{label:T("end"),tooltip:S("end","2m"),value:(null===(i=e.jsonData.tracesToMetrics)||void 0===i?void 0:i.spanEndTimeShift)||"",onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{spanEndTimeShift:n}))},placeholder:"2m",isInvalidError:C})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Tags that will be used in the metrics query",label:"Tags",labelWidth:26,children:(0,r.jsx)(O,{values:null!==(h=null===(s=e.jsonData.tracesToMetrics)||void 0===s?void 0:s.tags)&&void 0!==h?h:[],onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{tags:n}))})})}),null===(p=e.jsonData.tracesToMetrics)||void 0===p||null===(u=p.queries)||void 0===u?void 0:u.map(((n,o)=>(0,r.jsxs)("div",{className:d.queryRow,children:[(0,r.jsx)(c.InlineField,{label:"Link Label",labelWidth:26,tooltip:"Descriptive label for the linked query",children:(0,r.jsx)(c.Input,{label:"Link Label",type:"text",allowFullScreen:!0,value:n.name,width:40,onChange:n=>{var r,a;const i=(null!==(a=null===(r=e.jsonData.tracesToMetrics)||void 0===r?void 0:r.queries)&&void 0!==a?a:[]).map(((e,t)=>t===o?q(F({},e),{name:n.currentTarget.value}):e));(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{queries:i}))}})}),(0,r.jsx)(c.InlineField,{label:"Query",labelWidth:10,tooltip:"The Prometheus query that will run when navigating from a trace to metrics. Interpolate tags using the `$__tags` keyword",grow:!0,children:(0,r.jsx)(c.Input,{label:"Query",type:"text",allowFullScreen:!0,value:n.query,onChange:n=>{var r,a;const i=(null!==(a=null===(r=e.jsonData.tracesToMetrics)||void 0===r?void 0:r.queries)&&void 0!==a?a:[]).map(((e,t)=>t===o?q(F({},e),{query:n.currentTarget.value}):e));(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{queries:i}))}})}),(0,r.jsx)(c.Button,{variant:"destructive",title:"Remove query",icon:"times",type:"button",onClick:()=>{var n;const r=null===(n=e.jsonData.tracesToMetrics)||void 0===n?void 0:n.queries.filter(((e,t)=>t!==o));(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{queries:r}))}})]},o))),(0,r.jsx)(c.Button,{variant:"secondary",title:"Add query",icon:"plus",type:"button",onClick:()=>{var n,r;(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToMetrics",q(F({},e.jsonData.tracesToMetrics),{queries:[...null!==(r=null===(n=e.jsonData.tracesToMetrics)||void 0===n?void 0:n.queries)&&void 0!==r?r:[],{query:""}]}))},children:"Add query"})]})}const N=({options:e,onOptionsChange:t})=>{let n=e.type;return n+="tempo"===e.type?"/configure-tempo-data-source/#trace-to-metrics":"/#trace-to-metrics",(0,r.jsx)(i.A,{title:"Trace to metrics",description:(0,r.jsx)(s.H,{description:"Navigate from a trace span to the selected data source's metrics.",suffix:n,feature:"trace to metrics"}),isCollapsible:!0,isInitiallyOpen:!0,children:(0,r.jsx)(M,{options:e,onOptionsChange:t})})},R=e=>({infoText:{paddingBottom:e.spacing(2),color:e.colors.text.secondary},row:(0,o.css)({label:"row",alignItems:"baseline"}),queryRow:(0,o.css)({label:"queryRow",display:"flex",flexFlow:"wrap"})});var B=n(6321);function J(e){const t=(n=e.profileTypes,(0,a.useMemo)((()=>{if(!n)return[];let e=new Map;for(let r of n){var t;let n=[];r.id.indexOf(":")>-1&&(n=r.id.split(":"));const[o,a]=n;e.has(o)||e.set(o,{label:o,value:o,items:[]}),null===(t=e.get(o))||void 0===t||t.items.push({label:a,value:r.id})}return Array.from(e.values())}),[n]));var n,o;return(0,r.jsx)(c.Cascader,{placeholder:e.placeholder,separator:"-",displayAllSelectedLevels:!0,initialValue:e.initialProfileTypeId,allowCustomValue:!0,onSelect:e.onChange,options:t,changeOnSelect:!1,width:null!==(o=e.width)&&void 0!==o?o:26})}function U(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function W(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){U(a,r,o,i,s,"next",e)}function s(e){U(a,r,o,i,s,"throw",e)}i(void 0)}))}}function L(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Q(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){L(e,t,n[t])}))}return e}function A(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function $({options:e,onOptionsChange:t}){var n,i,s,u,p,d,h,g;const f=(0,a.useMemo)((()=>["grafana-pyroscope-datasource"]),[]),[b,y]=(0,a.useState)([]),j=(0,a.useMemo)((()=>{var t;let n=0===b.length?"No profile types found":"Select profile type";return(null===(t=e.jsonData.tracesToProfiles)||void 0===t?void 0:t.datasourceUid)||(n="Please select profiling data source"),n}),[null===(n=e.jsonData.tracesToProfiles)||void 0===n?void 0:n.datasourceUid,b]),{value:v}=(0,B.A)(W((function*(){var t;return yield(0,l.getDataSourceSrv)().get(null===(t=e.jsonData.tracesToProfiles)||void 0===t?void 0:t.datasourceUid)})),[null===(i=e.jsonData.tracesToProfiles)||void 0===i?void 0:i.datasourceUid]),{value:m}=(0,B.A)(W((function*(){var t;if(v instanceof l.DataSourceWithBackend&&f.includes(v.type)&&v.uid===(null===(t=e.jsonData.tracesToProfiles)||void 0===t?void 0:t.datasourceUid))return yield null==v?void 0:v.getResource("profileTypes")})),[v]);var w;return(0,a.useEffect)((()=>{y(null!=m?m:[])}),[m]),(0,r.jsxs)("div",{className:(0,o.css)({width:"100%"}),children:[(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"The profiles data source the trace is going to navigate to",label:"Data source",labelWidth:26,children:(0,r.jsx)(l.DataSourcePicker,{inputId:"trace-to-profiles-data-source-picker",filter:e=>f.includes(e.type),current:null===(s=e.jsonData.tracesToProfiles)||void 0===s?void 0:s.datasourceUid,noDefault:!0,width:40,onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{datasourceUid:n.uid}))},onClear:()=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{datasourceUid:void 0}))}})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Tags that will be used in the query. Default tags: 'service.name', 'service.namespace'",label:"Tags",labelWidth:26,children:(0,r.jsx)(O,{values:null!==(w=null===(u=e.jsonData.tracesToProfiles)||void 0===u?void 0:u.tags)&&void 0!==w?w:[],onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{tags:n}))}})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Profile type that will be used in the query",label:"Profile type",labelWidth:26,children:(0,r.jsx)(J,{profileTypes:b,placeholder:j,initialProfileTypeId:null===(p=e.jsonData.tracesToProfiles)||void 0===p?void 0:p.profileTypeId,onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{profileTypeId:n}))},width:40})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:"Use a custom query with the possibility to interpolate variables from the trace or span",label:"Use custom query",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"profilesCustomQuerySwitch",value:null===(d=e.jsonData.tracesToProfiles)||void 0===d?void 0:d.customQuery,onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{customQuery:n.currentTarget.checked}))})})}),(null===(h=e.jsonData.tracesToProfiles)||void 0===h?void 0:h.customQuery)&&(0,r.jsx)(c.InlineField,{label:"Query",labelWidth:26,tooltip:"The query that will run when navigating from a trace to profiles data source. Interpolate tags using the `$__tags` keyword",grow:!0,children:(0,r.jsx)(c.Input,{label:"Query",type:"text",allowFullScreen:!0,value:(null===(g=e.jsonData.tracesToProfiles)||void 0===g?void 0:g.query)||"",onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tracesToProfiles",A(Q({},e.jsonData.tracesToProfiles),{query:n.currentTarget.value}))})})]})}const H=({options:e,onOptionsChange:t})=>(0,r.jsx)(i.A,{title:"Trace to profiles",description:(0,r.jsx)(s.H,{description:"Navigate from a trace span to the selected data source's profiles.",suffix:`${e.type}/configure-tempo-data-source/#trace-to-profiles`,feature:"trace to profiles"}),isCollapsible:!0,isInitiallyOpen:!0,children:(0,r.jsx)($,{options:e,onOptionsChange:t})});var _=n(838);function V(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function G(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function z({options:e,onOptionsChange:t}){var n;const o=(0,c.useStyles2)(X);return(0,r.jsx)("div",{className:o.container,children:(0,r.jsx)(c.InlineFieldRow,{className:o.row,children:(0,r.jsx)(c.InlineField,{tooltip:"Displays the node graph above the trace view. Default: disabled",label:"Enable node graph",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"enableNodeGraph",value:null===(n=e.jsonData.nodeGraph)||void 0===n?void 0:n.enabled,onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"nodeGraph",G(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){V(e,t,n[t])}))}return e}({},e.jsonData.nodeGraph),{enabled:n.currentTarget.checked}))})})})})}const K=({options:e,onOptionsChange:t})=>{let n=e.type;return n+="tempo"===e.type?"/configure-tempo-data-source/#node-graph":"/#node-graph",(0,r.jsx)(_.I,{title:"Node graph",description:(0,r.jsx)(s.H,{description:"Show or hide the node graph visualization.",suffix:n,feature:"the node graph"}),children:(0,r.jsx)(z,{options:e,onOptionsChange:t})})},X=e=>({infoText:(0,o.css)({label:"infoText",paddingBottom:e.spacing(2),color:e.colors.text.secondary}),container:(0,o.css)({label:"container",width:"100%"}),row:(0,o.css)({label:"row",alignItems:"baseline"})});function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Y(e,t,n[t])}))}return e}function ee(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const te="None",ne="Duration",re="Tag";function oe({options:e,onOptionsChange:t}){var n,a,i;const s=(0,c.useStyles2)(ie),l=[te,ne,re].map(k.toOption);return(0,r.jsxs)("div",{className:(0,o.css)({width:"100%"}),children:[(0,r.jsx)(c.InlineFieldRow,{className:s.row,children:(0,r.jsx)(c.InlineField,{label:"Label",labelWidth:26,tooltip:"Default: duration",grow:!0,children:(0,r.jsx)(c.Select,{inputId:"label",options:l,value:(null===(n=e.jsonData.spanBar)||void 0===n?void 0:n.type)||"",onChange:n=>{var r;(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"spanBar",ee(Z({},e.jsonData.spanBar),{type:null!==(r=null==n?void 0:n.value)&&void 0!==r?r:""}))},placeholder:"Duration",isClearable:!0,"aria-label":"select-label-name",width:40})})}),(null===(a=e.jsonData.spanBar)||void 0===a?void 0:a.type)===re&&(0,r.jsx)(c.InlineFieldRow,{className:s.row,children:(0,r.jsx)(c.InlineField,{label:"Tag key",labelWidth:26,tooltip:"Tag key which will be used to get the tag value. A span's attributes and resources will be searched for the tag key",children:(0,r.jsx)(c.Input,{type:"text",placeholder:"Enter tag key",onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"spanBar",ee(Z({},e.jsonData.spanBar),{tag:n.currentTarget.value})),value:(null===(i=e.jsonData.spanBar)||void 0===i?void 0:i.tag)||"",width:40})})})]})}const ae=({options:e,onOptionsChange:t})=>{let n=e.type;return n+="tempo"===e.type?"/configure-tempo-data-source/#span-bar":"/#span-bar",(0,r.jsx)(_.I,{title:"Span bar",description:(0,r.jsx)(s.H,{description:"Add additional info next to the service and operation on a span bar row in the trace view.",suffix:n,feature:"the span bar"}),children:(0,r.jsx)(oe,{options:e,onOptionsChange:t})})},ie=e=>({infoText:(0,o.css)({label:"infoText",paddingBottom:e.spacing(2),color:e.colors.text.secondary}),row:(0,o.css)({label:"row",alignItems:"baseline"})});var se=n(4305),le=n(1535),ce=n(3260),ue=n(8455),pe=n(1080);function de(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function he(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){de(e,t,n[t])}))}return e}function ge(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function fe({options:e,onOptionsChange:t}){var n,o,a,i,s;const l=(0,c.useStyles2)(be),u=e=>`Time shift for ${e} of search`,p=e=>`Shifts the ${e} of the time range when searching by TraceID. Searching can return traces that do not fully fall into the search time range, so we recommend using higher time shifts for longer traces. Default: 30m (Time units can be used here, for example: 5s, 1m, 3h`;return(0,r.jsxs)("div",{className:l.container,children:[(0,r.jsx)(c.InlineField,{label:"Use time range in query",tooltip:"The time range can be used when there are performance issues or timeouts since it will narrow down the search to the defined range. Default: disabled",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"enable-time-shift",value:(null===(n=e.jsonData.traceQuery)||void 0===n?void 0:n.timeShiftEnabled)||!1,onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"traceQuery",ge(he({},e.jsonData.traceQuery),{timeShiftEnabled:n.currentTarget.checked}))}})}),(0,r.jsx)(f,{label:u("start"),tooltip:p("start"),value:(null===(o=e.jsonData.traceQuery)||void 0===o?void 0:o.spanStartTimeShift)||"",disabled:!(null===(a=e.jsonData.traceQuery)||void 0===a?void 0:a.timeShiftEnabled),onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"traceQuery",ge(he({},e.jsonData.traceQuery),{spanStartTimeShift:n}))},isInvalidError:C}),(0,r.jsx)(f,{label:u("end"),tooltip:p("end"),value:(null===(i=e.jsonData.traceQuery)||void 0===i?void 0:i.spanEndTimeShift)||"",disabled:!(null===(s=e.jsonData.traceQuery)||void 0===s?void 0:s.timeShiftEnabled),onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"traceQuery",ge(he({},e.jsonData.traceQuery),{spanEndTimeShift:n}))},isInvalidError:C})]})}const be=e=>({infoText:(0,o.css)({paddingBottom:e.spacing(2),color:e.colors.text.secondary}),container:(0,o.css)({width:"100%"}),row:(0,o.css)({alignItems:"baseline"})});function ye(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function je(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Oe({options:e,onOptionsChange:t}){var n,o,a;const i=(0,c.useStyles2)(be),s=(0,r.jsxs)(r.Fragment,{children:["Select which type of histograms are configured in the ",(0,r.jsx)("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/tempo/latest/setup-and-configuration/metrics-generator/",target:"_blank",rel:"noopener noreferrer",children:"Tempo metrics generator"}),". If native histograms are configured, you must also configure native histograms ingestion in ",(0,r.jsx)("a",{style:{textDecoration:"underline"},href:"https://prometheus.io/docs/specs/native_histograms/#native-histograms",target:"_blank",rel:"noopener noreferrer",children:"Prometheus"})," or"," ",(0,r.jsx)("a",{style:{textDecoration:"underline"},href:"https://grafana.com/docs/mimir/latest/configure/configure-native-histograms-ingestion/#configure-native-histograms-globally",target:"_blank",rel:"noopener noreferrer",children:"Mimir"}),"."]});return(0,r.jsxs)("div",{className:i.container,children:[(0,r.jsxs)(c.InlineFieldRow,{className:i.row,children:[(0,r.jsx)(c.InlineField,{tooltip:"The Prometheus data source with the service graph data",label:"Data source",labelWidth:26,children:(0,r.jsx)(l.DataSourcePicker,{inputId:"service-graph-data-source-picker",pluginId:"prometheus",current:null===(n=e.jsonData.serviceMap)||void 0===n?void 0:n.datasourceUid,noDefault:!0,width:40,onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"serviceMap",{datasourceUid:n.uid})})}),(null===(o=e.jsonData.serviceMap)||void 0===o?void 0:o.datasourceUid)?(0,r.jsx)(c.Button,{type:"button",variant:"secondary",size:"sm",fill:"text",onClick:()=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"serviceMap",{datasourceUid:void 0})},children:"Clear"}):null]}),(0,r.jsx)(c.InlineFieldRow,{className:i.row,children:(0,r.jsx)(c.InlineField,{tooltip:s,label:"Histogram type",labelWidth:26,interactive:!0,children:(0,r.jsx)(c.Combobox,{id:"histogram-type-select",value:(null===(a=e.jsonData.serviceMap)||void 0===a?void 0:a.histogramType)||"classic",width:40,options:[{label:"Classic",value:"classic"},{label:"Native",value:"native"},{label:"Both",value:"both"}],onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"serviceMap",je(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){ye(e,t,n[t])}))}return e}({},e.jsonData.serviceMap),{histogramType:n.value}))})})})]})}var ve=n(9638);function me(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){me(e,t,n[t])}))}return e}function De(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}const xe=({options:e,onOptionsChange:t})=>{var n,o;const a=(0,c.useStyles2)(Pe);return(0,r.jsxs)(i.A,{title:"Streaming",isCollapsible:!1,description:(0,r.jsxs)(c.Stack,{gap:.5,children:[(0,r.jsx)("div",{children:"Enable streaming for different Tempo features."}),(0,r.jsx)("a",{href:"https://grafana.com/docs/tempo/latest/traceql/#stream-query-results",target:"_blank",rel:"noreferrer",className:a.a,children:"Learn more"})]}),children:[(0,r.jsx)(c.Alert,{severity:"info",title:"Streaming and self-managed Tempo instances",children:"If your Tempo instance is behind a load balancer or proxy that does not supporting gRPC or HTTP2, streaming will probably not work and should be disabled."}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:`Enable streaming for search queries. Minimum required version for Tempo: ${ve.yJ[ve.SD.searchStreaming]}.`,label:"Search queries",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"streamingEnabled.search",value:(null===(n=e.jsonData.streamingEnabled)||void 0===n?void 0:n.search)||!1,onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"streamingEnabled",De(we({},e.jsonData.streamingEnabled),{search:n.currentTarget.checked}))}})})}),(0,r.jsx)(c.InlineFieldRow,{children:(0,r.jsx)(c.InlineField,{tooltip:`Enable streaming for metrics queries. Minimum required version for Tempo: ${ve.yJ[ve.SD.metricsStreaming]}.`,label:"Metrics queries",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"streamingEnabled.metrics",value:(null===(o=e.jsonData.streamingEnabled)||void 0===o?void 0:o.metrics)||!1,onChange:n=>{(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"streamingEnabled",De(we({},e.jsonData.streamingEnabled),{metrics:n.currentTarget.checked}))}})})})]})},Pe=e=>({a:(0,o.css)({color:e.colors.text.link,textDecoration:"underline",marginLeft:"5px","&:hover":{textDecoration:"none"}})});function Te({options:e,onOptionsChange:t}){const n=(0,c.useStyles2)(Ce);return(0,r.jsx)("div",{className:(0,o.css)({width:"100%"}),children:(0,r.jsx)(c.InlineFieldRow,{className:n.row,children:(0,r.jsx)(c.InlineField,{label:"Max tags and tag values",labelWidth:26,tooltip:"Specify the max number of tags and tag values to display in the Tempo editor. Default: 5000",children:(0,r.jsx)(c.Input,{type:"number",placeholder:"5000",onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"tagLimit",n.currentTarget.value),value:e.jsonData.tagLimit||"",width:40})})})})}const Se=({options:e,onOptionsChange:t})=>(0,r.jsx)(_.I,{title:"Tag limit",description:(0,r.jsx)(s.H,{description:"Specify the limit for tags and tag values.",suffix:"/#tag-limit",feature:"the tag limit"}),children:(0,r.jsx)(Te,{options:e,onOptionsChange:t})}),Ce=e=>({infoText:(0,o.css)({label:"infoText",paddingBottom:e.spacing(2),color:e.colors.text.secondary}),row:(0,o.css)({label:"row",alignItems:"baseline"})});var Ie=n(1777),ke=n(5876),Ee=n(9183),Fe=n(3292),qe=n(5645);function Me(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function Ne(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Re(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ne(e,t,n[t])}))}return e}function Be(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Je({options:e,onOptionsChange:t,datasource:n}){var o,i,s;const l=function(){var e,t=(e=function*(){if(!n)throw new Error("Unable to retrieve datasource");try{yield n.languageProvider.start()}catch(e){throw new Error((0,qe.u1)(e.data.message,"Unable to query Tempo"))}},function(){var t=this,n=arguments;return new Promise((function(r,o){var a=e.apply(t,n);function i(e){Me(a,r,o,i,s,"next",e)}function s(e){Me(a,r,o,i,s,"throw",e)}i(void 0)}))});return function(){return t.apply(this,arguments)}}(),{error:u,loading:p}=(0,Ie.A)(l,[n,e]),d=(0,a.useCallback)((n=>{var r;let o=null===(r=e.jsonData.search)||void 0===r?void 0:r.filters;o||(o=[]);const a=o.findIndex((e=>e.id===n.id));a>=0?o=(0,Ee._D)(o,a,n):o.push(n),(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"search",Be(Re({},e.jsonData.search),{filters:o}))}),[t,e]);(0,a.useEffect)((()=>{var n;(null===(n=e.jsonData.search)||void 0===n?void 0:n.filters)||(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"search",Be(Re({},e.jsonData.search),{filters:[{id:"service-name",tag:"service.name",operator:"=",scope:Fe.d.Resource},{id:"span-name",tag:"name",operator:"=",scope:Fe.d.Span}]}))}),[t,e]);const h=null===(i=e.jsonData.search)||void 0===i||null===(o=i.filters)||void 0===o?void 0:o.find((e=>!e.tag));return(0,r.jsxs)(r.Fragment,{children:[n?(0,r.jsx)(ke.A,{updateFilter:d,deleteFilter:n=>{var r,o;(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"search",Be(Re({},e.jsonData.search),{filters:null===(o=e.jsonData.search)||void 0===o||null===(r=o.filters)||void 0===r?void 0:r.filter((e=>e.id!==n.id))}))},filters:(null===(s=e.jsonData.search)||void 0===s?void 0:s.filters)||[],datasource:n,setError:()=>{},staticTags:["duration"],isTagsLoading:p,hideValues:!0,generateQueryWithoutFilter:()=>"{}"}):(0,r.jsx)("div",{children:"Invalid data source, please create a valid data source and try again"}),u&&(0,r.jsx)(c.Alert,{title:"Unable to fetch TraceQL tags",severity:"error",topSpacing:1,children:u.message}),h&&(0,r.jsx)(c.Alert,{title:"Please ensure each filter has a selected tag",severity:"warning",topSpacing:1})]})}function Ue(e,t,n,r,o,a,i){try{var s=e[a](i),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,o)}function We(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Le(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})),e}function Qe({options:e,onOptionsChange:t}){var n;const o=(0,c.useStyles2)(be),a=(0,l.getDataSourceSrv)(),i=function(){var t,n=(t=function*(){return yield a.get({type:e.type,uid:e.uid})},function(){var e=this,n=arguments;return new Promise((function(r,o){var a=t.apply(e,n);function i(e){Ue(a,r,o,i,s,"next",e)}function s(e){Ue(a,r,o,i,s,"throw",e)}i(void 0)}))});return function(){return n.apply(this,arguments)}}(),{value:s}=(0,Ie.A)(i,[a,e]);return(0,r.jsxs)("div",{className:o.container,children:[(0,r.jsx)(c.InlineFieldRow,{className:o.row,children:(0,r.jsx)(c.InlineField,{tooltip:"Removes the search tab from the query editor",label:"Hide search",labelWidth:26,children:(0,r.jsx)(c.InlineSwitch,{id:"hideSearch",value:null===(n=e.jsonData.search)||void 0===n?void 0:n.hide,onChange:n=>(0,k.updateDatasourcePluginJsonDataOption)({onOptionsChange:t,options:e},"search",Le(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){We(e,t,n[t])}))}return e}({},e.jsonData.search),{hide:n.currentTarget.checked}))})})}),(0,r.jsx)(c.InlineFieldRow,{className:o.row,children:(0,r.jsx)(c.InlineField,{tooltip:"Configures which fields are available in the UI",label:"Static filters",labelWidth:26,children:(0,r.jsx)(Je,{datasource:s,options:e,onOptionsChange:t})})})]})}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),r.forEach((function(t){Ae(e,t,n[t])}))}return e}const He=e=>({container:(0,o.css)({marginBottom:e.spacing(2),maxWidth:"900px"})}),_e=({options:e,onOptionsChange:t})=>{const n=(0,c.useStyles2)(He);return(0,r.jsxs)("div",{className:n.container,children:[(0,r.jsx)(se.I,{dataSourceName:"Tempo",docsLink:"https://grafana.com/docs/grafana/latest/datasources/tempo",hasRequiredFields:!1}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(le.u,{config:e,onChange:t,urlPlaceholder:"http://localhost:3200"}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(ce.N,$e({},(0,ue.pe)({config:e,onChange:t}))),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(xe,{options:e,onOptionsChange:t}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(I,{options:e,onOptionsChange:t}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(N,{options:e,onOptionsChange:t}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(H,{options:e,onOptionsChange:t}),(0,r.jsx)(c.Divider,{spacing:4}),(0,r.jsx)(i.A,{title:"Additional settings",description:"Additional settings are optional settings that can be configured for more control over your data source.",isCollapsible:!0,isInitiallyOpen:!1,children:(0,r.jsxs)(c.Stack,{gap:5,direction:"column",children:[(0,r.jsx)(pe.g,{config:e,onChange:t}),l.config.secureSocksDSProxyEnabled&&(0,r.jsx)(c.SecureSocksProxySettings,{options:e,onOptionsChange:t}),(0,r.jsx)(_.I,{title:"Service graph",description:(0,r.jsx)(s.H,{description:"Select a Prometheus data source that contains the service graph data.",suffix:"tempo/configure-tempo-data-source/#service-graph",feature:"the service graph"}),children:(0,r.jsx)(Oe,{options:e,onOptionsChange:t})}),(0,r.jsx)(K,{options:e,onOptionsChange:t}),(0,r.jsx)(_.I,{title:"Tempo search",description:(0,r.jsx)(s.H,{description:"Modify how traces are searched.",suffix:"tempo/configure-tempo-data-source/#tempo-search",feature:"Tempo search"}),children:(0,r.jsx)(Qe,{options:e,onOptionsChange:t})}),(0,r.jsx)(_.I,{title:"TraceID query",description:(0,r.jsx)(s.H,{description:"Modify how TraceID queries are run.",suffix:"tempo/configure-tempo-data-source/#traceid-query",feature:"the TraceID query"}),children:(0,r.jsx)(fe,{options:e,onOptionsChange:t})}),(0,r.jsx)(ae,{options:e,onOptionsChange:t}),(0,r.jsx)(Se,{options:e,onOptionsChange:t})]})})]})}}}]);
//# sourceMappingURL=6114.js.map