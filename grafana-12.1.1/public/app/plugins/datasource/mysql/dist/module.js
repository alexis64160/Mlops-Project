/*! For license information please see module.js.LICENSE.txt */
/* [create-plugin] version: 5.22.0 */
define(["module","@grafana/data","rxjs","rxjs/operators","@grafana/runtime","lodash","react","@emotion/css","@grafana/ui","moment","redux","react-redux"],((e,t,r,n,o,i,a,s,l,u,c,p)=>(()=>{var f,d,v,h,g={2381:(e,t,r)=>{"use strict";r.d(t,{d$:()=>xb,M$:()=>WO,XK:()=>wg,Aq:()=>kb});var n={};r.r(n),r.d(n,{applyToJS:()=>Uo,cleanJSX:()=>Go,clone:()=>fo(),deepEqual:()=>jo,deepFreeze:()=>Yo,escapeRegExp:()=>Bo,getFirstDefined:()=>Qo,getLogger:()=>Xo,getOpCardinality:()=>No,hasSafeOwnProperty:()=>Lo,isDirtyJSX:()=>Ko,isImmutable:()=>Do,isImmutableList:()=>Vo,isJSX:()=>$o,isJsonCompatible:()=>Jo,isJsonLogic:()=>Wo,isObject:()=>So,isObjectOrArray:()=>_o,isSafeKeyForObject:()=>Io,isTypeOf:()=>Ro,logger:()=>Zo,mergeArraysSmart:()=>Ho,mergeCustomizerNoArrays:()=>qo,mergeIn:()=>Ao,moment:()=>ho(),omit:()=>xo,opDefKeysToOmit:()=>Eo,setIn:()=>Co,shallowCopy:()=>wo,shallowEqual:()=>Fo,sleep:()=>zo,toImmutableList:()=>Mo,typeOf:()=>To,uuid:()=>co,widgetDefKeysToOmit:()=>bo});var o={};r.r(o),r.d(o,{_fixImmutableValue:()=>ea,expandTreePath:()=>Ui,expandTreeSubpath:()=>Bi,fixEmptyGroupsInTree:()=>Wi,fixPathsInTree:()=>$i,getAncestorRuleGroups:()=>Gi,getFlatTree:()=>zi,getItemByPath:()=>qi,getLightTree:()=>Ji,getSwitchValues:()=>Xi,getTotalReordableNodesCountInTree:()=>Hi,getTotalRulesCountInTree:()=>Yi,hasChildren:()=>Zi,immutableToJs:()=>Uo,isEmptyTree:()=>Qi,isImmutable:()=>Do,jsToImmutable:()=>ta,removeIsLockedInTree:()=>Ki,toImmutableList:()=>Mo});var i={};r.r(i),r.d(i,{calculateValueType:()=>ha,completeFuncValue:()=>Aa,completeValue:()=>Ca,formatFieldName:()=>Oa,getDefaultArgValue:()=>Na,getFieldPathLabels:()=>ya,getFuncPathLabels:()=>ga,getOneChildOrDescendant:()=>xa,getValueLabel:()=>ma,isEmptyGroupChildren:()=>Ta,isEmptyItem:()=>ba,isEmptyRuleGroupExtPropertiesAndChildren:()=>Sa,isEmptyRuleProperties:()=>wa,setArgValue:()=>ja,setFuncDefaultArg:()=>Pa,setFuncDefaultArgs:()=>Fa,whatRulePropertiesAreCompleted:()=>Ia});var a={};r.r(a),r.d(a,{addJsonLogicOperation:()=>Qa,addRequiredJsonLogicOperations:()=>es,applyJsonLogic:()=>Xa,customJsonLogicOperations:()=>Za,jsonLogicFormatConcat:()=>ts,jsonLogicImportConcat:()=>rs});var s={};r.r(s),r.d(s,{LINEAR_REGRESSION:()=>hs,LOWER:()=>ds,NOW:()=>ss,RELATIVE_DATE:()=>fs,RELATIVE_DATETIME:()=>ps,START_OF_TODAY:()=>us,TODAY:()=>ls,TRUNCATE_DATETIME:()=>cs,UPPER:()=>vs});var l={};r.r(l),r.d(l,{mongoEmptyValue:()=>bl,mongoFieldEscape:()=>_l,mongoFieldUnescape:()=>Tl,mongoFormatOp1:()=>El,mongoFormatOp2:()=>Sl});var u={};r.r(u),r.d(u,{spelEscape:()=>Ml,spelFixList:()=>ql,spelFormatConcat:()=>Ul,spelImportConcat:()=>Bl});var c={};r.r(c),r.d(c,{SqlString:()=>Gl,mongoEmptyValue:()=>bl,spelEscape:()=>Ml,spelFixList:()=>ql,spelFormatConcat:()=>Ul,spelImportConcat:()=>Bl,sqlEmptyValue:()=>Kl,stringifyForDisplay:()=>$l,wrapWithBrackets:()=>Wl});var p={};r.r(p),r.d(p,{_mongodbFormat:()=>Al,_spelFormat:()=>fu,_sqlFormat:()=>Ql,elasticSearchFormat:()=>qu,jsonLogicFormat:()=>ul,mongodbFormat:()=>Cl,queryBuilderFormat:()=>Va,queryString:()=>Cu,spelFormat:()=>pu,sqlFormat:()=>Xl});var f={};r.r(f),r.d(f,{_getFromConfigCache:()=>Ti,_getWidgetsAndSrcsForFieldOp:()=>xi,_saveToConfigCache:()=>Ri,_widgetDefKeysToOmit:()=>li,applyJsonLogic:()=>Xa,areConfigsSame:()=>Ks,cleanJSX:()=>Go,compileConfig:()=>Ns,compressConfig:()=>As,configKeys:()=>ui,createConfigMemo:()=>zs,decompressConfig:()=>xs,extendConfig:()=>el,filterValueSourcesForField:()=>Ni,findExtendedConfigInAllMemos:()=>Ws,getCommonMemo:()=>$s,getFieldConfig:()=>Ii,getFieldId:()=>_i,getFieldParts:()=>Ei,getFieldPartsConfigs:()=>Mi,getFieldPath:()=>bi,getFieldPathParts:()=>Si,getFieldRawConfig:()=>vi,getFieldSrc:()=>wi,getFieldWidgetConfig:()=>Ci,getFirstField:()=>Ai,getFirstOperator:()=>Vi,getFuncArgConfig:()=>mi,getFuncConfig:()=>yi,getFuncSignature:()=>gi,getOperatorConfig:()=>Li,getOperatorsForField:()=>Di,getOperatorsForType:()=>ki,getValueSourcesForFieldOp:()=>Fi,getWidgetForFieldOp:()=>ji,getWidgetsForFieldOp:()=>Pi,isDirtyJSX:()=>Ko,isFieldDescendantOfField:()=>Oi,isJSX:()=>$o,iterateFields:()=>fi,iterateFuncs:()=>pi,normalizeField:()=>hi,selectTypes:()=>ci});var d={};r.r(d),r.d(d,{getItemInListValues:()=>bf,getListValue:()=>Rf,getTitleInListValues:()=>Ef,getValueInListValues:()=>Sf,listValuesToArray:()=>Of,makeCustomListValue:()=>mf,mapListValues:()=>_f,searchListValue:()=>Tf,toListValue:()=>yf});var v={};r.r(v),r.d(v,{_validateTree:()=>Ff,checkTree:()=>Af,getTreeBadFields:()=>Cf,isValidTree:()=>Lf,sanitizeTree:()=>Nf,translateValidation:()=>lf,validateAndFixTree:()=>jf,validateRange:()=>Gf,validateTree:()=>xf,validateValue:()=>Mf});var h={};r.r(h),r.d(h,{getCompatibleArgsOnFuncChange:()=>zf,getDefaultArgValue:()=>Na,setArgValue:()=>ja,setArgValueAsyncListValues:()=>Wf,setArgValueSrc:()=>$f,setFunc:()=>Kf,setFuncDefaultArg:()=>Pa,setFuncDefaultArgs:()=>Fa});var g={};r.r(g),r.d(g,{createListFromArray:()=>pa,createListWithOneElement:()=>ca,defaultConjunction:()=>ra,defaultGroupConjunction:()=>oa,defaultGroupProperties:()=>ia,defaultItemProperties:()=>Xf,defaultOperatorOptions:()=>na,defaultRoot:()=>Zf,defaultRule:()=>Qf,defaultRuleProperties:()=>Jf,emptyProperties:()=>fa,getDefaultField:()=>aa,getDefaultFieldSrc:()=>la,getDefaultOperator:()=>ua,getDefaultSubField:()=>sa});var y={};r.r(y),r.d(y,{fixListValuesGroupOrder:()=>pd,getListValue:()=>Rf,listValueToOption:()=>cd,mergeListValues:()=>sd,optionToListValue:()=>ld,optionsToListValues:()=>ud,simulateAsyncFetch:()=>ad});var m={};r.r(m),r.d(m,{Autocomplete:()=>y,ConfigUtils:()=>f,DefaultUtils:()=>g,ExportUtils:()=>c,FuncUtils:()=>h,JsonLogicUtils:()=>a,ListUtils:()=>d,MongoUtils:()=>l,OtherUtils:()=>n,RuleUtils:()=>i,SpelUtils:()=>u,TreeUtils:()=>o,Validation:()=>v,checkTree:()=>Af,clone:()=>fo(),compressConfig:()=>As,decompressConfig:()=>xs,getSwitchValues:()=>Xi,i18n:()=>uf,isValidTree:()=>Lf,moment:()=>ho(),sanitizeTree:()=>Nf,uuid:()=>co,validateAndFixTree:()=>jf,validateTree:()=>xf});var O={};r.r(O),r.d(O,{_loadFromJsonLogic:()=>lc,_loadFromSpel:()=>fv,getTree:()=>Gu,isImmutableTree:()=>$u,isJsonLogic:()=>Wo,isTree:()=>Wu,jsToImmutable:()=>ta,loadFromJsonLogic:()=>sc,loadFromSpel:()=>pv,loadTree:()=>Ku});var b={};r.r(b),r.d(b,{addCaseGroup:()=>Oh,addDefaultCaseGroup:()=>mh,addGroup:()=>bh,addRule:()=>gh,moveItem:()=>Sh,removeGroup:()=>Eh,removeRule:()=>yh,setTree:()=>hh});var E={};r.r(E),r.d(E,{setConjunction:()=>_h,setLock:()=>Rh,setNot:()=>Th});var S={};r.r(S),r.d(S,{setField:()=>wh,setFieldSrc:()=>Ih,setFuncValue:()=>xh,setOperator:()=>Lh,setOperatorOption:()=>Nh,setValue:()=>Ch,setValueSrc:()=>Ah});var _={};r.r(_),r.d(_,{bindActionCreators:()=>vg,isUsingLegacyReactDomRender:()=>cg,liteShouldComponentUpdate:()=>pg,pureShouldComponentUpdate:()=>fg,useOnPropsChanged:()=>dg});var T={};r.r(T),r.d(T,{FuncWidget:()=>sm,ValueFieldWidget:()=>rb,VanillaBooleanWidget:()=>nb,VanillaButton:()=>Ob,VanillaButtonGroup:()=>Eb,VanillaConjs:()=>yb,VanillaDateTimeWidget:()=>ub,VanillaDateWidget:()=>ab,VanillaFieldSelect:()=>gb,VanillaIcon:()=>bb,VanillaMultiSelectWidget:()=>pb,VanillaNumberWidget:()=>vb,VanillaProvider:()=>Rb,VanillaSelectWidget:()=>db,VanillaSliderWidget:()=>hb,VanillaSwitch:()=>_b,VanillaTextAreaWidget:()=>ib,VanillaTextWidget:()=>ob,VanillaTimeWidget:()=>sb,VanillaValueSources:()=>Sb,vanillaConfirm:()=>Tb});var R={};function w(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function I(e){return I="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},I(e)}function L(e){var t=function(e,t){if("object"!=I(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=I(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==I(t)?t:t+""}function C(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,L(n.key),n)}}function A(e,t,r){return t&&C(e.prototype,t),r&&C(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function x(e,t){if(t&&("object"==I(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function N(e){return N=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},N(e)}function j(e,t){return j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},j(e,t)}function F(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&j(e,t)}r.r(R),r.d(R,{ProximityOperator:()=>Ib});var P=r(5959),k=r.n(P);function D(e){return D="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},D(e)}function V(e){var t=function(e,t){if("object"!=D(e)||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,t||"default");if("object"!=D(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==D(t)?t:t+""}function M(e,t,r){return(t=V(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function U(e){if(Array.isArray(e))return e}function B(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function q(e,t){if(e){if("string"==typeof e)return B(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(e,t):void 0}}function G(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function K(e,t){return U(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||q(e,t)||G()}function $(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}function W(e){return function(e){if(Array.isArray(e))return B(e)}(e)||$(e)||q(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var z="delete",H=32,Y=31,J={};function X(e){e&&(e.value=!0)}function Q(){}function Z(e){return void 0===e.size&&(e.size=e.__iterate(te)),e.size}function ee(e,t){if("number"!=typeof t){var r=t>>>0;if(""+r!==t||4294967295===r)return NaN;t=r}return t<0?Z(e)+t:t}function te(){return!0}function re(e,t,r){return(0===e&&!ae(e)||void 0!==r&&e<=-r)&&(void 0===t||void 0!==r&&t>=r)}function ne(e,t){return ie(e,t,0)}function oe(e,t){return ie(e,t,t)}function ie(e,t,r){return void 0===e?r:ae(e)?t===1/0?t:0|Math.max(0,t+e):void 0===t||t===e?e:0|Math.min(t,e)}function ae(e){return e<0||0===e&&1/e==-1/0}var se="@@__IMMUTABLE_ITERABLE__@@";function le(e){return Boolean(e&&e[se])}var ue="@@__IMMUTABLE_KEYED__@@";function ce(e){return Boolean(e&&e[ue])}var pe="@@__IMMUTABLE_INDEXED__@@";function fe(e){return Boolean(e&&e[pe])}function de(e){return ce(e)||fe(e)}var ve=function(e){return le(e)?e:De(e)},he=function(e){function t(e){return ce(e)?e:Ve(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(ve),ge=function(e){function t(e){return fe(e)?e:Me(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(ve),ye=function(e){function t(e){return le(e)&&!de(e)?e:Ue(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t}(ve);ve.Keyed=he,ve.Indexed=ge,ve.Set=ye;var me="@@__IMMUTABLE_SEQ__@@";function Oe(e){return Boolean(e&&e[me])}var be="@@__IMMUTABLE_RECORD__@@";function Ee(e){return Boolean(e&&e[be])}function Se(e){return le(e)||Ee(e)}var _e="@@__IMMUTABLE_ORDERED__@@";function Te(e){return Boolean(e&&e[_e])}var Re="function"==typeof Symbol&&Symbol.iterator,we="@@iterator",Ie=Re||we,Le=function(e){this.next=e};function Ce(e,t,r,n){var o=0===e?t:1===e?r:[t,r];return n?n.value=o:n={value:o,done:!1},n}function Ae(){return{value:void 0,done:!0}}function xe(e){return!!Array.isArray(e)||!!Fe(e)}function Ne(e){return e&&"function"==typeof e.next}function je(e){var t=Fe(e);return t&&t.call(e)}function Fe(e){var t=e&&(Re&&e[Re]||e[we]);if("function"==typeof t)return t}Le.prototype.toString=function(){return"[Iterator]"},Le.KEYS=0,Le.VALUES=1,Le.ENTRIES=2,Le.prototype.inspect=Le.prototype.toSource=function(){return this.toString()},Le.prototype[Ie]=function(){return this};var Pe=Object.prototype.hasOwnProperty;function ke(e){return!(!Array.isArray(e)&&"string"!=typeof e)||e&&"object"==typeof e&&Number.isInteger(e.length)&&e.length>=0&&(0===e.length?1===Object.keys(e).length:e.hasOwnProperty(e.length-1))}var De=function(e){function t(e){return null==e?$e():Se(e)?e.toSeq():function(e){var t=He(e);if(t)return(n=Fe(r=e))&&n===r.entries?t.fromEntrySeq():function(e){var t=Fe(e);return t&&t===e.keys}(e)?t.toSetSeq():t;var r,n;if("object"==typeof e)return new qe(e);throw new TypeError("Expected Array or collection object of values, or keyed object: "+e)}(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq {","}")},t.prototype.cacheResult=function(){return!this._cache&&this.__iterateUncached&&(this._cache=this.entrySeq().toArray(),this.size=this._cache.length),this},t.prototype.__iterate=function(e,t){var r=this._cache;if(r){for(var n=r.length,o=0;o!==n;){var i=r[t?n-++o:o++];if(!1===e(i[1],i[0],this))break}return o}return this.__iterateUncached(e,t)},t.prototype.__iterator=function(e,t){var r=this._cache;if(r){var n=r.length,o=0;return new Le((function(){if(o===n)return{value:void 0,done:!0};var i=r[t?n-++o:o++];return Ce(e,i[0],i[1])}))}return this.__iteratorUncached(e,t)},t}(ve),Ve=function(e){function t(e){return null==e?$e().toKeyedSeq():le(e)?ce(e)?e.toSeq():e.fromEntrySeq():Ee(e)?e.toSeq():We(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toKeyedSeq=function(){return this},t}(De),Me=function(e){function t(e){return null==e?$e():le(e)?ce(e)?e.entrySeq():e.toIndexedSeq():Ee(e)?e.toSeq().entrySeq():ze(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toIndexedSeq=function(){return this},t.prototype.toString=function(){return this.__toString("Seq [","]")},t}(De),Ue=function(e){function t(e){return(le(e)&&!de(e)?e:Me(e)).toSetSeq()}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return t(arguments)},t.prototype.toSetSeq=function(){return this},t}(De);De.isSeq=Oe,De.Keyed=Ve,De.Set=Ue,De.Indexed=Me,De.prototype[me]=!0;var Be=function(e){function t(e){this._array=e,this.size=e.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this.has(e)?this._array[ee(this,e)]:t},t.prototype.__iterate=function(e,t){for(var r=this._array,n=r.length,o=0;o!==n;){var i=t?n-++o:o++;if(!1===e(r[i],i,this))break}return o},t.prototype.__iterator=function(e,t){var r=this._array,n=r.length,o=0;return new Le((function(){if(o===n)return{value:void 0,done:!0};var i=t?n-++o:o++;return Ce(e,i,r[i])}))},t}(Me),qe=function(e){function t(e){var t=Object.keys(e).concat(Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(e):[]);this._object=e,this._keys=t,this.size=t.length}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return void 0===t||this.has(e)?this._object[e]:t},t.prototype.has=function(e){return Pe.call(this._object,e)},t.prototype.__iterate=function(e,t){for(var r=this._object,n=this._keys,o=n.length,i=0;i!==o;){var a=n[t?o-++i:i++];if(!1===e(r[a],a,this))break}return i},t.prototype.__iterator=function(e,t){var r=this._object,n=this._keys,o=n.length,i=0;return new Le((function(){if(i===o)return{value:void 0,done:!0};var a=n[t?o-++i:i++];return Ce(e,a,r[a])}))},t}(Ve);qe.prototype[_e]=!0;var Ge,Ke=function(e){function t(e){this._collection=e,this.size=e.length||e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.__iterateUncached=function(e,t){if(t)return this.cacheResult().__iterate(e,t);var r=je(this._collection),n=0;if(Ne(r))for(var o;!(o=r.next()).done&&!1!==e(o.value,n++,this););return n},t.prototype.__iteratorUncached=function(e,t){if(t)return this.cacheResult().__iterator(e,t);var r=je(this._collection);if(!Ne(r))return new Le(Ae);var n=0;return new Le((function(){var t=r.next();return t.done?t:Ce(e,n++,t.value)}))},t}(Me);function $e(){return Ge||(Ge=new Be([]))}function We(e){var t=He(e);if(t)return t.fromEntrySeq();if("object"==typeof e)return new qe(e);throw new TypeError("Expected Array or collection object of [k, v] entries, or keyed object: "+e)}function ze(e){var t=He(e);if(t)return t;throw new TypeError("Expected Array or collection object of values: "+e)}function He(e){return ke(e)?new Be(e):xe(e)?new Ke(e):void 0}var Ye="@@__IMMUTABLE_MAP__@@";function Je(e){return Boolean(e&&e[Ye])}function Xe(e){return Je(e)&&Te(e)}function Qe(e){return Boolean(e&&"function"==typeof e.equals&&"function"==typeof e.hashCode)}function Ze(e,t){if(e===t||e!=e&&t!=t)return!0;if(!e||!t)return!1;if("function"==typeof e.valueOf&&"function"==typeof t.valueOf){if((e=e.valueOf())===(t=t.valueOf())||e!=e&&t!=t)return!0;if(!e||!t)return!1}return!!(Qe(e)&&Qe(t)&&e.equals(t))}var et="function"==typeof Math.imul&&-2===Math.imul(4294967295,2)?Math.imul:function(e,t){var r=65535&(e|=0),n=65535&(t|=0);return r*n+((e>>>16)*n+r*(t>>>16)<<16>>>0)|0};function tt(e){return e>>>1&1073741824|3221225471&e}var rt=Object.prototype.valueOf;function nt(e){if(null==e)return ot(e);if("function"==typeof e.hashCode)return tt(e.hashCode(e));var t,r=(t=e).valueOf!==rt&&"function"==typeof t.valueOf?t.valueOf(t):t;if(null==r)return ot(r);switch(typeof r){case"boolean":return r?1108378657:1108378656;case"number":return function(e){if(e!=e||e===1/0)return 0;var t=0|e;t!==e&&(t^=4294967295*e);for(;e>4294967295;)t^=e/=4294967295;return tt(t)}(r);case"string":return r.length>vt?function(e){var t=yt[e];void 0===t&&(t=it(e),gt===ht&&(gt=0,yt={}),gt++,yt[e]=t);return t}(r):it(r);case"object":case"function":return function(e){var t;if(ct&&void 0!==(t=ut.get(e)))return t;if(t=e[dt],void 0!==t)return t;if(!st){if(void 0!==(t=e.propertyIsEnumerable&&e.propertyIsEnumerable[dt]))return t;if(void 0!==(t=function(e){if(e&&e.nodeType>0)switch(e.nodeType){case 1:return e.uniqueID;case 9:return e.documentElement&&e.documentElement.uniqueID}}(e)))return t}if(t=lt(),ct)ut.set(e,t);else{if(void 0!==at&&!1===at(e))throw new Error("Non-extensible objects are not allowed as keys.");if(st)Object.defineProperty(e,dt,{enumerable:!1,configurable:!1,writable:!1,value:t});else if(void 0!==e.propertyIsEnumerable&&e.propertyIsEnumerable===e.constructor.prototype.propertyIsEnumerable)e.propertyIsEnumerable=function(){return this.constructor.prototype.propertyIsEnumerable.apply(this,arguments)},e.propertyIsEnumerable[dt]=t;else{if(void 0===e.nodeType)throw new Error("Unable to set a non-enumerable property on object.");e[dt]=t}}return t}(r);case"symbol":return function(e){var t=pt[e];if(void 0!==t)return t;return t=lt(),pt[e]=t,t}(r);default:if("function"==typeof r.toString)return it(r.toString());throw new Error("Value type "+typeof r+" cannot be hashed.")}}function ot(e){return null===e?1108378658:1108378659}function it(e){for(var t=0,r=0;r<e.length;r++)t=31*t+e.charCodeAt(r)|0;return tt(t)}var at=Object.isExtensible,st=function(){try{return Object.defineProperty({},"@",{}),!0}catch(e){return!1}}();function lt(){var e=++ft;return 1073741824&ft&&(ft=0),e}var ut,ct="function"==typeof WeakMap;ct&&(ut=new WeakMap);var pt=Object.create(null),ft=0,dt="__immutablehash__";"function"==typeof Symbol&&(dt=Symbol(dt));var vt=16,ht=255,gt=0,yt={},mt=function(e){function t(e,t){this._iter=e,this._useKeys=t,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.get=function(e,t){return this._iter.get(e,t)},t.prototype.has=function(e){return this._iter.has(e)},t.prototype.valueSeq=function(){return this._iter.valueSeq()},t.prototype.reverse=function(){var e=this,t=Tt(this,!0);return this._useKeys||(t.valueSeq=function(){return e._iter.toSeq().reverse()}),t},t.prototype.map=function(e,t){var r=this,n=_t(this,e,t);return this._useKeys||(n.valueSeq=function(){return r._iter.toSeq().map(e,t)}),n},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t,n){return e(t,n,r)}),t)},t.prototype.__iterator=function(e,t){return this._iter.__iterator(e,t)},t}(Ve);mt.prototype[_e]=!0;var Ot=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.includes=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this,n=0;return t&&Z(this),this._iter.__iterate((function(o){return e(o,t?r.size-++n:n++,r)}),t)},t.prototype.__iterator=function(e,t){var r=this,n=this._iter.__iterator(1,t),o=0;return t&&Z(this),new Le((function(){var i=n.next();return i.done?i:Ce(e,t?r.size-++o:o++,i.value,i)}))},t}(Me),bt=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.has=function(e){return this._iter.includes(e)},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){return e(t,t,r)}),t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new Le((function(){var t=r.next();return t.done?t:Ce(e,t.value,t.value,t)}))},t}(Ue),Et=function(e){function t(e){this._iter=e,this.size=e.size}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.entrySeq=function(){return this._iter.toSeq()},t.prototype.__iterate=function(e,t){var r=this;return this._iter.__iterate((function(t){if(t){Ft(t);var n=le(t);return e(n?t.get(1):t[1],n?t.get(0):t[0],r)}}),t)},t.prototype.__iterator=function(e,t){var r=this._iter.__iterator(1,t);return new Le((function(){for(;;){var t=r.next();if(t.done)return t;var n=t.value;if(n){Ft(n);var o=le(n);return Ce(e,o?n.get(0):n[0],o?n.get(1):n[1],t)}}}))},t}(Ve);function St(e){var t=kt(e);return t._iter=e,t.size=e.size,t.flip=function(){return e},t.reverse=function(){var t=e.reverse.apply(this);return t.flip=function(){return e.reverse()},t},t.has=function(t){return e.includes(t)},t.includes=function(t){return e.has(t)},t.cacheResult=Dt,t.__iterateUncached=function(t,r){var n=this;return e.__iterate((function(e,r){return!1!==t(r,e,n)}),r)},t.__iteratorUncached=function(t,r){if(2===t){var n=e.__iterator(t,r);return new Le((function(){var e=n.next();if(!e.done){var t=e.value[0];e.value[0]=e.value[1],e.value[1]=t}return e}))}return e.__iterator(1===t?0:1,r)},t}function _t(e,t,r){var n=kt(e);return n.size=e.size,n.has=function(t){return e.has(t)},n.get=function(n,o){var i=e.get(n,J);return i===J?o:t.call(r,i,n,e)},n.__iterateUncached=function(n,o){var i=this;return e.__iterate((function(e,o,a){return!1!==n(t.call(r,e,o,a),o,i)}),o)},n.__iteratorUncached=function(n,o){var i=e.__iterator(2,o);return new Le((function(){var o=i.next();if(o.done)return o;var a=o.value,s=a[0];return Ce(n,s,t.call(r,a[1],s,e),o)}))},n}function Tt(e,t){var r=this,n=kt(e);return n._iter=e,n.size=e.size,n.reverse=function(){return e},e.flip&&(n.flip=function(){var t=St(e);return t.reverse=function(){return e.flip()},t}),n.get=function(r,n){return e.get(t?r:-1-r,n)},n.has=function(r){return e.has(t?r:-1-r)},n.includes=function(t){return e.includes(t)},n.cacheResult=Dt,n.__iterate=function(r,n){var o=this,i=0;return n&&Z(e),e.__iterate((function(e,a){return r(e,t?a:n?o.size-++i:i++,o)}),!n)},n.__iterator=function(n,o){var i=0;o&&Z(e);var a=e.__iterator(2,!o);return new Le((function(){var e=a.next();if(e.done)return e;var s=e.value;return Ce(n,t?s[0]:o?r.size-++i:i++,s[1],e)}))},n}function Rt(e,t,r,n){var o=kt(e);return n&&(o.has=function(n){var o=e.get(n,J);return o!==J&&!!t.call(r,o,n,e)},o.get=function(n,o){var i=e.get(n,J);return i!==J&&t.call(r,i,n,e)?i:o}),o.__iterateUncached=function(o,i){var a=this,s=0;return e.__iterate((function(e,i,l){if(t.call(r,e,i,l))return s++,o(e,n?i:s-1,a)}),i),s},o.__iteratorUncached=function(o,i){var a=e.__iterator(2,i),s=0;return new Le((function(){for(;;){var i=a.next();if(i.done)return i;var l=i.value,u=l[0],c=l[1];if(t.call(r,c,u,e))return Ce(o,n?u:s++,c,i)}}))},o}function wt(e,t,r,n){var o=e.size;if(re(t,r,o))return e;if(void 0===o&&(t<0||r<0))return wt(e.toSeq().cacheResult(),t,r,n);var i,a=ne(t,o),s=oe(r,o)-a;s==s&&(i=s<0?0:s);var l=kt(e);return l.size=0===i?i:e.size&&i||void 0,!n&&Oe(e)&&i>=0&&(l.get=function(t,r){return(t=ee(this,t))>=0&&t<i?e.get(t+a,r):r}),l.__iterateUncached=function(t,r){var o=this;if(0===i)return 0;if(r)return this.cacheResult().__iterate(t,r);var s=0,l=!0,u=0;return e.__iterate((function(e,r){if(!l||!(l=s++<a))return u++,!1!==t(e,n?r:u-1,o)&&u!==i})),u},l.__iteratorUncached=function(t,r){if(0!==i&&r)return this.cacheResult().__iterator(t,r);if(0===i)return new Le(Ae);var o=e.__iterator(t,r),s=0,l=0;return new Le((function(){for(;s++<a;)o.next();if(++l>i)return{value:void 0,done:!0};var e=o.next();return n||1===t||e.done?e:Ce(t,l-1,0===t?void 0:e.value[1],e)}))},l}function It(e,t,r,n){var o=kt(e);return o.__iterateUncached=function(o,i){var a=this;if(i)return this.cacheResult().__iterate(o,i);var s=!0,l=0;return e.__iterate((function(e,i,u){if(!s||!(s=t.call(r,e,i,u)))return l++,o(e,n?i:l-1,a)})),l},o.__iteratorUncached=function(o,i){var a=this;if(i)return this.cacheResult().__iterator(o,i);var s=e.__iterator(2,i),l=!0,u=0;return new Le((function(){var e,i,c;do{if((e=s.next()).done)return n||1===o?e:Ce(o,u++,0===o?void 0:e.value[1],e);var p=e.value;i=p[0],c=p[1],l&&(l=t.call(r,c,i,a))}while(l);return 2===o?e:Ce(o,i,c,e)}))},o}function Lt(e,t,r){var n=kt(e);return n.__iterateUncached=function(o,i){if(i)return this.cacheResult().__iterate(o,i);var a=0,s=!1;return function e(l,u){l.__iterate((function(i,l){return(!t||u<t)&&le(i)?e(i,u+1):(a++,!1===o(i,r?l:a-1,n)&&(s=!0)),!s}),i)}(e,0),a},n.__iteratorUncached=function(n,o){if(o)return this.cacheResult().__iterator(n,o);var i=e.__iterator(n,o),a=[],s=0;return new Le((function(){for(;i;){var e=i.next();if(!1===e.done){var l=e.value;if(2===n&&(l=l[1]),t&&!(a.length<t)||!le(l))return r?e:Ce(n,s++,l,e);a.push(i),i=l.__iterator(n,o)}else i=a.pop()}return{value:void 0,done:!0}}))},n}function Ct(e,t,r){t||(t=Vt);var n=ce(e),o=0,i=e.toSeq().map((function(t,n){return[n,t,o++,r?r(t,n,e):t]})).valueSeq().toArray();return i.sort((function(e,r){return t(e[3],r[3])||e[2]-r[2]})).forEach(n?function(e,t){i[t].length=2}:function(e,t){i[t]=e[1]}),n?Ve(i):fe(e)?Me(i):Ue(i)}function At(e,t,r){if(t||(t=Vt),r){var n=e.toSeq().map((function(t,n){return[t,r(t,n,e)]})).reduce((function(e,r){return xt(t,e[1],r[1])?r:e}));return n&&n[0]}return e.reduce((function(e,r){return xt(t,e,r)?r:e}))}function xt(e,t,r){var n=e(r,t);return 0===n&&r!==t&&(null==r||r!=r)||n>0}function Nt(e,t,r,n){var o=kt(e),i=new Be(r).map((function(e){return e.size}));return o.size=n?i.max():i.min(),o.__iterate=function(e,t){for(var r,n=this.__iterator(1,t),o=0;!(r=n.next()).done&&!1!==e(r.value,o++,this););return o},o.__iteratorUncached=function(e,o){var i=r.map((function(e){return e=ve(e),je(o?e.reverse():e)})),a=0,s=!1;return new Le((function(){var r;return s||(r=i.map((function(e){return e.next()})),s=n?r.every((function(e){return e.done})):r.some((function(e){return e.done}))),s?{value:void 0,done:!0}:Ce(e,a++,t.apply(null,r.map((function(e){return e.value}))))}))},o}function jt(e,t){return e===t?e:Oe(e)?t:e.constructor(t)}function Ft(e){if(e!==Object(e))throw new TypeError("Expected [K, V] tuple: "+e)}function Pt(e){return ce(e)?he:fe(e)?ge:ye}function kt(e){return Object.create((ce(e)?Ve:fe(e)?Me:Ue).prototype)}function Dt(){return this._iter.cacheResult?(this._iter.cacheResult(),this.size=this._iter.size,this):De.prototype.cacheResult.call(this)}function Vt(e,t){return void 0===e&&void 0===t?0:void 0===e?1:void 0===t?-1:e>t?1:e<t?-1:0}function Mt(e,t){t=t||0;for(var r=Math.max(0,e.length-t),n=new Array(r),o=0;o<r;o++)n[o]=e[o+t];return n}function Ut(e,t){if(!e)throw new Error(t)}function Bt(e){Ut(e!==1/0,"Cannot perform this action with an infinite size.")}function qt(e){if(ke(e)&&"string"!=typeof e)return e;if(Te(e))return e.toArray();throw new TypeError("Invalid keyPath: expected Ordered Collection or Array: "+e)}Ot.prototype.cacheResult=mt.prototype.cacheResult=bt.prototype.cacheResult=Et.prototype.cacheResult=Dt;var Gt=Object.prototype.toString;function Kt(e){if(!e||"object"!=typeof e||"[object Object]"!==Gt.call(e))return!1;var t=Object.getPrototypeOf(e);if(null===t)return!0;for(var r=t,n=Object.getPrototypeOf(t);null!==n;)r=n,n=Object.getPrototypeOf(r);return r===t}function $t(e){return"object"==typeof e&&(Se(e)||Array.isArray(e)||Kt(e))}function Wt(e){try{return"string"==typeof e?JSON.stringify(e):String(e)}catch(t){return JSON.stringify(e)}}function zt(e,t){return Se(e)?e.has(t):$t(e)&&Pe.call(e,t)}function Ht(e,t,r){return Se(e)?e.get(t,r):zt(e,t)?"function"==typeof e.get?e.get(t):e[t]:r}function Yt(e){if(Array.isArray(e))return Mt(e);var t={};for(var r in e)Pe.call(e,r)&&(t[r]=e[r]);return t}function Jt(e,t){if(!$t(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(Se(e)){if(!e.remove)throw new TypeError("Cannot update immutable value without .remove() method: "+e);return e.remove(t)}if(!Pe.call(e,t))return e;var r=Yt(e);return Array.isArray(r)?r.splice(t,1):delete r[t],r}function Xt(e,t,r){if(!$t(e))throw new TypeError("Cannot update non-data-structure value: "+e);if(Se(e)){if(!e.set)throw new TypeError("Cannot update immutable value without .set() method: "+e);return e.set(t,r)}if(Pe.call(e,t)&&r===e[t])return e;var n=Yt(e);return n[t]=r,n}function Qt(e,t,r,n){n||(n=r,r=void 0);var o=Zt(Se(e),e,qt(t),0,r,n);return o===J?r:o}function Zt(e,t,r,n,o,i){var a=t===J;if(n===r.length){var s=a?o:t,l=i(s);return l===s?t:l}if(!a&&!$t(t))throw new TypeError("Cannot update within non-data-structure value in path ["+r.slice(0,n).map(Wt)+"]: "+t);var u=r[n],c=a?J:Ht(t,u,J),p=Zt(c===J?e:Se(c),c,r,n+1,o,i);return p===c?t:p===J?Jt(t,u):Xt(a?e?Nr():{}:t,u,p)}function er(e,t,r){return Qt(e,t,J,(function(){return r}))}function tr(e,t){return er(this,e,t)}function rr(e,t){return Qt(e,t,(function(){return J}))}function nr(e){return rr(this,e)}function or(e,t,r,n){return Qt(e,[t],r,n)}function ir(e,t,r){return 1===arguments.length?e(this):or(this,e,t,r)}function ar(e,t,r){return Qt(this,e,t,r)}function sr(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return ur(this,e)}function lr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];if("function"!=typeof e)throw new TypeError("Invalid merger function: "+e);return ur(this,t,e)}function ur(e,t,r){for(var n=[],o=0;o<t.length;o++){var i=he(t[o]);0!==i.size&&n.push(i)}return 0===n.length?e:0!==e.toSeq().size||e.__ownerID||1!==n.length?e.withMutations((function(e){for(var t=r?function(t,n){or(e,n,J,(function(e){return e===J?t:r(e,t,n)}))}:function(t,r){e.set(r,t)},o=0;o<n.length;o++)n[o].forEach(t)})):e.constructor(n[0])}function cr(e,t,r){return pr(e,t,function(e){function t(r,n,o){return $t(r)&&$t(n)&&(i=n,a=De(r),s=De(i),fe(a)===fe(s)&&ce(a)===ce(s))?pr(r,[n],t):e?e(r,n,o):n;var i,a,s}return t}(r))}function pr(e,t,r){if(!$t(e))throw new TypeError("Cannot merge into non-data-structure value: "+e);if(Se(e))return"function"==typeof r&&e.mergeWith?e.mergeWith.apply(e,[r].concat(t)):e.merge?e.merge.apply(e,t):e.concat.apply(e,t);for(var n=Array.isArray(e),o=e,i=n?ge:he,a=n?function(t){o===e&&(o=Yt(o)),o.push(t)}:function(t,n){var i=Pe.call(o,n),a=i&&r?r(o[n],t,n):t;i&&a===o[n]||(o===e&&(o=Yt(o)),o[n]=a)},s=0;s<t.length;s++)i(t[s]).forEach(a);return o}function fr(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return cr(this,e)}function dr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return cr(this,t,e)}function vr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return Qt(this,e,Nr(),(function(e){return pr(e,t)}))}function hr(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return Qt(this,e,Nr(),(function(e){return cr(e,t)}))}function gr(e){var t=this.asMutable();return e(t),t.wasAltered()?t.__ensureOwner(this.__ownerID):this}function yr(){return this.__ownerID?this:this.__ensureOwner(new Q)}function mr(){return this.__ensureOwner()}function Or(){return this.__altered}var br=function(e){function t(t){return null==t?Nr():Je(t)&&!Te(t)?t:Nr().withMutations((function(r){var n=e(t);Bt(n.size),n.forEach((function(e,t){return r.set(t,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return Nr().withMutations((function(t){for(var r=0;r<e.length;r+=2){if(r+1>=e.length)throw new Error("Missing value for key: "+e[r]);t.set(e[r],e[r+1])}}))},t.prototype.toString=function(){return this.__toString("Map {","}")},t.prototype.get=function(e,t){return this._root?this._root.get(0,void 0,e,t):t},t.prototype.set=function(e,t){return jr(this,e,t)},t.prototype.remove=function(e){return jr(this,e,J)},t.prototype.deleteAll=function(e){var t=ve(e);return 0===t.size?this:this.withMutations((function(e){t.forEach((function(t){return e.remove(t)}))}))},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._root=null,this.__hash=void 0,this.__altered=!0,this):Nr()},t.prototype.sort=function(e){return on(Ct(this,e))},t.prototype.sortBy=function(e,t){return on(Ct(this,t,e))},t.prototype.map=function(e,t){var r=this;return this.withMutations((function(n){n.forEach((function(o,i){n.set(i,e.call(t,o,i,r))}))}))},t.prototype.__iterator=function(e,t){return new Lr(this,e,t)},t.prototype.__iterate=function(e,t){var r=this,n=0;return this._root&&this._root.iterate((function(t){return n++,e(t[1],t[0],r)}),t),n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?xr(this.size,this._root,e,this.__hash):0===this.size?Nr():(this.__ownerID=e,this.__altered=!1,this)},t}(he);br.isMap=Je;var Er=br.prototype;Er[Ye]=!0,Er[z]=Er.remove,Er.removeAll=Er.deleteAll,Er.setIn=tr,Er.removeIn=Er.deleteIn=nr,Er.update=ir,Er.updateIn=ar,Er.merge=Er.concat=sr,Er.mergeWith=lr,Er.mergeDeep=fr,Er.mergeDeepWith=dr,Er.mergeIn=vr,Er.mergeDeepIn=hr,Er.withMutations=gr,Er.wasAltered=Or,Er.asImmutable=mr,Er["@@transducer/init"]=Er.asMutable=yr,Er["@@transducer/step"]=function(e,t){return e.set(t[0],t[1])},Er["@@transducer/result"]=function(e){return e.asImmutable()};var Sr=function(e,t){this.ownerID=e,this.entries=t};Sr.prototype.get=function(e,t,r,n){for(var o=this.entries,i=0,a=o.length;i<a;i++)if(Ze(r,o[i][0]))return o[i][1];return n},Sr.prototype.update=function(e,t,r,n,o,i,a){for(var s=o===J,l=this.entries,u=0,c=l.length;u<c&&!Ze(n,l[u][0]);u++);var p=u<c;if(p?l[u][1]===o:s)return this;if(X(a),(s||!p)&&X(i),!s||1!==l.length){if(!p&&!s&&l.length>=Mr)return function(e,t,r,n){e||(e=new Q);for(var o=new wr(e,nt(r),[r,n]),i=0;i<t.length;i++){var a=t[i];o=o.update(e,0,void 0,a[0],a[1])}return o}(e,l,n,o);var f=e&&e===this.ownerID,d=f?l:Mt(l);return p?s?u===c-1?d.pop():d[u]=d.pop():d[u]=[n,o]:d.push([n,o]),f?(this.entries=d,this):new Sr(e,d)}};var _r=function(e,t,r){this.ownerID=e,this.bitmap=t,this.nodes=r};_r.prototype.get=function(e,t,r,n){void 0===t&&(t=nt(r));var o=1<<((0===e?t:t>>>e)&Y),i=this.bitmap;return i&o?this.nodes[Dr(i&o-1)].get(e+5,t,r,n):n},_r.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=nt(n));var s=(0===t?r:r>>>t)&Y,l=1<<s,u=this.bitmap,c=!!(u&l);if(!c&&o===J)return this;var p=Dr(u&l-1),f=this.nodes,d=c?f[p]:void 0,v=Fr(d,e,t+5,r,n,o,i,a);if(v===d)return this;if(!c&&v&&f.length>=Ur)return function(e,t,r,n,o){for(var i=0,a=new Array(H),s=0;0!==r;s++,r>>>=1)a[s]=1&r?t[i++]:void 0;return a[n]=o,new Tr(e,i+1,a)}(e,f,u,s,v);if(c&&!v&&2===f.length&&Pr(f[1^p]))return f[1^p];if(c&&v&&1===f.length&&Pr(v))return v;var h=e&&e===this.ownerID,g=c?v?u:u^l:u|l,y=c?v?Vr(f,p,v,h):function(e,t,r){var n=e.length-1;if(r&&t===n)return e.pop(),e;for(var o=new Array(n),i=0,a=0;a<n;a++)a===t&&(i=1),o[a]=e[a+i];return o}(f,p,h):function(e,t,r,n){var o=e.length+1;if(n&&t+1===o)return e[t]=r,e;for(var i=new Array(o),a=0,s=0;s<o;s++)s===t?(i[s]=r,a=-1):i[s]=e[s+a];return i}(f,p,v,h);return h?(this.bitmap=g,this.nodes=y,this):new _r(e,g,y)};var Tr=function(e,t,r){this.ownerID=e,this.count=t,this.nodes=r};Tr.prototype.get=function(e,t,r,n){void 0===t&&(t=nt(r));var o=(0===e?t:t>>>e)&Y,i=this.nodes[o];return i?i.get(e+5,t,r,n):n},Tr.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=nt(n));var s=(0===t?r:r>>>t)&Y,l=o===J,u=this.nodes,c=u[s];if(l&&!c)return this;var p=Fr(c,e,t+5,r,n,o,i,a);if(p===c)return this;var f=this.count;if(c){if(!p&&--f<Br)return function(e,t,r,n){for(var o=0,i=0,a=new Array(r),s=0,l=1,u=t.length;s<u;s++,l<<=1){var c=t[s];void 0!==c&&s!==n&&(o|=l,a[i++]=c)}return new _r(e,o,a)}(e,u,f,s)}else f++;var d=e&&e===this.ownerID,v=Vr(u,s,p,d);return d?(this.count=f,this.nodes=v,this):new Tr(e,f,v)};var Rr=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entries=r};Rr.prototype.get=function(e,t,r,n){for(var o=this.entries,i=0,a=o.length;i<a;i++)if(Ze(r,o[i][0]))return o[i][1];return n},Rr.prototype.update=function(e,t,r,n,o,i,a){void 0===r&&(r=nt(n));var s=o===J;if(r!==this.keyHash)return s?this:(X(a),X(i),kr(this,e,t,r,[n,o]));for(var l=this.entries,u=0,c=l.length;u<c&&!Ze(n,l[u][0]);u++);var p=u<c;if(p?l[u][1]===o:s)return this;if(X(a),(s||!p)&&X(i),s&&2===c)return new wr(e,this.keyHash,l[1^u]);var f=e&&e===this.ownerID,d=f?l:Mt(l);return p?s?u===c-1?d.pop():d[u]=d.pop():d[u]=[n,o]:d.push([n,o]),f?(this.entries=d,this):new Rr(e,this.keyHash,d)};var wr=function(e,t,r){this.ownerID=e,this.keyHash=t,this.entry=r};wr.prototype.get=function(e,t,r,n){return Ze(r,this.entry[0])?this.entry[1]:n},wr.prototype.update=function(e,t,r,n,o,i,a){var s=o===J,l=Ze(n,this.entry[0]);return(l?o===this.entry[1]:s)?this:(X(a),s?void X(i):l?e&&e===this.ownerID?(this.entry[1]=o,this):new wr(e,this.keyHash,[n,o]):(X(i),kr(this,e,t,nt(n),[n,o])))},Sr.prototype.iterate=Rr.prototype.iterate=function(e,t){for(var r=this.entries,n=0,o=r.length-1;n<=o;n++)if(!1===e(r[t?o-n:n]))return!1},_r.prototype.iterate=Tr.prototype.iterate=function(e,t){for(var r=this.nodes,n=0,o=r.length-1;n<=o;n++){var i=r[t?o-n:n];if(i&&!1===i.iterate(e,t))return!1}},wr.prototype.iterate=function(e,t){return e(this.entry)};var Ir,Lr=function(e){function t(e,t,r){this._type=t,this._reverse=r,this._stack=e._root&&Ar(e._root)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.next=function(){for(var e=this._type,t=this._stack;t;){var r=t.node,n=t.index++,o=void 0;if(r.entry){if(0===n)return Cr(e,r.entry)}else if(r.entries){if(n<=(o=r.entries.length-1))return Cr(e,r.entries[this._reverse?o-n:n])}else if(n<=(o=r.nodes.length-1)){var i=r.nodes[this._reverse?o-n:n];if(i){if(i.entry)return Cr(e,i.entry);t=this._stack=Ar(i,t)}continue}t=this._stack=this._stack.__prev}return{value:void 0,done:!0}},t}(Le);function Cr(e,t){return Ce(e,t[0],t[1])}function Ar(e,t){return{node:e,index:0,__prev:t}}function xr(e,t,r,n){var o=Object.create(Er);return o.size=e,o._root=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function Nr(){return Ir||(Ir=xr(0))}function jr(e,t,r){var n,o;if(e._root){var i={value:!1},a={value:!1};if(n=Fr(e._root,e.__ownerID,0,void 0,t,r,i,a),!a.value)return e;o=e.size+(i.value?r===J?-1:1:0)}else{if(r===J)return e;o=1,n=new Sr(e.__ownerID,[[t,r]])}return e.__ownerID?(e.size=o,e._root=n,e.__hash=void 0,e.__altered=!0,e):n?xr(o,n):Nr()}function Fr(e,t,r,n,o,i,a,s){return e?e.update(t,r,n,o,i,a,s):i===J?e:(X(s),X(a),new wr(t,n,[o,i]))}function Pr(e){return e.constructor===wr||e.constructor===Rr}function kr(e,t,r,n,o){if(e.keyHash===n)return new Rr(t,n,[e.entry,o]);var i,a=(0===r?e.keyHash:e.keyHash>>>r)&Y,s=(0===r?n:n>>>r)&Y,l=a===s?[kr(e,t,r+5,n,o)]:(i=new wr(t,n,o),a<s?[e,i]:[i,e]);return new _r(t,1<<a|1<<s,l)}function Dr(e){return e=(e=(858993459&(e-=e>>1&1431655765))+(e>>2&858993459))+(e>>4)&252645135,e+=e>>8,127&(e+=e>>16)}function Vr(e,t,r,n){var o=n?e:Mt(e);return o[t]=r,o}var Mr=8,Ur=16,Br=8,qr="@@__IMMUTABLE_LIST__@@";function Gr(e){return Boolean(e&&e[qr])}var Kr=function(e){function t(t){var r=Xr();if(null==t)return r;if(Gr(t))return t;var n=e(t),o=n.size;return 0===o?r:(Bt(o),o>0&&o<H?Jr(0,o,5,null,new Wr(n.toArray())):r.withMutations((function(e){e.setSize(o),n.forEach((function(t,r){return e.set(r,t)}))})))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("List [","]")},t.prototype.get=function(e,t){if((e=ee(this,e))>=0&&e<this.size){var r=en(this,e+=this._origin);return r&&r.array[e&Y]}return t},t.prototype.set=function(e,t){return function(e,t,r){if(t=ee(e,t),t!=t)return e;if(t>=e.size||t<0)return e.withMutations((function(e){t<0?tn(e,t).set(0,r):tn(e,0,t+1).set(t,r)}));t+=e._origin;var n=e._tail,o=e._root,i={value:!1};t>=rn(e._capacity)?n=Qr(n,e.__ownerID,0,t,r,i):o=Qr(o,e.__ownerID,e._level,t,r,i);if(!i.value)return e;if(e.__ownerID)return e._root=o,e._tail=n,e.__hash=void 0,e.__altered=!0,e;return Jr(e._origin,e._capacity,e._level,o,n)}(this,e,t)},t.prototype.remove=function(e){return this.has(e)?0===e?this.shift():e===this.size-1?this.pop():this.splice(e,1):this},t.prototype.insert=function(e,t){return this.splice(e,0,t)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=this._origin=this._capacity=0,this._level=5,this._root=this._tail=this.__hash=void 0,this.__altered=!0,this):Xr()},t.prototype.push=function(){var e=arguments,t=this.size;return this.withMutations((function(r){tn(r,0,t+e.length);for(var n=0;n<e.length;n++)r.set(t+n,e[n])}))},t.prototype.pop=function(){return tn(this,0,-1)},t.prototype.unshift=function(){var e=arguments;return this.withMutations((function(t){tn(t,-e.length);for(var r=0;r<e.length;r++)t.set(r,e[r])}))},t.prototype.shift=function(){return tn(this,1)},t.prototype.concat=function(){for(var t=arguments,r=[],n=0;n<arguments.length;n++){var o=t[n],i=e("string"!=typeof o&&xe(o)?o:[o]);0!==i.size&&r.push(i)}return 0===r.length?this:0!==this.size||this.__ownerID||1!==r.length?this.withMutations((function(e){r.forEach((function(t){return t.forEach((function(t){return e.push(t)}))}))})):this.constructor(r[0])},t.prototype.setSize=function(e){return tn(this,0,e)},t.prototype.map=function(e,t){var r=this;return this.withMutations((function(n){for(var o=0;o<r.size;o++)n.set(o,e.call(t,n.get(o),o,r))}))},t.prototype.slice=function(e,t){var r=this.size;return re(e,t,r)?this:tn(this,ne(e,r),oe(t,r))},t.prototype.__iterator=function(e,t){var r=t?this.size:0,n=Yr(this,t);return new Le((function(){var o=n();return o===Hr?{value:void 0,done:!0}:Ce(e,t?--r:r++,o)}))},t.prototype.__iterate=function(e,t){for(var r,n=t?this.size:0,o=Yr(this,t);(r=o())!==Hr&&!1!==e(r,t?--n:n++,this););return n},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?Jr(this._origin,this._capacity,this._level,this._root,this._tail,e,this.__hash):0===this.size?Xr():(this.__ownerID=e,this.__altered=!1,this)},t}(ge);Kr.isList=Gr;var $r=Kr.prototype;$r[qr]=!0,$r[z]=$r.remove,$r.merge=$r.concat,$r.setIn=tr,$r.deleteIn=$r.removeIn=nr,$r.update=ir,$r.updateIn=ar,$r.mergeIn=vr,$r.mergeDeepIn=hr,$r.withMutations=gr,$r.wasAltered=Or,$r.asImmutable=mr,$r["@@transducer/init"]=$r.asMutable=yr,$r["@@transducer/step"]=function(e,t){return e.push(t)},$r["@@transducer/result"]=function(e){return e.asImmutable()};var Wr=function(e,t){this.array=e,this.ownerID=t};Wr.prototype.removeBefore=function(e,t,r){if(r===t?1<<t:0===this.array.length)return this;var n=r>>>t&Y;if(n>=this.array.length)return new Wr([],e);var o,i=0===n;if(t>0){var a=this.array[n];if((o=a&&a.removeBefore(e,t-5,r))===a&&i)return this}if(i&&!o)return this;var s=Zr(this,e);if(!i)for(var l=0;l<n;l++)s.array[l]=void 0;return o&&(s.array[n]=o),s},Wr.prototype.removeAfter=function(e,t,r){if(r===(t?1<<t:0)||0===this.array.length)return this;var n,o=r-1>>>t&Y;if(o>=this.array.length)return this;if(t>0){var i=this.array[o];if((n=i&&i.removeAfter(e,t-5,r))===i&&o===this.array.length-1)return this}var a=Zr(this,e);return a.array.splice(o+1),n&&(a.array[o]=n),a};var zr,Hr={};function Yr(e,t){var r=e._origin,n=e._capacity,o=rn(n),i=e._tail;return a(e._root,e._level,0);function a(e,s,l){return 0===s?function(e,a){var s=a===o?i&&i.array:e&&e.array,l=a>r?0:r-a,u=n-a;u>H&&(u=H);return function(){if(l===u)return Hr;var e=t?--u:l++;return s&&s[e]}}(e,l):function(e,o,i){var s,l=e&&e.array,u=i>r?0:r-i>>o,c=1+(n-i>>o);c>H&&(c=H);return function(){for(;;){if(s){var e=s();if(e!==Hr)return e;s=null}if(u===c)return Hr;var r=t?--c:u++;s=a(l&&l[r],o-5,i+(r<<o))}}}(e,s,l)}}function Jr(e,t,r,n,o,i,a){var s=Object.create($r);return s.size=t-e,s._origin=e,s._capacity=t,s._level=r,s._root=n,s._tail=o,s.__ownerID=i,s.__hash=a,s.__altered=!1,s}function Xr(){return zr||(zr=Jr(0,0,5))}function Qr(e,t,r,n,o,i){var a,s=n>>>r&Y,l=e&&s<e.array.length;if(!l&&void 0===o)return e;if(r>0){var u=e&&e.array[s],c=Qr(u,t,r-5,n,o,i);return c===u?e:((a=Zr(e,t)).array[s]=c,a)}return l&&e.array[s]===o?e:(i&&X(i),a=Zr(e,t),void 0===o&&s===a.array.length-1?a.array.pop():a.array[s]=o,a)}function Zr(e,t){return t&&e&&t===e.ownerID?e:new Wr(e?e.array.slice():[],t)}function en(e,t){if(t>=rn(e._capacity))return e._tail;if(t<1<<e._level+5){for(var r=e._root,n=e._level;r&&n>0;)r=r.array[t>>>n&Y],n-=5;return r}}function tn(e,t,r){void 0!==t&&(t|=0),void 0!==r&&(r|=0);var n=e.__ownerID||new Q,o=e._origin,i=e._capacity,a=o+t,s=void 0===r?i:r<0?i+r:o+r;if(a===o&&s===i)return e;if(a>=s)return e.clear();for(var l=e._level,u=e._root,c=0;a+c<0;)u=new Wr(u&&u.array.length?[void 0,u]:[],n),c+=1<<(l+=5);c&&(a+=c,o+=c,s+=c,i+=c);for(var p=rn(i),f=rn(s);f>=1<<l+5;)u=new Wr(u&&u.array.length?[u]:[],n),l+=5;var d=e._tail,v=f<p?en(e,s-1):f>p?new Wr([],n):d;if(d&&f>p&&a<i&&d.array.length){for(var h=u=Zr(u,n),g=l;g>5;g-=5){var y=p>>>g&Y;h=h.array[y]=Zr(h.array[y],n)}h.array[p>>>5&Y]=d}if(s<i&&(v=v&&v.removeAfter(n,0,s)),a>=f)a-=f,s-=f,l=5,u=null,v=v&&v.removeBefore(n,0,a);else if(a>o||f<p){for(c=0;u;){var m=a>>>l&Y;if(m!==f>>>l&Y)break;m&&(c+=(1<<l)*m),l-=5,u=u.array[m]}u&&a>o&&(u=u.removeBefore(n,l,a-c)),u&&f<p&&(u=u.removeAfter(n,l,f-c)),c&&(a-=c,s-=c)}return e.__ownerID?(e.size=s-a,e._origin=a,e._capacity=s,e._level=l,e._root=u,e._tail=v,e.__hash=void 0,e.__altered=!0,e):Jr(a,s,l,u,v)}function rn(e){return e<H?0:e-1>>>5<<5}var nn,on=function(e){function t(e){return null==e?sn():Xe(e)?e:sn().withMutations((function(t){var r=he(e);Bt(r.size),r.forEach((function(e,r){return t.set(r,e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("OrderedMap {","}")},t.prototype.get=function(e,t){var r=this._map.get(e);return void 0!==r?this._list.get(r)[1]:t},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._map.clear(),this._list.clear(),this.__altered=!0,this):sn()},t.prototype.set=function(e,t){return ln(this,e,t)},t.prototype.remove=function(e){return ln(this,e,J)},t.prototype.__iterate=function(e,t){var r=this;return this._list.__iterate((function(t){return t&&e(t[1],t[0],r)}),t)},t.prototype.__iterator=function(e,t){return this._list.fromEntrySeq().__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e),r=this._list.__ensureOwner(e);return e?an(t,r,e,this.__hash):0===this.size?sn():(this.__ownerID=e,this.__altered=!1,this._map=t,this._list=r,this)},t}(br);function an(e,t,r,n){var o=Object.create(on.prototype);return o.size=e?e.size:0,o._map=e,o._list=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function sn(){return nn||(nn=an(Nr(),Xr()))}function ln(e,t,r){var n,o,i=e._map,a=e._list,s=i.get(t),l=void 0!==s;if(r===J){if(!l)return e;a.size>=H&&a.size>=2*i.size?(n=(o=a.filter((function(e,t){return void 0!==e&&s!==t}))).toKeyedSeq().map((function(e){return e[0]})).flip().toMap(),e.__ownerID&&(n.__ownerID=o.__ownerID=e.__ownerID)):(n=i.remove(t),o=s===a.size-1?a.pop():a.set(s,void 0))}else if(l){if(r===a.get(s)[1])return e;n=i,o=a.set(s,[t,r])}else n=i.set(t,a.size),o=a.set(a.size,[t,r]);return e.__ownerID?(e.size=n.size,e._map=n,e._list=o,e.__hash=void 0,e.__altered=!0,e):an(n,o)}on.isOrderedMap=Xe,on.prototype[_e]=!0,on.prototype[z]=on.prototype.remove;var un="@@__IMMUTABLE_STACK__@@";function cn(e){return Boolean(e&&e[un])}var pn=function(e){function t(e){return null==e?hn():cn(e)?e:hn().pushAll(e)}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.prototype.toString=function(){return this.__toString("Stack [","]")},t.prototype.get=function(e,t){var r=this._head;for(e=ee(this,e);r&&e--;)r=r.next;return r?r.value:t},t.prototype.peek=function(){return this._head&&this._head.value},t.prototype.push=function(){var e=arguments;if(0===arguments.length)return this;for(var t=this.size+arguments.length,r=this._head,n=arguments.length-1;n>=0;n--)r={value:e[n],next:r};return this.__ownerID?(this.size=t,this._head=r,this.__hash=void 0,this.__altered=!0,this):vn(t,r)},t.prototype.pushAll=function(t){if(0===(t=e(t)).size)return this;if(0===this.size&&cn(t))return t;Bt(t.size);var r=this.size,n=this._head;return t.__iterate((function(e){r++,n={value:e,next:n}}),!0),this.__ownerID?(this.size=r,this._head=n,this.__hash=void 0,this.__altered=!0,this):vn(r,n)},t.prototype.pop=function(){return this.slice(1)},t.prototype.clear=function(){return 0===this.size?this:this.__ownerID?(this.size=0,this._head=void 0,this.__hash=void 0,this.__altered=!0,this):hn()},t.prototype.slice=function(t,r){if(re(t,r,this.size))return this;var n=ne(t,this.size);if(oe(r,this.size)!==this.size)return e.prototype.slice.call(this,t,r);for(var o=this.size-n,i=this._head;n--;)i=i.next;return this.__ownerID?(this.size=o,this._head=i,this.__hash=void 0,this.__altered=!0,this):vn(o,i)},t.prototype.__ensureOwner=function(e){return e===this.__ownerID?this:e?vn(this.size,this._head,e,this.__hash):0===this.size?hn():(this.__ownerID=e,this.__altered=!1,this)},t.prototype.__iterate=function(e,t){var r=this;if(t)return new Be(this.toArray()).__iterate((function(t,n){return e(t,n,r)}),t);for(var n=0,o=this._head;o&&!1!==e(o.value,n++,this);)o=o.next;return n},t.prototype.__iterator=function(e,t){if(t)return new Be(this.toArray()).__iterator(e,t);var r=0,n=this._head;return new Le((function(){if(n){var t=n.value;return n=n.next,Ce(e,r++,t)}return{value:void 0,done:!0}}))},t}(ge);pn.isStack=cn;var fn,dn=pn.prototype;function vn(e,t,r,n){var o=Object.create(dn);return o.size=e,o._head=t,o.__ownerID=r,o.__hash=n,o.__altered=!1,o}function hn(){return fn||(fn=vn(0))}dn[un]=!0,dn.shift=dn.pop,dn.unshift=dn.push,dn.unshiftAll=dn.pushAll,dn.withMutations=gr,dn.wasAltered=Or,dn.asImmutable=mr,dn["@@transducer/init"]=dn.asMutable=yr,dn["@@transducer/step"]=function(e,t){return e.unshift(t)},dn["@@transducer/result"]=function(e){return e.asImmutable()};var gn="@@__IMMUTABLE_SET__@@";function yn(e){return Boolean(e&&e[gn])}function mn(e){return yn(e)&&Te(e)}function On(e,t){if(e===t)return!0;if(!le(t)||void 0!==e.size&&void 0!==t.size&&e.size!==t.size||void 0!==e.__hash&&void 0!==t.__hash&&e.__hash!==t.__hash||ce(e)!==ce(t)||fe(e)!==fe(t)||Te(e)!==Te(t))return!1;if(0===e.size&&0===t.size)return!0;var r=!de(e);if(Te(e)){var n=e.entries();return t.every((function(e,t){var o=n.next().value;return o&&Ze(o[1],e)&&(r||Ze(o[0],t))}))&&n.next().done}var o=!1;if(void 0===e.size)if(void 0===t.size)"function"==typeof e.cacheResult&&e.cacheResult();else{o=!0;var i=e;e=t,t=i}var a=!0,s=t.__iterate((function(t,n){if(r?!e.has(t):o?!Ze(t,e.get(n,J)):!Ze(e.get(n,J),t))return a=!1,!1}));return a&&e.size===s}function bn(e,t){var r=function(r){e.prototype[r]=t[r]};return Object.keys(t).forEach(r),Object.getOwnPropertySymbols&&Object.getOwnPropertySymbols(t).forEach(r),e}function En(e){if(!e||"object"!=typeof e)return e;if(!le(e)){if(!$t(e))return e;e=De(e)}if(ce(e)){var t={};return e.__iterate((function(e,r){t[r]=En(e)})),t}var r=[];return e.__iterate((function(e){r.push(En(e))})),r}var Sn=function(e){function t(t){return null==t?In():yn(t)&&!Te(t)?t:In().withMutations((function(r){var n=e(t);Bt(n.size),n.forEach((function(e){return r.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(he(e).keySeq())},t.intersect=function(e){return(e=ve(e).toArray()).length?Tn.intersect.apply(t(e.pop()),e):In()},t.union=function(e){return(e=ve(e).toArray()).length?Tn.union.apply(t(e.pop()),e):In()},t.prototype.toString=function(){return this.__toString("Set {","}")},t.prototype.has=function(e){return this._map.has(e)},t.prototype.add=function(e){return Rn(this,this._map.set(e,e))},t.prototype.remove=function(e){return Rn(this,this._map.remove(e))},t.prototype.clear=function(){return Rn(this,this._map.clear())},t.prototype.map=function(e,t){var r=this,n=!1,o=Rn(this,this._map.mapEntries((function(o){var i=o[1],a=e.call(t,i,i,r);return a!==i&&(n=!0),[a,a]}),t));return n?o:this},t.prototype.union=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];return 0===(t=t.filter((function(e){return 0!==e.size}))).length?this:0!==this.size||this.__ownerID||1!==t.length?this.withMutations((function(r){for(var n=0;n<t.length;n++)"string"==typeof t[n]?r.add(t[n]):e(t[n]).forEach((function(e){return r.add(e)}))})):this.constructor(t[0])},t.prototype.intersect=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var n=[];return this.forEach((function(e){t.every((function(t){return t.includes(e)}))||n.push(e)})),this.withMutations((function(e){n.forEach((function(t){e.remove(t)}))}))},t.prototype.subtract=function(){for(var t=[],r=arguments.length;r--;)t[r]=arguments[r];if(0===t.length)return this;t=t.map((function(t){return e(t)}));var n=[];return this.forEach((function(e){t.some((function(t){return t.includes(e)}))&&n.push(e)})),this.withMutations((function(e){n.forEach((function(t){e.remove(t)}))}))},t.prototype.sort=function(e){return Wn(Ct(this,e))},t.prototype.sortBy=function(e,t){return Wn(Ct(this,t,e))},t.prototype.wasAltered=function(){return this._map.wasAltered()},t.prototype.__iterate=function(e,t){var r=this;return this._map.__iterate((function(t){return e(t,t,r)}),t)},t.prototype.__iterator=function(e,t){return this._map.__iterator(e,t)},t.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._map.__ensureOwner(e);return e?this.__make(t,e):0===this.size?this.__empty():(this.__ownerID=e,this._map=t,this)},t}(ye);Sn.isSet=yn;var _n,Tn=Sn.prototype;function Rn(e,t){return e.__ownerID?(e.size=t.size,e._map=t,e):t===e._map?e:0===t.size?e.__empty():e.__make(t)}function wn(e,t){var r=Object.create(Tn);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function In(){return _n||(_n=wn(Nr()))}Tn[gn]=!0,Tn[z]=Tn.remove,Tn.merge=Tn.concat=Tn.union,Tn.withMutations=gr,Tn.asImmutable=mr,Tn["@@transducer/init"]=Tn.asMutable=yr,Tn["@@transducer/step"]=function(e,t){return e.add(t)},Tn["@@transducer/result"]=function(e){return e.asImmutable()},Tn.__empty=In,Tn.__make=wn;var Ln,Cn=function(e){function t(e,r,n){if(!(this instanceof t))return new t(e,r,n);if(Ut(0!==n,"Cannot step a Range by 0"),e=e||0,void 0===r&&(r=1/0),n=void 0===n?1:Math.abs(n),r<e&&(n=-n),this._start=e,this._end=r,this._step=n,this.size=Math.max(0,Math.ceil((r-e)/n-1)+1),0===this.size){if(Ln)return Ln;Ln=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Range []":"Range [ "+this._start+"..."+this._end+(1!==this._step?" by "+this._step:"")+" ]"},t.prototype.get=function(e,t){return this.has(e)?this._start+ee(this,e)*this._step:t},t.prototype.includes=function(e){var t=(e-this._start)/this._step;return t>=0&&t<this.size&&t===Math.floor(t)},t.prototype.slice=function(e,r){return re(e,r,this.size)?this:(e=ne(e,this.size),(r=oe(r,this.size))<=e?new t(0,0):new t(this.get(e,this._end),this.get(r,this._end),this._step))},t.prototype.indexOf=function(e){var t=e-this._start;if(t%this._step==0){var r=t/this._step;if(r>=0&&r<this.size)return r}return-1},t.prototype.lastIndexOf=function(e){return this.indexOf(e)},t.prototype.__iterate=function(e,t){for(var r=this.size,n=this._step,o=t?this._start+(r-1)*n:this._start,i=0;i!==r&&!1!==e(o,t?r-++i:i++,this);)o+=t?-n:n;return i},t.prototype.__iterator=function(e,t){var r=this.size,n=this._step,o=t?this._start+(r-1)*n:this._start,i=0;return new Le((function(){if(i===r)return{value:void 0,done:!0};var a=o;return o+=t?-n:n,Ce(e,t?r-++i:i++,a)}))},t.prototype.equals=function(e){return e instanceof t?this._start===e._start&&this._end===e._end&&this._step===e._step:On(this,e)},t}(Me);function An(e,t,r){for(var n=qt(t),o=0;o!==n.length;)if((e=Ht(e,n[o++],J))===J)return r;return e}function xn(e,t){return An(this,e,t)}function Nn(e,t){return An(e,t,J)!==J}function jn(){Bt(this.size);var e={};return this.__iterate((function(t,r){e[r]=t})),e}ve.isIterable=le,ve.isKeyed=ce,ve.isIndexed=fe,ve.isAssociative=de,ve.isOrdered=Te,ve.Iterator=Le,bn(ve,{toArray:function(){Bt(this.size);var e=new Array(this.size||0),t=ce(this),r=0;return this.__iterate((function(n,o){e[r++]=t?[o,n]:n})),e},toIndexedSeq:function(){return new Ot(this)},toJS:function(){return En(this)},toKeyedSeq:function(){return new mt(this,!0)},toMap:function(){return br(this.toKeyedSeq())},toObject:jn,toOrderedMap:function(){return on(this.toKeyedSeq())},toOrderedSet:function(){return Wn(ce(this)?this.valueSeq():this)},toSet:function(){return Sn(ce(this)?this.valueSeq():this)},toSetSeq:function(){return new bt(this)},toSeq:function(){return fe(this)?this.toIndexedSeq():ce(this)?this.toKeyedSeq():this.toSetSeq()},toStack:function(){return pn(ce(this)?this.valueSeq():this)},toList:function(){return Kr(ce(this)?this.valueSeq():this)},toString:function(){return"[Collection]"},__toString:function(e,t){return 0===this.size?e+t:e+" "+this.toSeq().map(this.__toStringMapper).join(", ")+" "+t},concat:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return jt(this,function(e,t){var r=ce(e),n=[e].concat(t).map((function(e){return le(e)?r&&(e=he(e)):e=r?We(e):ze(Array.isArray(e)?e:[e]),e})).filter((function(e){return 0!==e.size}));if(0===n.length)return e;if(1===n.length){var o=n[0];if(o===e||r&&ce(o)||fe(e)&&fe(o))return o}var i=new Be(n);return r?i=i.toKeyedSeq():fe(e)||(i=i.toSetSeq()),(i=i.flatten(!0)).size=n.reduce((function(e,t){if(void 0!==e){var r=t.size;if(void 0!==r)return e+r}}),0),i}(this,e))},includes:function(e){return this.some((function(t){return Ze(t,e)}))},entries:function(){return this.__iterator(2)},every:function(e,t){Bt(this.size);var r=!0;return this.__iterate((function(n,o,i){if(!e.call(t,n,o,i))return r=!1,!1})),r},filter:function(e,t){return jt(this,Rt(this,e,t,!0))},partition:function(e,t){return function(e,t,r){var n=ce(e),o=[[],[]];e.__iterate((function(i,a){o[t.call(r,i,a,e)?1:0].push(n?[a,i]:i)}));var i=Pt(e);return o.map((function(t){return jt(e,i(t))}))}(this,e,t)},find:function(e,t,r){var n=this.findEntry(e,t);return n?n[1]:r},forEach:function(e,t){return Bt(this.size),this.__iterate(t?e.bind(t):e)},join:function(e){Bt(this.size),e=void 0!==e?""+e:",";var t="",r=!0;return this.__iterate((function(n){r?r=!1:t+=e,t+=null!=n?n.toString():""})),t},keys:function(){return this.__iterator(0)},map:function(e,t){return jt(this,_t(this,e,t))},reduce:function(e,t,r){return Vn(this,e,t,r,arguments.length<2,!1)},reduceRight:function(e,t,r){return Vn(this,e,t,r,arguments.length<2,!0)},reverse:function(){return jt(this,Tt(this,!0))},slice:function(e,t){return jt(this,wt(this,e,t,!0))},some:function(e,t){Bt(this.size);var r=!1;return this.__iterate((function(n,o,i){if(e.call(t,n,o,i))return r=!0,!1})),r},sort:function(e){return jt(this,Ct(this,e))},values:function(){return this.__iterator(1)},butLast:function(){return this.slice(0,-1)},isEmpty:function(){return void 0!==this.size?0===this.size:!this.some((function(){return!0}))},count:function(e,t){return Z(e?this.toSeq().filter(e,t):this)},countBy:function(e,t){return function(e,t,r){var n=br().asMutable();return e.__iterate((function(o,i){n.update(t.call(r,o,i,e),0,(function(e){return e+1}))})),n.asImmutable()}(this,e,t)},equals:function(e){return On(this,e)},entrySeq:function(){var e=this;if(e._cache)return new Be(e._cache);var t=e.toSeq().map(Un).toIndexedSeq();return t.fromEntrySeq=function(){return e.toSeq()},t},filterNot:function(e,t){return this.filter(Bn(e),t)},findEntry:function(e,t,r){var n=r;return this.__iterate((function(r,o,i){if(e.call(t,r,o,i))return n=[o,r],!1})),n},findKey:function(e,t){var r=this.findEntry(e,t);return r&&r[0]},findLast:function(e,t,r){return this.toKeyedSeq().reverse().find(e,t,r)},findLastEntry:function(e,t,r){return this.toKeyedSeq().reverse().findEntry(e,t,r)},findLastKey:function(e,t){return this.toKeyedSeq().reverse().findKey(e,t)},first:function(e){return this.find(te,null,e)},flatMap:function(e,t){return jt(this,function(e,t,r){var n=Pt(e);return e.toSeq().map((function(o,i){return n(t.call(r,o,i,e))})).flatten(!0)}(this,e,t))},flatten:function(e){return jt(this,Lt(this,e,!0))},fromEntrySeq:function(){return new Et(this)},get:function(e,t){return this.find((function(t,r){return Ze(r,e)}),void 0,t)},getIn:xn,groupBy:function(e,t){return function(e,t,r){var n=ce(e),o=(Te(e)?on():br()).asMutable();e.__iterate((function(i,a){o.update(t.call(r,i,a,e),(function(e){return(e=e||[]).push(n?[a,i]:i),e}))}));var i=Pt(e);return o.map((function(t){return jt(e,i(t))})).asImmutable()}(this,e,t)},has:function(e){return this.get(e,J)!==J},hasIn:function(e){return Nn(this,e)},isSubset:function(e){return e="function"==typeof e.includes?e:ve(e),this.every((function(t){return e.includes(t)}))},isSuperset:function(e){return(e="function"==typeof e.isSubset?e:ve(e)).isSubset(this)},keyOf:function(e){return this.findKey((function(t){return Ze(t,e)}))},keySeq:function(){return this.toSeq().map(Mn).toIndexedSeq()},last:function(e){return this.toSeq().reverse().first(e)},lastKeyOf:function(e){return this.toKeyedSeq().reverse().keyOf(e)},max:function(e){return At(this,e)},maxBy:function(e,t){return At(this,t,e)},min:function(e){return At(this,e?qn(e):Kn)},minBy:function(e,t){return At(this,t?qn(t):Kn,e)},rest:function(){return this.slice(1)},skip:function(e){return 0===e?this:this.slice(Math.max(0,e))},skipLast:function(e){return 0===e?this:this.slice(0,-Math.max(0,e))},skipWhile:function(e,t){return jt(this,It(this,e,t,!0))},skipUntil:function(e,t){return this.skipWhile(Bn(e),t)},sortBy:function(e,t){return jt(this,Ct(this,t,e))},take:function(e){return this.slice(0,Math.max(0,e))},takeLast:function(e){return this.slice(-Math.max(0,e))},takeWhile:function(e,t){return jt(this,function(e,t,r){var n=kt(e);return n.__iterateUncached=function(n,o){var i=this;if(o)return this.cacheResult().__iterate(n,o);var a=0;return e.__iterate((function(e,o,s){return t.call(r,e,o,s)&&++a&&n(e,o,i)})),a},n.__iteratorUncached=function(n,o){var i=this;if(o)return this.cacheResult().__iterator(n,o);var a=e.__iterator(2,o),s=!0;return new Le((function(){if(!s)return{value:void 0,done:!0};var e=a.next();if(e.done)return e;var o=e.value,l=o[0],u=o[1];return t.call(r,u,l,i)?2===n?e:Ce(n,l,u,e):(s=!1,{value:void 0,done:!0})}))},n}(this,e,t))},takeUntil:function(e,t){return this.takeWhile(Bn(e),t)},update:function(e){return e(this)},valueSeq:function(){return this.toIndexedSeq()},hashCode:function(){return this.__hash||(this.__hash=function(e){if(e.size===1/0)return 0;var t=Te(e),r=ce(e),n=t?1:0;return function(e,t){return t=et(t,3432918353),t=et(t<<15|t>>>-15,461845907),t=et(t<<13|t>>>-13,5),t=t+3864292196^e,t=et(t^t>>>16,2246822507),t=et(t^t>>>13,3266489909),t=tt(t^t>>>16),t}(e.__iterate(r?t?function(e,t){n=31*n+$n(nt(e),nt(t))|0}:function(e,t){n=n+$n(nt(e),nt(t))|0}:t?function(e){n=31*n+nt(e)|0}:function(e){n=n+nt(e)|0}),n)}(this))}});var Fn=ve.prototype;Fn[se]=!0,Fn[Ie]=Fn.values,Fn.toJSON=Fn.toArray,Fn.__toStringMapper=Wt,Fn.inspect=Fn.toSource=function(){return this.toString()},Fn.chain=Fn.flatMap,Fn.contains=Fn.includes,bn(he,{flip:function(){return jt(this,St(this))},mapEntries:function(e,t){var r=this,n=0;return jt(this,this.toSeq().map((function(o,i){return e.call(t,[i,o],n++,r)})).fromEntrySeq())},mapKeys:function(e,t){var r=this;return jt(this,this.toSeq().flip().map((function(n,o){return e.call(t,n,o,r)})).flip())}});var Pn=he.prototype;Pn[ue]=!0,Pn[Ie]=Fn.entries,Pn.toJSON=jn,Pn.__toStringMapper=function(e,t){return Wt(t)+": "+Wt(e)},bn(ge,{toKeyedSeq:function(){return new mt(this,!1)},filter:function(e,t){return jt(this,Rt(this,e,t,!1))},findIndex:function(e,t){var r=this.findEntry(e,t);return r?r[0]:-1},indexOf:function(e){var t=this.keyOf(e);return void 0===t?-1:t},lastIndexOf:function(e){var t=this.lastKeyOf(e);return void 0===t?-1:t},reverse:function(){return jt(this,Tt(this,!1))},slice:function(e,t){return jt(this,wt(this,e,t,!1))},splice:function(e,t){var r=arguments.length;if(t=Math.max(t||0,0),0===r||2===r&&!t)return this;e=ne(e,e<0?this.count():this.size);var n=this.slice(0,e);return jt(this,1===r?n:n.concat(Mt(arguments,2),this.slice(e+t)))},findLastIndex:function(e,t){var r=this.findLastEntry(e,t);return r?r[0]:-1},first:function(e){return this.get(0,e)},flatten:function(e){return jt(this,Lt(this,e,!1))},get:function(e,t){return(e=ee(this,e))<0||this.size===1/0||void 0!==this.size&&e>this.size?t:this.find((function(t,r){return r===e}),void 0,t)},has:function(e){return(e=ee(this,e))>=0&&(void 0!==this.size?this.size===1/0||e<this.size:-1!==this.indexOf(e))},interpose:function(e){return jt(this,function(e,t){var r=kt(e);return r.size=e.size&&2*e.size-1,r.__iterateUncached=function(r,n){var o=this,i=0;return e.__iterate((function(e){return(!i||!1!==r(t,i++,o))&&!1!==r(e,i++,o)}),n),i},r.__iteratorUncached=function(r,n){var o,i=e.__iterator(1,n),a=0;return new Le((function(){return(!o||a%2)&&(o=i.next()).done?o:a%2?Ce(r,a++,t):Ce(r,a++,o.value,o)}))},r}(this,e))},interleave:function(){var e=[this].concat(Mt(arguments)),t=Nt(this.toSeq(),Me.of,e),r=t.flatten(!0);return t.size&&(r.size=t.size*e.length),jt(this,r)},keySeq:function(){return Cn(0,this.size)},last:function(e){return this.get(-1,e)},skipWhile:function(e,t){return jt(this,It(this,e,t,!1))},zip:function(){return jt(this,Nt(this,Gn,[this].concat(Mt(arguments))))},zipAll:function(){return jt(this,Nt(this,Gn,[this].concat(Mt(arguments)),!0))},zipWith:function(e){var t=Mt(arguments);return t[0]=this,jt(this,Nt(this,e,t))}});var kn=ge.prototype;kn[pe]=!0,kn[_e]=!0,bn(ye,{get:function(e,t){return this.has(e)?e:t},includes:function(e){return this.has(e)},keySeq:function(){return this.valueSeq()}});var Dn=ye.prototype;function Vn(e,t,r,n,o,i){return Bt(e.size),e.__iterate((function(e,i,a){o?(o=!1,r=e):r=t.call(n,r,e,i,a)}),i),r}function Mn(e,t){return t}function Un(e,t){return[t,e]}function Bn(e){return function(){return!e.apply(this,arguments)}}function qn(e){return function(){return-e.apply(this,arguments)}}function Gn(){return Mt(arguments)}function Kn(e,t){return e<t?1:e>t?-1:0}function $n(e,t){return e^t+2654435769+(e<<6)+(e>>2)}Dn.has=Fn.includes,Dn.contains=Dn.includes,Dn.keys=Dn.values,bn(Ve,Pn),bn(Me,kn),bn(Ue,Dn);var Wn=function(e){function t(e){return null==e?Jn():mn(e)?e:Jn().withMutations((function(t){var r=ye(e);Bt(r.size),r.forEach((function(e){return t.add(e)}))}))}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.of=function(){return this(arguments)},t.fromKeys=function(e){return this(he(e).keySeq())},t.prototype.toString=function(){return this.__toString("OrderedSet {","}")},t}(Sn);Wn.isOrderedSet=mn;var zn,Hn=Wn.prototype;function Yn(e,t){var r=Object.create(Hn);return r.size=e?e.size:0,r._map=e,r.__ownerID=t,r}function Jn(){return zn||(zn=Yn(sn()))}Hn[_e]=!0,Hn.zip=kn.zip,Hn.zipWith=kn.zipWith,Hn.zipAll=kn.zipAll,Hn.__empty=Jn,Hn.__make=Yn;var Xn=function(e,t){var r;!function(e){if(Ee(e))throw new Error("Can not call `Record` with an immutable Record as default values. Use a plain javascript object instead.");if(Se(e))throw new Error("Can not call `Record` with an immutable Collection as default values. Use a plain javascript object instead.");if(null===e||"object"!=typeof e)throw new Error("Can not call `Record` with a non-object as default values. Use a plain javascript object instead.")}(e);var n=function(i){var a=this;if(i instanceof n)return i;if(!(this instanceof n))return new n(i);if(!r){r=!0;var s=Object.keys(e),l=o._indices={};o._name=t,o._keys=s,o._defaultValues=e;for(var u=0;u<s.length;u++){var c=s[u];l[c]=u,o[c]?"object"==typeof console&&console.warn&&console.warn("Cannot define "+eo(this)+' with property "'+c+'" since that property name is part of the Record API.'):ro(o,c)}}return this.__ownerID=void 0,this._values=Kr().withMutations((function(e){e.setSize(a._keys.length),he(i).forEach((function(t,r){e.set(a._indices[r],t===a._defaultValues[r]?void 0:t)}))})),this},o=n.prototype=Object.create(Qn);return o.constructor=n,t&&(n.displayName=t),n};Xn.prototype.toString=function(){for(var e,t=eo(this)+" { ",r=this._keys,n=0,o=r.length;n!==o;n++)t+=(n?", ":"")+(e=r[n])+": "+Wt(this.get(e));return t+" }"},Xn.prototype.equals=function(e){return this===e||Ee(e)&&to(this).equals(to(e))},Xn.prototype.hashCode=function(){return to(this).hashCode()},Xn.prototype.has=function(e){return this._indices.hasOwnProperty(e)},Xn.prototype.get=function(e,t){if(!this.has(e))return t;var r=this._indices[e],n=this._values.get(r);return void 0===n?this._defaultValues[e]:n},Xn.prototype.set=function(e,t){if(this.has(e)){var r=this._values.set(this._indices[e],t===this._defaultValues[e]?void 0:t);if(r!==this._values&&!this.__ownerID)return Zn(this,r)}return this},Xn.prototype.remove=function(e){return this.set(e)},Xn.prototype.clear=function(){var e=this._values.clear().setSize(this._keys.length);return this.__ownerID?this:Zn(this,e)},Xn.prototype.wasAltered=function(){return this._values.wasAltered()},Xn.prototype.toSeq=function(){return to(this)},Xn.prototype.toJS=function(){return En(this)},Xn.prototype.entries=function(){return this.__iterator(2)},Xn.prototype.__iterator=function(e,t){return to(this).__iterator(e,t)},Xn.prototype.__iterate=function(e,t){return to(this).__iterate(e,t)},Xn.prototype.__ensureOwner=function(e){if(e===this.__ownerID)return this;var t=this._values.__ensureOwner(e);return e?Zn(this,t,e):(this.__ownerID=e,this._values=t,this)},Xn.isRecord=Ee,Xn.getDescriptiveName=eo;var Qn=Xn.prototype;function Zn(e,t,r){var n=Object.create(Object.getPrototypeOf(e));return n._values=t,n.__ownerID=r,n}function eo(e){return e.constructor.displayName||e.constructor.name||"Record"}function to(e){return We(e._keys.map((function(t){return[t,e.get(t)]})))}function ro(e,t){try{Object.defineProperty(e,t,{get:function(){return this.get(t)},set:function(e){Ut(this.__ownerID,"Cannot set on an immutable record."),this.set(t,e)}})}catch(e){}}Qn[be]=!0,Qn[z]=Qn.remove,Qn.deleteIn=Qn.removeIn=nr,Qn.getIn=xn,Qn.hasIn=Fn.hasIn,Qn.merge=sr,Qn.mergeWith=lr,Qn.mergeIn=vr,Qn.mergeDeep=fr,Qn.mergeDeepWith=dr,Qn.mergeDeepIn=hr,Qn.setIn=tr,Qn.update=ir,Qn.updateIn=ar,Qn.withMutations=gr,Qn.asMutable=yr,Qn.asImmutable=mr,Qn[Ie]=Qn.entries,Qn.toJSON=Qn.toObject=Fn.toObject,Qn.inspect=Qn.toSource=function(){return this.toString()};var no,oo=function(e){function t(e,r){if(!(this instanceof t))return new t(e,r);if(this._value=e,this.size=void 0===r?1/0:Math.max(0,r),0===this.size){if(no)return no;no=this}}return e&&(t.__proto__=e),t.prototype=Object.create(e&&e.prototype),t.prototype.constructor=t,t.prototype.toString=function(){return 0===this.size?"Repeat []":"Repeat [ "+this._value+" "+this.size+" times ]"},t.prototype.get=function(e,t){return this.has(e)?this._value:t},t.prototype.includes=function(e){return Ze(this._value,e)},t.prototype.slice=function(e,r){var n=this.size;return re(e,r,n)?this:new t(this._value,oe(r,n)-ne(e,n))},t.prototype.reverse=function(){return this},t.prototype.indexOf=function(e){return Ze(this._value,e)?0:-1},t.prototype.lastIndexOf=function(e){return Ze(this._value,e)?this.size:-1},t.prototype.__iterate=function(e,t){for(var r=this.size,n=0;n!==r&&!1!==e(this._value,t?r-++n:n++,this););return n},t.prototype.__iterator=function(e,t){var r=this,n=this.size,o=0;return new Le((function(){return o===n?{value:void 0,done:!0}:Ce(e,t?n-++o:o++,r._value)}))},t.prototype.equals=function(e){return e instanceof t?Ze(this._value,e._value):On(this,e)},t}(Me);function io(e,t){return ao([],t||so,e,"",t&&t.length>2?[]:void 0,{"":e})}function ao(e,t,r,n,o,i){if("string"!=typeof r&&!Se(r)&&(ke(r)||xe(r)||Kt(r))){if(~e.indexOf(r))throw new TypeError("Cannot convert circular structure to Immutable");e.push(r),o&&""!==n&&o.push(n);var a=t.call(i,n,De(r).map((function(n,i){return ao(e,t,n,i,o,r)})),o&&o.slice());return e.pop(),o&&o.pop(),a}return r}function so(e,t){return fe(t)?t.toList():ce(t)?t.toMap():t.toSet()}const lo={version:"4.3.7",Collection:ve,Iterable:ve,Seq:De,Map:br,OrderedMap:on,List:Kr,Stack:pn,Set:Sn,OrderedSet:Wn,PairSorting:{LeftThenRight:-1,RightThenLeft:1},Record:Xn,Range:Cn,Repeat:oo,is:Ze,fromJS:io,hash:nt,isImmutable:Se,isCollection:le,isKeyed:ce,isIndexed:fe,isAssociative:de,isOrdered:Te,isValueObject:Qe,isPlainObject:Kt,isSeq:Oe,isList:Gr,isMap:Je,isOrderedMap:Xe,isStack:cn,isSet:yn,isOrderedSet:mn,isRecord:Ee,get:Ht,getIn:An,has:zt,hasIn:Nn,merge:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return pr(e,t)},mergeDeep:function(e){for(var t=[],r=arguments.length-1;r-- >0;)t[r]=arguments[r+1];return cr(e,t)},mergeWith:function(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return pr(t,r,e)},mergeDeepWith:function(e,t){for(var r=[],n=arguments.length-2;n-- >0;)r[n]=arguments[n+2];return cr(t,r,e)},remove:Jt,removeIn:rr,set:Xt,setIn:er,update:or,updateIn:Qt};var uo=0;const co=function(){var e=((new Date).getTime().toString(16)+"FF").substr(0,11);return"ssssssss-xxxx-4xxx-yxxx-x".replace(/[xys]/g,(function(e){var t="s"===e?Math.floor(16*Math.random()):15&uo++;return("x"===e?t:3&t|8).toString(16)}))+e};var po=r(3523),fo=r.n(po),vo=r(2468),ho=r.n(vo);function go(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return yo(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?yo(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function yo(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function mo(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Oo(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mo(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mo(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var bo=["formatValue","mongoFormatValue","sqlFormatValue","jsonLogic","elasticSearchFormatValue","spelFormatValue","spelImportFuncs","spelImportValue"],Eo=["formatOp","mongoFormatOp","sqlFormatOp","jsonLogic","spelFormatOp"],So=function(e){return"object"===D(e)&&null!==e&&"[object Object]"===Object.prototype.toString.call(e)},_o=function(e){return"object"===D(e)&&null!==e},To=function(e){var t=D(e);return t&&null!==e&&Array.isArray(e)?"array":t},Ro=function(e,t){return To(e)===t||"number"===t&&!isNaN(e)},wo=function(e){if("object"===D(e)&&null!==e){if(Array.isArray(e))return W(e);if(So(e))return Oo({},e)}return e},Io=function(e){return!["__proto__","constructor","prototype"].includes(e)},Lo=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)&&Io(t)},Co=function(e,t,r,n){var o=n=Oo(Oo({},{canCreate:!1,canIgnore:!1,canChangeType:!1}),null!=n?n:{}),i=o.canCreate,a=o.canIgnore,s=o.canChangeType;if(!Array.isArray(t))throw new Error("path is not an array");if(!t.length)throw new Error("path is empty");var l="number"==typeof t[0]?"array":"object";if(!Ro(e,l))throw new Error("obj is not of type ".concat(l));var u,c=wo(e),p=c,f=W(t),d=f.pop(),v=[],h=go(f);try{for(h.s();!(u=h.n()).done;){var g=u.value;if(!Io(g))throw new Error("path contains unsafe ".concat(g));var y="number"==typeof t[v.length]?"array":"object";if(!Ro(p[g],y)){if(!(p[g]?s:i)){if(a){p=void 0,c=e;break}throw new Error("Value by path ".concat(v.join(".")," should have type ").concat(y," but got ").concat(To(p[g])))}p[g]="array"===y?[]:{}}v.push(g),p[g]=wo(p[g]),p=p[g]}}catch(e){h.e(e)}finally{h.f()}if(p)if(void 0===r)delete p[d];else{var m=p[d];p[d]="function"==typeof r?r(m):r}return c},Ao=function(e,t,r){var n=r=Oo(Oo({},{canCreate:!0,canChangeType:!0,deepCopyObj:!1,deepCopyMixin:!1,arrayMergeMode:"merge",circularRefs:!1,specialSymbols:!0}),null!=r?r:{}),o=n.deepCopyObj,i=n.deepCopyMixin,a=n.circularRefs,s=n.specialSymbols;if(!Ro(e,"object"))throw new Error("obj is not an object");if(!Ro(t,"object"))throw new Error("mixin is not an object");var l=Symbol.for("_v"),u=Symbol.for("_type"),c=Symbol.for("_canCreate"),p=Symbol.for("_canChangeType"),f=Symbol.for("_arrayMergeMode"),d=o?fo()(e,a):wo(e),v=!1,h=function(e,t,n){var d=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},g=d.isMixingArray,y=d.isMixingRealArray,m=0,O=function(){if(!Io(b))throw new Error("mixin contains unsafe key ".concat(b));if(!Lo(t,b))return 0;var d,O,E,S,_,T,R,w=g?Number(b)+m:b,I=s&&_o(t[b]),L=r.canCreate,C=r.canChangeType,A=r.arrayMergeMode,x=t[b],N=!1,j=To(x);I&&(l in t[b]&&(N=!0,x=t[b][l]),j=(null===(d=t[b])||void 0===d?void 0:d[u])||To(x),L=null!==(O=null===(E=t[b])||void 0===E?void 0:E[c])&&void 0!==O?O:L,C=null!==(S=null===(_=t[b])||void 0===_?void 0:_[p])&&void 0!==S?S:C,A=null!==(T=null===(R=t[b])||void 0===R?void 0:R[f])&&void 0!==T?T:A,"array"===j&&"overwrite"===A&&(N=!0));if("array"!==j&&(A=void 0),!Ro(n[w],j)){if(!(n[w]?C:L))return 0;"array"!==j&&"object"!==j||(n[w]="array"===j?[]:{},v=!0)}if("array"===j||"object"===j)if(N)v=!0,n[w]=i?fo()(x,a):wo(x);else if(A&&["join","joinMissing","joinRespectOrder"].includes(A)){v=!0;var F=o?n[w]:fo()(n[w],a),P=i?fo()(x,a):x;"joinRespectOrder"===A?n[w]=Ho(F,P):("joinMissing"===A&&(P=P.filter((function(e){return!F.includes(e)}))),n[w]=[].concat(W(F),W(P)))}else{var k;o||(n[w]=wo(n[w])),h([].concat(W(e),[b]),x,n[w],{isMixingArray:"array"===j,isMixingRealArray:"array"===j&&!(null!==(k=t[b])&&void 0!==k&&k[u])})}else void 0===x&&!y&&!N?w in n&&(v=!0,Array.isArray(n)?(n.splice(w,1),m--):delete n[w]):(v=!0,n[w]=x)};for(var b in t)O()};return h([],t,d),v?d:e},xo=function(e,t){return Object.fromEntries(Object.entries(e).filter((function(e){var r=K(e,1)[0];return!t.includes(r)})))},No=function(e){var t;return null!==(t=null==e?void 0:e.cardinality)&&void 0!==t?t:1},jo=function(e,t){return e===t||(br.isMap(e)?e.equals(t):JSON.stringify(e)==JSON.stringify(t))},Fo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?Po(e,t,r):br.isMap(e)?e.equals(t):"object"==D(e)?ko(e,t,r):e===t)};function Po(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++){if(!(r?Fo(e[o],t[o],r):e[o]===t[o]))return!1}return!0}function ko(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var a=0;a<i;a++){var s=n[a];if(!(r?Fo(e[s],t[s],r):e[s]===t[s]))return!1}return!0}var Do=function(e){return"object"===D(e)&&null!==e&&"function"==typeof e.toJS},Vo=function(e){return Do(e)&&lo.isList(e)};function Mo(e){return Vo(e)?e:new lo.List(e)}function Uo(e){return Do(e)?e.toJS():e}var Bo=function(e){return e.replace(/[.*+?^${}()|[\]\\/]/g,"\\$&")},qo=function(e,t,r,n,o,i){if(Array.isArray(e))return t},Go=function(e){var t;if(e instanceof Array)return e.map((function(e,t){return Go(e)}));if("object"===D(e)&&null!==e&&Ko(e)){var r,n=xo(e,["$$typeof","_owner","_store","ref","key"]);return n.type&&(n.type="string"==typeof(t=n.type)?t:"function"==typeof t?t.name:t),null!=n&&null!==(r=n.props)&&void 0!==r&&r.children&&(n.props.children=Go(n.props.children)),n}return e},Ko=function(e){return"object"===D(e)&&null!==e&&!Array.isArray(e)&&Object.keys(e).includes("type")&&Object.keys(e).includes("props")&&Object.keys(e).includes("key")&&Object.keys(e).includes("ref")&&Object.keys(e).includes("$$typeof")},$o=function(e){return"object"===D(e)&&null!==e&&!Array.isArray(e)&&"string"==typeof e.type&&Object.keys(e).includes("props")},Wo=function(e){var t="object"===D(e)&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length;return t};function zo(e){return new Promise((function(t){setTimeout(t,e)}))}function Ho(e,t){return e||(e=[]),t||(t=[]),t.map((function(t){return[t,e.indexOf(t)]})).map((function(e,t,r){var n=K(e,2),o=n[0];if(-1==n[1]){var i=r.slice(t+1),a=r.slice(0,t),s=W(a).reverse().find((function(e){var t=K(e,2);t[0];return-1!=t[1]})),l=a[a.length-1],u=i.find((function(e){var t=K(e,2);t[0];return-1!=t[1]})),c=s&&s===a[a.length-1],p=u&&i===i[0];return c?[o,"after",s[0]]:p?[o,"before",u[0]]:s?l?[o,"after",l[0]]:[o,"after",s[0]]:u?[o,"before",u[0]]:[o,"append",null]}return null})).filter((function(e){return null!==e})).reduce((function(e,t){var r=K(t,3),n=r[0],o=r[1],i=r[2],a=e.indexOf(i);if(-1===e.indexOf(n))if(a>-1){var s="after"===o?1:0;e.splice(a+s,0,n)}else e.splice("append"===o?1/0:0,0,n);return e}),e.slice())}var Yo=function(e){"object"!==D(e)||null===e||Ko(e)||(Object.keys(e).forEach((function(t){"__cache"!==t&&Yo(e[t])})),Object.freeze(e))},Jo=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];if(So(e)){if(e.var)return r[e.var]=t,!0;if(!So(t))return!1;for(var o in e){var i=e[o],a=t[o];if(!Jo(i,a,r,[].concat(W(n),[o])))return!1}return!0}if(Array.isArray(e)){if(!Array.isArray(t))return!1;for(var s=0;s<e.length;s++){var l=e[s],u=t[s];if(!Jo(l,u,r,[].concat(W(n),[s])))return!1}return!0}return e===t},Xo=function(e){return"undefined"!=typeof process&&"true"==(null===(t=process)||void 0===t||null===(t=t.env)||void 0===t?void 0:t.NODE_ENV_TEST)?Oo(Oo({},console),{},{log:function(){},debug:function(){},info:function(){}}):(null!=e?e:"undefined"!=typeof process&&"development"==(null===(r=process)||void 0===r||null===(r=r.env)||void 0===r?void 0:"production"))?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}};var t,r},Qo=function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=0;r<t.length;r++){var n=t[r];if(void 0!==n){e=n;break}}return e},Zo=Xo(),ei=r(5522),ti=r.n(ei),ri=r(8831),ni=r.n(ri);function oi(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ii(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?oi(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):oi(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ai=ti().mark(pi),si=ti().mark(fi),li=bo,ui=["conjunctions","fields","types","operators","widgets","settings","funcs","ctx"],ci=["select","multiselect","treeselect","treemultiselect"];function pi(e){return ti().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(di(e,e.funcs||{},[]),"t0",1);case 1:case"end":return t.stop()}}),ai)}function fi(e){return ti().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.delegateYield(di(e,e.fields||{},[]),"t0",1);case 1:case"end":return t.stop()}}),si)}function di(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";return ti().mark((function o(i){var a,s,l;return ti().wrap((function(o){for(;;)switch(o.prev=o.next){case 0:a=(null==e||null===(i=e.settings)||void 0===i?void 0:i.fieldSeparator)||".",o.t0=ti().keys(t);case 2:if((o.t1=o.t0()).done){o.next=13;break}if(s=o.t1.value,!(l=t[s])[n]){o.next=9;break}return o.delegateYield(di(e,l[n],[].concat(W(r),[s]),n),"t2",7);case 7:o.next=11;break;case 9:return o.next=11,[[].concat(W(r),[s]).join(a),l,s];case 11:o.next=2;break;case 13:case"end":return o.stop()}}),o)}))()}var vi=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"fields",i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"subfields";if(!t)return null;if("!case_value"===t)return null==e||null===(n=e.settings)||void 0===n?void 0:n.caseValueField;var a=(null==e||null===(r=e.settings)||void 0===r?void 0:r.fieldSeparator)||".",s=Ei(t,e),l=e[o];if(!l)return null;for(var u=l,c=null,p=[],f=0;f<s.length;f++){var d=s[f];p.push(d),c=u[p.join(a)],f<s.length-1&&(c&&c[i]?(u=c[i],p=[]):c=null)}return c},hi=function(e,t){var r,n,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=e.settings.fieldSeparator,a=[o].concat(W(t.split(i))).filter((function(e){return null!=e})),s=t;return((null===(r=e.__fieldNames[s])||void 0===r||null===(n=r.find)||void 0===n||null===(n=n.call(r,(function(e){var t=e.inGroup;return!t||(null==o?void 0:o.startsWith(t))})))||void 0===n?void 0:n.fullPath)||a).join(i)},gi=function(e,t){if(!t)return null;var r=vi(e,t,"funcs","subfields");if(!r)return null;var n=r.returnType,o=r.args;return{returnType:n,args:Object.fromEntries(Object.entries(o||{}).map((function(e){var t=K(e,2),r=t[0],n=t[1];return[r,ni()(n,["type","valueSources","defaultValue","fieldSettings","isOptional","_funcKey","_argKey","_isFuncArg"])]})))}},yi=function(e,t){if(!t)return null;var r=vi(e,t,"funcs","subfields");return r||null},mi=function(e,t,r){var n=yi(e,t);if(!n)return null;var o=n.args&&n.args[r]||null;return o||null},Oi=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return!1;var o=(null==n||null===(r=n.settings)||void 0===r?void 0:r.fieldSeparator)||".",i=bi(e,n),a=bi(t,n);return i.startsWith(a+o)},bi=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("string"==typeof e)return e;var n=(null==r||null===(t=r.settings)||void 0===t?void 0:t.fieldSeparator)||".";return Ei(e,r).join(n)},Ei=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!e)return[];if(Array.isArray(e))return e;var i,a=(null==o||null===(t=o.settings)||void 0===t?void 0:t.fieldSeparator)||".";return null!=e&&e.func?Array.isArray(e.func)?e.func:e.func.split(a):null!=e&&null!==(r=e.get)&&void 0!==r&&r.call(e,"func")?null==e||null===(i=e.get)||void 0===i?void 0:i.call(e,"func").split(a):(null==e||null===(n=e.split)||void 0===n?void 0:n.call(e,a))||[]},Si=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!e)return null;var n=t.settings.fieldSeparator,o=Ei(e,t);return r?o:o.map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return e.join(n)}))},_i=function(e){var t;if("string"==typeof e||Array.isArray(e))return"field:".concat(bi(e));if("object"===D(e)&&e){if(e._funcKey&&e._argKey)return"arg:".concat(bi(e._funcKey),"__").concat(e._argKey);if(e._funcKey)return"func:".concat(bi(e._funcKey));if(e.func&&e.arg)return"arg:".concat(bi(e.func),"__").concat(e.arg);if(e.func)return"func:".concat(bi(e.func));if(e.type)return null}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?"arg:".concat(bi(e.get("func")),"__").concat(e.get("arg")):"func:".concat(bi(e.get("func"))):null},Ti=function(e,t,r){var n;return null===(n=e.__cache)||void 0===n||null===(n=n[t])||void 0===n?void 0:n[r]},Ri=function(e,t,r,n){e.__cache&&r&&(e.__cache[t]||(e.__cache[t]={}),e.__cache[t][r]=n)},wi=function(e){var t;if(!e)return null;if("object"===D(e)){if(!e.func&&e.type)return"field";if(e.func)return e.func&&e.arg?null:"func"}return null!=e&&null!==(t=e.get)&&void 0!==t&&t.call(e,"func")?null!=e&&e.get("arg")?null:"func":"field"},Ii=function(e,t){var r;if(!t)return null;if("object"==D(t)){if(!t.func&&t.type&&t.widgets)return t;if(t._isFuncArg)return mi(e,t._funcKey,t._argKey);if(t._isFunc)return yi(e,t._funcKey);if(t.func)return t.func&&t.arg?mi(e,t.func,t.arg):yi(e,t.func)}if(null!=t&&null!==(r=t.get)&&void 0!==r&&r.call(t,"func"))return null!=t&&t.get("arg")?mi(e,t.get("func"),t.get("arg")):yi(e,t.get("func"));var n=vi(e,t);return n||null},Li=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!t)return null;var n=e.operators[t];if(r){var o,i,a=_i(r),s=a?"".concat(a,"__").concat(t):null,l=Ti(e,"getOperatorConfig",s);if(l)return l;var u=Ii(e,r),c=ji(e,r,t,null),p=e.widgets[c]||{},f=(u&&u.widgets?u.widgets[c]:{})||{},d=(null===(o=p.opProps)||void 0===o?void 0:o[t])||{},v=(null===(i=f.opProps)||void 0===i?void 0:i[t])||{},h=ii(ii(ii({},n),d),v);return Ri(e,"getOperatorConfig",s,h),h}return n},Ci=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};if(!t)return null;var s=Ii(e,t),l=_i(t);o||(o=ji(e,t,n,i));var u=l?"".concat(l,"__").concat(n,"__").concat(o,"__").concat(i):null,c=Ti(e,"getFieldWidgetConfig",u);if(c)return c;var p=e.widgets[o]||{},f=(null==s||null===(r=s.widgets)||void 0===r?void 0:r[o])||{},d=f.widgetProps||{},v="value"!==i&&i?{}:null==s?void 0:s.fieldSettings,h=ii(ii(ii(ii({},p),f),d),v);return Ri(e,"getFieldWidgetConfig",u,h),a.forExport&&(h=xo(h,"factory")),h},Ai=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=e.settings.fieldSeparator,n=Ei(t,e),o=t?vi(e,t):e,i=null,a=[];do{var s,l=o===e?e.fields:null===(s=o)||void 0===s?void 0:s.subfields;if(!l||!Object.keys(l).length){o=i=null;break}i=Object.keys(l)[0],a.push(i),o=l[i]}while("!struct"==o.type||"!group"==o.type);return(n||[]).concat(a).join(r)};function xi(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=[],i=[];if(!t)return{widgets:o,valueSrcs:i};var a=_i(t),s=a?"".concat(a,"__").concat(r,"__").concat(n):null,l=Ti(e,"_getWidgetsAndSrcsForFieldOp",s);if(l)return l;var u="object"===D(t)&&(!!t.func&&!!t.arg||t._isFuncArg),c=Ii(e,t),p=r?e.operators[r]:null;if(null!=c&&c.widgets){var f=function(){var a=c.widgets[d];if(!e.widgets[d])return 1;var s=e.widgets[d].valueSrc||"value",l=!0;if("field"===d&&(l=l&&Ni(e,["field"],c,r).length>0),"func"===d&&(l=l&&Ni(e,["func"],c,r).length>0),"value"!==n||a.operators||u||"!case_value"===t||(l=!1),a.operators&&r&&(l=l&&-1!=a.operators.indexOf(r)),n&&n!=s&&"const"!==n&&(l=!1),p&&0==p.cardinality&&"value"!==s&&(l=!1),l){var f,v;o.push(d);var h=-1!=(null===(f=c.valueSources)||void 0===f?void 0:f.indexOf(s));-1==(null==p||null===(v=p.valueSources)||void 0===v?void 0:v.indexOf(s))&&(h=!1),h&&!i.find((function(e){return e==s}))&&i.push(s)}};for(var d in c.widgets)f()}var v=function(e){var t=0;return c.preferWidgets?c.preferWidgets.includes(e)&&(t+=10-c.preferWidgets.indexOf(e)):e==c.mainWidget&&(t+=100),"field"===e&&(t-=1),"func"===e&&(t-=2),t};o.sort((function(e,t){return v(t)-v(e)}));var h={widgets:o,valueSrcs:i};return Ri(e,"_getWidgetsAndSrcsForFieldOp",s,h),h}var Ni=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(!r)return t;var i=null!==(n=r.type)&&void 0!==n?n:r.returnType;"!group"===i&&(i="number");var a=!1;if(o){var s=e.operators[o];null!=s&&s.valueTypes&&(i=s.valueTypes[0],a=!0)}return t||(t=Object.keys(e.settings.valueSourcesInfo)),t.filter((function(t){var n=!0;if("field"===t&&e.__fieldsCntByType){var o=r._isFuncArg||a?0:1;n=n&&e.__fieldsCntByType[i]>o}return"func"===t&&(r.funcs&&(n=n&&r.funcs.length>0),e.__funcsCntByType&&(n=n&&e.__funcsCntByType[i]>0)),n}))},ji=function(e,t,r){var n=xi(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets,o=null;return n.length&&(o=n[0]),o},Fi=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=xi(e,t,r,null).valueSrcs;return Ni(e,o,n,r)},Pi=function(e,t,r){return xi(e,t,r,arguments.length>3&&void 0!==arguments[3]?arguments[3]:null).widgets},ki=function(e,t){var r;return(null===(r=e.types[t])||void 0===r?void 0:r.operators)||null},Di=function(e,t){var r=Ii(e,t);return r?r.operators:[]},Vi=function(e,t){var r,n=Di(e,t);return null!==(r=null==n?void 0:n[0])&&void 0!==r?r:null},Mi=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(!e)return null;var n=r&&vi(t,r)||null,o=t.settings.fieldSeparator,i=Ei(e,t),a=Oi(e,r,t)?Ei(r,t):[];return i.slice(a.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return{part:[].concat(W(a),W(e)).join(o),key:e[e.length-1]}})).map((function(e){var r=e.part;return{key:e.key,cnf:vi(t,r)}})).map((function(e,t,r){return[e.key,e.cnf,t>0?r[t-1].cnf:n]}))},Ui=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.skip(1),e.push.apply(e,r),e}))},Bi=function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];return e.interpose("children1").withMutations((function(e){return e.push.apply(e,r),e}))},qi=function(e,t){var r=new lo.OrderedMap(M({},e.get("id"),e)),n=e;return t.forEach((function(e){var t,o;n=null===(t=r)||void 0===t?void 0:t.get(e),r=null===(o=n)||void 0===o?void 0:o.get("children1")})),n},Gi=function(e,t){var r=t.map((function(e,r){return t.take(r+1)})).reverse().toJS().map((function(t){return{item:qi(e,t),path:t}})).filter((function(e){var t=e.item;return"rule_group"===(null==t?void 0:t.get("type"))}));return r.length?r.map((function(e){var t=e.item;return{path:e.path,field:t.get("properties").get("field")}})):[]},Ki=function(e){var t=e;return function e(r,n){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=n.push(r.get("id")),a=r.getIn(["properties","isLocked"]);o&&a&&(t=t.deleteIn(Ui(i,"properties","isLocked")));var s=r.get("children1");s&&s.map((function(t,r){e(t,i,a||o)}))}(e,new lo.List),t},$i=function(e){var t=e;return function e(r,n,o,i){if(r){var a=r.get("path"),s=r.get("id"),l=s||i||co(),u=n.push(l);a&&a.equals(u)||(t=t.setIn(Ui(u,"path"),u)),s||(t=t.setIn(Ui(u,"id"),l));var c=r.get("children1");c&&("Map"===c.constructor.name&&(t=t.setIn(Ui(u,"children1"),new lo.OrderedMap(c))),c.map((function(t,r){e(t,u,o+1,r)})))}}(e,new lo.List,0),t},Wi=function(e){var t=e;return function e(r,n,o,i){if(!r)return!1;var a=r.get("id")||i,s=n.push(a),l=r.get("children1");if(l){var u=l.map((function(t,r){return e(t,s,o+1,r)})).reduce((function(e,t){return e&&t}),!0);if((0==l.size||u)&&o>0)return t=t.deleteIn(Ui(s)),!0}return!1}(e,new lo.List,0),t},zi=function(e,t){var r=[],n={},o=[],i=0,a=0,s=0,l={};!function u(c,p,f,d,v,h,g,y,m){var O,b,E,S=c===e,_=c.get("type"),T=c.get("collapsed"),R=c.get("id"),w=c.get("children1"),I=c.getIn(["properties","isLocked"]),L=w?w.map((function(e,t){return t})).valueSeq().toArray():null,C="rule_group"===_,A="rule"===_,x="group"===_,N="case_group"===_,j=!v&&(!w||C),F=(null==L?void 0:L.length)>0,P=p.length?p[p.length-1]:null,k=W(p).reverse().find((function(e){return"rule_group"==n[e].type})),D=c.getIn(["properties","field"]),V=D&&t&&Ii(t,D),M=V?!1!==(null==V?void 0:V.canRegroup):void 0,U=null==V?void 0:V.maxNesting,B=null==n||null===(O=n[k])||void 0===O?void 0:O.canRegroup,q=null==n||null===(b=n[k])||void 0===b?void 0:b.maxNesting,G=null==n||null===(E=n[k])||void 0===E?void 0:E.lev,K=N?R:y;N&&(o.push(R),a=0,s=0,l={});var $,z=K?o.indexOf(K):null,H=r.length,Y=i;S||(($={}).caseNo=z,$.globalNoByType=N?z:l[_]||0,$.indexPath=[].concat(W(p.slice(1).map((function(e){return n[e].childNo}))),[m]),A?$.globalLeafNo=a:x&&($.globalGroupNo=s));var J=v||C?g:g+1;r.push(R),n[R]={node:c,index:H,id:R,type:_,parent:P,children:L,childNo:m,caseId:K,caseNo:z,closestRuleGroupId:k,closestRuleGroupLev:G,closestRuleGroupMaxNesting:q,closestRuleGroupCanRegroup:B,maxNesting:U,canRegroup:M,path:p.concat(R),lev:h,atomicLev:g,nextAtomicLev:J,isLeaf:!w,isAtomicRule:j,isLocked:I||d,top:f?null:Y,isDefaultCase:N?!w:void 0,atomicRulesCountInCase:N?0:void 0,position:$,collapsed:T,_top:H,parentType:P?n[P].type:null,leaf:!w};var X=0,Q=0;f||(i+=1,X+=1,!F||T||C||(Q+=1),S||N||(x&&s++,j&&0,A&&a++,l[_]=(l[_]||0)+1)),y&&j&&n[y].atomicRulesCountInCase++;var Z=0,ee=0;if(F){var te=0;w.map((function(e,t){if(e){u(e,p.concat(R),f||T,d||I,v||C,h+1,J,K,te);var r=n[t];Z=Math.max(Z,r.depth||0),ee+=r.height,te++}}))}X+=ee,Q+=Z;var re=r.length-H,ne=f?null:Y+X;Object.assign(n[R],{depth:w?Q:void 0,_height:re,height:X,bottom:ne})}(e,[],!1,!1,!1,0,0,null,null);for(var u=0;u<r.length;u++){var c=u>0?r[u-1]:null,p=u<r.length-1?r[u+1]:null,f=n[r[u]];f.prev=c,f.next=p}return{flat:r,items:n,cases:o}},Hi=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,s;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),s=r.get("type")):(i=r.id,a=r.children1,s=r.type),t++,"rule_group"==s&&o>0||a&&a.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t-1},Yi=function(e){if(!e)return-1;var t=0;return function e(r,n,o){var i,a,s;"function"==typeof r.get?(i=r.get("id"),a=r.get("children1"),s=r.get("type")):(i=r.id,a=r.children1,s=r.type),"rule"==s||"rule_group"==s&&o>0?t++:a&&a.map((function(t,r){t&&e(t,n.concat(i),o+1)}))}(e,[],0),t},Ji=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=e;return function e(n,o){t&&n.path&&delete n.path,t&&!r&&o&&delete n.id;var i=n.properties;i&&null==i.operatorOptions&&delete i.operatorOptions;var a=n.children1;if(a){for(var s in a)a[s]&&e(a[s],s);r&&(n.children1=Object.values(a))}}(e,null),n},Xi=function(e){var t=[],r=e.get("children1");return r&&r.map((function(e){var r,n=e.getIn(["properties","value"]);n&&1==n.size?(r=n.get(0),Array.isArray(r)&&0==r.length&&(r=null)):r=null,t=[].concat(W(t),[r])})),t},Qi=function(e){return!e.get("children1")||0==e.get("children1").size},Zi=function(e,t){return e.getIn(Ui(t,"children1")).size>0},ea=function(e){if(null!=e&&e.toJS){var t,r=null==e||null===(t=e.toJS)||void 0===t?void 0:t.call(e);return null!=r&&r.func?e.toOrderedMap():r}return e};function ta(e){return io(e,(function(e,t,r){var n,o=r&&r.length>3&&"value"===r[r.length-1]&&"args"===r[r.length-3],i=r&&r.length>3&&"value"===r[r.length-1]&&"properties"===r[r.length-2];if("properties"==e){n=t.toOrderedMap();for(var a=0;a<2;a++){var s,l;null===(null===(s=n.get("value"))||void 0===s||null===(l=s.get)||void 0===l?void 0:l.call(s,a))&&(n=n.setIn(["value",a],void 0))}}else n=o?ea(t):(r?i:"value"==e)&&lo.Iterable.isIndexed(t)?t.map(ea).toList():"asyncListValues"==e?t.toJS():"children1"==e&&lo.Iterable.isIndexed(t)?new lo.OrderedMap(t.map((function(e){return[(null==e?void 0:e.get("id"))||co(),e]}))):lo.Iterable.isIndexed(t)?t.toList():t.toOrderedMap();return n}))}var ra=function(e){return oa(e)},na=function(e,t,r){var n=t?Li(e,t,r):null;return n&&n.options?new lo.Map(n.options&&n.options.defaults||{}):null},oa=function(e){var t,r,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,o=(null===(t=n=Ii(e,n))||void 0===t?void 0:t.conjunctions)||Object.keys(e.conjunctions);return 1==o.length?o[0]:(null===(r=n)||void 0===r?void 0:r.defaultConjunction)||e.settings.defaultConjunction||e.settings.defaultGroupConjunction||o[0]},ia=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return new lo.Map({conjunction:oa(e,t),not:!1})},aa=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=e.settings.defaultField,o=(r?sa(e,r):n)||t&&Ai(e,r)||null;return null==o||"string"==typeof o||Do(o)||(o=ta(o)),o},sa=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!r)return null;var n=(null==e||null===(t=e.settings)||void 0===t?void 0:t.fieldSeparator)||".",o=Ii(e,r),i=null==o?void 0:o.defaultField;return i&&(i=[].concat(W(Ei(r)),[i]).join(n)),i},la=function(e){var t;return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(null===(t=e.settings.fieldSources)||void 0===t?void 0:t[0])||"field"},ua=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=Ii(e,t),o=(null==n?void 0:n.operators)||[],i=e.settings.defaultOperator;i&&!o.includes(i)&&(i=null);var a=null==n?void 0:n.defaultOperator,s=null==n?void 0:n.ownDefaultOperator,l=r?Vi(e,t):null;return s||i||a||l},ca=function(e){return Vo(e)?e:pa([e])},pa=function(e){return Vo(e)?e:new lo.List(e)},fa=function(){return new lo.Map},da=r(8906),va=r.n(da),ha=function(e,t,r){var n=null;if(e)if("field"===t){var o=Ii(r,e);o&&(n=o.type)}else if("func"===t){var i=e.get("func");if(i){var a=yi(r,i);a&&(n=a.returnType||a.type)}}return n},ga=function(e,t){return ya(e,t,arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,"funcs","subfields")},ya=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"fields",o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"subfields";if(!e)return null;var i=t.settings.fieldSeparator,a=Ei(e,t),s=Ei(r,t);return a.slice(s.length).map((function(e,t,r){return r.slice(0,t+1)})).map((function(e){return[].concat(W(s),W(e)).join(i)})).map((function(e){var r=vi(t,e,n,o);return r&&r.label||va()(e.split(i))})).filter((function(e){return null!=e}))},ma=function(e,t,r,n){var o=arguments.length>5&&void 0!==arguments[5]&&arguments[5],i=Ci(e,t,r,null,arguments.length>4&&void 0!==arguments[4]?arguments[4]:null)||{},a=Li(e,r,t)||{},s=null;if((o?1:a.cardinality)>1){var l=i.valueLabels||a.valueLabels;l&&(s=l[n]),s&&"object"!==D(s)&&(s={label:s,placeholder:s}),s||(s={label:e.settings.valueLabel+" "+(n+1),placeholder:e.settings.valuePlaceholder+" "+(n+1)})}else{var u=i.valueLabel,c=i.valuePlaceholder;s={label:u||e.settings.valueLabel,placeholder:c||e.settings.valuePlaceholder}}return s},Oa=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};if(e){var i=Ii(t,e)||{},a=t.settings.fieldSeparator,s=Ei(e,t),l=Array.isArray(e)?e.join(a):e;if(null!=o&&o.useTableName&&i.tableName){var u=W(s);u[0]=i.tableName,l=u.join(a)}if(i.fieldName&&(l=i.fieldName),n){Ii(t,n);var c=n;0==l.indexOf(c+a)?l=l.slice((c+a).length):i.fieldName||r.errors.push("Can't cut group ".concat(c," from field ").concat(l))}return l}},ba=function(e,t){var r=e.get("type"),n=e.getIn(["properties","mode"]);return"rule_group"==r&&"array"==n?Ea(e,t):"group"==r||"rule_group"==r?_a(e,t):Ra(e,t)},Ea=function(e,t){var r=e.get("children1"),n=e.get("properties");return Sa(n.toObject(),r,t)},Sa=function(e,t,r){var n,o,i=e.operator,a=0==(null!==(n=null===(o=r.operators[i])||void 0===o?void 0:o.cardinality)&&void 0!==n?n:1),s={group:!wa(e,r),children:!Ta(t,r)};return!(s.group&&(!a||s.children))},_a=function(e,t){var r=e.get("children1");return Ta(r,t)},Ta=function(e,t){return!((null==e?void 0:e.size)>0&&e.filter((function(e){return!ba(e,t)})).size>0)},Ra=function(e,t){var r=e.get("properties");return wa((null==r?void 0:r.toObject())||{},t)},wa=function(e,t){return!(Ia(e,t,!0).score>=3)},Ia=function(e,t){var r,n,o,i=e.field,a=e.fieldSrc,s=(e.fieldType,e.operator),l=e.value,u=e.valueSrc,c=(e.valueType,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),p=null!==(r=null===(n=t.operators[s])||void 0===n?void 0:n.cardinality)&&void 0!==r?r:1,f=null!=u&&u.get?u.toJS():u,d={parts:{},score:0};if(d.parts.field=c?null!=i:La(i,a,t),d.parts.operator=!!s,d.parts.value=(null==l||null===(o=l.filter((function(e,r){return La(e,null==f?void 0:f[r],t,c)})))||void 0===o?void 0:o.size)>=(c?Math.min(p,1):p),d.score=Object.keys(d.parts).filter((function(e){return!!d.parts[e]})).length,c&&d.score<3){var v=!0;!d.parts.value&&"func"===a&&La(i,a,t,!1,v)&&d.score++,d.parts.field||null==l||l.map((function(e,r){"func"===(null==f?void 0:f[r])&&La(e,null==f?void 0:f[r],t,!1,v)&&d.score++}))}return d},La=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(!n&&"func"==t&&e){var i,a=null===(i=e.get)||void 0===i?void 0:i.call(e,"func"),s=yi(r,a);if(s){var l=e.get("args");for(var u in s.args){var c=s.args[u],p=l?l.get(u):void 0,f=p?p.get("value"):void 0,d=p?p.get("valueSrc"):void 0;if(null==f&&void 0===(null==c?void 0:c.defaultValue)&&(null==c||!c.isOptional))return!1;if(null!=f&&!La(f,d,r,!o||n))return!1}return!0}}return null!=e},Ca=function(e,t,r){return"func"==t?Aa(e,r):e},Aa=function(e,t){if(e){var r=e.get("func"),n=r&&yi(t,r);if(n){var o=e,i=!1;for(var a in n.args){var s=n.args[a],l=s.valueSources,u=s.isOptional,c=s.defaultValue,p=Ni(t,l,s),f=o.get("args"),d=1==p.length?p[0]:void 0,v=f?f.get(a):void 0,h=v?v.get("value"):void 0,g=(v?v.get("valueSrc"):void 0)||d;if(void 0!==h){var y=Ca(h,g,t);if(void 0===y)return;if(y!==h&&(o=o.setIn(["args",a,"value"],y)),i)return}else if(void 0===c||So(c)){if(!u)return;i=!0}else o=(o=o.setIn(["args",a,"value"],Na(s))).setIn(["args",a,"valueSrc"],"value")}return o}}},xa=function(e){var t=e.get("children1");if(1==(null==t?void 0:t.size)){var r=t.first();return"group"===r.get("type")?xa(r):r}return null},Na=function(e){var t=e.defaultValue;return So(t)&&!lo.Map.isMap(t)&&t.func?lo.fromJS(t,(function(e,t){return lo.Iterable.isIndexed(t)?t.toList():t.toOrderedMap()})):t},ja=function(e,t,r,n,o){if(e&&e.get("func")){var i=(e=e.setIn(["args",t,"value"],r)).getIn(["args",t,"valueSrc"]),a=n.valueSources,s=Ni(o,a,n),l=1==s.length?s[0]:void 0;!l&&s.includes("value")&&(l="value"),!i&&l&&(e=e.setIn(["args",t,"valueSrc"],l))}return e},Fa=function(e,t,r){if(r)for(var n in r.args)t=Pa(e,t,r,n);return t},Pa=function(e,t,r,n){var o=r.args[n],i=o.valueSources,a=o.defaultValue,s=Ni(e,i,o),l=s.length?s[0]:void 0,u=(a?So(a)&&a.func?"func":"value":void 0)||l;return t.getIn(["args",n])||(void 0!==a&&(t=t.setIn(["args",n,"value"],Na(o))),u&&(t=t.setIn(["args",n,"valueSrc"],u))),t};function ka(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Da(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ka(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ka(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Va=function(e,t){var r={usedFields:[]},n=Ma(e,t,r);if(n)return Da(Da({},n),r)},Ma=function(e,t,r){if(e){var n=e.get("type"),o=e.get("children1");return("group"===n||"rule_group"===n)&&o&&o.size?Ua(e,t,r):"rule"===n?Ba(e,t,r):void 0}},Ua=function(e,t,r){var n=e.get("properties")||new br,o=e.get("children1"),i=e.get("id"),a=o.map((function(e){return Ma(e,t,r)})).filter((function(e){return void 0!==e}));if(a.size){var s=n.get("conjunction");s||(s=ra(t));var l=n.get("not");return{id:i,rules:a.toList(),condition:s.toUpperCase(),not:l}}},Ba=function(e,t,r){var n,o=e.get("properties")||new br,i=e.get("id"),a=o.get("operator"),s=o.get("operatorOptions"),l=o.get("field"),u=o.get("value"),c=o.get("valueSrc"),p=o.get("valueType"),f=u.filter((function(e){return void 0===e})).size>0;if(null!=l&&null!=a&&!f){var d=Ii(t,l)||{},v=Li(t,a,l)||{},h=d.type||"undefined",g=No(v),y=t.types[d.type]||{},m=Oa(l,t,r);if(!(u.size<g)){-1==r.usedFields.indexOf(l)&&r.usedFields.push(l),u=u.toArray(),c=c.toArray(),p=(null===(n=p)||void 0===n?void 0:n.toArray())||[];for(var O=[],b=0;b<u.length;b++){var E={type:p[b],value:u[b]};if(O.push(E),"field"==c[b]){var S=u[b];-1==r.usedFields.indexOf(S)&&r.usedFields.push(S)}}var _=s?s.toJS():null;_&&!Object.keys(_).length&&(_=null);var T={id:i,fieldName:m,type:h,input:y.mainWidget,operator:a};return _&&(T.operatorOptions=_),T.values=O,T}}},qa=r(2815),Ga=r.n(qa),Ka={reverseOperatorsForNot:!1,canShortMongoQuery:!0,fixJsonLogicDateCompareOp:!1,formatField:function(e,t,r,n,o,i){return i?r:e},caseValueField:{type:"case_value"},fieldSources:["field"],keepInputOnChangeFieldSrc:!0,fieldItemKeysForSearch:["label","path","altLabel","grouplabel"],listKeysForSearch:["title","value"],valueSourcesInfo:{value:{}},fieldSeparator:".",fieldSeparatorDisplay:".",canReorder:!0,canRegroup:!0,canDeleteLocked:!1,canLeaveEmptyGroup:!0,shouldCreateEmptyGroup:!1,exportPreserveGroups:!1,removeEmptyGroupsOnLoad:!0,removeEmptyRulesOnLoad:!0,removeIncompleteRulesOnLoad:!1,removeInvalidMultiSelectValuesOnLoad:!0,showErrorMessage:!1,setOpOnChangeField:["keep","default"],groupOperators:["some","all","none"],defaultConjunction:"AND",defaultGroupConjunction:"AND",locale:{moment:"en"},valueLabel:"Value",valuePlaceholder:"Value",fieldLabel:"Field",operatorLabel:"Operator",funcLabel:"Function",fieldPlaceholder:"Select field",funcPlaceholder:"Select function",operatorPlaceholder:"Select operator",lockLabel:"Lock",lockedLabel:"Locked",deleteLabel:"Delete",addGroupLabel:"Add group",addCaseLabel:"Add condition",addDefaultCaseLabel:"Add default condition",defaultCaseLabel:"Default:",addRuleLabel:"Add rule",addSubRuleLabel:"Add sub rule",addSubGroupLabel:"Add sub group",delGroupLabel:"Delete",notLabel:"Not",fieldSourcesPopupTitle:"Select source",valueSourcesPopupTitle:"Select value source",removeRuleConfirmOptions:null,removeGroupConfirmOptions:null,loadMoreLabel:"Load more...",loadingMoreLabel:"Loading more...",typeToSearchLabel:"Type to search",loadingLabel:"Loading...",notFoundLabel:"Not found"},$a=r(4308),Wa=r.n($a),za=r(502),Ha=r.n(za);function Ya(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ja(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ya(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ya(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Xa(e,t){return Ha().apply(e,t)}function Qa(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ha()).add_operation(e,t)}var Za={CALL:function(e,t){for(var r=arguments.length,n=new Array(r>2?r-2:0),o=2;o<r;o++)n[o-2]=arguments[o];return e.call.apply(e,[t].concat(n))},JSX:function(e,t){return{type:e,props:t}},mergeObjects:function(e,t){return Ja(Ja({},e),t)},fromEntries:function(e){return Object.fromEntries(e)},toLowerCase:function(e){return e.toLowerCase()},toUpperCase:function(e){return e.toUpperCase()},strlen:function(e){return(null==e?void 0:e.length)||0},regexTest:function(e,t,r){return null!=(null==e?void 0:e.match(new RegExp(t,r)))},"date==":function(e,t){if(null==e||null==t)return!1;var r=ho()(e).startOf("day"),n=ho()(t).startOf("day");return r.isSame(n)},"date!=":function(e,t){return!Za["date=="](e,t)},"datetime==":function(e,t){if(null==e||null==t)return!1;var r=ho()(e),n=ho()(t);return r.isSame(n)},"datetime!=":function(e,t){return!Za["datetime=="](e,t)},now:function(){return new Date},today:function(){var e=ho()().startOf("day"),t=e.year(),r=e.month(),n=e.date();return ho().utc([t,r,n]).toDate()},start_of_today:function(){return ho()().startOf("day").toDate()},date_add:function(e,t,r){return ho()(e).add(t,r).toDate()},datetime_add:function(e,t,r){return ho()(e).add(t,r).toDate()},datetime_truncate:function(e,t){return ho()(e).startOf(t).toDate()}};function es(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ha();for(var t in Za)Qa(t,Za[t],e)}var ts=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e})).filter((function(e){return null!=e})):void 0},rs=function(e){if(null!=e){var t=[],r=(Array.isArray(e)?e:[e]).filter((function(e){return null!=e})).map((function(t){return{type:"property",value:e}}));if(t.length)throw new Error(t.join("\n"));return r}};function ns(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function os(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ns(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ns(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var is={day:"day",week:"week",month:"month",year:"year"},as=os({hour:"hour",minute:"minute",second:"second"},is),ss={label:"Now",returnType:"datetime",jsonLogicCustomOps:{now:{}},jsonLogic:function(){return{now:[]}},jsonLogicImport:function(e){if(e.now)return[]},spelFunc:"T(java.time.LocalDateTime).now()",sqlFormatFunc:function(){return"NOW()"},sqlFunc:"NOW",mongoFormatFunc:function(){return{$toDate:"$$NOW"}},formatFunc:function(){return"NOW"}},ls={label:"Today",returnType:"date",jsonLogicCustomOps:{today:{}},jsonLogic:function(){return{today:[]}},jsonLogicImport:function(e){if(e.today)return[]},spelFunc:"T(java.time.LocalDate).now()",sqlFormatFunc:function(){return"CURDATE()"},sqlFunc:"CURDATE",mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"TODAY"}},us={label:"Start of today",returnType:"datetime",jsonLogicCustomOps:{start_of_today:{}},jsonLogic:function(){return{start_of_today:[]}},jsonLogicImport:function(e){if(e.start_of_today)return[]},spelFunc:"T(java.time.LocalDateTime).now().truncatedTo(T(java.time.temporal.ChronoUnit).DAYS)",spelImport:function(e){var t,r,n,o,i=e.obj,a=e.args,s="!func"===(null==e?void 0:e.type)&&"truncatedTo"===(null==e?void 0:e.methodName),l="now"===(null==i?void 0:i.methodName)&&"java.time.LocalDateTime"===(null==i||null===(t=i.obj)||void 0===t||null===(t=t.cls)||void 0===t?void 0:t.join(".")),u=(null==a?void 0:a.length)||0,c=null==a?void 0:a[0],p=null==c||null===(r=c.children)||void 0===r?void 0:r[0],f=null==c||null===(n=c.children)||void 0===n?void 0:n[1],d="!type"===(null==p?void 0:p.type)&&(null==p||null===(o=p.cls)||void 0===o?void 0:o.join(".")),v="property"===(null==f?void 0:f.type)&&(null==f?void 0:f.val),h=1===u&&"compound"===c.type&&"java.time.temporal.ChronoUnit"===d&&"DAYS"===v;if(l&&s&&h)return{}},sqlFormatFunc:function(){return"DATE_FORMAT(NOW(), '%Y-%m-%d 00:00:00')"},sqlImport:function(e,t,r){var n;if("DATE_FORMAT"===(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o=K(e.children,2),i=o[0],a=o[1];if("%Y-%m-%d 00:00:00"==(null==a?void 0:a.value)&&"NOW"==(null==i?void 0:i.func))return{args:{}}}},mongoFormatFunc:function(){return{$dateTrunc:{date:{$toDate:"$$NOW"},unit:"day"}}},formatFunc:function(){return"START_OF_TODAY"}},cs={label:"Truncate",returnType:"datetime",renderBrackets:["",""],renderSeps:["to"],jsonLogicCustomOps:{datetime_truncate:{}},jsonLogic:function(e){return{datetime_truncate:[e.date,e.dim]}},jsonLogicImport:function(e){if(e.datetime_truncate)return[e.datetime_truncate[0],e.datetime_truncate[1]]},spelFormatFunc:function(e){var t=e.date,r=e.dim,n=(r.charAt(0).toUpperCase()+r.slice(1)+"s").toUpperCase();return"".concat(t,".truncatedTo(T(java.time.temporal.ChronoUnit).").concat(n,")")},spelImport:function(e){var t,r,n,o=e.args,i="!func"===(null==e?void 0:e.type)&&"truncatedTo"===(null==e?void 0:e.methodName),a=(null==o?void 0:o.length)||0,s=null==o?void 0:o[0],l=null==s||null===(t=s.children)||void 0===t?void 0:t[0],u=null==s||null===(r=s.children)||void 0===r?void 0:r[1],c="!type"===(null==l?void 0:l.type)&&(null==l||null===(n=l.cls)||void 0===n?void 0:n.join(".")),p="property"===(null==u?void 0:u.type)&&(null==u?void 0:u.val),f=1===a&&"compound"===s.type&&"java.time.temporal.ChronoUnit"===c&&p,d=p.toLowerCase().substring(0,p.length-1);if(i&&f)return{date:e.obj,dim:{type:"string",val:d}}},sqlFormatFunc:function(e,t){var r=e.date,n=e.dim;if(t&&"MySQL"!==t){if("PostgreSQL"===t)return"date_trunc(".concat(n,", ").concat(r,")")}else switch(n=n.replace(/^'|'$/g,"")){case"second":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:%i:%s')");case"minute":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:%i:00')");case"hour":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d %H:00:00')");case"day":return"DATE_FORMAT(".concat(r,", '%Y-%m-%d 00:00:00')");case"week":return"DATE_SUB(DATE_FORMAT(".concat(r,", '%Y-%m-%d 00:00:00'), INTERVAL WEEKDAY(").concat(r,") DAY)");case"month":return"DATE_FORMAT(".concat(r,", '%Y-%m-01 00:00:00')");case"year":return"DATE_FORMAT(".concat(r,", '%Y-01-01 00:00:00')")}},sqlImport:function(e,t,r){var n,o,i;if(r&&"MySQL"!==r){if("PostgreSQL"===r&&"date_trunc"===(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var a=K(e.children,2),s=a[0];return{args:{date:a[1],dim:s.value}}}}else if("DATE_FORMAT"===(null==e?void 0:e.func)&&2===(null===(o=e.children)||void 0===o?void 0:o.length)){var l,u=K(e.children,2),c=u[0],p=u[1];switch(null==p?void 0:p.value){case"%Y-%m-%d %H:%i:%s":l="second";break;case"%Y-%m-%d %H:%i:00":l="minute";break;case"%Y-%m-%d %H:00:00":l="hour";break;case"%Y-%m-%d 00:00:00":l="day";break;case"%Y-%m-01 00:00:00":l="month";break;case"%Y-01-01 00:00:00":l="year"}if(l)return{args:{date:c,dim:l}}}else if("DATE_SUB"===(null==e?void 0:e.func)&&2===(null===(i=e.children)||void 0===i?void 0:i.length)){var f,d=K(e.children,2),v=d[0],h=d[1],g="DATE_FORMAT"===(null==v?void 0:v.func)&&2===(null===(f=v.children)||void 0===f?void 0:f.length),y="interval"==h._type&&"day"===h.unit;if(g&&y){var m=K(v.children,2),O=m[0],b=m[1];if("%Y-%m-%d 00:00:00"===(null==b?void 0:b.value))return{args:{date:O,dim:"week"}}}}},mongoFormatFunc:function(e){return{$dateTrunc:{date:e.date,unit:e.dim}}},formatFunc:function(e){var t=e.date,r=e.dim;return"TRUNCATE ".concat(t," TO ").concat(r)},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:as},escapeForFormat:!1}}},ps={label:"Relative",returnType:"datetime",renderBrackets:["",""],renderSeps:["","",""],spelFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim,i=r+(o.charAt(0).toUpperCase()+o.slice(1)+"s");return"".concat(t,".").concat(i,"(").concat(n,")")},spelImport:function(e){var t,r,n,o,i=null===(t=e.methodName)||void 0===t?void 0:t.match(/^(minus|plus)(\w+)s$/);if(i&&(o=i[2].toLowerCase(),r=i[1],["minus","plus"].includes(r)&&Object.keys(as).includes(o)))return r={type:"string",val:r},o={type:"string",val:o},n=e.args[0],{date:e.obj,op:r,val:n,dim:o}},jsonLogic:function(e){var t=e.date,r=e.op;return{datetime_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){if(e.datetime_add){var t=e.datetime_add[0],r=Math.abs(e.datetime_add[1]);return[t,e.datetime_add[1]>=0?"plus":"minus",r,e.datetime_add[2]]}},jsonLogicCustomOps:{datetime_add:{}},sqlFormatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return"DATE_ADD(".concat(t,", INTERVAL ").concat(parseInt(n)*("minus"==r?-1:1)," ").concat(o.replace(/^'|'$/g,""),")")},sqlImport:function(e,t,r){var n;if(["DATE_ADD","DATE_SUB"].includes(null==e?void 0:e.func)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o=K(e.children,2),i=o[0],a=o[1];if("interval"==a._type)return{args:{date:i,op:"DATE_ADD"===(null==e?void 0:e.func)?"plus":"minus",val:a.value,dim:a.unit}}}},mongoFormatFunc:function(e){var t=e.date,r=e.op,n=e.val;return{$dateAdd:{startDate:t,unit:e.dim,amount:n*("minus"==r?-1:1)}}},formatFunc:function(e){var t=e.date,r=e.op,n=e.val,o=e.dim;return n?"".concat(t," ").concat("minus"==r?"-":"+"," ").concat(n," ").concat(o):t},args:{date:{label:"Datetime",type:"datetime",defaultValue:{func:"NOW",args:[]},valueSources:["value","field","func"],escapeForFormat:!0},op:{label:"Op",type:"select",defaultValue:"plus",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:{plus:"+",minus:"-"}},escapeForFormat:!1},val:{label:"Value",type:"number",fieldSettings:{min:0},defaultValue:0,valueSources:["value"],escapeForFormat:!1},dim:{label:"Dimension",type:"select",defaultValue:"day",valueSources:["value"],mainWidgetProps:{customProps:{showSearch:!1}},fieldSettings:{listValues:as},escapeForFormat:!1}}},fs=os(os({},ps),{},{label:"Relative",returnType:"date",jsonLogic:function(e){var t=e.date,r=e.op;return{date_add:[t,e.val*("minus"==r?-1:1),e.dim]}},jsonLogicImport:function(e){var t=e.date_add[0],r=Math.abs(e.date_add[1]);return[t,e.date_add[1]>=0?"plus":"minus",r,e.date_add[2]]},jsonLogicCustomOps:{date_add:{}},args:{date:os(os({},ps.args.date),{},{label:"Date",type:"date",defaultValue:{func:"TODAY",args:[]}}),op:os({},ps.args.op),val:os({},ps.args.val),dim:os(os({},ps.args.dim),{},{defaultValue:"day",fieldSettings:{listValues:is}})}}),ds={label:"Lowercase",mongoFunc:"$toLower",jsonLogic:"toLowerCase",sqlFunc:"LOWER",spelFunc:"${str}.toLowerCase()",jsonLogicCustomOps:{toLowerCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},vs={label:"Uppercase",mongoFunc:"$toUpper",jsonLogic:"toUpperCase",sqlFunc:"UPPER",spelFunc:"${str}.toUpperCase()",jsonLogicCustomOps:{toUpperCase:{}},returnType:"text",args:{str:{label:"String",type:"text",valueSources:["value","field","func"]}}},hs={label:"Linear regression",returnType:"number",formatFunc:function(e,t){var r=e.coef,n=e.bias,o=e.val;return"(".concat(r," * ").concat(o," + ").concat(n,")")},sqlFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelFormatFunc:function(e){var t=e.coef,r=e.bias,n=e.val;return"(".concat(t," * ").concat(n," + ").concat(r,")")},spelImport:function(e){var t,r;if("op-plus"===e.type){var n=K(e.children,2);if(r=n[0],t=n[1],"op-multiply"===r.type){var o=K(r.children,2);return{coef:o[0],val:o[1],bias:t}}}},sqlImport:function(e,t,r){var n;if(["+"].includes(null==e?void 0:e.operator)&&2===(null===(n=e.children)||void 0===n?void 0:n.length)){var o,i=K(e.children,2),a=i[0],s=i[1];if(["*"].includes(null==a?void 0:a.operator)&&2===(null===(o=a.children)||void 0===o?void 0:o.length)){var l=K(a.children,2);return{args:{coef:l[0],val:l[1],bias:s}}}}},mongoFormatFunc:function(e){var t=e.coef,r=e.bias;return{$sum:[{$multiply:[t,e.val]},r]}},jsonLogic:function(e){var t=e.coef,r=e.bias;return{"+":[{"*":[t,e.val]},r]}},jsonLogicImport:function(e){return[e["+"][0]["*"][0],e["+"][0]["*"][1],e["+"][1]]},renderBrackets:["",""],renderSeps:[" * "," + "],args:{coef:{label:"Coef",type:"number",defaultValue:1,valueSources:["value"]},val:{label:"Value",type:"number",valueSources:["value","field"]},bias:{label:"Bias",type:"number",defaultValue:0,valueSources:["value"]}}};function gs(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ys(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ys(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ys(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function ms(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Os(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ms(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ms(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function bs(e,t,r){var n;try{n=Ha().apply(e,t)}catch(e){throw e.message="".concat(r.join(".")," :: ").concat(e.message),e}return n}function Es(e,t,r,n){var o;try{o=t.call.apply(t,[e].concat(W(r)))}catch(e){throw e.message="".concat(n.join(".")," :: ").concat(e.message),e}return o}es();var Ss={asyncFetch:{type:"f",args:["searchOrValues","offset"]},labelYes:{type:"r"},labelNo:{type:"r"},marks:{type:"r",isArr:!0},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]}},_s=Os(Os({},Ss),{},{factory:{type:"rf"},formatValue:{type:"f",args:["val","fieldDef","wgtDef","isForDisplay","op","opDef","rightFieldDef"]},sqlFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef","sqlDialect"]},spelFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef","rightFieldDef"]},spelImportValue:{type:"f",args:["val","wgtDef","args"]},sqlImport:{type:"f",args:["sqlObj","wgtDef","sqlDialect"]},mongoFormatValue:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},elasticSearchFormatValue:{type:"f",args:["queryType","val","op","field","config"]},jsonLogic:{type:"f",args:["val","fieldDef","wgtDef","op","opDef"]},jsonLogicImport:{type:"f",args:["val","wgtDef"]},validateValue:{type:"f",args:["val","fieldSettings","op","opDef","rightFieldDef"]},toJS:{type:"f",args:["val"]}}),Ts={options:{factory:{type:"rf"}},formatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","isForDisplay","fieldDef"]},mongoFormatOp:{type:"f",args:["field","op","vals","useExpr","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},sqlFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},spelFormatOp:{type:"f",args:["field","op","vals","valueSrc","valueType","opDef","operatorOptions","fieldDef"]},jsonLogic:{type:"f",ignore:"string",args:["field","op","vals","opDef","operatorOptions","fieldDef","expectedType","settings"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},elasticSearchQueryType:{type:"f",ignore:"string",args:["valueType"]},textSeparators:{type:"r",isArr:!0}},Rs={widgetProps:_s,opProps:Ts},ws=Os(Os({},Ss),{},{fieldSettings:Ss}),Is=Os(Os({},Ss),{},{fieldSettings:Ss,widgets:{x:Rs},mainWidgetProps:_s}),Ls={locale:{mui:{type:"f",args:[],invokeWith:[],ignore:"jl"}},caseValueField:Is,canCompareFieldWithField:{type:"f",args:["leftField","leftFieldConfig","rightField","rightFieldConfig","op"]},formatReverse:{type:"f",args:["q","op","reversedOp","operatorDefinition","revOperatorDefinition","isForDisplay"]},sqlFormatReverse:{type:"f",args:["q"]},spelFormatReverse:{type:"f",args:["q"]},formatField:{type:"f",args:["field","parts","label2","fieldDefinition","config","isForDisplay"]},formatSpelField:{type:"f",args:["field","parentField","parts","partsExt","fieldDefinition","config"]},formatAggr:{type:"f",args:["whereStr","aggrField","operator","value","valueSrc","valueType","opDef","operatorOptions","isForDisplay","aggrFieldDef"]},normalizeListValues:{type:"f",args:["listValues","type","fieldSettings"]},renderConfirm:{type:"f",args:["props"]},useConfirm:{type:"f",args:[]},renderField:{type:"rf"},renderOperator:{type:"rf"},renderFunc:{type:"rf"},renderConjs:{type:"rf"},renderButton:{type:"rf"},renderIcon:{type:"rf"},renderButtonGroup:{type:"rf"},renderValueSources:{type:"rf"},renderFieldSources:{type:"rf"},renderProvider:{type:"rf"},renderSwitch:{type:"rf"},renderSwitchPrefix:{type:"r"},renderItem:{type:"rf"},renderBeforeWidget:{type:"rf"},renderAfterWidget:{type:"rf"},renderBeforeActions:{type:"rf"},renderAfterActions:{type:"rf"},renderBeforeCaseValue:{type:"rf"},renderAfterCaseValue:{type:"rf"},renderRuleError:{type:"rf"}},Cs={fields:{x:Is},widgets:{x:_s},conjunctions:{x:{formatConj:{type:"f",args:["children","conj","not","isForDisplay"]},sqlFormatConj:{type:"f",args:["children","conj","not"]},spelFormatConj:{type:"f",args:["children","conj","not","omitBrackets"]}}},operators:{x:Ts},types:{x:{widgets:{x:Rs}}},funcs:{x:Os(Os(Os({},ws),{renderBrackets:{type:"r",isArr:!0},renderSeps:{type:"r",isArr:!0},jsonLogic:{type:"f",ignore:"string",args:["formattedArgs"]},jsonLogicImport:{type:"f",args:["val"]},spelImport:{type:"f",args:["spel"]},sqlImport:{type:"f",args:["sqlObj","_","sqlDialect"]},formatFunc:{type:"f",args:["formattedArgs","isForDisplay"]},sqlFormatFunc:{type:"f",args:["formattedArgs","sqlDialect"]},mongoFormatFunc:{type:"f",args:["formattedArgs"]},spelFormatFunc:{type:"f",args:["formattedArgs"]}}),{},{args:{x:Os({},ws)}})},settings:Ls},As=function(e,t){if(e.__fieldNames)throw new Error("Don't apply `compressConfig()` to extended config");var r=ni()(e,ui);delete r.ctx;var n,o=function(e,t,r,n){if(So(e)){if(Ko(e)&&(e=Go(e)),"funcs"===r[0]&&!t){var i=r[r.length-1];(t=vi({funcs:n.BasicFuncs},i,"funcs","subfields")||void 0)&&(e.$$key=i)}if(void 0!==t&&So(t))for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(!Object.keys(e).includes(a)||void 0===e[a]&&void 0!==t[a]?e[a]="$$deleted":(e[a]=o(e[a],t[a],[].concat(W(r),[a]),n),void 0===e[a]&&delete e[a]));for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var l;if(!t||!Object.keys(t).includes(s))e[s]=o(e[s],null===(l=t)||void 0===l?void 0:l[s],[].concat(W(r),[s]),n);void 0===e[s]&&delete e[s]}0===Object.keys(e).length&&(e=void 0)}else Array.isArray(e)&&e.forEach((function(t,i){e[i]=o(e[i],void 0,[].concat(W(r),[i]),n)}));if(void 0===t||!Fo(e,t,!0)){if("function"==typeof e)throw new Error("compressConfig: function at ".concat(r.join(".")," should be converted to JsonLogic"));return e}},i=gs(ui);try{for(i.s();!(n=i.n()).done;){var a=n.value;if("ctx"===a);else if("fields"===a)r[a]=fo()(r[a]),o(r[a],{},[a]);else if("funcs"===a)for(var l in r[a]=fo()(r[a]||{}),r[a])o(r[a][l],null,[a,l],{BasicFuncs:s});else r[a]=fo()(r[a]),o(r[a],t[a],[a])}}catch(e){i.e(e)}finally{i.f()}return r},xs=function(e,t,r){if(!e.settings.useConfigCompress)throw new Error("Please enable `useConfigCompress` in config settings to use decompressConfig()");var n,o={},i=function(e,t,r){if(So(t))for(var n in So(e)||(e={}),t)Lo(t,n)&&("$$deleted"===t[n]?delete e[n]:e[n]=i(e[n],t[n],[].concat(W(r),[n])));else e=Array.isArray(t)?fo()(t):t;return e},a=function(e,t,r){var n=!1;if(So(e)&&Object.prototype.hasOwnProperty.call(e,"$$key")&&e.$$key){var o=vi({funcs:r.BasicFuncs},e.$$key,"funcs","subfields");if(!o)throw new Error("decompressConfig: basic function not found by key ".concat(e.$$key," at ").concat(t.join(".")));delete e.$$key,e=i(fo()(o),e,t),n=!0}if(!n)if(So(e))for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(e[s]=a(e[s],[].concat(W(t),[s]),r));else if(Array.isArray(e)){var l,u=gs(e);try{for(u.s();!(l=u.n()).done;){var c=l.value;e[c]=a(e[c],[].concat(W(t),[c]),r)}}catch(e){u.e(e)}finally{u.f()}}return e},l=gs(ui);try{for(l.s();!(n=l.n()).done;){var u=n.value;"ctx"===u?o[u]=Wa()({},t.ctx||{},r||{}):"funcs"===u?(o[u]=fo()(e[u]||{}),a(o[u],[u],{BasicFuncs:s})):"fields"===u?o[u]=fo()(e[u]||{}):(o[u]=fo()(t[u]||{}),i(o[u],e[u]||{},[u]))}}catch(e){l.e(e)}finally{l.f()}return o},Ns=function(e){if(e.__compliled)return e;return js(e=fo()(e),e,{ctx:e.ctx},Cs,[]),Object.defineProperty(e,"__compliled",{enumerable:!1,writable:!1,value:!0}),e};function js(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:[];if(t){i.length;for(var a in n){var s=n[a],l="x"===a?i:[].concat(W(i),[a]);if("r"===s.type){var u=t,c=u[a];if(s.isArr)for(var p in c){var f=ks(c[p],r,[].concat(W(l),[p]));f!==c[p]&&(o.push("Compiled ".concat(l.join("."),"[").concat(p,"]")),c[p]=f)}else{var d=ks(c,r,l,void 0);d!==c&&(o.push("Compiled R ".concat(l.join("."))),u[a]=d)}}else if("rf"===s.type){var v=t,h=v[a],g=Fs(h,r,l,s.ignore);g!==h&&(o.push("Compiled JL-RF ".concat(l.join("."))),v[a]=g)}else if("f"===s.type){var y,m=t,O=m[a],b=Ps(O,r,l,s.args,s.ignore);if(s.invokeWith&&b&&"function"==typeof b)b=(y=b).call.apply(y,[null].concat(W(s.invokeWith)));b!==O&&(o.push("Compiled JL-F ".concat(l.join("."))),m[a]=b)}else if("x"===a)for(var E in t){l=[].concat(W(i),[E]);var S=t[E];js(e,S,r,s,o,l),S.subfields&&js(e,S.subfields,r,n,o,l)}else{js(e,t[a],r,s,o,l)}}}}function Fs(e,t,r){return Wo(e)?function(n,o){o=o||(null==t?void 0:t.ctx);var i=bs(e,{props:n,ctx:o},r);return"string"==typeof i&&(i={type:i,props:n}),ks(i,{ctx:o},r)}:"string"==typeof e?function(n,o){o=o||(null==t?void 0:t.ctx);var i=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),o);return i?Es(this,i,[n,o],r):ks({type:e,props:n},{ctx:o},r)}:e}function Ps(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return Wo(e)&&"jl"!==o?function(){for(var o=arguments.length,i=new Array(o),a=0;a<o;a++)i[a]=arguments[a];var s=this||(null==t?void 0:t.ctx),l=(n||[]).reduce((function(e,t,r){return Os(Os({},e),{},M({},t,i[r]))}),{args:i,ctx:s});return bs(e,l,r)}.bind(null==t?void 0:t.ctx):"string"==typeof e&&"string"!==o?function(){var n=this||(null==t?void 0:t.ctx),o=e.split(".").reduce((function(e,t){return null==e?void 0:e[t]}),n);if(o){for(var i=arguments.length,a=new Array(i),s=0;s<i;s++)a[s]=arguments[s];return Es(this,o,a,r)}throw new Error("".concat(r.join(".")," :: Function ").concat(e," is not found in ctx"))}.bind(null==t?void 0:t.ctx):e}function ks(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if($o(e)){var o,i=e.type,a=e.props;if("string"!=typeof i)throw new Error("renderReactElement for ".concat(r.join("."),": type should be string"));var s,l=function(e,t){var r;return(null==t||null===(r=t.components)||void 0===r?void 0:r[e])||t.W[e]||t.O[e]}(i,t.ctx)||i.toLowerCase();return void 0!==n&&(a=Os(Os({},a),{},{key:n})),null!==(o=a)&&void 0!==o&&o.children&&(s=ks(a.children,t,r),a=Os(Os({},a),{},{children:s})),t.ctx.RCE(l,a)}return e instanceof Array?e.map((function(e,n){return ks(e,t,r,""+n)})):e}function Ds(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Vs(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Vs(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Vs(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ms(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}var Us,Bs=0,qs=0,Gs={},Ks=function(e,t){return 0===ui.map((function(r){return e[r]===t[r]})).filter((function(e){return!e})).length},$s=function(e){return Us||(Us=zs({reactIndex:void 0,maxSize:3,canCompile:void 0,extendConfig:e})),Us},Ws=function(e,t){var r;for(var n in Gs){var o=Gs[n].findExtendedConfig(e,t);if(o){r=o;break}}return r},zs=function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{reactIndex:void 0,maxSize:2,canCompile:!0,extendConfig:void 0},r=new Map,n=t.maxSize||2,o=++Bs,i=function(e,t){r.size+1>n&&r.delete(r.keys().next().value),r.set(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ms(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ms(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},e),t)},a=function(e,t){var n,o=Ds(r.keys());try{var i,a=function(){var o=n.value;if(ui.filter((function(t){return o[t]===e[t]})).length===ui.length&&(!t||o.__compliled))return{v:r.get(o)}};for(o.s();!(n=o.n()).done;)if(i=a())return i.v}catch(e){o.e(e)}finally{o.f()}var s,l=Ds(r.values());try{var u,c=function(){var r=s.value;if(ui.filter((function(t){return r[t]===e[t]})).length===ui.length&&(!t||r.__compliled))return{v:r}};for(l.s();!(s=l.n()).done;)if(u=c())return u.v}catch(e){l.e(e)}finally{l.f()}return null},s=function(e){return a(e)||function(e){var r=t.extendConfig(e,++qs,t.canCompile);return i(e,r),r}(e)};return e={getExtendedConfig:function(e){return s(function(e){return ni()(e,ui)}(e))},findExtendedConfig:a,getBasicConfig:function(e){var t,n=Ds(r.keys());try{for(n.s();!(t=n.n()).done;){var o=t.value,i=r.get(o);if(Ks(i,e))return o}}catch(e){n.e(e)}finally{n.f()}return e},clearConfigMemo:function(){r.clear(),delete Gs[o],Us===e&&(Us=void 0)},configId:qs,storeConfigPair:i,getSize:function(){return r.size},configStore:r,memoId:o,meta:t},void 0===t.reactIndex&&(Us=e),Gs[o]=e,e};function Hs(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ys(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ys(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ys(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Js(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xs(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Js(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Js(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Qs=["customProps"],Zs=["options"],el=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(r=r&&e.settings.useConfigCompress,e.__configId)return e;var n=Ws(e,r);if(n)return n;var o=e;(e=r?e.__compliled?fo()(e):Ns(e):fo()(e)).settings=Ga()({},Ka,e.settings,qo),e.__fieldsCntByType={},e.__funcsCntByType={},e.__fieldNames={},function(e,t){for(var r in e){tl(r,e[r],t)}}(e.types,e),rl(e.fields,e),nl(e.funcs,e);var i=e.settings.caseValueField;i&&ol(i,e,[],!1,!0);var a=e.settings.locale.moment;return a&&ho().locale(a),Object.defineProperty(e,"__configId",{enumerable:!1,writable:!1,value:t||co()}),e.__cache={},Yo(e),$s(el).storeConfigPair(o,e),e};function tl(e,t,r){var n=null,o=null;t.mainWidget=t.mainWidget||Object.keys(t.widgets).filter((function(e){return"field"!=e&&"func"!=e}))[0];var i=t.excludeOperators||[];for(var a in t.widgets){var s=t.widgets[a],l=s.defaultOperator;if(s.operators)n=Ho(n,s.operators.filter((function(e){return!i.includes(e)})));l&&!i.includes(l)&&(o&&a!==t.mainWidget||(o=l)),a==t.mainWidget&&(s.widgetProps=Xs(Xs({},t.mainWidgetProps||{}),s.widgetProps||{})),t.widgets[a]=s}t.valueSources||(t.valueSources=Object.keys(r.settings.valueSourcesInfo));var u,c=Hs(t.valueSources);try{for(c.s();!(u=c.n()).done;){var p=u.value;"value"==p||t.widgets[p]||(t.widgets[p]={})}}catch(e){c.e(e)}finally{c.f()}!t.operators&&n&&(t.operators=Array.from(new Set(n))),!t.defaultOperator&&o&&(t.defaultOperator=o)}function rl(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];for(var n in e){var o=[].concat(W(r),[n]);ol(e[n],t,o),e[n].subfields&&rl(e[n].subfields,t,o)}}function nl(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e){var o=(null==t||null===(r=t.settings)||void 0===r?void 0:r.fieldSeparator)||".";for(var i in e){var a=[].concat(W(n),[i]),s=a.join(o),l=e[i];if(l.returnType&&(l.type=l.returnType,t.__funcsCntByType[l.returnType]||(t.__funcsCntByType[l.returnType]=0),t.__funcsCntByType[l.returnType]++),ol(l,t,a,!1),l.args){for(var u in l.args)ol(l.args[u],t,[].concat(W(a),[u]),!0);var c,p=!0,f=Hs(Object.keys(l.args).reverse());try{for(f.s();!(c=f.n()).done;){var d=c.value,v=l.args[d];!p&&v.isOptional&&(Zo.info("Arg ".concat(d," for func ").concat(s," can't be optional")),delete v.isOptional),v.isOptional||(p=!1)}}catch(e){f.e(e)}finally{f.f()}}l.subfields&&nl(l.subfields,t,[].concat(W(n),[i]))}}}function ol(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=t.settings,a=i.showLabels,s=i.fieldSeparator;s=null!=s?s:".";var l=r[r.length-1],u=n?r.slice(0,r.length-1).join(s):r.join(s),c=!!e.returnType,p=e.type||e.returnType,f=t.types[p],d=e.excludeOperators||[],v=(e.operators||(null==f?void 0:f.operators)||[]).filter((function(e){return!d.includes(e)})),h=e.defaultOperator||(null==f?void 0:f.defaultOperator);d.includes(h)&&(h=void 0);var g=!!h&&h==e.defaultOperator;if(g&&(e.ownDefaultOperator=e.defaultOperator),f){n||c||o||(t.__fieldsCntByType[p]||(t.__fieldsCntByType[p]=0),t.__fieldsCntByType[p]++),n&&(e._isFuncArg=!0,e._argKey=l,e._funcKey=u),c&&(e._isFunc=!0,e._funcKey=u),o&&(e._isCaseValue=!0),function(e,t,r){for(var n,o,i=0,a=["listValues","treeValues","allowCustomValues","validateValue"];i<a.length;i++){var s=a[i];e[s]&&(e.fieldSettings||(e.fieldSettings={}),e.fieldSettings[s]=e[s],delete e[s])}null!==(n=e.fieldSettings)&&void 0!==n&&n.listValues&&t.settings.normalizeListValues&&(e.fieldSettings.listValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.listValues,r,e.fieldSettings)),null!==(o=e.fieldSettings)&&void 0!==o&&o.treeValues&&t.settings.normalizeListValues&&(e.fieldSettings.treeValues=t.settings.normalizeListValues.call(t.ctx,e.fieldSettings.treeValues,r,e.fieldSettings))}(e,t,p);var y=["widgets","operators","defaultOperator"];Object.keys(f).filter((function(e){return!y.includes(e)})).map((function(t){e[t]||(e[t]=wo(f[t]))}));var m=f.excludeOperators||[];e.operators&&(m=m.filter((function(t){return!e.operators.includes(t)}))),e.widgets||(e.widgets={});var O=function(){var r=Xs({},e.widgets[b]||{}),o=f.widgets[b]||{};if(!n){var i=r.defaultOperator,s=[].concat(W(d),W(m)),u=e.preferWidgets&&("field"===b||e.preferWidgets.includes(b))||s.length>0;if(r.operators){var c=r.operators.filter((function(e){return!s.includes(e)}));r.operators=c,v=Ho(v,c)}else if(u&&o.operators){var p=o.operators.filter((function(e){return!s.includes(e)}));r.operators=p,v=Ho(v,p)}i&&!s.includes(i)&&(h&&(g||b!==e.mainWidget)||(h=i))}r.widgetProps=Xs(Xs(Xs({},o.widgetProps||{}),b===e.mainWidget&&e.mainWidgetProps||{}),r.widgetProps||{});for(var y=0,O=Qs;y<O.length;y++){var E,S,_,T,R=O[y];if(r.widgetProps[R])r.widgetProps[R]=Xs(Xs(Xs(Xs({},(null===(E=t.widgets[b])||void 0===E?void 0:E[R])||{}),(null===(S=o.widgetProps)||void 0===S?void 0:S[R])||{}),b===e.mainWidget&&(null===(_=e.mainWidgetProps)||void 0===_?void 0:_[R])||{}),(null===(T=r.widgetProps)||void 0===T?void 0:T[R])||{})}var w=Array.from(new Set([].concat(W(Object.keys(o.opProps||{})),W(Object.keys(r.opProps||{})))));if(w.length){var I,L={},C=Hs(w);try{for(C.s();!(I=C.n()).done;){var A,x,N=I.value;L[N]=Xs(Xs({},(null===(A=o.opProps)||void 0===A?void 0:A[N])||{}),(null===(x=r.opProps)||void 0===x?void 0:x[N])||{});for(var j=0,F=Zs;j<F.length;j++){var P,k,D,V=F[j];if(L[N][V])L[N][V]=Xs(Xs(Xs({},(null===(P=t.operators)||void 0===P||null===(P=P[N])||void 0===P?void 0:P[V])||{}),(null===(k=o.opProps)||void 0===k||null===(k=k[N])||void 0===k?void 0:k[V])||{}),(null===(D=r.opProps)||void 0===D||null===(D=D[N])||void 0===D?void 0:D[V])||{})}}}catch(e){C.e(e)}finally{C.f()}r.opProps=L}var M=r,U=M.valueLabel,B=M.valuePlaceholder;n&&(U||(r.valueLabel=e.label||l),B||a||(r.valuePlaceholder=e.label||l)),r=Xs(Xs({},o),r),e.widgets[b]=r};for(var b in f.widgets)O();if(n||(e.operators||(e.operators=Array.from(new Set(v))),e.defaultOperator||(e.defaultOperator=h)),!n&&!c&&!o){var E=function(e,t){if(!t)return{};var r=e.settings.fieldSeparator,n=W(t).reduce((function(t,n,o,i){var a=t.computedPath,s=t.computed,l=t.inGroup,u=[].concat(W(i.slice(0,o)),[n]),c=vi(e,u);return"!group"===(null==c?void 0:c.type)&&o<i.length-1?(l=u.join(r),a=[]):null!=c&&c.fieldName?(s=!0,a=[c.fieldName]):a=[].concat(W(a),[n]),{computedPath:a,computed:s,inGroup:l}}),{computedPath:[],computed:!1,inGroup:void 0}),o=n.computedPath,i=n.computed,a=n.inGroup;return i?{fieldName:o.join(r),inGroup:a}:{}}(t,r),S=E.fieldName,_=E.inGroup;S&&(e.fieldName=S,t.__fieldNames[S]||(t.__fieldNames[S]=[]),t.__fieldNames[S].push({fullPath:r,inGroup:_}))}}else"!struct"!==e.type&&(e.disabled=!0)}function il(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function al(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?il(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):il(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ll(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ll(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ll(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ul=function(e,t){var r,n={usedFields:[],errors:[]},o=el(t,void 0,!1),i=cl(e,o,n,!1,!0),a=n.errors,s=n.usedFields,l=(o.settings.fieldSeparator,{}),u=sl(s);try{for(u.s();!(r=u.n()).done;)for(var c=r.value,p=Ei(c,t),f=(Ii(o,c),l),d=0;d<p.length;d++){var v=p[d],h=Ii(o,p.slice(0,d+1))||{};d!=p.length-1?"!group"==h.type&&"struct"!=h.mode?(f[v]||(f[v]=[{}]),f=f[v][0]):(f[v]||(f[v]={}),f=f[v]):f[v]||(f[v]=null)}}catch(e){u.e(e)}finally{u.f()}return{errors:a,logic:i,data:l}},cl=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(e){var a,s=e.get("type"),l=(e.get("properties")||new br).get("isLocked"),u=t.settings.jsonLogic.lockedOp;return"group"===s||"rule_group"===s?a=pl(e,t,r,n,o,i):"rule"===s?a=fl(e,t,r,n,i):"switch_group"==s?a=dl(e,t,r,n):"case_group"==s&&(a=vl(e,t,r,n,i)),l&&a&&u&&(a=M({},u,a)),a}},pl=function(e,t,r){var n,o,i,a,s,l,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],p=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,f=e.get("type"),d=e.get("properties")||new br,v=d.get("mode"),h=e.get("children1")||new Kr,g=d.get("field"),y=Ii(t,g),m=d.get("conjunction");m||(m=ra(t));var O=t.conjunctions[m],b=(null==O?void 0:O.jsonLogicConj)||m.toLowerCase(),E=!!d.get("not"),S="rule_group"===f&&!c,_=S&&"struct"!=v,T=_?g:p,R=d.get("operator"),w=R&&Li(t,R,g)||null,I=hl(t,d,r,R,p),L=S&&(!R||0==(null===(n=w)||void 0===n?void 0:n.cardinality)),C=S&&(null==h?void 0:h.size)>0,A=(S&&(null!=h&&h.size),E),x=!1;C?(x=E,A=u):u&&(A=!A);var N=!1,j=null===(o=w)||void 0===o?void 0:o.reversedOp,F=Li(t,j,g),P=!(null!==(i=w)&&void 0!==i&&i.jsonLogic||null===(a=F)||void 0===a||!a.jsonLogic),k=!(null===(s=F)||void 0===s||!s.jsonLogic),D=null===(l=xa(e))||void 0===l?void 0:l.get("type");if(!!t.settings.reverseOperatorsForNot&&(!S&&A&&"rule"===D||x&&1===(null==h?void 0:h.size))&&(C?x=!x:A=!A,N=!0),A&&S&&k&&(!!t.settings.reverseOperatorsForNot||P)){A=!A;var V=[j,R];R=V[0],j=V[1];var U=[F,w];w=U[0],F=U[1]}var B=h.map((function(e){return cl(e,t,r,N,!1,T)})).filter((function(e){return void 0!==e})),q=!!t.settings.exportPreserveGroups;if(_&&!L){if(null==I)return}else if(!B.size&&!q)return;var G=c||q||1!=B.size;G||!E||N||(G=h.some((function(e){var r,n,o,i,a=null===(r=e.get("properties"))||void 0===r?void 0:r.get("operator"),s=null===(n=t.operators)||void 0===n||null===(n=n[a])||void 0===n?void 0:n.reversedOp;return null!==(o=null===(i=t.operators)||void 0===i||null===(i=i[s])||void 0===i?void 0:i._jsonLogicIsExclamationOp)&&void 0!==o&&o})));var K={};G?K[b]=B.toList().toJS():K=B.first(),x&&(K={"!":K});var $=K;if(_){var W,z,H=ml(r,t,g,p);if(!L)z={reduce:[B.size?{filter:[H,K]}:H,{"+":[1,{var:"accumulator"}]},0]};var Y=null!=z?z:H,J=new br({having:K,reduce:z,groupField:g,groupFieldFormatted:H});if("function"==typeof(null===(W=w)||void 0===W?void 0:W.jsonLogic))$=Ol(t,d,Y,I,R,J,y);else if(L)$=M({},R||"some",[H,K]);else $=Ol(t,d,Y,I,R,null,y)}return A&&($={"!":$}),$},fl=function(e,t,r){var n,o,i,a,s,l,u=arguments.length>3&&void 0!==arguments[3]&&arguments[3],c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,p=e.get("properties")||new br,f=p.get("field"),d=p.get("fieldSrc"),v=p.get("operator"),h=p.get("operatorOptions");if((h=h?h.toJS():null)&&!Object.keys(h).length&&(h=null),null!=f&&null!=v){var g=Ii(t,f),y=Li(t,v,f),m=null===(n=y)||void 0===n?void 0:n.reversedOp,O=Li(t,m,f);if(null!==(o=y)&&void 0!==o&&o.jsonLogic||null!==(i=O)&&void 0!==i&&i.jsonLogic){var b=u,E=!(null!==(a=y)&&void 0!==a&&a.jsonLogic||null===(s=O)||void 0===s||!s.jsonLogic),S=!(null===(l=O)||void 0===l||!l.jsonLogic)&&(!!t.settings.reverseOperatorsForNot||E);if(b&&S||E){b=!b;var _=[m,v];v=_[0],m=_[1];var T=[O,y];y=T[0],O=T[1]}var R=hl(t,p,r,v,c);if(void 0!==R){var w="func"===d?yl(r,t,f,c):ml(r,t,f,c);if(void 0!==w)return Ol(t,p,w,R,v,h,g,b)}}else r.errors.push("Operator ".concat(v," is not supported"))}},dl=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=e.get("children1");if(o){for(var i=o.map((function(e){return vl(e,t,r,n,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray(),a=[],s=0;s<i.length;s++)s===i.length-1||i[s][0]?(a.push(i[s]),s===i.length-1&&i[s][0]&&a.push([void 0,null])):r.errors.push("No condition for case ".concat(s));if(a.length){if(1===a.length){var l=K(a[0],2),u=(l[0],l[1]);return null==u&&(u=null),u}for(var c={if:[]},p=c.if,f=K(a[a.length-1],2),d=(f[0],f[1]),v=0;v<a.length-1;v++){var h=v===a.length-2,g=K(a[v],2),y=g[0],m=g[1];null==m&&(m=null),null==y&&(y=!0),p.push(y),p.push(m),h?p.push(d):(p.push({if:[]}),p=p[p.length-1].if)}return c}}},vl=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=e.get("type");if("case_group"==i){var a=e.get("properties")||new br;return[pl(e,t,r,n,o),hl(t,a,r,null,o,"!case_value")]}r.errors.push("Unexpected child of type ".concat(i," inside switch"))},hl=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=t.get("field"),s=t.get("valueSrc"),l=t.get("valueType");("!case_value"==i||l&&"case_value"==l.get(0))&&(a="!case_value");var u=Ii(e,a),c=Li(e,n,a),p=No(c),f=t.get("value"),d=t.get("asyncListValues");if(null!=f){var v=[],h=[],g=r.usedFields,y=f.map((function(t,i){var p=s?s.get(i):null,f=l?l.get(i):null,g=Ca(t,p,e),y=ji(e,a,n,p),m=Ci(e,a,n,y,p,{forExport:!0}),O=gl(r,e,g,p,f,m,u,n,c,o,d);return void 0!==O&&(v.push(p),h.push(f)),O})),m=y.filter((function(e){return void 0===e})).size>0;if(!(y.size<p||m))return p>1?y.toArray():1==p?y.first():null;r.usedFields=g}},gl=function(e,t,r,n,o,i,a,s,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p;if("field"==n)p=ml(e,t,r,u);else if("func"==n)p=yl(e,t,r,u);else if("function"==typeof(null==i?void 0:i.jsonLogic)){var f=i.jsonLogic,d=[r,al(al({},a?ni()(a,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),xo(i,bo)];s&&(d.push(s),d.push(l)),p=f.call.apply(f,[t.ctx].concat(d))}else p=r;return p}},yl=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),s=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),l=yi(t,a),u=Ei(a,t),c=u[u.length-1];if(l)if(null!=l&&l.jsonLogic){var p={},f=[],d=[];for(var v in l.args){var h,g=l.args[v],y=Ii(t,g),m=g.defaultValue,O=g.isOptional,b=null!=m&&m.func?"func":"value",E=s?s.get(v):void 0,S=E?E.get("value"):void 0,_=E?E.get("valueSrc"):void 0;"func"!==_&&null!==(h=S)&&void 0!==h&&h.toJS&&(S=S.toJS());var T=null,R=ji(t,g,T,_),w=Ci(t,g,T,R,_,{forExport:!0}),I=gl(e,t,S,_,g.type,w,y,null,null,i);if(null!=S&&void 0===I)return void("func"!=_&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(a)));var L=void 0;if(void 0===I&&!O&&null!=m){var C=ji(t,g,T,b),A=Ci(t,g,T,C,b,{forExport:!0});if(void 0===(L=gl(e,t,m,b,g.type,A,y,null,null,i)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(a)))}var x=null!=I?I:L;if(void 0!==x){if(f.length){var N,j=sl(f);try{for(j.s();!(N=j.n()).done;){p[N.value]=void 0}}catch(e){j.e(e)}finally{j.f()}f=[]}p[v]=x}else O||d.push(v),f.push(v)}if(!d.length){var F,P=Object.values(p);if("function"==typeof l.jsonLogic){var k=l.jsonLogic,D=[p];F=k.call.apply(k,[t.ctx].concat(D))}else{var V=l.jsonLogic||c;if(!!l.jsonLogicIsMethod){var U=P[0],B=P.slice(1);F=B.length?{method:[U,V,B]}:{method:[U,V]}}else F=M({},V,P)}return F}}else e.errors.push("Func ".concat(a," is not supported"));else e.errors.push("Func ".concat(a," is not defined in config"))},ml=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=t.settings,a=i.fieldSeparator,s=i.jsonLogic;if(r){Array.isArray(r)&&(r=r.join(a));var l=Ii(t,r)||{},u=Oa(r,t,e,o);n=M({},l.jsonLogicVar||("!group"==l.type?s.groupVarKey:"var"),u),-1==e.usedFields.indexOf(r)&&e.usedFields.push(r)}return n},Ol=function(e,t,r,n,o){var i,a,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,u=arguments.length>7&&void 0!==arguments[7]&&arguments[7],c=t.get("field"),p=null===(i=t.get("valueType"))||void 0===i?void 0:i.get(0),f=Li(e,o,c)||{},d=null!==(a=null==l?void 0:l.type)&&void 0!==a?a:p,v="function"==typeof f.jsonLogic?f.jsonLogic:function(e,t,r,n){var o=e,i=No(t);"string"==typeof t.jsonLogic&&(o=t.jsonLogic);var a=["<","<=",">",">="],s=["==","!="];return function(e,t,l,u,c){return 0==i&&s.includes(o)?M({},o,[r,null]):0==i?M({},o,r):1==i?M({},o,[r,n]):2==i&&a.includes(o)?M({},o,[n[0],r,n[1]]):M({},o,[r].concat(W(n)))}}(o,f,r,n),h=[r,o,n,xo(f,Eo),s,l,d,e.settings],g=v.call.apply(v,[e.ctx].concat(h));return u&&(g={"!":g}),g},bl=function(e){var t="";return"number"==(null==e?void 0:e.type)&&(t=0),t},El=function(e,t,r,n,o,i,a,s,l,u,c,p,f){var d="string"!=typeof n||n.startsWith("$")?n:"$"+n,v=t(i,f);if(void 0!==v){var h=a^r;if(s&&"$nin"==e&&(h=!h,e="$in"),s&&"$regex"==e){var g={$regexFind:{input:d,regex:v}};return h&&(g={$not:g}),g}return h?s?{$not:M({},e,[d,v])}:M({},n,{$not:M({},e,v)}):s||e&&"$eq"!=e?s?M({},e,[d,v]):M({},n,M({},e,v)):M({},n,v)}},Sl=function(e,t,r,n,o,i,a,s,l,u,c,p){var f="string"!=typeof r||r.startsWith("$")?r:"$"+r;return i^t?a?{$not:{$and:[M({},e[0],[f,o[0]]),M({},e[1],[f,o[1]])]}}:M({},r,{$not:M(M({},e[0],o[0]),e[1],o[1])}):a?{$and:[M({},e[0],[f,o[0]]),M({},e[1],[f,o[1]])]}:M({},r,M(M({},e[0],o[0]),e[1],o[1]))},_l=function(e){return e.replace(/\$/g,"")},Tl=function(e){return e.replace(/\uFF04/g,"$")};function Rl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return wl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function wl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Il(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Ll(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Il(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Il(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Cl=function(e,t){return Al(e,t,!1)},Al=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=el(t,void 0,!1),i=xl([],e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to MongoDb:",n.errors),i)},xl=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],i=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;if(t){var l=t.get("type");return"group"===l||"rule_group"===l?Nl(e,t,r,n,o,i,a,s):"rule"===l?jl(e,t,r,n,o,i,a,s):void 0}},Nl=function(e,t,r,n){var o,i,a,s,l,u,c,p,f,d=arguments.length>4&&void 0!==arguments[4]&&arguments[4],v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,h=t.get("type"),g=t.get("properties")||new br,y=!!g.get("not"),m=t.get("children1")||new Kr,O=r.settings,b=O.canShortMongoQuery,E=O.fieldSeparator,S=O.exportPreserveGroups,_=O.reverseOperatorsForNot,T=E,R=null===(o=e.filter((function(e){return"rule_group"==e.get("type")})))||void 0===o||null===(o=o.slice(-1))||void 0===o?void 0:o.pop(),w=!!R,I=null==R?void 0:R.get("properties").get("field"),L=w&&"array"==R.get("properties").get("mode"),C="rule_group"===h,A=C?g.get("field"):null,x=C?g.get("operator"):null,N=x&&Li(r,x,A)||null,j=x?null!==(i=null===(a=N)||void 0===a?void 0:a.cardinality)&&void 0!==i?i:1:void 0,F=Oa(A,r,n,I),P=(Ii(r,A)||{}).mode,k=A&&"array"===P&&j>=1,D=C&&(null==m?void 0:m.size)>0,V=(C&&(null!=m&&m.size),!1),U=y,B=!1;D?(B=y,U=d):d&&(U=!U);var q=null===(s=N)||void 0===s?void 0:s.reversedOp,G=Li(r,q,A),K=!(null!==(l=N)&&void 0!==l&&l.mongoFormatOp||null===(u=G)||void 0===u||!u.mongoFormatOp),$=!(null===(c=G)||void 0===c||!c.mongoFormatOp),z=null===(p=xa(t))||void 0===p?void 0:p.get("type"),H=!C&&"rule"===z;if((U&&H||B&&1===(null==m?void 0:m.size))&&!S&&(H?U=!U:B=!B,V=!0),U&&C&&$&&(!!_&&!S||K)){U=!U;var Y=[q,x];x=Y[0],q=Y[1];var J=[G,N];N=J[0],G=J[1]}var X=g.get("conjunction");X||(X=ra(r));var Q=r.conjunctions[X];if(Q){var Z=Q.reversedConj;U&&"or"===(null===(f=X)||void 0===f?void 0:f.toLowerCase())&&Z&&!C&&!!_&&!S&&(X=Z,Q=r.conjunctions[X],U=!U,V=!0);var ee=Q.mongoConj,te=!C&&!w,re="array"==P?function(e){return"$$el".concat(T).concat(e)}:v,ne=m.map((function(o){return xl([].concat(W(e),[t]),o,r,n,V,te,re)})).filter((function(e){return void 0!==e}));if(k||ne.size){var oe;if(1==ne.size)oe=ne.first();else if(ne.size>1){var ie=ne.toList().toJS();b&&"$and"==ee&&!S&&(oe=ie.reduce((function(e,t){if(e){for(var r in t){if("$"==r[0]){e=void 0;break}if(null==e[r])e[r]=t[r];else{var n=e[r],o=t[r];if(So(n)||(n={$eq:n}),So(o)||(o={$eq:o}),Object.keys(n)[0]==Object.keys(o)[0]){e=void 0;break}e[r]=Object.assign({},n,o)}}return e}}),{})),oe?!0:oe=M({},ee,ie)}if(A)if("array"==P){var ae={$size:{$ifNull:["$"+_l(F),[]]}};B&&oe&&(oe={$not:oe},B=!1);var se=oe?{$size:{$ifNull:[{$filter:{input:"$"+_l(F),as:"el",cond:oe}},[]]}}:ae,le=!S&&U;le&&(U=!1),oe={$expr:oe=xl(e,t.set("type","rule"),r,n,le,!1,(function(e){return se}),ae)}}else oe=M({},_l(F),{$elemMatch:oe});return U&&(oe=L?{$not:oe}:{$nor:[oe]}),oe}}},jl=function(e,t,r,n){var o,i,a,s,l,u,c,p,f=arguments.length>4&&void 0!==arguments[4]&&arguments[4],d=!(arguments.length>5&&void 0!==arguments[5])||arguments[5],v=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,h=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0,g=t.get("properties")||new br,y=null===(o=e.filter((function(e){return"rule_group"==e.get("type")})))||void 0===o||null===(o=o.slice(-1))||void 0===o?void 0:o.pop(),m=null==y?void 0:y.get("properties").get("field"),O=g.get("operator"),b=g.get("operatorOptions"),E=g.get("field"),S=g.get("fieldSrc"),_=g.get("value"),T=g.get("valueSrc"),R=g.get("valueType"),w=g.get("asyncListValues");if(null!=E&&null!=O&&void 0!==_){var I=Ii(r,E),L=Li(r,O,E),C=null===(i=L)||void 0===i?void 0:i.reversedOp,A=Li(r,C,E),x=No(L);if(null!==(a=L)&&void 0!==a&&a.mongoFormatOp||null!==(s=A)&&void 0!==s&&s.mongoFormatOp){var N,j=f,F=!(null!==(l=L)&&void 0!==l&&l.mongoFormatOp||null===(u=A)||void 0===u||!u.mongoFormatOp);if(!(null===(c=A)||void 0===c||!c.mongoFormatOp)&&(!!r.settings.reverseOperatorsForNot||F)&&j||F){var P=[C,O];O=P[0],C=P[1];var k=[A,L];L=k[0],A=k[1],j=!j}var D=!1;if("func"==S){var V=K(kl(n,r,E,m),2);N=V[0],D=V[1]}else N=Oa(E,r,n,m),N=_l(N),v&&(D=!0,N=v(N));if(null!=N){var M,U=[],B=[];if(null!=_){var q=_.map((function(e,t){var o=T?T.get(t):null,i=R?R.get(t):null,a=Ca(e,o,r),s=ji(r,E,O,o),l=Ci(r,E,O,s,o,{forExport:!0}),u=K(Fl(n,r,a,o,i,l,I,m,O,L,w),2),c=u[0],p=u[1];return void 0!==c&&(D=D||p,U.push(o),B.push(i)),c})),G=q.filter((function(e){return void 0===e})).size>0;if(q.size<x||G)return;M=x>1?q.toArray():1==x?q.first():null}var $=D&&d,W=null===(p=L)||void 0===p?void 0:p.mongoFormatOp,z=[N,O,void 0!==h&&null==M?h:M,j,D,U.length>1?U:U[0],B.length>1?B:B[0],xo(L,Eo),b,I],H=W.call.apply(W,[r.ctx].concat(z));return $&&(H={$expr:H}),H}}else n.errors.push("Operator ".concat(O," is not supported"))}},Fl=function(e,t,r,n,o,i,a,s,l,u,c){if(void 0===r)return[void 0,!1];var p,f=!1;if("field"==n){var d=K(Pl(e,t,r,s),2);p=d[0],f=d[1]}else if("func"==n){var v=K(kl(e,t,r,s),2);p=v[0],f=v[1]}else{var h;if("function"==typeof(null==i?void 0:i.mongoFormatValue)){var g=i.mongoFormatValue,y=[r,Ll(Ll({},a?ni()(a,["fieldSettings","listValues"]):{}),{},{asyncListValues:c}),xo(i,bo)];l&&(y.push(l),y.push(u)),p=g.call.apply(g,[t.ctx].concat(y))}else p=r;null!==(h=p)&&void 0!==h&&h.$dateFromString&&(f=!0)}return[p,f]},Pl=function(e,t,r,n){var o,i=t.settings.fieldSeparator;if(r){var a=Ii(t,r)||{},s=Ei(r,t),l=ya(r,t),u=l?l.join(i):null,c=(0,t.settings.formatField)(Oa(r,t,e,n),s,u,a,t,!1);o="$"+_l(c)}return[o,!0]},kl=function(e,t,r,n){var o,i,a,s=null===(o=r.get)||void 0===o?void 0:o.call(r,"func"),l=null===(i=r.get)||void 0===i?void 0:i.call(r,"args"),u=yi(t,s);if(!u)return e.errors.push("Func ".concat(s," is not defined in config")),[void 0,!1];var c=Ei(s,t),p=c[c.length-1],f=u.mongoFunc||p,d=u.mongoArgsAsObject,v={},h=0,g=void 0,y=[],m=[];for(var O in u.args){var b;h++;var E=u.args[O],S=Ii(t,E),_=E.defaultValue,T=E.isOptional,R=null!=_&&_.func?"func":"value",w=l?l.get(O):void 0,I=w?w.get("value"):void 0,L=w?w.get("valueSrc"):void 0;"func"!==L&&null!==(b=I)&&void 0!==b&&b.toJS&&(I=I.toJS());var C=w?w.get("asyncListValues"):void 0,A=null,x=ji(t,E,A,L),N=Ci(t,E,A,x,L,{forExport:!0}),j=K(Fl(e,t,I,L,E.type,N,S,n,null,null,C),2),F=j[0];j[1];if(null!=I&&void 0===F)return"func"!=L&&e.errors.push("Can't format value of arg ".concat(O," for func ").concat(s)),[void 0,!1];var P=void 0;if(void 0===F&&!T&&null!=_){var k=ji(t,E,A,R),D=Ci(t,E,A,k,R,{forExport:!0}),V=K(Fl(e,t,_,R,E.type,D,S,n,null,null,C),2);if(P=V[0],V[1],void 0===P)return"func"!=R&&e.errors.push("Can't format default value of arg ".concat(O," for func ").concat(s)),[void 0,!1]}var U=null!=F?F:P;if(void 0!==U){if(y.length){var B,q=Rl(y);try{for(q.s();!(B=q.n()).done;){v[B.value]=void 0}}catch(e){q.e(e)}finally{q.f()}y=[]}v[O]=U,g=U}else T||m.push(O),y.push(O)}if(m.length)return[void 0,!1];if("function"==typeof u.mongoFormatFunc){var G=u.mongoFormatFunc,$=[v];a=G.call.apply(G,[t.ctx].concat($))}else{if(null===u.mongoFormatFunc)return e.errors.push("Functon ".concat(f," is not supported")),[void 0,!1];a=M({},f,d?v:1==h&&void 0!==g?g:Object.values(v))}return[a,!0]},Dl=r(358),Vl=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=["int","float"];return e.map((function(e){if(null!=e){if("string"==typeof e)r="String";else{if("number"!=typeof e)throw new Error("spelEscape: Can't use value ".concat(e," in array"));r=Number.isInteger(e)?"int":"float"}if(t){if(t!=r){if(!i.includes(t)||!i.includes(r))throw new Error("spelEscape: Can't use different types in array: found ".concat(t," and ").concat(r));t="float"}}else t=r}})),t||(t="String"),n="float"==t?e.map((function(e){return Ml(e,!0)})):e.map((function(e){return Ml(e)})),o?"new ".concat(t,"[]{").concat(n.join(", "),"}"):"{".concat(n.join(", "),"}")},Ml=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==e)return"null";switch(D(e)){case"boolean":return e?"true":"false";case"number":if(!Number.isFinite(e)||isNaN(e))return;return e+(!Number.isInteger(e)||t?"f":"");case"object":if(Array.isArray(e))return Vl(e,r);throw new Error("spelEscape: Object is not supported");default:return function(e){return"'"+e.replace(/'/g,"''")+"'"}(e)}},Ul=function(e){return e&&Array.isArray(e)&&e.length?e.map((function(e){return"const"==e.type?Ml(e.value):"property"==e.type?""+e.value:"variable"==e.type?"#"+e.value:void 0})).filter((function(e){return null!=e})).join(" + "):"null"},Bl=function(e){if(null==e)return[void 0,[]];var t=[],r="case_value"==e.valueType?e.value:e;return[(Array.isArray(r)?r:[r]).map((function(e){return"value"===e.valueSrc?null===e.value?void 0:{type:"const",value:e.value}:"field"===e.valueSrc?{type:e.isVariable?"variable":"property",value:e.value}:void t.push("Unsupported valueSrc ".concat(e.valueSrc," in concatenation"))})).filter((function(e){return null!=e})),t]},ql=function(e){return"".concat(e,".?[true]")},Gl=r.n(Dl)();Gl.trim=function(e){return"'"==(null==e?void 0:e.charAt(0))?e.substring(1,e.length-1):e},Gl.unescapeLike=function(e){if("string"!=typeof e)return e;var t=e;return t="BigQuery"===(arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0)?t.replace(/\\\\([%_])/g,"$1"):t.replace(/\\([%_])/g,"$1")},Gl.escapeLike=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0;if("string"!=typeof e)return e;var o=Gl.escape(e);return o=Gl.trim(o),o="'"+(o=(t?"%":"")+(o="BigQuery"===n?o.replace(/[%_\\]/g,"\\\\$&"):o.replace(/[%_]/g,"\\$&"))+(r?"%":""))+"'"};var Kl=function(e){var t="''",r=null==e?void 0:e.type;return"date"==r?t="'0000-00-00'":"datetime"==r?t="'0000-00-00 00:00'":"time"==r?t="'00:00'":"number"==r&&(t="0"),t},$l=function(e){return null==e?"NULL":e.toString()},Wl=function(e){return null==e||"("===(null==e?void 0:e[0])&&")"===(null==e?void 0:e[(null==e?void 0:e.length)-1])?e:"("+e+")"};function zl(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Hl(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hl(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Hl(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Yl(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jl(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yl(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yl(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Xl=function(e,t){return Ql(e,t,!1)},Ql=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=el(t,void 0,!1),i=Zl(e,o,n);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SQL:",n.errors),i)},Zl=function(e,t,r){if(e){var n=e.get("type");e.get("children1");return"group"===n||"rule_group"===n?eu(e,t,r):"rule"===n?tu(e,t,r):void 0}},eu=function(e,t,r){var n=e.get("type"),o=e.get("properties")||new br,i=e.get("children1")||new Kr,a="rule_group"===n?o.get("field"):null;"array"==(Ii(t,a)||{}).mode&&r.errors.push("Aggregation is not supported for ".concat(a));var s=o.get("not"),l=i.map((function(e){return Zl(e,t,r)})).filter((function(e){return void 0!==e}));if(l.size){var u=o.get("conjunction");return u||(u=ra(t)),t.conjunctions[u].sqlFormatConj.call(t.ctx,l,u,s)}},tu=function(e,t,r){var n=e.get("properties")||new br,o=n.get("field"),i=n.get("fieldSrc"),a=n.get("operator"),s=n.get("operatorOptions"),l=n.get("valueSrc"),u=n.get("valueType"),c=n.get("value"),p=n.get("asyncListValues");if(null!=o&&null!=a){var f=Ii(t,o)||{},d=Li(t,a,o)||{},v=d.reversedOp,h=Li(t,v,o)||{},g=No(d),y=!1,m=d.sqlOp||d.sqlFormatOp,O=h.sqlOp||h.sqlFormatOp;if(m||O){if(!m&&O){y=!0;var b=[v,a];a=b[0],v=b[1];var E=[h,d];d=E[0],h=E[1]}var S,_=[],T=[];if(null!=c){var R=c.map((function(e,n){var i=l?l.get(n):null,s=u?u.get(n):null,c=Ca(e,i,t),v=ji(t,o,a,i),h=Ci(t,o,a,v,i,{forExport:!0}),g=ru(r,t,c,i,s,h,f,a,d,p);return void 0!==g&&(_.push(i),T.push(s)),g}));if(R.filter((function(e){return void 0===e})).size>0||R.size<g)return;S=1==g?R.first():R}var w=d.sqlFormatOp||function(e,t){var r,n=t.sqlOp||e,o=No(t);return 0==o?r=function(e,t,r,o,i,a,s,l){return"".concat(e," ").concat(n)}:1==o?r=function(e,t,r,o,i,a,s,l){return"".concat(e," ").concat(n," ").concat(r)}:2==o&&(r=function(e,t,r,o,i,a,s,l){var u,c,p=null==r||null===(u=r.first)||void 0===u?void 0:u.call(r),f=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(n," ").concat(p," AND ").concat(f)}),r}(a,d);if(w){var I="func"==i?ou(r,t,o):nu(r,t,o);if(null!=I){var L,C=[I,a,S,_.length>1?_:_[0],T.length>1?T:T[0],xo(d,Eo),s,f];if(L=w.call.apply(w,[t.ctx].concat(C)),y&&(L=t.settings.sqlFormatReverse.call(t.ctx,L)),void 0!==L)return L;r.errors.push("Operator ".concat(a," is not supported for value source ").concat(_.join(", ")))}}else r.errors.push("Operator ".concat(a," is not supported"))}else r.errors.push("Operator ".concat(a," is not supported"))}},ru=function(e,t,r,n,o,i,a,s,l,u){if(void 0!==r){var c;if("field"==n)c=nu(e,t,r);else if("func"==n)c=ou(e,t,r);else if(null==r)c=void 0;else if("function"==typeof(null==i?void 0:i.sqlFormatValue)){var p=i.sqlFormatValue,f="field"==n&&Ii(t,r)||{},d=[r,Jl(Jl({},ni()(a,["fieldSettings","listValues"])),{},{asyncListValues:u}),xo(i,bo),s,l,f,t.settings.sqlDialect];c=p.call.apply(p,[t.ctx].concat(d))}else c=Array.isArray(r)?r.map((function(e){return Gl.escape(e)})):Gl.escape(r);return c}},nu=function(e,t,r){if(r){var n=t.settings.fieldSeparator,o=Ii(t,r)||{},i=Ei(r,t),a=ya(r,t),s=a?a.join(n):null;return(0,t.settings.formatField)(Oa(r,t,e,null,{useTableName:!0}),i,s,o,t)}},ou=function(e,t,r){var n,o,i=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),a=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),s=yi(t,i);if(s){var l=Ei(i,t),u=l[l.length-1],c=s.sqlFunc||u,p={},f=[],d=[];for(var v in s.args){var h,g=s.args[v],y=Ii(t,g),m=g.defaultValue,O=g.isOptional,b=null!=m&&m.func?"func":"value",E=a?a.get(v):void 0,S=E?E.get("value"):void 0,_=E?E.get("valueSrc"):void 0;"func"!==_&&null!==(h=S)&&void 0!==h&&h.toJS&&(S=S.toJS());var T=E?E.get("asyncListValues"):void 0,R=ru(e,t,S,_,g.type,y,g,null,null,T);if(null!=S&&void 0===R)return void("func"!=_&&e.errors.push("Can't format value of arg ".concat(v," for func ").concat(i)));var w=void 0;if(void 0===R&&!O&&null!=m&&void 0===(w=ru(e,t,m,b,g.type,y,g,null,null,T)))return void("func"!=b&&e.errors.push("Can't format default value of arg ".concat(v," for func ").concat(i)));var I=null!=R?R:w;if(void 0!==I){if(f.length){var L,C=zl(v);try{for(C.s();!(L=C.n()).done;){p[L.value]=void 0}}catch(e){C.e(e)}finally{C.f()}f=[]}p[v]=I}else O||d.push(v),f.push(v)}if(!d.length){var A;if("function"==typeof s.sqlFormatFunc){var x=s.sqlFormatFunc,N=[p,t.settings.sqlDialect];A=x.call.apply(x,[t.ctx].concat(N))}else{var j=Object.entries(p).map((function(e){var t=K(e,2);t[0];return t[1]})).join(", ");A="".concat(c,"(").concat(j,")")}return A}}else e.errors.push("Func ".concat(i," is not defined in config"))};function iu(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return au(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?au(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function au(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function su(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function lu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?su(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):su(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var uu="${0}.compareTo(${1})",cu={datetime:!0,time:!0,date:!0},pu=function(e,t){return fu(e,t,!1)},fu=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n={errors:[]},o=el(t,void 0,!1),i=du(e,o,n,null);return r?[i,n.errors]:(n.errors.length&&console.warn("Errors while exporting to SpEL:",n.errors),i)},du=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(e){var o=e.get("type");return"group"===o||"rule_group"===o?gu(e,t,r,n):"rule"===o?Ou(e,t,r,n):"switch_group"==o?hu(e,t,r,n):"case_group"==o?vu(e,t,r,n):void 0}},vu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type");if("case_group"==o){var i=e.get("properties")||new br,a=Eu(t,i,r,null,n,"!case_value"),s=a.value;a.valueSrc,a.valueType;return[gu(e,t,r,n),s]}r.errors.push("Unexpected child of type ".concat(o," inside switch"))},hu=function(e,t,r){e.get("properties")||new br;var n=e.get("children1");if(n){var o=n.map((function(e){return vu(e,t,r,null)})).filter((function(e){return void 0!==e})).valueSeq().toArray();if(o.length){if(1==o.length&&!o[0][0])return o[0][1];for(var i=[],a=0;a<o.length;a++)a==o.length-1||o[a][0]?(i.push(o[a]),a==o.length-1&&o[a][0]&&i.push([void 0,null])):r.errors.push("No condition for case ".concat(a));for(var s="",l="",u=0;u<i.length;u++){var c=K(i[u],2),p=c[0],f=c[1];null==f&&(f="null"),null==p&&(p="true"),u!=i.length-1?(s+="(".concat(p," ? ").concat(f," : "),l+=")"):s+="".concat(f)}return s+l}}},gu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=e.get("type"),i=e.get("properties")||new br,a=i.get("mode"),s=e.get("children1")||new Kr,l=i.get("field"),u=i.get("conjunction");u||(u=ra(t));var c=t.conjunctions[u],p=i.get("not"),f="rule_group"===o&&l,d=f&&"struct"!=a,v=d?l:n,h=(Ii(t,v)||{}).isSpelArray,g=t.settings.fieldSeparator,y=i.get("operator");y||a&&"some"!=a||(y="some");var m=mu(t,y,l),O=m!=y,b=y&&Li(t,m,l)||null,E=f&&(!m||0==b.cardinality),S=Eu(t,i,r,m,n,null),_=S.value,T=S.valueSrc,R=S.valueType,w=s.map((function(e){return du(e,t,r,v)})).filter((function(e){return void 0!==e}));if(d&&!E){if(null==_)return}else if(!w.size)return;var I,L=f,C=w.size?c.spelFormatConj.call(t.ctx,w,u,p,L):null;if(d){var A=_u(r,t,l,n).value,x=(g||".")+(h?"length":"size()"),N="".concat(A).concat(x),j=C?"".concat(A,".?[").concat(C,"]").concat(x):N;I=yu(r,t,i,j,E?N:_,m,T,R,O)}else I=C;return I},yu=function(e,t,r,n,o,i,a,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=r.get("field"),c=Li(t,i,u)||{},p=Ii(t,u)||{},f=r.get("operatorOptions"),d=c.spelFormatOp||function(e,t,r){var n=t.spelOp;if(n){var o,i=n.includes("${0}"),a=cu[r],s=n,l=No(t);return a?o=function(e,t,r,n,o,i,a,u){var c=uu.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:l>1?r[n-1]:r}));return"".concat(c," ").concat(s," 0")}:i?o=function(e,t,r,o,i,a,s,u){return n.replace(/\${(\w+)}/g,(function(t,n){return 0==n?e:l>1?r[n-1]:r}))}:0==l?o=function(e,t,r,n,o,i,a,l){return"".concat(e," ").concat(s)}:1==l&&(o=function(e,t,r,n,o,i,a,l){return"".concat(e," ").concat(s," ").concat(r)}),o}}(0,c,null!=s?s:p.type);if(d){var v,h=[n,i,o,a,s,xo(c,Eo),f,p];return v=d.call.apply(d,[t.ctx].concat(h)),l&&(v=t.settings.spelFormatReverse.call(t.ctx,v)),void 0===v&&e.errors.push("Operator ".concat(i," is not supported for value source ").concat(a)),v}e.errors.push("Operator ".concat(i," is not supported"))},mu=function(e,t,r){if(t){var n=Li(e,t,r)||{},o=n.reversedOp,i=Li(e,o,r)||{},a=n.spelOp||n.spelFormatOp,s=i.spelOp||i.spelFormatOp;if(a||s){if(!a&&s){0;var l=[o,t];t=l[0],o=l[1];var u=[i,n];n=u[0],i=u[1]}return t}}},Ou=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=e.get("properties")||new br,a=i.get("field"),s=i.get("fieldSrc"),l=i.get("operator");if(null!=a&&null!=l){var u=mu(t,l,a);if(u){var c=u!=l,p=Eu(t,i,r,u,o,null),f=p.value,d=p.valueSrc,v=p.valueType;if(void 0!==f){var h=null!==(n=bu(r,t,a,s,o))&&void 0!==n?n:{},g=h.value,y=(h.valueSrc,h.valueType);if(void 0!==g)return yu(r,t,i,g,f,u,d,null!=v?v:y,c)}}else r.errors.push("Operator ".concat(l," is not supported"))}},bu=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"func"===n?Tu(e,t,r,o):_u(e,t,r,o)},Eu=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=t.get("field"),s=t.get("valueSrc"),l=t.get("valueType");("!case_value"==i||l&&"case_value"==l.get(0))&&(a="!case_value");var u,c=Ii(e,a)||{},p=Li(e,n,a)||{},f=No(p),d=t.get("value"),v=t.get("asyncListValues"),h=[],g=[];if(null!=d){var y=d.map((function(t,i){var u=s?s.get(i):null,f=l?l.get(i):null,d=Ca(t,u,e),y=ji(e,a,n,u),m=Ci(e,a,n,y,u,{forExport:!0}),O=Su(r,e,d,u,f,m,c,n,p,o,v);return void 0!==O&&(h.push(u),g.push(f)),O})),m=y.filter((function(e){return void 0===e})).size>0;y.size<f||m||(u=f>1?y.toArray():1==f?y.first():null)}return{value:u,valueSrc:h.length>1?h:h[0],valueType:g.length>1?g:g[0]}},Su=function(e,t,r,n,o,i,a,s,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,c=arguments.length>10?arguments[10]:void 0;if(void 0!==r){var p,f;if("field"===n)p=null===(f=_u(e,t,r,u))||void 0===f?void 0:f.value;else if("func"===n){var d;p=null===(d=Tu(e,t,r,u,o))||void 0===d?void 0:d.value}else if("function"==typeof(null==i?void 0:i.spelFormatValue)){var v=i.spelFormatValue,h=[r,lu(lu({},ni()(a,["fieldSettings","listValues"])),{},{asyncListValues:c}),xo(i,bo)];if(s&&(h.push(s),h.push(l)),"field"==n){var g=Ii(t,r)||{};h.push(g)}p=v.call.apply(v,[t.ctx].concat(h))}else p=Ml(r);return p}},_u=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(r){var o=t.settings.fieldSeparator,i=Ii(t,r)||{},a=Ei(r,t),s=Mi(r,t,n),l=t.settings.formatSpelField,u=Oa(r,t,e,n),c=s.map((function(e){var t,r=K(e,3),n=r[0],i=r[1],a=r[2];return a&&(t="!struct"==a.type||"!group"==a.type&&"struct"==a.mode?null!=i&&i.isSpelMap?"map":"class":"!group"==a.type?null!=i&&i.isSpelItemMap?"[map]":"[class]":"class"),{key:n,parent:t,isSpelVariable:null==i?void 0:i.isSpelVariable,fieldSeparator:o}}));return{value:l.call(t.ctx,u,n,a,c,i,t),valueSrc:"field",valueType:null==i?void 0:i.type}}},Tu=function(e,t,r){var n,o,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=null===(n=r.get)||void 0===n?void 0:n.call(r,"func"),s=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),l=yi(t,a);if(l){var u={},c=[],p=[];for(var f in l.args){var d,v,h=l.args[f],g=Ii(t,h),y=h.defaultValue,m=h.isOptional,O=null!=y&&y.func?"func":"value",b=s?s.get(f):void 0,E=b?b.get("value"):void 0,S=b?b.get("valueSrc"):void 0;"func"!==S&&null!==(d=E)&&void 0!==d&&d.toJS&&(E=E.toJS());var _=b?b.get("asyncListValues"):void 0,T=null===(v=h.escapeForFormat)||void 0===v||v,R=null,w=ji(t,h,R,S),I=Ci(t,h,R,w,S,{forExport:!0}),L=Su(e,t,E,S,h.type,I,g,null,null,i,_);if(null!=E&&void 0===L)return void("func"!=S&&e.errors.push("Can't format value of arg ".concat(f," for func ").concat(a)));var C=void 0;if(void 0===L&&!m&&null!=y){var A=ji(t,h,R,O),x=Ci(t,h,R,A,O,{forExport:!0});if(void 0===(C=Su(e,t,y,O,h.type,x,g,null,null,i,_)))return void("func"!=O&&e.errors.push("Can't format default value of arg ".concat(f," for func ").concat(a)))}var N=null!=L?L:C;if(void 0!==N){if(c.length){var j,F=iu(c);try{for(F.s();!(j=F.n()).done;){var P=j.value;u[P]=void 0}}catch(e){F.e(e)}finally{F.f()}c=[]}u[f]=T?N:null!=E?E:y}else m||p.push(f),c.push(f)}if(!p.length){var k;if("function"==typeof l.spelFormatFunc){var D=l.spelFormatFunc,V=[u];k=D.call.apply(D,[t.ctx].concat(V))}else if(l.spelFunc){k=l.spelFunc.replace(/\${(\w+)}/g,(function(e,t){var r;return null!==(r=u[t])&&void 0!==r?r:e}));var M,U=Object.keys(l.args||{}).reverse().filter((function(e){return!!l.args[e].isOptional})),B=iu(U);try{for(B.s();!(M=B.n()).done;){var q=M.value;if(null!=u[q])break;k=k.replace(new RegExp("(, )?\\${"+q+"}","g"),"")}}catch(e){B.e(e)}finally{B.f()}k=k.replace(/\${(\w+)}/g,"null")}else e.errors.push("Func ".concat(a," is not supported"));return{value:k,valueSrc:"func",valueType:l.returnType}}}else e.errors.push("Func ".concat(a," is not defined in config"))};function Ru(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return wu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?wu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Iu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Lu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Iu(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Iu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Cu=function(e,t){var r={errors:[],settings:{isForDisplay:arguments.length>2&&void 0!==arguments[2]&&arguments[2],isDebugMode:arguments.length>3&&void 0!==arguments[3]&&arguments[3]}},n=el(t,void 0,!1),o=Au([],e,n,r,null);return r.errors.length&&console.warn("Errors while exporting to string:",r.errors),o},Au=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(t){var i=t.get("type");t.get("children1");return"group"===i||"rule_group"===i?xu(e,t,r,n,o):"rule"===i?Nu(e,t,r,n,o):void 0}},xu=function(e,t,r,n){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=n.settings,l=s.isForDisplay,u=s.isDebugMode,c=t.get("type"),p=t.get("properties")||new br,f=p.get("mode"),d=t.get("children1")||new Kr,v=a,h="rule_group"===c,g=h&&"array"==f?p.get("field"):null,y="rule_group"===c?p.get("operator"):null,m=y?null!==(o=null===(i=r.operators[y])||void 0===i?void 0:i.cardinality)&&void 0!==o?o:1:void 0,O=h&&"array"===f&&m>=1,b=p.get("not"),E=d.map((function(o){return Au([].concat(W(e),[t]),o,r,n,null!=g?g:v)})).filter((function(e){return void 0!==e}));if(O||E.size||u){var S=p.get("conjunction");S||(S=ra(r));var _,T=r.conjunctions[S],R=E.size?T.formatConj.call(r.ctx,E,S,b,l):null;if(g){var w=Nu(e,t,r,n,v,!0);if(w){var I,L=w.pop(),C=[R].concat(W(w));_=(I=r.settings.formatAggr).call.apply(I,[r.ctx].concat(W(C))),L&&(_=r.settings.formatReverse.call(r.ctx,_,null,null,null,null,l))}}else _=R;return u&&null==_&&(_="?"),_}},Nu=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5],a=n.settings,s=a.isForDisplay,l=a.isDebugMode,u=t.get("properties")||new br,c=u.get("field"),p=u.get("fieldSrc"),f=u.get("operator"),d=u.get("operatorOptions");if(null!=c&&null!=f||l){var v=Ii(r,c)||{},h=Li(r,f,c)||{},g=h.reversedOp,y=Li(r,g,c)||{},m=!1,O=h.formatOp;if(!O&&g&&(O=y.formatOp)){m=!0;var b=[g,f];f=b[0],g=b[1];var E=[y,h];h=E[0],y=E[1]}if(l&&!f&&(f="?"),O||(O=function(e,t,r){var n,o=r.settings.isDebugMode,i=(null==t?void 0:t.labelForFormat)||e,a=No(t);return 0==a?n=function(e,t,r,n,o,a,s,l){return"".concat(e," ").concat(i)}:1==a?n=function(e,t,r,n,a,s,l,u){return o&&"?"===t&&"?"===r?e&&"?"!==e?"".concat(e," ?"):"?":"".concat(e," ").concat(i," ").concat(r)}:2==a&&(n=function(e,t,r,n,o,a,s,l){var u,c,p=null==r||null===(u=r.first)||void 0===u?void 0:u.call(r),f=null==r||null===(c=r.get)||void 0===c?void 0:c.call(r,1);return"".concat(e," ").concat(i," ").concat(p," AND ").concat(f)}),n}(f,h,n)),O){var S="func"===p?Pu(r,n,c,o):Fu(r,n,c,o);if(null!=S){var _=function(e,t,r,n,o){var i,a,s=r.settings,l=(s.isForDisplay,s.isDebugMode),u=t.get("field"),c=t.get("valueSrc"),p=t.get("valueType"),f=Ii(e,u)||{},d=n||t.get("operator"),v=Li(e,d,u)||{},h=No(v),g=t.get("value"),y=t.get("asyncListValues"),m=[],O=[];return null!=g&&!((a=g.map((function(t,n){var i=c?c.get(n):null,a=p?p.get(n):null,s=l?t:Ca(t,i,e),h=ji(e,u,d,i),g=Ci(e,u,d,h,i,{forExport:!0}),b=ju(e,r,s,i,a,g,f,d,v,o,y);return void 0!==b&&(m.push(i),O.push(a)),b}))).filter((function(e){return void 0===e})).size>0)&&a.size===h&&(i=1==h?a.first():a),l&&!i&&(i=h>1?new Kr(Array.from({length:h}).map((function(e,t){var r,n;return null!==(r=null===(n=a)||void 0===n?void 0:n.get(t))&&void 0!==r?r:"?"}))):"?"),[i,m.length>1?m:m[0],O.length>1?O:O[0]]}(r,u,n,f,o),T=K(_,3),R=T[0],w=T[1],I=T[2];if(void 0!==R){var L=[S,f,R,w,I,xo(h,Eo),d,s,v,m];if(i)return L;var C,A=(C=O).call.apply(C,[r.ctx].concat(L));return m&&(A=r.settings.formatReverse.call(r.ctx,A,f,g,h,y,s)),A}}}}},ju=function(e,t,r,n,o,i,a,s,l){var u,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,p=arguments.length>10?arguments[10]:void 0,f=t.settings,d=f.isForDisplay,v=f.isDebugMode;if(void 0===r)return v?"array"===(null==i?void 0:i.jsType)?[]:"?":void 0;if("field"==n)u=Fu(e,t,r,c);else if("func"==n)u=Pu(e,t,r,c);else if(null==r)u=void 0;else if("function"==typeof(null==i?void 0:i.formatValue)){var h,g=i.formatValue,y=[r,Lu(Lu({},ni()(a,["fieldSettings","listValues"])),{},{asyncListValues:p}),xo(i,bo),d];if(s&&(y.push(s),y.push(l)),"field"==n){var m=Ii(e,r)||{};y.push(m)}u=null===(h=null==a?void 0:a.escapeForFormat)||void 0===h||h?g.call.apply(g,[e.ctx].concat(y)):r}else u=r;return u},Fu=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=t.settings,a=i.isForDisplay,s=i.isDebugMode,l=e.settings,u=(l.fieldSeparator,l.fieldSeparatorDisplay),c=null;if(r){var p=Ii(e,r)||{},f=Ei(r,e),d=ya(r,e,o?n:null),v=d?d.join(u):null,h=p.label2||v;c=(0,e.settings.formatField)(Oa(r,e,t,o?n:null,{useTableName:!0}),f,h,p,e,a)}else s&&(c="?");return c},Pu=function(e,t,r){var n,o,i,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,s=t.settings,l=s.isForDisplay,u=s.isDebugMode,c=null==r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func");if(!c)return u?"?()":void 0;var p=null===(o=r.get)||void 0===o?void 0:o.call(r,"args"),f=yi(e,c);if(f||u){var d,v=Ei(c,e),h=v[v.length-1],g=l&&(null==f?void 0:f.label)||h,y={},m=[],O=[],b={},E=Ru(f?Object.keys(f.args||{}):(null==p||null===(i=p.keySeq)||void 0===i?void 0:i.call(p).toArray())||[]);try{for(E.s();!(d=E.n()).done;){var S,_=d.value,T=null==f?void 0:f.args[_],R=(Ii(e,T),T||{}),w=R.defaultValue,I=R.isOptional,L=null!=w&&w.func?"func":"value",C=Ci(e,T,void 0,void 0,L,{forExport:!0}),A=l&&(null==T?void 0:T.label)||_,x=p?p.get(_):void 0,N=x?x.get("value"):void 0,j=x?x.get("valueSrc"):void 0;"func"!==j&&null!==(S=N)&&void 0!==S&&S.toJS&&(N=N.toJS());var F=x?x.get("asyncListValues"):void 0,P=ju(e,t,N,j,null==T?void 0:T.type,C,T,null,null,a,F);null!=N&&void 0===P&&"func"!=j&&t.errors.push("Can't format value of arg ".concat(_," for func ").concat(c));var k=void 0;if(void 0===P&&!I&&null!=w&&void 0===(k=ju(e,t,w,L,null==T?void 0:T.type,C,T,null,null,a,F)))return void("func"!=L&&t.errors.push("Can't format default value of arg ".concat(_," for func ").concat(c)));var D=null!=P?P:k;if(void 0!==D){if(m.length){var V,M=Ru(_);try{for(M.s();!(V=M.n()).done;){var U=K(V.value,2),B=U[0];U[1];y[B]=void 0}}catch(e){M.e(e)}finally{M.f()}m=[]}y[_]=D,b[A]=D}else I||O.push(_),m.push([_,A])}}catch(e){E.e(e)}finally{E.f()}if(!O.length||u){var q=null;if("function"==typeof(null==f?void 0:f.formatFunc)){var G=f.formatFunc,$=[y,l];q=G.call.apply(G,[e.ctx].concat($))}else{var W=Object.entries(l?b:y).map((function(e){var t=K(e,2),r=t[0],n=t[1];return l?"".concat(r,": ").concat(n):"".concat(n)})).join(", ");q="".concat(g,"(").concat(W,")")}return q}}else t.errors.push("Func ".concat(c," is not defined in config"))};function ku(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Du(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ku(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ku(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Vu(e,t,r,n,o,i){var a=function(e){return e}(n);switch(e){case"filter":return{script:o.operators[r].elasticSearchScript(n,t)};case"exists":return{field:n};case"match":return M({},a,t[0]);case"term":return M({},n,i===Uu?{value:t[0]}:t[0]);case"geo_bounding_box":return M({},n,function(e){if(null==e)return null;var t=e.split(",").map(Number);return{top_left:{lat:t[0],lon:t[1]},bottom_right:{lat:t[2],lon:t[3]}}}(t[0]));case"range":return M({},n,function(e,t){if(e.length>1)return{gte:"".concat(e[0]),lte:"".concat(e[1])};var r=e[0];switch(t){case"on_date":case"not_on_date":case"equal":case"select_equals":case"not_equal":return{gte:"".concat(r,"||/d"),lte:"".concat(r,"||+1d")};case"less_or_equal":return{lte:"".concat(r)};case"greater_or_equal":return{gte:"".concat(r)};case"less":return{lt:"".concat(r)};case"greater":return{gt:"".concat(r)};default:return}}(t,r));case"wildcard":return M({},n,function(e){return{value:"*"+e+"*"}}(t[0]));case"regexp":return M({},n,function(e){return{value:e}}(t[0]));default:return}}function Mu(e,t,r,n,o,i){if(e&&r&&null!=t){var a=r,s=n.operators[a];if(s){var l=s.elasticSearchQueryType,u=!1;if(!l&&s.reversedOp)u=!0,a=s.reversedOp,l=(s=n.operators[a]).elasticSearchQueryType;var c=ji(n,e,a,o),p=n.widgets[c];if(p){var f,d,v=p.elasticSearchFormatValue;if(f="function"==typeof l?l(c):l)return d="function"==typeof v?v(f,t,a,e,n):Vu(f,t,a,e,n,i),u?{bool:{must_not:M({},f,Du({},d))}}:M({},f,Du({},d))}}}}var Uu="ES_7_SYNTAX",Bu="ES_6_SYNTAX";function qu(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Bu,n=el(t,void 0,!1);if(e){var o=e.get("type"),i=e.get("properties")||new Map;if("rule"===o&&i.get("field")){var a,s,l,u=i.get("operator"),c=i.get("field"),p=i.get("fieldSrc"),f=null===(a=i.get("value"))||void 0===a?void 0:a.toJS(),d=(null===(s=i.get("valueType"))||void 0===s||s.get(0),null===(l=i.get("valueSrc"))||void 0===l?void 0:l.get(0));if("func"===d||"func"==p)return;return f&&Array.isArray(f[0])?f[0].map((function(e){return Mu(c,[e],u,n,d,r)})):Mu(c,f,u,n,d,r)}if("group"===o||"rule_group"===o){var v=i.get("not"),h=i.get("conjunction");return h||(h=ra(n)),function(e,t,r,n,o,i){if(e&&e.size){var a=e.valueSeq().toArray(),s=function(e,t){switch(e){case"AND":return t?"must_not":"must";case"OR":return t?"should_not":"should";case"NOT":return t?"must":"must_not";default:return}}(t,r),l=a.map((function(e){return n(e,o,i)})).filter((function(e){return void 0!==e}));if(l.length)return{bool:M({},s,l.flat(1/0))}}}(e.get("children1"),h,v,qu,n,r)}}}var Gu=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(e){var n=e;return n=n.toJS(),n=Ji(n,t,r)}},Ku=function(e){if($u(e))return e;if(Wu(e))return $i(ta(e));if("string"==typeof e&&e.startsWith('["~#iM"'))throw new Error("You are trying to load query in obsolete serialization format (Immutable string) which is not supported in versions starting from 2.1.17");if("string"==typeof e)return $i(ta(JSON.parse(e)));throw new Error("Can't load tree!")},$u=function(e){return br.isMap(e)},Wu=function(e){return"object"==D(e)&&("group"==e.type||"switch_group"==e.type)};function zu(e){return U(e)||$(e)||q(e)||G()}function Hu(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yu(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hu(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hu(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Ju(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Xu(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Xu(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Xu(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var Qu="jlField",Zu="jlRawField",ec="jlHavingMarker",tc=new Proxy({__name:"jlArgs",__test:function(e){var t,r=null==e||null===(t=e.match)||void 0===t?void 0:t.call(e,/jlArgs\[(\d+)\]/);if(r)return parseInt(r[1])}},{get:function(e,t){return isNaN(parseInt(t))?e[t]:"jlArgs["+t+"]"}}),rc=["==","!=","datetime==","datetime!=","date==","date!="],nc=["<","<=",">",">="],oc=["in","!in"],ic=["multiselect_equals","multiselect_not_equals","multiselect_contains","multiselect_not_contains"],ac=function(e){return{errors:[],settings:null==e?void 0:e.settings}},sc=function(e,t){return lc(e,t,!1)},lc=function(e,t){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=ac();n.settings={allowUnknownFields:!1,returnErrors:r};var o=el(t,void 0,!1),i=uc(o),a=e?fc(e,i,o,["rule","group","switch","case_val"],n):void 0,s=a?Ku(a):void 0;return n.errors=Array.from(new Set(n.errors)),r?[s,n.errors]:(n.errors.length&&console.warn("Errors while importing from JsonLogic:",n.errors),s)},uc=function(e){var t={},r={},n=function(n){var o=e.operators[n],i=No(o);if("string"==typeof o.jsonLogic){var a=o.jsonLogic+"/"+i;t[a]||(t[a]=[]),t[a].push(n)}else if("function"==typeof o.jsonLogic){var s,l,u,c,p;try{p=o.jsonLogic(Qu,n,tc,o,new lo.Map({having:ec,groupField:Zu}))}catch(e){return console.warn("Error while running JsonLogic template for op ".concat(n),e),1}var f=Object.keys(p)[0],d=null===(s=o.jsonLogic2)||void 0===s?void 0:s.startsWith("#"),v=null!==(l=null===(u=o.jsonLogic2)||void 0===u?void 0:u.replace(/^#/,""))&&void 0!==l?l:f;(null!==(c=o.jsonLogicOps)&&void 0!==c?c:[v]).map((function(e){var r=e+"/"+i;t[r]||(t[r]=[]),t[r].push(n)})),r[n]||(r[n]={}),r[n]={template:p,newOp:v,_jsonLogicIsExclamationOp:!!o._jsonLogicIsExclamationOp,isRevArgs:d}}};for(var o in e.operators)n(o);var i={};for(var a in e.conjunctions){i[e.conjunctions[a].jsonLogicConj||a.toLowerCase()]=a}var s,l={},u=Ju(pi(e));try{for(u.s();!(s=u.n()).done;){var c=K(s.value,2),p=c[0],f=c[1],d=void 0;f.jsonLogicIsMethod?d="#"+f.jsonLogic:"string"==typeof f.jsonLogic&&(d=f.jsonLogic),d&&(l[d]||(l[d]=[]),l[d].push(p))}}catch(e){u.e(e)}finally{u.f()}var v=e.settings.jsonLogic,h=v.groupVarKey,g=v.altVarKey;return{operators:t,conjunctions:i,funcs:l,varKeys:["var",h,g],combinationOperators:r}},cc=function(e,t,r){var n,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;if(null!=t&&t.combinationOperators)for(var i=0,a=Object.entries(t.combinationOperators);i<a.length;i++){var s=K(a[i],2),l=s[0],u=s[1];if(null==o||o.includes(l)){var c=pc(u.template,e);c.match&&(n?r.errors.push("Operator matched against 2 templates: ".concat(n.newOp," and ").concat(l)):n=c,n.newOp=u.newOp)}}return n},pc=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{match:!0,jlField:null,jlArgs:[],jlHaving:null};if(null==e||null==t)return r.match=!1,r;var n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return r.match=!1,r;r.vals=[];for(var i=0;i<n.length;i++){var a=n[i],s=e[a];if(r.vals.push(t[a]),a!==o[i])return r.match=!1,r;var l=tc.__test(s);if(void 0!==l)r.jlArgs[l]=t[a];else if(s===Qu&&Wo(t[a]))r.jlField=t[a];else if(s===Zu)r.jlField={var:t[a]};else if(s===tc)r.jlArgs.push(t[a]);else if(s===ec)r.jlHaving=t[a];else if("object"===D(s)&&null!==s||Array.isArray(s))r=pc(s,t[a],r);else if(s!==t[a])return r.match=!1,r}return r},fc=function(e,t,r,n,o){var i,a,s,l=arguments.length>5&&void 0!==arguments[5]&&arguments[5],u=arguments.length>6?arguments[6]:void 0,c=arguments.length>7?arguments[7]:void 0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null;Wo(e)&&(i=Object.keys(e)[0],a=e[i],Array.isArray(a)||(a=[a]));var f=o.errors.length,d=r.settings.jsonLogic.lockedOp,v="!"==i&&1==a.length&&a[0]&&Wo(a[0])&&t.varKeys.includes(Object.keys(a[0])[0]),h=cc(e,t,o);h&&((a=[])[0]=h.jlField,h.jlHaving&&a.push(h.jlHaving),h.jlArgs.forEach((function(e){return a.push(e)})),i=h.newOp,oc.includes(i)&&(a=h.vals));var g="!"==i&&!v,y=d&&i==d,m=n.includes("switch");if(y)s=fc(a[0],t,r,n,o,l,u,c,p,!0);else if(g)s=fc(a[0],t,r,n,o,!l,u,c,p);else if(n.includes("val"))s=vc(i,a,t,r,l,o,p)||mc(i,a,t,r,l,u,o,p)||dc(e,u,c,r,o);else{var O=W(o.errors);n.includes("switch")&&(s=Tc(i,a,t,r,l,o,p)),null==s&&n.includes("group")&&(s=Oc(i,a,t,r,l,o,p,!1)),null==s&&n.includes("rule")&&(s=Sc(i,a,t,r,l,o,p));var b=W(o.errors);null==s&&n.includes("case_val")&&(o.errors=O,null==(s=_c(i,a,t,r,l,o,p))&&(o.errors=b)),s&&m&&!["group","switch_group"].includes(s.type)&&(s=bc(s,r))}var E=o.errors.length;return"!"!=i&&void 0===s&&E==f&&o.errors.push("Can't parse logic ".concat(JSON.stringify(e))),y&&(s.properties.isLocked=!0),s},dc=function(e,t,r,n,o){var i;if(void 0===e&&(e=null==t?void 0:t.defaultValue),void 0!==e){r=r||(null==t?void 0:t.mainWidget);var a=n.widgets[r],s=null==t?void 0:t.type;if(!s||a){if(!Wo(e)){if(null!=a&&a.jsonLogicImport)try{var l;e=a.jsonLogicImport.call(n.ctx,e,Yu(Yu({},a),null!==(l=null==t?void 0:t.fieldSettings)&&void 0!==l?l:{}))}catch(t){var u;o.errors.push("Can't import value ".concat(e," using import func of widget ").concat(r,": ").concat(null!==(u=null==t?void 0:t.message)&&void 0!==u?u:t)),e=void 0}else{if("time"===s&&"number"==typeof e){var c=Math.floor(e/60/60)%24,p=Math.floor(e/60)%60,f=e%60,d=a.valueFormat;if(d){var v=new Date(e);v.setMilliseconds(0),v.setHours(c),v.setMinutes(p),v.setSeconds(f),e=ho()(v).format(d)}else e="".concat(c,":").concat(p,":").concat(f)}if(["date","datetime"].includes(s)&&e&&!(e instanceof Date))try{var h="number"==typeof e||"string"==typeof e&&!isNaN(e),g=h&&"string"==typeof e?parseInt(e):e,y=new Date(h?g:e);if(y instanceof Date&&(e=y),isNaN(y))throw new Error("Invalid date")}catch(t){o.errors.push("Can't convert value ".concat(e," as Date")),e=void 0}}if(e instanceof Date&&t){var m=a.valueFormat;m&&(e=ho()(e).format(m))}var O;if(e&&null!=t&&null!==(i=t.fieldSettings)&&void 0!==i&&i.asyncFetch)O=Array.isArray(e)?e:[e];return{valueSrc:"value",value:e,valueType:null==a?void 0:a.type,asyncListValues:O}}o.errors.push("Unexpected logic in value: ".concat(JSON.stringify(e)))}else o.errors.push("No widget for type ".concat(s))}},vc=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if(r.varKeys.includes(e)&&"string"==typeof t[0]){var s,l=hi(n,t[0],a),u=Ii(n,l);return u||null!==(s=i.settings)&&void 0!==s&&s.allowUnknownFields?{valueSrc:"field",value:l,valueType:null==u?void 0:u.type}:void i.errors.push("No config for field ".concat(l))}},hc=function(e,t,r,n,o){var i,a,s,l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,u=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,c=arguments.length>7?arguments[7]:void 0,p=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,f=!!o.operators[e],d=Object.keys(t)[0],v=Object.values(t)[0],h=function(e,t){return gc(e,t,n,o,l,c,p)||yc(e,t,n,o,l,u,c,p)},g=c.errors.length,y=h(d,v);if(y&&(i=y.field,a=y.fieldSrc),f&&(s=r[0],r=r.splice(1)),"reduce"==d&&Array.isArray(v)&&3==v.length){var m=K(v,3),O=m[0],b=m[1],E=m[2];if(Wo(O)&&0==E&&Wo(b)&&Array.isArray(b["+"])&&1==b["+"][0]&&Wo(b["+"][1])&&"accumulator"==b["+"][1].var)if(d=Object.keys(O)[0],v=Object.values(O)[0],"filter"==d){var S=K(v,2),_=S[0],T=S[1];if(Wo(_)){var R=h(d=Object.keys(_)[0],v=Object.values(_)[0]);R&&(i=R.field,a=R.fieldSrc,s=T,f=!0)}}else{var w=h(d,v);w&&(i=w.field,a=w.fieldSrc,f=!0)}}var I=c.errors.length;if(i||I!=g||c.errors.push("Unknown LHS ".concat(JSON.stringify(t))),i)return{field:i,fieldSrc:a,having:s,isGroup:f,args:r}},gc=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;Array.isArray(t)||(t=[t]);var s=vc(e,t,r,n,o,i,a);if(s)return{fieldSrc:"field",field:s.value}},yc=function(e,t,r,n,o){var i=mc(e,t,r,n,o,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6?arguments[6]:void 0,arguments.length>7&&void 0!==arguments[7]?arguments[7]:null);if(i)return{fieldSrc:"func",field:i.value}},mc=function(e,t,r,n,o){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,a=arguments.length>6?arguments[6]:void 0,s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;if(e){var l,u,c,p="method"==e;if(p){var f,d,v=zu(t);f=v[0],l=v[1],d=v.slice(2),u=[f].concat(W(d))}else l=e,u=t;var h=(p?"#":"")+l,g=(null==i?void 0:i.type)||(null==i?void 0:i.returnType),y=(r.funcs[h]||[]).filter((function(e){return!i||yi(n,e).returnType==g}));if(y.length)c=y[0];else{var m,O=M({},e,t),b=Ju(pi(n));try{for(b.s();!(m=b.n()).done;){var E=K(m.value,2),S=E[0],_=E[1];if(_.jsonLogicImport&&(!g||_.returnType==g)){var T=void 0;try{T=_.jsonLogicImport.call(n.ctx,O)}catch(e){}T&&(c=S,u=T)}}}catch(e){b.e(e)}finally{b.f()}}if(c&&c){var R=yi(n,c),w=Object.keys(R.args||{}),I=u.reduce((function(e,t,o){var i,l=w[o],u=R.args[l];return u&&(i=fc(t,r,n,["val"],a,!1,u,null,s)),void 0!==i?Yu(Yu({},e),{},M({},l,i)):e}),{});for(var L in R.args){var C=R.args[L],A=I[L];if(void 0===A){var x;if(void 0!==(A=null==C?void 0:C.defaultValue))A={value:A,valueSrc:null!==(x=A)&&void 0!==x&&x.func?"func":"value",valueType:C.type};if(void 0===A){if(null==C||!C.isOptional)return void a.errors.push("No value for arg ".concat(L," of func ").concat(c))}else I[L]=A}}return{valueSrc:"func",value:{func:c,args:I},valueType:R.returnType}}}},Oc=function(e,t,r,n,o,i){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=r.conjunctions[e],u=n.settings.fieldSeparator;if(l){var c=t.map((function(e){return fc(e,r,n,["rule","group"],i,!1,null,null,s)})).filter((function(e){return void 0!==e})).reduce((function(e,t){return Yu(Yu({},e),{},M({},t.id,t))}),{}),p=Object.values(c).map((function(e){var t,r;return"field"==(null==e||null===(t=e.properties)||void 0===t?void 0:t.fieldSrc)&&(null==e||null===(r=e.properties)||void 0===r?void 0:r.field)})).filter((function(e){var t;return null==e||null===(t=e.includes)||void 0===t?void 0:t.call(e,u)})),f=Object.fromEntries((a=p,Array.from(new Set(a))).map((function(e){var t=e.split(u),r=Object.fromEntries(t.slice(0,-1).map((function(e,t,r){return[].concat(W(r.slice(0,t)),[e])})).map((function(e){return[e.join(u),Ii(n,e)]})).filter((function(e){var t=K(e,2),r=(t[0],t[1]);return"!group"==(null==r?void 0:r.type)})));return[e,Object.keys(r)]}))),d={conjunction:l,not:o},v=co(),h={},g={};return Object.entries(c).map((function(e){var t=K(e,2),r=t[0],o=t[1];if("group"==(null==o?void 0:o.type)||"rule_group"==(null==o?void 0:o.type))h[r]=o;else{var i,a=null==o||null===(i=o.properties)||void 0===i?void 0:i.field,c=f[a]||[],p=c[c.length-1];if(p){var d=h,v=Ei(s,n),y=Ei(p,n);Fo(v,y.slice(0,v.length))||(v=[]),p.split(u).slice(v.length).map((function(e,t,r){return[].concat(W(v),W(r.slice(0,t)),[e]).join(u)})).map((function(e){return{f:e,fc:Ii(n,e)||{}}})).filter((function(e){return"!struct"!=e.fc.type})).map((function(e,t){var r=e.f,n=e.fc,o=g[r];o||(o=co(),g[r]=o,d[o]={type:"rule_group",id:o,children1:{},properties:{conjunction:l,not:!1,field:r,fieldSrc:"field",mode:n.mode}}),d=d[o].children1})),d[r]=o}else o&&(h[r]=o)}})),{type:"group",id:v,children1:h,properties:d}}},bc=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:co(),children1:M({},e.id,e),properties:{conjunction:oa(t),not:r}}},Ec=function(e,t,r,n,o,i,a){var s,l=ic.map((function(e){var t;return null===(t=i.operators[e])||void 0===t?void 0:t.jsonLogic2})).includes(e),u=i.settings.groupOperators.find((function(t){var r=i.operators[t];return[t,"string"==typeof r.jsonLogic&&r.jsonLogic,r.jsonLogic2].includes(e)})),c=i.operators[u],p=u&&0==(null==c?void 0:c.cardinality)&&!l,f=null!==(s=null==c?void 0:c.cardinality)&&void 0!==s?s:t-1;!p&&rc.includes(e)&&1==f&&null===r[1]&&(t=1,f=0,r=[r[0]]);var d=e+"/"+f,v=o.operators[d];if(v){var h,g=[],y=Ju(v);try{for(y.s();!(h=y.n()).done;){var m,O,b=h.value,E=void 0,S=[];if(nc.includes(e)&&3==t)E=r[1],S=[r[0],r[2]];else{var _=zu(r);E=_[0],S=_.slice(1)}if(null!==(m=o.combinationOperators[b])&&void 0!==m&&m.isRevArgs&&(E=r[r.length-1],S=r.slice(0,r.length-1)),Wo(E)){var T=hc(u,E,S,o,i,null,null,a,n);if(T){var R=T.field,w=T.fieldSrc,I=T.having,L=(T.isGroup,T.args),C=Ii(i,R);if(!(C||null!==(O=a.settings)&&void 0!==O&&O.allowUnknownFields))return void a.errors.push("No config for LHS ".concat(R));var A=(null==C?void 0:C.operators)&&C.operators.includes(b);g.push({field:R,fieldSrc:w,fieldConfig:C,opKey:b,args:L,having:I,isValidOp:A})}}}}catch(e){y.e(e)}finally{y.f()}return g.sort((function(e){return e.isValidOp?-1:1})),g[0]}},Sc=function(e,t,r,n,o,i){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]&&arguments[7];if(e){var u=Object.values(n.conjunctions).map((function(e){return e.jsonLogicConj})),c=function(e,t,r,n,o,i,a){var s=ac(a),l=Ec(e,t,r,n,o,i,s);if(l)return l;a.errors.push(Array.from(new Set(s.errors)).join("; ")||"Unknown op ".concat(e,"/").concat(t))}(e,t.length,t,s,r,n,i);if(c){var p,f,d=c.field,v=c.fieldSrc,h=c.fieldConfig,g=c.opKey,y=c.args,m=c.having,O=Ii(n,s),b=n.operators[g],E=!1,S=!!n.operators[null===(a=b)||void 0===a?void 0:a.reversedOp],_="!group"==h.type,T="!group"==(null==O?void 0:O.type),R=S&&(!!n.settings.reverseOperatorsForNot||_&&!m||!_&&T&&!l),w=o&&R||E,I=!1,L=!!n.settings.reverseOperatorsForNot;if("!group"==(null==h?void 0:h.type)&&m){p=Object.keys(m)[0],f=m[p],Array.isArray(f)||(f=[f]);for(var C=cc(m,r,i);"!"==p&&!C;){if("!"==p&&1==f.length&&f[0]&&Wo(f[0])&&r.varKeys.includes(Object.keys(f[0])[0]))break;I=!I,m=m["!"],p=Object.keys(m)[0],f=m[p],L&&u.includes(p)&&1==f.length&&(m=m[p][0],p=Object.keys(m)[0],f=m[p]);var A=cc(m,r,i);C=A||C}Array.isArray(f)||(f=[f]),C&&((f=[])[0]=C.jlField,C.jlArgs.forEach((function(e){return f.push(e)})),p=C.newOp,oc.includes(C.newOp)&&(f=C.vals))}w&&(o=!o,g=b.reversedOp,b=n.operators[g]);var x=ji(n,d,g,null),N=y.map((function(e){return fc(e,r,n,["val"],i,!1,h,x,s)}));if(!N.filter((function(e){return void 0===e})).length){var j,F=null==h?void 0:h.type;if("!group"!==F&&"!struct"!==F||(F=null),"!group"==(null==h?void 0:h.type)&&m){var P;if(void 0!==r.conjunctions[p])j=Oc(p,f,r,n,I,i,d,!0);else if(j=Sc(p,f,r,n,I,i,d,!0))"rule_group"===j.type&&(null===(P=j.properties)||void 0===P?void 0:P.field)!==d&&(j=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0,i=arguments.length>5&&void 0!==arguments[5]&&arguments[5];if(e)return{type:"rule_group",id:co(),children1:M({},e.id,e),properties:{conjunction:o||oa(n,r),not:i,field:t}}}(j,d,h,n)),Object.assign(j.properties,{conjunction:oa(n,h)});if(!j)return;j.type="rule_group",Object.assign(j.properties,{field:d,mode:h.mode,operator:g}),"array"==h.mode&&Object.assign(j.properties,{value:N.map((function(e){return e.value})),valueSrc:N.map((function(e){return e.valueSrc})),valueType:N.map((function(e){return e.valueType}))}),o&&(j=bc(j,n,o))}else if("!group"!=(null==h?void 0:h.type)||m){var k=N.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),D=k.length?k[0]:void 0;j={type:"rule",id:co(),properties:Yu({field:d,fieldSrc:v,operator:g,value:N.map((function(e){return e.value})),valueSrc:N.map((function(e){return e.valueSrc})),valueType:N.map((function(e){return e.valueType}))},D?{asyncListValues:D}:{})},(o||l)&&(j=bc(j,n,o))}else j={type:"rule_group",id:co(),children1:{},properties:{conjunction:oa(n,h),not:!1,mode:h.mode,field:d,operator:g}},"array"===h.mode&&Object.assign(j.properties,{value:N.map((function(e){return e.value})),valueSrc:N.map((function(e){return e.valueSrc})),valueType:N.map((function(e){return e.valueType}))}),o&&(j=bc(j,n,o));return j}}}},_c=function(e,t,r,n,o,i){var a=M({},e,t),s=Ic(n,i,r,a);if(void 0!==s){var l=[wc(null,s,n,i)];return{type:"switch_group",id:co(),children1:l,properties:{}}}},Tc=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("if"===(null==e?void 0:e.toLowerCase())){var s=Rc(t).map((function(e){var t=K(e,2),o=t[0],s=t[1];return[o?fc(o,r,n,["rule","group"],i,!1,null,null,a):null,Ic(n,i,r,s)]})).map((function(e){var t=K(e,2),r=t[0],o=t[1];return wc(r,o,n,i)}));return{type:"switch_group",id:co(),children1:s,properties:{}}}},Rc=function(e){var t=[];return function e(r){var n=K(r,3),o=n[0],i=n[1],a=n[2];t.push([o,i]);var s=Wo(a)?Object.keys(a)[0]:null;"if"===(null==s?void 0:s.toLowerCase())?e(a[s]):t.push([void 0,a])}(e),t},wc=function(e,t,r,n){var o;return e?(o=Yu({},e)).type?("group"!=o.type&&(o=bc(o,r)),o.type="case_group"):(n.errors.push("Unexpected case: ".concat(JSON.stringify(o))),o=void 0):o={id:co(),type:"case_group",properties:{}},o&&(o.properties=Yu(Yu({},o.properties),t)),o},Ic=function(e,t,r,n){var o=Ii(e,"!case_value");if(o){var i=o.mainWidget,a=e.widgets[i];if(a){var s=fc(n,r,e,["val","case_val"],t,!1,o,i);if(null!=s){var l=s.value,u=s.valueSrc,c=s.valueType;return{value:[l],valueSrc:[null!=u?u:"value"],valueType:[null!=c?c:null==a?void 0:a.type],field:"!case_value"}}}else t.errors.push("No widget ".concat(i," for case value"))}else t.errors.push("Missing caseValueField in settings")},Lc=r(138),Cc=r(7027),Ac=r.n(Cc);const xc=e=>"string"==typeof e,Nc=()=>{let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r},jc=e=>null==e?"":""+e,Fc=/###/g,Pc=e=>e&&e.indexOf("###")>-1?e.replace(Fc,"."):e,kc=e=>!e||xc(e),Dc=(e,t,r)=>{const n=xc(t)?t.split("."):t;let o=0;for(;o<n.length-1;){if(kc(e))return{};const t=Pc(n[o]);!e[t]&&r&&(e[t]=new r),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++o}return kc(e)?{}:{obj:e,k:Pc(n[o])}},Vc=(e,t,r)=>{const{obj:n,k:o}=Dc(e,t,Object);if(void 0!==n||1===t.length)return void(n[o]=r);let i=t[t.length-1],a=t.slice(0,t.length-1),s=Dc(e,a,Object);for(;void 0===s.obj&&a.length;)i=`${a[a.length-1]}.${i}`,a=a.slice(0,a.length-1),s=Dc(e,a,Object),s&&s.obj&&void 0!==s.obj[`${s.k}.${i}`]&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=r},Mc=(e,t)=>{const{obj:r,k:n}=Dc(e,t);if(r)return r[n]},Uc=(e,t,r)=>{for(const n in t)"__proto__"!==n&&"constructor"!==n&&(n in e?xc(e[n])||e[n]instanceof String||xc(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):Uc(e[n],t[n],r):e[n]=t[n]);return e},Bc=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var qc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const Gc=e=>xc(e)?e.replace(/[&<>"'\/]/g,(e=>qc[e])):e;const Kc=[" ",",","?","!",";"],$c=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}(20),Wc=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:".";if(!e)return;if(e[t])return e[t];const n=t.split(r);let o=e;for(let e=0;e<n.length;){if(!o||"object"!=typeof o)return;let t,i="";for(let a=e;a<n.length;++a)if(a!==e&&(i+=r),i+=n[a],t=o[i],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<n.length-1)continue;e+=a-e+1;break}o=t}return o},zc=e=>e&&e.replace("_","-"),Hc={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console&&console[e]&&console[e].apply(console,t)}};class Yc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.init(e,t)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.prefix=t.prefix||"i18next:",this.logger=e||Hc,this.options=t,this.debug=t.debug}log(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"log","",!0)}warn(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","",!0)}error(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"error","")}deprecate(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return this.forward(t,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,n){return n&&!this.debug?null:(xc(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new Yc(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new Yc(this.logger,e)}}var Jc=new Yc;class Xc{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const r=this.observers[e].get(t)||0;this.observers[e].set(t,r+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];if(this.observers[e]){Array.from(this.observers[e].entries()).forEach((e=>{let[t,n]=e;for(let e=0;e<n;e++)t(...r)}))}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach((t=>{let[n,o]=t;for(let t=0;t<o;t++)n.apply(n,[e,...r])}))}}}class Qc extends Xc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,i=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let a;e.indexOf(".")>-1?a=e.split("."):(a=[e,t],r&&(Array.isArray(r)?a.push(...r):xc(r)&&o?a.push(...r.split(o)):a.push(r)));const s=Mc(this.data,a);return!s&&!t&&!r&&e.indexOf(".")>-1&&(e=a[0],t=a[1],r=a.slice(2).join(".")),!s&&i&&xc(r)?Wc(this.data&&this.data[e]&&this.data[e][t],r,o):s}addResource(e,t,r,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{silent:!1};const i=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let a=[e,t];r&&(a=a.concat(i?r.split(i):r)),e.indexOf(".")>-1&&(a=e.split("."),n=t,t=a[1]),this.addNamespaces(t),Vc(this.data,a,n),o.silent||this.emit("added",e,t,r,n)}addResources(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{silent:!1};for(const n in r)(xc(r[n])||Array.isArray(r[n]))&&this.addResource(e,t,n,r[n],{silent:!0});n.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{silent:!1,skipCopy:!1},a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),n=r,r=t,t=a[1]),this.addNamespaces(t);let s=Mc(this.data,a)||{};i.skipCopy||(r=JSON.parse(JSON.stringify(r))),n?Uc(s,r,o):s={...s,...r},Vc(this.data,a,s),i.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),"v1"===this.options.compatibilityAPI?{...this.getResource(e,t)}:this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var Zc={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,o){return e.forEach((e=>{this.processors[e]&&(t=this.processors[e].process(t,r,n,o))})),t}};const ep={};class tp extends Xc{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};super(),((e,t,r)=>{e.forEach((e=>{t[e]&&(r[e]=t[e])}))})(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=Jc.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};if(null==e)return!1;const r=this.resolve(e,t);return r&&void 0!==r.res}extractFromKey(e,t){let r=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===r&&(r=":");const n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let o=t.ns||this.options.defaultNS||[];const i=r&&e.indexOf(r)>-1,a=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,r)=>{t=t||"",r=r||"";const n=Kc.filter((e=>t.indexOf(e)<0&&r.indexOf(e)<0));if(0===n.length)return!0;const o=$c.getRegExp(`(${n.map((e=>"?"===e?"\\?":e)).join("|")})`);let i=!o.test(e);if(!i){const t=e.indexOf(r);t>0&&!o.test(e.substring(0,t))&&(i=!0)}return i})(e,r,n));if(i&&!a){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:xc(o)?[o]:o};const i=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(i[0])>-1)&&(o=i.shift()),e=i.join(n)}return{key:e,namespaces:xc(o)?[o]:o}}translate(e,t,r){if("object"!=typeof t&&this.options.overloadTranslationOptionHandler&&(t=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof t&&(t={...t}),t||(t={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const n=void 0!==t.returnDetails?t.returnDetails:this.options.returnDetails,o=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator,{key:i,namespaces:a}=this.extractFromKey(e[e.length-1],t),s=a[a.length-1],l=t.lng||this.language,u=t.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(l&&"cimode"===l.toLowerCase()){if(u){const e=t.nsSeparator||this.options.nsSeparator;return n?{res:`${s}${e}${i}`,usedKey:i,exactUsedKey:i,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:`${s}${e}${i}`}return n?{res:i,usedKey:i,exactUsedKey:i,usedLng:l,usedNS:s,usedParams:this.getUsedParamsDetails(t)}:i}const c=this.resolve(e,t);let p=c&&c.res;const f=c&&c.usedKey||i,d=c&&c.exactUsedKey||i,v=Object.prototype.toString.apply(p),h=void 0!==t.joinArrays?t.joinArrays:this.options.joinArrays,g=!this.i18nFormat||this.i18nFormat.handleAsObject,y=!xc(p)&&"boolean"!=typeof p&&"number"!=typeof p;if(!(g&&p&&y&&["[object Number]","[object Function]","[object RegExp]"].indexOf(v)<0)||xc(h)&&Array.isArray(p))if(g&&xc(h)&&Array.isArray(p))p=p.join(h),p&&(p=this.extendTranslation(p,e,t,r));else{let n=!1,a=!1;const u=void 0!==t.count&&!xc(t.count),f=tp.hasDefaultValue(t),d=u?this.pluralResolver.getSuffix(l,t.count,t):"",v=t.ordinal&&u?this.pluralResolver.getSuffix(l,t.count,{ordinal:!1}):"",h=u&&!t.ordinal&&0===t.count&&this.pluralResolver.shouldUseIntlApi(),g=h&&t[`defaultValue${this.options.pluralSeparator}zero`]||t[`defaultValue${d}`]||t[`defaultValue${v}`]||t.defaultValue;!this.isValidLookup(p)&&f&&(n=!0,p=g),this.isValidLookup(p)||(a=!0,p=i);const y=(t.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&a?void 0:p,m=f&&g!==p&&this.options.updateMissing;if(a||n||m){if(this.logger.log(m?"updateKey":"missingKey",l,s,i,m?g:p),o){const e=this.resolve(i,{...t,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const r=this.languageUtils.getFallbackCodes(this.options.fallbackLng,t.lng||this.language);if("fallback"===this.options.saveMissingTo&&r&&r[0])for(let t=0;t<r.length;t++)e.push(r[t]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(t.lng||this.language):e.push(t.lng||this.language);const n=(e,r,n)=>{const o=f&&n!==p?n:y;this.options.missingKeyHandler?this.options.missingKeyHandler(e,s,r,o,m,t):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(e,s,r,o,m,t),this.emit("missingKey",e,s,r,p)};this.options.saveMissing&&(this.options.saveMissingPlurals&&u?e.forEach((e=>{const r=this.pluralResolver.getSuffixes(e,t);h&&t[`defaultValue${this.options.pluralSeparator}zero`]&&r.indexOf(`${this.options.pluralSeparator}zero`)<0&&r.push(`${this.options.pluralSeparator}zero`),r.forEach((r=>{n([e],i+r,t[`defaultValue${r}`]||g)}))})):n(e,i,g))}p=this.extendTranslation(p,e,t,c,r),a&&p===i&&this.options.appendNamespaceToMissingKey&&(p=`${s}:${i}`),(a||n)&&this.options.parseMissingKeyHandler&&(p="v1"!==this.options.compatibilityAPI?this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${s}:${i}`:i,n?p:void 0):this.options.parseMissingKeyHandler(p))}else{if(!t.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(f,p,{...t,ns:a}):`key '${i} (${this.language})' returned an object instead of string.`;return n?(c.res=e,c.usedParams=this.getUsedParamsDetails(t),c):e}if(o){const e=Array.isArray(p),r=e?[]:{},n=e?d:f;for(const e in p)if(Object.prototype.hasOwnProperty.call(p,e)){const i=`${n}${o}${e}`;r[e]=this.translate(i,{...t,joinArrays:!1,ns:a}),r[e]===i&&(r[e]=p[e])}p=r}}return n?(c.res=p,c.usedParams=this.getUsedParamsDetails(t),c):p}extendTranslation(e,t,r,n,o){var i=this;if(this.i18nFormat&&this.i18nFormat.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const a=xc(e)&&(r&&r.interpolation&&void 0!==r.interpolation.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let s;if(a){const t=e.match(this.interpolator.nestingRegexp);s=t&&t.length}let l=r.replace&&!xc(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,r.lng||this.language||n.usedLng,r),a){const t=e.match(this.interpolator.nestingRegexp);s<(t&&t.length)&&(r.nest=!1)}!r.lng&&"v1"!==this.options.compatibilityAPI&&n&&n.res&&(r.lng=this.language||n.usedLng),!1!==r.nest&&(e=this.interpolator.nest(e,(function(){for(var e=arguments.length,n=new Array(e),a=0;a<e;a++)n[a]=arguments[a];return o&&o[0]===n[0]&&!r.context?(i.logger.warn(`It seems you are nesting recursively key: ${n[0]} in key: ${t[0]}`),null):i.translate(...n,t)}),r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,s=xc(a)?[a]:a;return null!=e&&s&&s.length&&!1!==r.applyPostProcessor&&(e=Zc.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e){let t,r,n,o,i,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return xc(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(t))return;const s=this.extractFromKey(e,a),l=s.key;r=l;let u=s.namespaces;this.options.fallbackNS&&(u=u.concat(this.options.fallbackNS));const c=void 0!==a.count&&!xc(a.count),p=c&&!a.ordinal&&0===a.count&&this.pluralResolver.shouldUseIntlApi(),f=void 0!==a.context&&(xc(a.context)||"number"==typeof a.context)&&""!==a.context,d=a.lngs?a.lngs:this.languageUtils.toResolveHierarchy(a.lng||this.language,a.fallbackLng);u.forEach((e=>{this.isValidLookup(t)||(i=e,!ep[`${d[0]}-${e}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(i)&&(ep[`${d[0]}-${e}`]=!0,this.logger.warn(`key "${r}" for languages "${d.join(", ")}" won't get resolved as namespace "${i}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),d.forEach((r=>{if(this.isValidLookup(t))return;o=r;const i=[l];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(i,l,r,e,a);else{let e;c&&(e=this.pluralResolver.getSuffix(r,a.count,a));const t=`${this.options.pluralSeparator}zero`,n=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(c&&(i.push(l+e),a.ordinal&&0===e.indexOf(n)&&i.push(l+e.replace(n,this.options.pluralSeparator)),p&&i.push(l+t)),f){const r=`${l}${this.options.contextSeparator}${a.context}`;i.push(r),c&&(i.push(r+e),a.ordinal&&0===e.indexOf(n)&&i.push(r+e.replace(n,this.options.pluralSeparator)),p&&i.push(r+t))}}let s;for(;s=i.pop();)this.isValidLookup(t)||(n=s,t=this.getResource(r,e,s,a))})))}))})),{res:t,usedKey:r,exactUsedKey:n,usedLng:o,usedNS:i}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}getUsedParamsDetails(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!xc(e.replace);let n=r?e.replace:e;if(r&&void 0!==e.count&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!r){n={...n};for(const e of t)delete n[e]}return n}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,12)&&void 0!==e[r])return!0;return!1}}const rp=e=>e.charAt(0).toUpperCase()+e.slice(1);class np{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=Jc.create("languageUtils")}getScriptPartFromCode(e){if(!(e=zc(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=zc(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(xc(e)&&e.indexOf("-")>-1){if("undefined"!=typeof Intl&&void 0!==Intl.getCanonicalLocales)try{let t=Intl.getCanonicalLocales(e)[0];if(t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t)return t}catch(e){}const t=["hans","hant","latn","cyrl","cans","mong","arab"];let r=e.split("-");return this.options.lowerCaseLng?r=r.map((e=>e.toLowerCase())):2===r.length?(r[0]=r[0].toLowerCase(),r[1]=r[1].toUpperCase(),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=rp(r[1].toLowerCase()))):3===r.length&&(r[0]=r[0].toLowerCase(),2===r[1].length&&(r[1]=r[1].toUpperCase()),"sgn"!==r[0]&&2===r[2].length&&(r[2]=r[2].toUpperCase()),t.indexOf(r[1].toLowerCase())>-1&&(r[1]=rp(r[1].toLowerCase())),t.indexOf(r[2].toLowerCase())>-1&&(r[2]=rp(r[2].toLowerCase()))),r.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const r=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(r)||(t=r)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const r=this.getLanguagePartFromCode(e);if(this.isSupportedCode(r))return t=r;t=this.options.supportedLngs.find((e=>e===r?e:e.indexOf("-")<0&&r.indexOf("-")<0?void 0:e.indexOf("-")>0&&r.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===r||0===e.indexOf(r)&&r.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),xc(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes(t||this.options.fallbackLng||[],e),n=[],o=e=>{e&&(this.isSupportedCode(e)?n.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return xc(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&o(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&o(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&o(this.getLanguagePartFromCode(e))):xc(e)&&o(this.formatLanguageCode(e)),r.forEach((e=>{n.indexOf(e)<0&&o(this.formatLanguageCode(e))})),n}}let op=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],ip={1:e=>Number(e>1),2:e=>Number(1!=e),3:e=>0,4:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),5:e=>Number(0==e?0:1==e?1:2==e?2:e%100>=3&&e%100<=10?3:e%100>=11?4:5),6:e=>Number(1==e?0:e>=2&&e<=4?1:2),7:e=>Number(1==e?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2),8:e=>Number(1==e?0:2==e?1:8!=e&&11!=e?2:3),9:e=>Number(e>=2),10:e=>Number(1==e?0:2==e?1:e<7?2:e<11?3:4),11:e=>Number(1==e||11==e?0:2==e||12==e?1:e>2&&e<20?2:3),12:e=>Number(e%10!=1||e%100==11),13:e=>Number(0!==e),14:e=>Number(1==e?0:2==e?1:3==e?2:3),15:e=>Number(e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2),16:e=>Number(e%10==1&&e%100!=11?0:0!==e?1:2),17:e=>Number(1==e||e%10==1&&e%100!=11?0:1),18:e=>Number(0==e?0:1==e?1:2),19:e=>Number(1==e?0:0==e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3),20:e=>Number(1==e?0:0==e||e%100>0&&e%100<20?1:2),21:e=>Number(e%100==1?1:e%100==2?2:e%100==3||e%100==4?3:0),22:e=>Number(1==e?0:2==e?1:(e<0||e>10)&&e%10==0?2:3)};const ap=["v1","v2","v3"],sp=["v4"],lp={zero:0,one:1,two:2,few:3,many:4,other:5};class up{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.languageUtils=e,this.options=t,this.logger=Jc.create("pluralResolver"),this.options.compatibilityJSON&&!sp.includes(this.options.compatibilityJSON)||"undefined"!=typeof Intl&&Intl.PluralRules||(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=(()=>{const e={};return op.forEach((t=>{t.lngs.forEach((r=>{e[r]={numbers:t.nr,plurals:ip[t.fc]}}))})),e})(),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this.shouldUseIntlApi()){const r=zc("dev"===e?"en":e),n=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:r,type:n});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let i;try{i=new Intl.PluralRules(r,{type:n})}catch(r){if(!e.match(/-|_/))return;const n=this.languageUtils.getLanguagePartFromCode(e);i=this.getRule(n,t)}return this.pluralRulesCache[o]=i,i}return this.rules[e]||this.rules[this.languageUtils.getLanguagePartFromCode(e)]}needsPlural(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.getRule(e,t);return this.shouldUseIntlApi()?r&&r.resolvedOptions().pluralCategories.length>1:r&&r.numbers.length>1}getPluralFormsOfKey(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.getSuffixes(e,r).map((e=>`${t}${e}`))}getSuffixes(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const r=this.getRule(e,t);return r?this.shouldUseIntlApi()?r.resolvedOptions().pluralCategories.sort(((e,t)=>lp[e]-lp[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):r.numbers.map((r=>this.getSuffix(e,r,t))):[]}getSuffix(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const n=this.getRule(e,r);return n?this.shouldUseIntlApi()?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:this.getSuffixRetroCompatible(n,t):(this.logger.warn(`no plural rule found for: ${e}`),"")}getSuffixRetroCompatible(e,t){const r=e.noAbs?e.plurals(t):e.plurals(Math.abs(t));let n=e.numbers[r];this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]&&(2===n?n="plural":1===n&&(n=""));const o=()=>this.options.prepend&&n.toString()?this.options.prepend+n.toString():n.toString();return"v1"===this.options.compatibilityJSON?1===n?"":"number"==typeof n?`_plural_${n.toString()}`:o():"v2"===this.options.compatibilityJSON||this.options.simplifyPluralSuffix&&2===e.numbers.length&&1===e.numbers[0]?o():this.options.prepend&&r.toString()?this.options.prepend+r.toString():r.toString()}shouldUseIntlApi(){return!ap.includes(this.options.compatibilityJSON)}}const cp=function(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:".",o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=((e,t,r)=>{const n=Mc(e,r);return void 0!==n?n:Mc(t,r)})(e,t,r);return!i&&o&&xc(r)&&(i=Wc(e,r,n),void 0===i&&(i=Wc(t,r,n))),i},pp=e=>e.replace(/\$/g,"$$$$");class fp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Jc.create("interpolator"),this.options=e,this.format=e.interpolation&&e.interpolation.format||(e=>e),this.init(e)}init(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:n,prefix:o,prefixEscaped:i,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:u,unescapePrefix:c,nestingPrefix:p,nestingPrefixEscaped:f,nestingSuffix:d,nestingSuffixEscaped:v,nestingOptionsSeparator:h,maxReplaces:g,alwaysFormat:y}=e.interpolation;this.escape=void 0!==t?t:Gc,this.escapeValue=void 0===r||r,this.useRawValueToEscape=void 0!==n&&n,this.prefix=o?Bc(o):i||"{{",this.suffix=a?Bc(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=p?Bc(p):f||Bc("$t("),this.nestingSuffix=d?Bc(d):v||Bc(")"),this.nestingOptionsSeparator=h||",",this.maxReplaces=g||1e3,this.alwaysFormat=void 0!==y&&y,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e&&e.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,n){let o,i,a;const s=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},l=e=>{if(e.indexOf(this.formatSeparator)<0){const o=cp(t,s,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,r,{...n,...t,interpolationkey:e}):o}const o=e.split(this.formatSeparator),i=o.shift().trim(),a=o.join(this.formatSeparator).trim();return this.format(cp(t,s,i,this.options.keySeparator,this.options.ignoreJSONStructure),a,r,{...n,...t,interpolationkey:i})};this.resetRegExp();const u=n&&n.missingInterpolationHandler||this.options.missingInterpolationHandler,c=n&&n.interpolation&&void 0!==n.interpolation.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>pp(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?pp(this.escape(e)):pp(e)}].forEach((t=>{for(a=0;o=t.regex.exec(e);){const r=o[1].trim();if(i=l(r),void 0===i)if("function"==typeof u){const t=u(e,o,n);i=xc(t)?t:""}else if(n&&Object.prototype.hasOwnProperty.call(n,r))i="";else{if(c){i=o[0];continue}this.logger.warn(`missed to pass in variable ${r} for interpolating ${e}`),i=""}else xc(i)||this.useRawValueToEscape||(i=jc(i));const s=t.safeValue(i);if(e=e.replace(o[0],s),c?(t.regex.lastIndex+=i.length,t.regex.lastIndex-=o[0].length):t.regex.lastIndex=0,a++,a>=this.maxReplaces)break}})),e}nest(e,t){let r,n,o,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(e,t)=>{const r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;const n=e.split(new RegExp(`${r}[ ]*{`));let i=`{${n[1]}`;e=n[0],i=this.interpolate(i,o);const a=i.match(/'/g),s=i.match(/"/g);(a&&a.length%2==0&&!s||s.length%2!=0)&&(i=i.replace(/'/g,'"'));try{o=JSON.parse(i),t&&(o={...t,...o})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${r}${i}`}return o.defaultValue&&o.defaultValue.indexOf(this.prefix)>-1&&delete o.defaultValue,e};for(;r=this.nestingRegexp.exec(e);){let s=[];o={...i},o=o.replace&&!xc(o.replace)?o.replace:o,o.applyPostProcessor=!1,delete o.defaultValue;let l=!1;if(-1!==r[0].indexOf(this.formatSeparator)&&!/{.*}/.test(r[1])){const e=r[1].split(this.formatSeparator).map((e=>e.trim()));r[1]=e.shift(),s=e,l=!0}if(n=t(a.call(this,r[1].trim(),o),o),n&&r[0]===e&&!xc(n))return n;xc(n)||(n=jc(n)),n||(this.logger.warn(`missed to resolve ${r[1]} for nesting ${e}`),n=""),l&&(n=s.reduce(((e,t)=>this.format(e,t,i.lng,{...i,interpolationkey:r[1].trim()})),n.trim())),e=e.replace(r[0],n),this.regexp.lastIndex=0}return e}}const dp=e=>{const t={};return(r,n,o)=>{let i=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(i={...i,[o.interpolationkey]:void 0});const a=n+JSON.stringify(i);let s=t[a];return s||(s=e(zc(n),o),t[a]=s),s(r)}};class vp{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.logger=Jc.create("formatter"),this.options=e,this.formats={number:dp(((e,t)=>{const r=new Intl.NumberFormat(e,{...t});return e=>r.format(e)})),currency:dp(((e,t)=>{const r=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>r.format(e)})),datetime:dp(((e,t)=>{const r=new Intl.DateTimeFormat(e,{...t});return e=>r.format(e)})),relativetime:dp(((e,t)=>{const r=new Intl.RelativeTimeFormat(e,{...t});return e=>r.format(e,t.range||"day")})),list:dp(((e,t)=>{const r=new Intl.ListFormat(e,{...t});return e=>r.format(e)}))},this.init(e)}init(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{interpolation:{}};this.formatSeparator=t.interpolation.formatSeparator||","}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=dp(t)}format(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find((e=>e.indexOf(")")>-1))){const e=o.findIndex((e=>e.indexOf(")")>-1));o[0]=[o[0],...o.splice(1,e)].join(this.formatSeparator)}return o.reduce(((e,t)=>{const{formatName:o,formatOptions:i}=(e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const o=n[1].substring(0,n[1].length-1);"currency"===t&&o.indexOf(":")<0?r.currency||(r.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?r.range||(r.range=o.trim()):o.split(";").forEach((e=>{if(e){const[t,...n]=e.split(":"),o=n.join(":").trim().replace(/^'+|'+$/g,""),i=t.trim();r[i]||(r[i]=o),"false"===o&&(r[i]=!1),"true"===o&&(r[i]=!0),isNaN(o)||(r[i]=parseInt(o,10))}}))}return{formatName:t,formatOptions:r}})(t);if(this.formats[o]){let t=e;try{const a=n&&n.formatParams&&n.formatParams[n.interpolationkey]||{},s=a.locale||a.lng||n.locale||n.lng||r;t=this.formats[o](e,s,{...i,...n,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${o}`),e}),e)}}class hp extends Xc{constructor(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=n,this.logger=Jc.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(r,n.backend,n)}queueLoad(e,t,r,n){const o={},i={},a={},s={};return e.forEach((e=>{let n=!0;t.forEach((t=>{const a=`${e}|${t}`;!r.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===i[a]&&(i[a]=!0):(this.state[a]=1,n=!1,void 0===i[a]&&(i[a]=!0),void 0===o[a]&&(o[a]=!0),void 0===s[t]&&(s[t]=!0)))})),n||(a[e]=!0)})),(Object.keys(o).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(o),pending:Object.keys(i),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(e,t,r){const n=e.split("|"),o=n[0],i=n[1];t&&this.emit("failedLoading",o,i,t),!t&&r&&this.store.addResourceBundle(o,i,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const a={};this.queue.forEach((r=>{((e,t,r)=>{const{obj:n,k:o}=Dc(e,t,Object);n[o]=n[o]||[],n[o].push(r)})(r.loaded,[o],i),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(r,e),t&&r.errors.push(t),0!==r.pendingCount||r.done||(Object.keys(r.loaded).forEach((e=>{a[e]||(a[e]={});const t=r.loaded[e];t.length&&t.forEach((t=>{void 0===a[e][t]&&(a[e][t]=!0)}))})),r.done=!0,r.errors.length?r.callback(r.errors):r.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((e=>!e.done))}read(e,t,r){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.retryTimeout,i=arguments.length>5?arguments[5]:void 0;if(!e.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:r,tried:n,wait:o,callback:i});this.readingCalls++;const a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&s&&n<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,r,n+1,2*o,i)}),o):i(a,s)},s=this.backend[r].bind(this.backend);if(2!==s.length)return s(e,t,a);try{const r=s(e,t);r&&"function"==typeof r.then?r.then((e=>a(null,e))).catch(a):a(null,r)}catch(e){a(e)}}prepareLoading(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();xc(e)&&(e=this.languageUtils.toResolveHierarchy(e)),xc(t)&&(t=[t]);const o=this.queueLoad(e,t,r,n);if(!o.toLoad.length)return o.pending.length||n(),null;o.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";const r=e.split("|"),n=r[0],o=r[1];this.read(n,o,"read",void 0,void 0,((r,i)=>{r&&this.logger.warn(`${t}loading namespace ${o} for language ${n} failed`,r),!r&&i&&this.logger.log(`${t}loaded namespace ${o} for language ${n}`,i),this.loaded(e,r,i)}))}saveMissing(e,t,r,n,o){let i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(t))this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");else if(null!=r&&""!==r){if(this.backend&&this.backend.create){const s={...i,isUpdate:o},l=this.backend.create.bind(this.backend);if(l.length<6)try{let o;o=5===l.length?l(e,t,r,n,s):l(e,t,r,n),o&&"function"==typeof o.then?o.then((e=>a(null,e))).catch(a):a(null,o)}catch(e){a(e)}else l(e,t,r,n,a,s)}e&&e[0]&&this.store.addResource(e[0],t,r,n)}}}const gp=()=>({debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),xc(e[1])&&(t.defaultValue=e[1]),xc(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const r=e[3]||e[2];Object.keys(r).forEach((e=>{t[e]=r[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}),yp=e=>(xc(e.ns)&&(e.ns=[e.ns]),xc(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),xc(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs&&e.supportedLngs.indexOf("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),e),mp=()=>{};class Op extends Xc{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;var r;if(super(),this.options=yp(e),this.services={},this.logger=Jc,this.modules={external:[]},r=this,Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach((e=>{"function"==typeof r[e]&&(r[e]=r[e].bind(r))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initImmediate)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(){var e=this;let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,"function"==typeof t&&(r=t,t={}),!t.defaultNS&&!1!==t.defaultNS&&t.ns&&(xc(t.ns)?t.defaultNS=t.ns:t.ns.indexOf("translation")<0&&(t.defaultNS=t.ns[0]));const n=gp();this.options={...n,...this.options,...yp(t)},"v1"!==this.options.compatibilityAPI&&(this.options.interpolation={...n.interpolation,...this.options.interpolation}),void 0!==t.keySeparator&&(this.options.userDefinedKeySeparator=t.keySeparator),void 0!==t.nsSeparator&&(this.options.userDefinedNsSeparator=t.nsSeparator);const o=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let t;this.modules.logger?Jc.init(o(this.modules.logger),this.options):Jc.init(null,this.options),this.modules.formatter?t=this.modules.formatter:"undefined"!=typeof Intl&&(t=vp);const r=new np(this.options);this.store=new Qc(this.options.resources,this.options);const i=this.services;i.logger=Jc,i.resourceStore=this.store,i.languageUtils=r,i.pluralResolver=new up(r,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),!t||this.options.interpolation.format&&this.options.interpolation.format!==n.interpolation.format||(i.formatter=o(t),i.formatter.init(i,this.options),this.options.interpolation.format=i.formatter.format.bind(i.formatter)),i.interpolator=new fp(this.options),i.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},i.backendConnector=new hp(o(this.modules.backend),i.resourceStore,i,this.options),i.backendConnector.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.emit(t,...n)})),this.modules.languageDetector&&(i.languageDetector=o(this.modules.languageDetector),i.languageDetector.init&&i.languageDetector.init(i,this.options.detection,this.options)),this.modules.i18nFormat&&(i.i18nFormat=o(this.modules.i18nFormat),i.i18nFormat.init&&i.i18nFormat.init(this)),this.translator=new tp(this.services,this.options),this.translator.on("*",(function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),o=1;o<r;o++)n[o-1]=arguments[o];e.emit(t,...n)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,r||(r=mp),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((t=>{this[t]=function(){return e.store[t](...arguments)}}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((t=>{this[t]=function(){return e.store[t](...arguments),e}}));const i=Nc(),a=()=>{const e=(e,t)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),i.resolve(t),r(e,t)};if(this.languages&&"v1"!==this.options.compatibilityAPI&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initImmediate?a():setTimeout(a,0),i}loadResources(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mp;const r=xc(e)?e:this.language;if("function"==typeof e&&(t=e),!this.options.resources||this.options.partialBundledLanguages){if(r&&"cimode"===r.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return t();const e=[],n=t=>{if(!t)return;if("cimode"===t)return;this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};if(r)n(r);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>n(e)))}this.options.preload&&this.options.preload.forEach((e=>n(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),t(e)}))}else t(null)}reloadResources(e,t,r){const n=Nc();return"function"==typeof e&&(r=e,e=void 0),"function"==typeof t&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=mp),this.services.backendConnector.reload(e,t,(e=>{n.resolve(),r(e)})),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&Zc.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1))for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}}changeLanguage(e,t){var r=this;this.isLanguageChangingTo=e;const n=Nc();this.emit("languageChanging",e);const o=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},i=(e,i)=>{i?(o(i),this.translator.changeLanguage(i),this.isLanguageChangingTo=void 0,this.emit("languageChanged",i),this.logger.log("languageChanged",i)):this.isLanguageChangingTo=void 0,n.resolve((function(){return r.t(...arguments)})),t&&t(e,(function(){return r.t(...arguments)}))},a=t=>{e||t||!this.services.languageDetector||(t=[]);const r=xc(t)?t:this.services.languageUtils.getBestMatchFromCodes(t);r&&(this.language||o(r),this.translator.language||this.translator.changeLanguage(r),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(r)),this.loadResources(r,(e=>{i(e,r)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(a):this.services.languageDetector.detect(a):a(e):a(this.services.languageDetector.detect()),n}getFixedT(e,t,r){var n=this;const o=function(e,t){let i;if("object"!=typeof t){for(var a=arguments.length,s=new Array(a>2?a-2:0),l=2;l<a;l++)s[l-2]=arguments[l];i=n.options.overloadTranslationOptionHandler([e,t].concat(s))}else i={...t};i.lng=i.lng||o.lng,i.lngs=i.lngs||o.lngs,i.ns=i.ns||o.ns,""!==i.keyPrefix&&(i.keyPrefix=i.keyPrefix||r||o.keyPrefix);const u=n.options.keySeparator||".";let c;return c=i.keyPrefix&&Array.isArray(e)?e.map((e=>`${i.keyPrefix}${u}${e}`)):i.keyPrefix?`${i.keyPrefix}${u}${e}`:e,n.t(c,i)};return xc(e)?o.lng=e:o.lngs=e,o.ns=t,o.keyPrefix=r,o}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;const i=(e,t)=>{const r=this.services.backendConnector.state[`${e}|${t}`];return-1===r||0===r||2===r};if(t.precheck){const e=t.precheck(this,i);if(void 0!==e)return e}return!!this.hasResourceBundle(r,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!i(r,e)||n&&!i(o,e)))}loadNamespaces(e,t){const r=Nc();return this.options.ns?(xc(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=Nc();xc(e)&&(e=[e]);const n=this.options.preload||[],o=e.filter((e=>n.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return o.length?(this.options.preload=n.concat(o),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!e)return"rtl";const t=this.services&&this.services.languageUtils||new np(gp());return["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){return new Op(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},arguments.length>1?arguments[1]:void 0)}cloneInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:mp;const r=e.forkResourceStore;r&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},o=new Op(n);void 0===e.debug&&void 0===e.prefix||(o.logger=o.logger.clone(e));return["store","services","language"].forEach((e=>{o[e]=this[e]})),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},r&&(o.store=new Qc(this.store.data,n),o.services.resourceStore=o.store),o.translator=new tp(o.services,n),o.translator.on("*",(function(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];o.emit(e,...r)})),o.init(n,t),o.translator.options=n,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const bp=Op.createInstance();bp.createInstance=Op.createInstance;bp.createInstance,bp.dir,bp.init,bp.loadResources,bp.reloadResources,bp.use,bp.changeLanguage,bp.getFixedT,bp.t,bp.exists,bp.setDefaultNamespace,bp.hasLoadedNamespace,bp.loadNamespaces,bp.loadLanguages;var Ep,Sp="EMPTY_GROUP",_p="EMPTY_RULE_GROUP",Tp="EMPTY_QUERY",Rp="EMPTY_CASE",wp="NO_CONFIG_FOR_FIELD",Ip="NO_CONFIG_FOR_OPERATOR",Lp="NO_CONFIG_FOR_FUNCTION",Cp="INVALID_VALUE",Ap="INVALID_FUNC_ARG_VALUE",xp="UNSUPPORTED_FIELD_TYPE",Np="UNSUPPORTED_OPERATOR_FOR_FIELD",jp="INVALID_VALUE_SRC",Fp="INCOMPLETE_RULE",Pp="INCOMPLETE_LHS",kp="INCOMPLETE_RHS",Dp="BAD_MULTISELECT_VALUES",Vp="BAD_SELECT_VALUE",Mp="INCORRECT_VALUE_TYPE",Up="INCORRECT_VALUE_JS_TYPE",Bp="VALUE_LENGTH_CONSTRAINT_FAIL",qp="VALUE_MIN_CONSTRAINT_FAIL",Gp="VALUE_MAX_CONSTRAINT_FAIL",Kp="NO_CONFIG_FOR_FIELD_VALUE",$p="CANT_COMPARE_FIELD_WITH_ITSELF",Wp="CANT_COMPARE_FIELD_WITH_FIELD",zp="INCORRECT_FIELD_TYPE",Hp="UNSUPPORTED_FUNCTION_FOR_FIELD",Yp="REQUIRED_FUNCTION_ARG",Jp="INCORRECT_FUNCTION_RETURN_TYPE",Xp="INVALID_RANGE",Qp="ITEM_POSITION",Zp="ITEM_POSITION_ROOT",ef="ITEM_POSITION_WITH_INDEX_PATH",tf="ITEM_POSITION_IN_CASE",rf="range",nf=(M(M(M(M(M(M(M(M(M(M(Ep={},Sp,"Empty group"),_p,"No conditions for group field {{field}}"),Tp,"Empty query"),Rp,"Empty case"),wp,"No config for field {{field}}"),"FIXED_OPERATOR","Fixed operator {{from}} to {{to}} for field {{field}}"),Ip,"No config for operator {{operator}}"),Lp,"No config for function {{funcKey}}"),Cp,"Invalid value"),Ap,"Invalid value of arg {{argName}} for func {{funcName}}: {{argValidationError}}"),M(M(M(M(M(M(M(M(M(M(Ep,xp,"Type of field {{field}} is not supported"),Np,"Operator {{operator}} is not supported for field {{field}}"),Fp,"Incomplete rule"),Pp,"Incomplete LHS"),kp,"Incomplete RHS"),jp,"Invalid value src {{valueSrcs, list}}"),Dp+"_one","Value {{badValues, list}} is not in the list of allowed values"),Dp+"_other","Values {{badValues, list}} are not in the list of allowed values"),Vp,"Value {{value}} is not in the list of allowed values"),Mp,"Value should have type {{wType}}, but got value of type {{valueType}}"),M(M(M(M(M(M(M(M(M(M(Ep,Up,"Value should have JS type {{jsType}}, but got value of type {{valueTypeof}}"),Bp,"Value {{value}} should have max length {{fieldSettings.maxLength}} but got {{length}}"),qp,"Value {{value}} should be greater than or equal to {{fieldSettings.min}}"),qp+"_"+rf,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Gp,"Value {{value}} should be less than or equal to {{fieldSettings.max}}"),Gp+"_"+rf,"Value {{value}} should be from {{fieldSettings.min}} to {{fieldSettings.max}}"),Kp,"No config for field {{field}}"),$p,"Can't compare field {{field}} with itself"),Wp,"Can't compare field {{leftField}} with {{rightField}}"),zp,"Field {{field}} is of type {{type}}, but expected {{expected}}"),M(M(M(M(M(M(M(M(M(M(Ep,Hp,"Unsupported function {{funcKey}} for field {{field}}"),Yp,"Value of arg {{argName}} for func {{funcName}} is required"),Jp,"Function {{funcKey}} should return value of type {{returnType}}, but got {{valueType}}"),Xp,"Invalid range"),Zp,"Root"),Qp+"__rule","Leaf #{{globalLeafNo}}"),Qp+"__group","Group #{{globalGroupNo}}"),Qp+"__rule_group","Rule-group #{{globalNoByType}}"),Qp+"__case_group","Case #{{globalNoByType}}"),Qp+"__rule__deleted","Deleted leaf #{{globalLeafNo}}"),M(M(M(M(M(Ep,Qp+"__group__deleted","Deleted group #{{globalGroupNo}}"),Qp+"__rule_group__deleted","Deleted rule-group #{{globalNoByType}}"),Qp+"__case_group__deleted","Deleted case #{{globalNoByType}}"),tf,"{{str}} in case #{{caseNo}}"),ef,"{{str}} (index path: {{indexPath, list}})")),of="raqbvalidation",af="".concat(of,":"),sf=bp.createInstance();sf.init({fallbackLng:"en"}),sf.addResources("en",of,nf);var lf=function(e,t){return null!=e&&e.str?e.str:null!=e&&e.key?lf(e.key,e.args):null===t?e:sf.t(e.includes(":")?e:af+e,t)};const uf=sf;function cf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function pf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?cf(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):cf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ff=function(e,t){var r,n,o,i,a=e.validateValue,s=e.validateRange,l=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,u=arguments.length>3?arguments[3]:void 0,c=arguments.length>4?arguments[4]:void 0,p=arguments.length>5?arguments[5]:void 0,f=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,d=arguments.length>7&&void 0!==arguments[7]&&arguments[7],v=arguments.length>8&&void 0!==arguments[8]&&arguments[8],h=arguments.length>9&&void 0!==arguments[9]&&arguments[9];l||(l=t);var g=t.settings,y=g.keepInputOnChangeFieldSrc,m=g.convertableWidgets,O=g.clearValueOnChangeField,b=g.clearValueOnChangeOp,E="!case_value"==c,S=u.get("field");!S&&E&&(S=c);var _,T=u.get("fieldType"),R=u.get("fieldSrc"),w=u.get("operator"),I=u.get("value"),L=u.get("valueSrc",new lo.List),C=u.get("valueType",new lo.List),A=u.get("valueError",new lo.List),x=u.get("asyncListValues"),N=E,j=Li(l,w),F=Li(t,p,c),P=E?1:w?No(j):null,k=E?1:p?No(F):null,D=Ii(l,S),V=Ii(t,c),M=!S&&T&&y,U=(null==D?void 0:D.type)||T,B=(null==V?void 0:V.type)||!c&&M&&U,q=null==D?void 0:D.listValuesType,G=null==V?void 0:V.listValuesType,$=(null===(r=S)||void 0===r||null===(n=r.get)||void 0===n?void 0:n.call(r,"func"))||S,W=((null===(o=c)||void 0===o||null===(i=o.get)||void 0===i?void 0:i.call(o,"func"))||c)!=$,z=[],H=(S||M)&&(w&&p||N)&&null!=I;if((!U||!B||U!=B||"field"===f&&W&&O||"operator"===f&&b)&&(H=!1),W&&ci.includes(B)&&(G&&G===q||(H=!1)),N||(null!=I&&I.size||!k)&&(null==I||!I.size||k)||(H=!1),"func"===R&&c){var Y=K(a(t,null,null,p,c,B,R,x,d,v,h),2),J=Y[0],X=Y[1],Q=!(null!=X&&X.length),Z=J!==c,ee=!Q&&Z&&!X.find((function(e){return!e.fixed})),te=d&&!Q&&!ee&&!!f&&c!==S,re=!1;if(te?c=S:Z&&(c=J),!Q){var ne=!Q&&!ee&&!te,oe=X.find((function(e){return!e.fixed&&!e.ignore}));ne&&oe&&(_=lf(oe)),X.map((function(e){return z.push(pf(pf({side:"lhs"},e),{},{fixed:e.fixed||te||re}))}))}}for(var ie=0;ie<k;ie++){var ae=L.get(ie)||null,se=ji(l,S,w,ae),le=ji(t,c,p,ae),ue="value"===ae?se:ji(l,S,w,"value"),ce="value"===ae?le:ji(t,c,p,"value");ce==ue||(m[ue]||[]).includes(ce)||!ue&&M||(H=!1)}w!=p&&[w,p].includes("proximity")&&(H=!1);var pe=L.first(),fe=Ci(t,c,p,null,pe),de=Fi(t,c,p,null);!c&&M&&(de=Object.keys(t.settings.valueSourcesInfo));var ve,he=de[0];1===k&&fe&&void 0!==fe.type?ve=fe.type:1===k&&V&&void 0!==V.type&&(ve="!group"===V.type?"number":V.type);var ge=H&&"operator"===f&&1===P&&2===k,ye=[],me=[],Oe=[],be=Array.from({length:k},(function(){return null}));if(H)for(var Ee=function(e){var r=I.get(e),n=C.get(e)||null,o=L.get(e)||null;ge&&1===e&&(r=void 0!==ye[0]?ye[0]:I.get(0),ye[e]=r,n=C.get(0)||null,o=L.get(0)||null);var i=!o||void 0!==de.find((function(e){return e==o})),s=K(a(t,c,c,p,r,n,o,x,d,v,h),2),l=s[0],u=s[1],f=!(null!=u&&u.length),g=l!==r,y=!f&&g&&!(null!=u&&u.find((function(e){return!e.fixed}))),m=!(null!=u&&u.find((function(e){return!e.fixed&&!e.ignore}))),O=!i||d&&!f&&!y&&(!m||W);f||null==u||u.map((function(t){return z.push(pf(pf({side:"rhs",delta:e},t),{},{fixed:t.fixed||O}))})),O&&(ye[e]=null,0===e&&delete ye[1]);var b=!f&&!g,E=null==u?void 0:u.find((function(e){return!e.fixed&&!e.ignore}));b&&E&&(be[e]=lf(E)),g&&(ye[e]=l),!ge||0!==e||f||g||(ge=!1),ge&&0===e&&["func","field"].includes(o)&&(ge=!1)},Se=0;Se<k;Se++)Ee(Se);if(!H)for(var _e=0;_e<k;_e++)if(1===k){var Te,Re,we=Qo([null==V?void 0:V.defaultValue,null==V||null===(Te=V.fieldSettings)||void 0===Te?void 0:Te.defaultValue,null==fe?void 0:fe.defaultValue]);ye[_e]=we,(null!=we&&we.func||null!=we&&null!==(Re=we.get)&&void 0!==Re&&Re.call(we,"func"))&&(me[_e]="func")}for(var Ie=0;Ie<k;Ie++){var Le,Ce,Ae=H&&L.get(Ie)||null,xe=H&&C.get(Ie)||null,Ne=void 0!==ye[Ie]?ye[Ie]:H?I.get(Ie):void 0;if(H&&ge&&1===Ie)Ae=null!==(Le=me[Ie])&&void 0!==Le?Le:L.get(0),xe=null!==(Ce=Oe[Ie])&&void 0!==Ce?Ce:C.get(0),me[Ie]=Ae,Oe[Ie]=xe;de.includes(Ae)||(me[Ie]=he),xe||(Oe[Ie]=ve),null!=Ne&&Ne.func&&(ye[Ie]=ta(Ne),me[Ie]="func")}var je=I;(ye.length>0||!H||k<P)&&(je=new lo.List(Array.from({length:k},(function(e,t){return void 0!==ye[t]?ye[t]:H?I.get(t):void 0}))));var Fe=L;(me.length>0||!H||k<P)&&(Fe=new lo.List(Array.from({length:k},(function(e,t){var r;return null!==(r=me[t])&&void 0!==r?r:H&&L.get(t)||null}))));var Pe=C;(Oe.length>0||!H||k<P)&&(Pe=new lo.List(Array.from({length:k},(function(e,t){var r;return null!==(r=Oe[t])&&void 0!==r?r:H&&C.get(t)||null}))));var ke=s(t,c,p,je,Fe);if(ke){var De=lf(ke),Ve=d&&k>=2,Me=je;Ve&&(ye[1]=je.get(0),je=je.set(1,ye[1]),be[1]=be[0]),!Ve&&be.push(De),z.push(pf(pf({side:"rhs",delta:-1},ke),{},{fixed:Ve,fixedFrom:Ve?[Me.get(0),Me.get(1)]:void 0,fixedTo:Ve?[je.get(0),je.get(1)]:void 0}))}var Ue=A,Be=(null==A?void 0:A.size)!==be.length||be.filter((function(e,t){return e!=A.get(t)})).length>0;return Be&&(Ue=new lo.List(be)),{canReuseValue:H,newValue:je,newValueSrc:Fe,newValueType:Pe,operatorCardinality:k,fixedField:c,newValueError:Ue,newFieldError:_,validationErrors:z}};function df(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return vf(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?vf(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function vf(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function hf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hf(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var yf=function(e,t){return null==e||""==e?void 0:So(e)?gf(gf({},e),{},{title:e.title||e.value}):{value:e,title:void 0!==t?t:""+e}},mf=function(e){var t=yf(e);return So(t)?gf(gf({},yf(e)),{},{isCustom:!0}):t},Of=function(e){if(Array.isArray(e))return e.map((function(e){return yf(e)}));if(!So(e))return e;var t=[];for(var r in e){var n=e[r];t.push(yf(r,n))}return t},bf=function(e,t){return Array.isArray(e)?e.map((function(e){return yf(e)})).find((function(e){return""+e.value==""+t})):void 0!==e[t]?yf(t,e[t]):void 0},Ef=function(e,t){if(null==e)return t;var r=bf(e,t);return void 0!==r?r.title:t},Sf=function(e,t){if(null==e)return t;var r=bf(e,t);return void 0!==r?r.value:t},_f=function(e,t){var r=[];if(Array.isArray(e)){var n,o=df(e);try{for(o.s();!(n=o.n()).done;){var i=n.value,a=t(yf(i));null!=a&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}}else for(var s in e){var l=t(yf(s,e[s]));null!=l&&r.push(l)}return r},Tf=function(e,t){return _f(t,(function(t){return-1!="".concat(t.value).indexOf(e)||-1!=t.title.indexOf(e)?t:null})).filter((function(e){return null!==e})).shift()},Rf=function(e,t){return _f(t,(function(t){return""+t.value==""+e?t:null})).filter((function(e){return null!==e})).shift()};function wf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function If(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?wf(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):wf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Lf=function(e,t){return 0===Cf(e,t).length},Cf=function(e,t){var r=t.settings.showErrorMessage,n=[];return e&&function e(t,o,i){var a,s,l=t.get("id"),u=t.get("children1"),c=t.getIn(["properties","valueError"]),p=t.getIn(["properties","fieldError"]),f=t.getIn(["properties","field"]),d=null!==(a=null==f||null===(s=f.get)||void 0===s?void 0:s.call(f,"func"))&&void 0!==a?a:f;((null==c?void 0:c.size)>0&&c.filter((function(e){return null!=e})).size>0||!!p)&&r&&n.push(d),u&&u.map((function(t,r){t&&e(t,o.concat(l),i+1)}))}(e,[],0),Array.from(new Set(n))},Af=function(e,t){var r=el(t,void 0,!0),n={removeEmptyGroups:t.settings.removeEmptyGroupsOnLoad,removeIncompleteRules:t.settings.removeIncompleteRulesOnLoad,removeEmptyRules:t.settings.removeEmptyRulesOnLoad,forceFix:!1},o=Ff(e,null,r,r,n),i=o.fixedTree,a=o.allErrors;return o.isSanitized&&a.length&&console.warn("Tree check errors: ",a),i},xf=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=el(t,void 0,!0),o=If(If({},r),{},{removeEmptyGroups:!1,removeEmptyRules:!1,removeIncompleteRules:!1,forceFix:!1});return Ff(e,null,n,n,o).allErrors},Nf=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=el(t,void 0,!0),o=If({removeEmptyGroups:!0,removeEmptyRules:!0,removeIncompleteRules:!0,forceFix:!1},r),i=Ff(e,null,n,n,o);return{fixedTree:i.fixedTree,fixedErrors:i.fixedErrors,nonFixedErrors:i.nonFixedErrors,allErrors:i.allErrors}},jf=function(e,t,r,n,o,i,a){void 0===o&&(o=r.settings.removeEmptyGroupsOnLoad),void 0===i&&(i=r.settings.removeEmptyRulesOnLoad),void 0===a&&(a=r.settings.removeIncompleteRulesOnLoad);var s=Ff(e,t,r,n,{removeEmptyGroups:o,removeEmptyRules:i,removeIncompleteRules:a,forceFix:!1}),l=s.fixedTree,u=(s.allErrors,s.fixedErrors);s.nonFixedErrors;return s.isSanitized&&u.length&&console.warn("Fixed tree errors: ",u),l=$i(l)},Ff=function(e,t,r,n,o){if(!e)return{fixedTree:e,allErrors:[],fixedErrors:[],nonFixedErrors:[],isSanitized:!1};var i,a,s=o||{},l=s.removeEmptyGroups,u=s.removeEmptyRules,c=s.removeIncompleteRules,p=s.forceFix,f=s.translateErrors,d=void 0===f||f,v=s.includeStringifiedItems,h=void 0===v||v,g=s.stringifyFixedItems,y=void 0!==g&&g,m=s.stringifyItemsUserFriendly,O=void 0===m||m,b=s.includeItemsPositions,E=void 0===b||b,S={errors:{}},_=Df(e,[],null,S,{config:r,oldConfig:n,removeEmptyGroups:l,removeEmptyRules:u,removeIncompleteRules:c,forceFix:p}),T=S.sanitized,R=[];for(var w in E&&(i=zi(_,r).items),S.errors){var I=S.errors[w],L=I.path,C=I.errors;d&&(C=C.map((function(e){return If(If({},e),{},{str:lf(e)})})));var A={path:L,errors:C};if(h){var x=qi(y?_:e,L);if(!(1===L.length)&&"group"!==x.get("type")){var N=Cu(x,r,O,!0);A.itemStr=N}}if(E){var j=i[w],F=!j;if(F&&(a||(a=zi(e,r).items),j=a[w]),j){var P=If(If({},j.position),{},{index:j.index,type:j.type,isDeleted:F});A.itemPosition=P;var k=j.index?Qp+"__"+j.type+(F?"__deleted":""):Zp,D=If({},P);if(O){for(var V,M=0,U=["caseNo","globalLeafNo","globalGroupNo","globalNoByType"];M<U.length;M++){var B=U[M];null!=D[B]&&(D[B]=D[B]+1)}D.indexPath=null===(V=P.indexPath)||void 0===V?void 0:V.map((function(e){return e+1}))}A.itemPositionStr=lf(k,D),j.index&&(j.caseId&&"case_group"!==j.type&&(A.itemPositionStr=lf(tf,If(If({},D),{},{str:A.itemPositionStr}))),"case_group"!==j.type&&(A.itemPositionStr=lf(ef,If(If({},D),{},{str:A.itemPositionStr}))))}}R.push(A)}for(var q=[],G=[],K=0,$=R;K<$.length;K++){var W=$[K],z=W.errors.filter((function(e){return!!e.fixed})),H=W.errors.filter((function(e){return!e.fixed&&"EMPTY_QUERY"!==e.key}));z.length&&q.push(If(If({},W),{},{errors:z})),H.length&&G.push(If(If({},W),{},{errors:H}))}return{fixedTree:_,allErrors:R,fixedErrors:q,nonFixedErrors:G,isSanitized:T}};function Pf(e,t,r,n){var o=t.get("id");e.errors[o]||(e.errors[o]={path:[].concat(W(r),[o]),errors:[]}),e.errors[o].errors.push(n)}function kf(e,t){var r=t.get("id");e.errors[r]&&e.errors[r].errors.map((function(e){e.fixed=!0}))}function Df(e,t,r,n,o){var i=null==e?void 0:e.get("type");return"group"===i||"rule_group"===i||"case_group"==i||"switch_group"==i?function(e,t,r,n,o){var i,a,s,l,u,c,p=o.removeEmptyGroups,f=o.removeIncompleteRules,d=(o.forceFix,o.config),v=(d.settings.showErrorMessage,e.get("id")),h=e.get("children1"),g=!t.length,y=h,m=e.get("type"),O=e.get("properties"),b=null==O?void 0:O.get("field"),E=null==O?void 0:O.get("mode"),S=null==O||null===(i=O.get)||void 0===i?void 0:i.call(O,"operator"),_="rule_group"===m&&"array"===E,T="case_group"===m,R=T&&null==h,w=S?null!==(a=null===(s=d.operators[S])||void 0===s?void 0:s.cardinality)&&void 0!==a?a:1:void 0,I=T?!R:_?0==w:p,L=_||T;!v&&r&&(v=r,e=e.set("id",v),n.sanitized=!0);L&&(e=Vf(e,t,r,n,o));var C={errors:{}};h=null===(l=h)||void 0===l?void 0:l.map((function(e,r){return Df(e,t.concat(v),r,C,o)}));var A=null===(u=h)||void 0===u?void 0:u.filter((function(e){return null!=e}));p&&(h=A);var x=C.sanitized||(null==y?void 0:y.size)!=(null===(c=h)||void 0===c?void 0:c.size),N=!(null!=A&&A.size),j=p&&!g;_&&b&&(j=f);N&&I&&(Pf(n,e,t,{key:g?Tp:T?Rp:_?_p:Sp,args:{field:b},fixed:j}),j&&(kf(n,e),e=void 0));x&&(n.sanitized=!0);x&&e&&(e=e.set("children1",h));return n.errors=If(If({},n.errors),(null==C?void 0:C.errors)||{}),e}(e,t,r,n,o):"rule"===i?Vf(e,t,r,n,o):e}function Vf(e,t,r,n,o){var i=o.removeIncompleteRules,a=o.removeEmptyRules,s=o.forceFix,l=o.config,u=o.oldConfig,c=l.settings.showErrorMessage,p=!c||s,f=e.get("id"),d="case_group"===e.get("type"),v=e.get("properties");if(!v){if(!d)return void Pf(n,e,t,{key:Fp,args:{},fixed:i||a});v=new lo.Map}var h=v.get("field")||null;d&&(h="!case_value");var g=v.get("fieldSrc")||null,y=v.get("operator")||null,m=v.get("operatorOptions"),O=v.get("valueSrc"),b=v.get("value"),E=v.get("valueError"),S=v.get("fieldError"),_=function(){var e,t;return{field:(null===(e=h)||void 0===e||null===(t=e.toJS)||void 0===t?void 0:t.call(e))||h,fieldSrc:g,operator:y,operatorOptions:m?m.toJS():{},valueSrc:O?O.toJS():null,value:b?b.toJS():null,valueError:E?E.toJS():null,fieldError:S||null}},T=_();!f&&r&&(f=r,e=e.set("id",f),n.sanitized=!0);var R=h?Ii(l,h):null;h&&!R&&(Pf(n,e,t,{key:wp,args:{field:h},side:"lhs",fixed:i||a}),h=null),null!=h||d||(v=["operator","operatorOptions","valueSrc","value","valueError","fieldError","field"].reduce((function(e,t){return e.delete(t)}),v),y=null),g||!h||d||(g=wi(h),v=v.set("fieldSrc",g)),"range_between"!==y&&"range_not_between"!==y||(y="range_between"===y?"between":"not_between",v=v.set("operator",y));var w=y?Li(l,y,h):null;y&&!w&&(Pf(n,e,t,{key:Ip,args:{operator:y},side:"op",fixed:i||a}),y=null);var I=h?Di(l,h):[];h&&!d&&(null!=I&&I.length?y&&-1==I.indexOf(y)&&("is_empty"===y||"is_not_empty"===y?(y="is_empty"===y?"is_null":"is_not_null",v=v.set("operator",y)):(Pf(n,e,t,{key:Np,args:{operator:y,field:h},side:"lhs",fixed:i||a}),y=null)):(Pf(n,e,t,{key:xp,args:{field:h},side:"lhs",fixed:i||a}),y=null)),null!=y||d||(v=["operatorOptions","valueSrc","value","valueError"].reduce((function(e,t){return e.delete(t)}),v)),m=v.get("operatorOptions"),!y||m&&!w.options?(m=null,v=v.delete("operatorOptions")):y&&!m&&w.options&&(m=na(l,y,h),v=v.set("operatorOptions",m)),O=v.get("valueSrc"),b=v.get("value");var L=ff({validateValue:Mf,validateRange:Gf},l,u,v,h,y,null,p,!0),C=L.newValue,A=L.newValueSrc,x=L.newValueError,N=L.validationErrors,j=L.newFieldError,F=L.fixedField;b=C,O=A,E=x,S=j,h=F,v=(v=(v=v.set("field",h)).set("value",b)).set("valueSrc",O),v=c?v.set("valueError",E).set("fieldError",S):v.delete("valueError").delete("fieldError");var P=_(),k=!jo(T,P),D=Ia(v.toObject(),l),V=d?D.parts.value:D.score>=3;if(k&&(n.sanitized=!0,e=e.set("properties",v)),null==N||N.map((function(r){return Pf(n,e,t,r)})),!V)if(d);else{var M=D.score?i:a,U={key:Fp,args:{}};if(D.parts.field){if(!D.parts.value){var B,q,G,K;U.key=kp,U.side="rhs",null!==(B=P.valueSrc)&&void 0!==B&&B[0]&&(null===(q=P.valueSrc)||void 0===q?void 0:q[0])!=(null===(G=T.valueSrc)||void 0===G?void 0:G[0])&&null!=(null===(K=P.value)||void 0===K?void 0:K[0])&&(U.key=jp,U.args={valueSrcs:P.valueSrc})}}else U.key=Pp,U.side="lhs";U.fixed=M,Pf(n,e,t,U),M&&(kf(n,e),e=void 0)}return e}var Mf=function(e,t,r,n,o,i,a,s){var l=arguments.length>8&&void 0!==arguments[8]&&arguments[8],u=arguments.length>9&&void 0!==arguments[9]&&arguments[9],c=arguments.length>10&&void 0!==arguments[10]&&arguments[10],p=[],f=o;if(null!=o){var d,v,h,g;if("field"===a){var y=K(Bf(t,r,o,a,i,s,e,n,l,u),2);f=y[0],p=y[1]}else if("func"===a){var m=K(qf(t,r,o,a,i,s,e,n,l,u,c),2);f=m[0],p=m[1]}else if("value"===a||!a){var O=K(Uf(r,o,a,i,s,e,n,l,u),2);f=O[0],p=O[1]}var b=!(null!==(d=p)&&void 0!==d&&d.find((function(e){return!e.fixed})));if(!!r&&!["field","func"].includes(a)&&(!(null!==(v=p)&&void 0!==v&&v.length)||b)){var E=ji(e,r,n,a),S=n?Li(e,n,r):null,_=Ci(e,r,n,E,a,{forExport:!0}),T="field"===a?Ii(e,o):null,R=_,w=_.validateValue;if("function"==typeof w){var I=[f,R,n,S];"field"===a&&I.push(T);var L,C,A=w.call.apply(w,[e.ctx].concat(I));if("object"!==D(A)||null===A||Array.isArray(A))"boolean"==typeof A?0==A&&p.push({key:Cp,args:{}}):"string"==typeof A&&p.push({key:A,args:null});else C=null!==(L=A.error)&&void 0!==L&&L.key?If({},A.error):{key:A.error,args:null},void 0!==A.fixedValue&&l&&(C.fixed=!0,C.fixedFrom=f,C.fixedTo=A.fixedValue,f=A.fixedValue),p.push(C)}}if(b=!(null!==(h=p)&&void 0!==h&&h.find((function(e){return!e.fixed}))),null!==(g=p)&&void 0!==g&&g.length&&!b&&l){var x=Ii(e,r),N=null==x?void 0:x.fieldSettings,j=null==N?void 0:N.defaultValue;if(void 0!==j){var F=p[p.length-1];F.fixed=!0,F.fixedFrom=f,F.fixedTo=j,f=j,p.map((function(e){e.fixed=!0}))}}}return[f,p]},Uf=function(e,t,r,n,o,i){var a=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=[],u=t;if(e){var c=Ii(i,e),p=ji(i,e,a,r),f=i.widgets[p],d=null==f?void 0:f.type,v=null==f?void 0:f.jsType,h=null==c?void 0:c.fieldSettings,g=(null==h?void 0:h.treeValues)||(null==h?void 0:h.listValues),y=!(null==h||!h.asyncFetch),m=g||y;if(n&&d&&n!=d)return l.push({key:Mp,args:{wType:d,valueType:n}}),[t,l];if(v&&!Ro(t,v)&&!m)return l.push({key:Up,args:{jsType:v,valueTypeof:To(t)}}),[t,l];if(h){var O=o||g;if(O&&!h.allowCustomValues&&"case_value"!==p){var b=function(e,t,r,n,o){var i=lo.List.isList(e)?e.toJS():e instanceof Array?W(e):void 0,a=e,s=[];if(i){var l=i.reduce((function(e,r){var n=K(e,2),o=n[0],i=n[1],a=bf(t,r);return null==a?[o,[].concat(W(i),[r])]:[[].concat(W(o),[a.value]),i]}),[[],[]]),u=K(l,2),c=u[0],p=u[1],f=p.length>0;if(a=(r=r||!0===o)&&f?c:e,p.length){var d=r&&f;s.push({key:Dp,args:{badValues:p,count:p.length},fixed:d,fixedFrom:d?i:void 0,fixedTo:d?a:void 0})}return[a,s]}var v=bf(t,e);return null==v?(a=r?null:e,s.push({key:Vp,args:{value:e},fixed:r,fixedFrom:r?e:void 0,fixedTo:r?a:void 0})):a=v.value,[a,s]}(t,O,s,0,i.settings.removeInvalidMultiSelectValuesOnLoad),E=K(b,2);u=E[0],l=E[1]}h.maxLength>0&&null!=t&&String(t).length>h.maxLength&&(u=s?String(t).substring(0,h.maxLength):t,l.push({key:Bp,args:{value:t,length:String(t).length,fieldSettings:h},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?u:void 0}));var S=null!=h.min&&null!=h.max?rf:void 0;null!=h.min&&t<h.min&&(u=s?h.min:t,l.push({key:qp,args:{value:t,fieldSettings:h,context:S},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?u:void 0})),null!=h.max&&t>h.max&&(u=s?h.max:t,l.push({key:Gp,args:{value:t,fieldSettings:h,context:S},fixed:s,fixedFrom:s?t:void 0,fixedTo:s?u:void 0}))}}return[u,l]},Bf=function(e,t,r,n,o,i,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,l=[],u=a.settings,c=u.fieldSeparator,p=u.canCompareFieldWithField,f="object"==D(t)&&(null==t?void 0:t._isFuncArg),d=Array.isArray(e)?e.join(c):e,v=Ii(a,e),h=Array.isArray(r)?r.join(c):r,g=Ii(a,r);if(!g)return l.push({key:Kp,args:{field:h}}),[r,l];if(e&&h===d&&!f)return l.push({key:$p,args:{field:d}}),[r,l];if(o&&o!=g.type)return l.push({key:zp,args:{field:h,type:g.type,expected:o}}),[r,l];if(e&&!f&&p&&!p(d,v,h,g,s))return l.push({key:Wp,args:{leftField:d,rightField:h}}),[r,l];return[r]},qf=function(e,t,r,n,o,i,a){var s,l,u=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null,c=arguments.length>8&&void 0!==arguments[8]&&arguments[8],p=arguments.length>9&&void 0!==arguments[9]&&arguments[9],f=arguments.length>10&&void 0!==arguments[10]&&arguments[10],d=r,v=[];if(!r)return[r];var h=null===(s=r.get)||void 0===s?void 0:s.call(r,"func");if(!h)return[r];var g=Ii(a,t);if(null!=g&&g.funcs&&!g.funcs.includes(h))return v.push({key:Hp,args:{funcKey:h,field:t}}),[r,v];var y=yi(a,h);if(!y)return v.push({key:Lp,args:{funcKey:h}}),[r,v];var m=null!==(l=y.label)&&void 0!==l?l:h;if(o&&y.returnType!=o)return v.push({key:Jp,args:{funcKey:h,funcName:m,returnType:y.returnType,valueType:o}}),[r,v];for(var O in c=c||f,y.args){var b,E=y.args[O],S=d.get("args"),_=S?S.get(O):void 0,T=Ii(a,E),R=null!==(b=null==T?void 0:T.label)&&void 0!==b?b:O,w=_?_.get("value"):void 0,I=_?_.get("valueSrc"):void 0;if(void 0!==w){var L=K(Mf(a,e,T,u,w,E.type,I,i,c,p,f),2),C=L[0],A=L[1],x=!(null!=A&&A.length),N=c&&C!==w,j=c&&!x&&!N&&(p||f);if(N&&(d=d.setIn(["args",O,"value"],C)),j&&(d=d.deleteIn(["args",O]),d=Pa(a,d,y,O)),!x){var F,P,k=null!==(F=null!==(P=A.find((function(e){return!e.fixed&&!e.ignore})))&&void 0!==P?P:A.find((function(e){return!e.fixed})))&&void 0!==F?F:A[0],D=N||j,V=0===A.filter((function(e){return!e.ignore})).length;if(k){var M=lf(k);v.push({key:Ap,args:{funcKey:h,funcName:m,argKey:O,argName:R,argValidationError:M,argErrors:A},ignore:V,fixed:D,fixedFrom:D?w:void 0,fixedTo:D?N?C:E.defaultValue:void 0})}}}else if(!E.isOptional&&(p||f)){var U=c&&void 0!==E.defaultValue&&(p||f);p&&v.push({key:Yp,args:{funcKey:h,funcName:m,argKey:O,argName:R},fixed:U,fixedTo:U?E.defaultValue:void 0,ignore:!U}),U&&(d=d.deleteIn(["args",O]),d=Pa(a,d,y,O))}}return[d,v]},Gf=function(e,t,r,n,o){var i,a=Li(e,r,t),s=r?No(a):null,l=o.toJS?o.toJS():o,u=n.toJS?n.toJS():n,c=l.filter((function(e){return"value"==e||null==e})).length==s;if(null!=a&&a.validateValues&&c){var p=l[0],f=ji(e,t,r,p),d=Ci(e,t,r,f,p),v=null!=d&&d.toJS?u.map((function(t){var r=d.toJS.call(e.ctx,t,d);return r instanceof Date&&(r=r.getTime()),r})):u,h=a.validateValues(v);"boolean"==typeof h&&0==h&&(i={key:Xp,args:{jsValues:v,values:u}})}return i},Kf=function(e,t,r,n){var o=r.settings.fieldSeparator;e=e||new lo.Map,Array.isArray(t)&&(t=t.join(o));var i=e.get("func"),a=e.get("args");e=e.set("func",t);var s=t&&yi(r,t),l=t&&gi(r,t),u=i&&gi(r,i),c=zf(u,l,a,r,n);c.length?e=Object.keys(l.args).filter((function(e){return!c.includes(e)})).reduce((function(e,t){return e.deleteIn(["args",t])}),e):e=e.set("args",new lo.Map);return e=Fa(r,e,s)},$f=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t],new lo.Map({valueSrc:r}))),e},Wf=function(e,t,r,n,o){return e&&e.get("func")&&(e=e.setIn(["args",t,"asyncListValues"],r)),e},zf=function(e,t,r,n){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if((null==e?void 0:e.returnType)!=(null==t?void 0:t.returnType))return[];return Object.keys(t.args).filter((function(i,a){var s=t.args[i],l=e.args[i];Object.keys(e.args).indexOf(i);if(!l&&(void 0!==s.defaultValue||s.isOptional))return!0;if((null==l?void 0:l.type)!=s.type)return!1;if(ci.includes(s.type)&&(!l.listValuesType||l.listValuesType!==s.listValuesType))return!1;if(r){var u,c=r.get(i),p=null==c?void 0:c.get("value"),f=null==c?void 0:c.get("valueSrc");if(f&&s.valueSources&&!s.valueSources.includes(f))return!1;var d=K(Mf(n,null,s,null,p,s.type,f,null,o,!0),2),v=(d[0],d[1]);if(null!=v&&null!==(u=v.filter((function(e){return!e.fixed})))&&void 0!==u&&u.length)return!1}return!0}))};function Hf(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Yf(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Hf(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Hf(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Jf=function(e){var t,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],s=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=null,u=null,c=null,p=e.settings.showErrorMessage;i?(c=null==i||null===(t=i.properties)||void 0===t?void 0:t.fieldSrc,l=null==i||null===(r=i.properties)||void 0===r?void 0:r.field,u=null==i||null===(n=i.properties)||void 0===n?void 0:n.operator):a?(c=(l=aa(e,s,o))?Do(l)?"func":"field":la(e),u=ua(e,l,!0)):c=la(e);var f=new lo.Map({fieldSrc:c,field:l,operator:u,value:new lo.List,valueSrc:new lo.List,operatorOptions:na(e,u,l)});if(p&&(f=f.set("valueError",new lo.List)),l&&u){var d=ff({validateValue:Mf,validateRange:Gf},e,e,f,l,u,"operator",!1),v=d.newValue,h=d.newValueSrc,g=d.newValueType,y=d.newValueError,m=d.newFieldError;f=f.set("value",v).set("valueSrc",h).set("valueType",g),p&&(f=f.set("valueError",y).set("fieldError",m))}var O=Ii(e,l);if("!group"===(null==O?void 0:O.type)){var b=oa(e,O);f=f.set("conjunction",b)}return f},Xf=function(e,t){return"group"==(null==t?void 0:t.type)?ia(e):Jf(e,null,t)},Qf=function(e,t){return M({},e,new lo.Map({type:"rule",id:e,properties:Jf(t)}))},Zf=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return new lo.Map({type:"group",id:co(),children1:new lo.OrderedMap(t?Yf({},Qf(co(),e)):{}),properties:ia(e)})};function ed(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}var td=["title","value","disabled","groupTitle","grouplabel","renderTitle","children","label","isCustom","isHidden"];function rd(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return nd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?nd(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function nd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function od(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function id(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?od(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):od(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ad=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3;return function(){var n,o=(n=ti().mark((function n(o,i,a){var s,l,u,c,p,f,d;return ti().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(!r){n.next=3;break}return n.next=3,zo(r);case 3:if(null==a||!a.fetchSelectedValues||!Array.isArray(o)){n.next=7;break}return s=Of(e).filter((function(e){var t=e.value;return o.includes(t)})),n.abrupt("return",{values:s});case 7:return l=null!=(null==a?void 0:a.pageSize)?a.pageSize:t,u=Of(e).filter((function(e){var t=e.title,r=e.value;return null==o||-1!=t.toUpperCase().indexOf(o.toUpperCase())||-1!="".concat(r).toUpperCase().indexOf(o.toUpperCase())})),l&&Math.ceil(u.length/l),c=i||0,l&&Math.ceil(c/l),p=l?u.slice(c,c+l):u,f=l?c+p.length:null,d=!!l&&f<u.length,n.abrupt("return",{values:p,hasMore:d});case 16:case"end":return n.stop()}}),n)})),function(){var e=this,t=arguments;return new Promise((function(r,o){var i=n.apply(e,t);function a(e){ed(i,r,o,a,s,"next",e)}function s(e){ed(i,r,o,a,s,"throw",e)}a(void 0)}))});return function(e,t,r){return o.apply(this,arguments)}}()},sd=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!t)return e;var o=e||[],i=t.filter((function(e){return null==o.find((function(t){return""+t.value==""+e.value}))})).map((function(e){return n?id(id({},e),{},{isHidden:!0}):e}));return r?[].concat(W(i),W(o)):[].concat(W(o),W(i))},ld=function(e,t,r){var n,o=null==e||""==e?void 0:null!==(n=null==e?void 0:e.value)&&void 0!==n?n:e,i=Rf(o,t),a=r&&!i?mf(o):void 0,s=i||a;return[o,s?[s]:void 0]},ud=function(e,t,r){var n=e.map((function(e,n){var o,i=null==e||""==e?void 0:null!==(o=null==e?void 0:e.value)&&void 0!==o?o:e,a=Rf(i,t),s=r&&!a?mf(i):void 0;return a||s})).filter((function(e){return null!=e})),o=n.map((function(e){var t;return null!==(t=null==e?void 0:e.value)&&void 0!==t?t:e}));return o.length||(o=void 0),[o,n]},cd=function(e){if(null==e)return null;var t=e.title,r=e.value,n=e.disabled,o=e.groupTitle,i=e.grouplabel,a=e.renderTitle,s=e.children,l=e.label,u=e.isCustom,c=e.isHidden,p=function(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}(e,td),f={value:r,title:t||l||s};return n&&(f.disabled=n),u&&(f.isCustom=u),c&&(f.isHidden=c),(o||i)&&(f.groupTitle=o||i),a&&(f.renderTitle=a),f=id(id({},f),p)},pd=function(e){var t,r=[],n=[],o=rd(e);try{var i=function(){var e=t.value,o=function(e,t){if(e.findLastIndex)return e.findLastIndex(t);var r=W(e).reverse().findIndex(t);return-1==r?-1:e.length-1-r}(r,(function(t){var r,n;return(null!==(r=t.groupTitle)&&void 0!==r?r:"")==(null!==(n=e.groupTitle)&&void 0!==n?n:"")}));null==e.groupTitle||n.includes(e.groupTitle)||(n.push(e.groupTitle),1===n.length&&(r=r.map((function(e){return id(id({},e),{},{groupTitle:""})})))),null==e.groupTitle&&n.length&&(e=id(id({},e),{},{groupTitle:""})),-1!=o?r.splice(o+1,0,e):r.push(e)};for(o.s();!(t=o.n()).done;)i()}catch(e){o.e(e)}finally{o.f()}return r};function fd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function dd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?fd(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):fd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function vd(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return hd(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hd(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function hd(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var gd=pi,yd=Zo,md=["between","not_between","is_empty","is_not_empty","is_null","is_not_null","some","all","none"],Od=["proximity"],bd=function(e,t){var r,n=[],o="",i=e.type,a=e.methodName,s=(e.val,e.obj),l=e.args,u=e.isVar,c=e.cls,p=e.children,f=null==p?void 0:p[p.length-1],d=t[t.length-1];if("!func"===i){for(var v=s;v;){var h,g=K(bd(dd(dd({},v),{},{obj:null}),[{}]),2),y=g[0],m=g[1];if("?"!==y){var O={s:d.s,params:W(d.params),objs:W(d.objs)};d.objs.unshift("?"),d.params.unshift(v),t.push(O),d=t[t.length-1]}d.objs.unshift(y),(h=d.params).unshift.apply(h,W(m)),v="!func"===v.type?v.obj:null}var b,E=vd(t);try{for(E.s();!(b=E.n()).done;){var S,_=b.value;n=[].concat(W((null==_?void 0:_.params)||[]),W(l||[])),o="",null!=_&&null!==(S=_.objs)&&void 0!==S&&S.length&&(o+=_.objs.join(".")+"."),o+=(u?"#":"")+a,o+="("+(l||[]).map((function(e){return"?"})).join(", ")+")",_.s=o,_.params=n}}catch(e){E.e(e)}finally{E.f()}}else"!new"===i?(n=l||[],o="new ".concat(c.join("."),"(").concat(n.map((function(e){return"?"})).join(", "),")")):"!type"===i?o="T(".concat(c.join("."),")"):"compound"===i&&"property"===f.type&&(r=f.val,["length"].includes(r))?o=p.map((function(e){var t;if(e===f)return e.val;var r=K(bd(dd(dd({},e),{},{obj:null}),[{}]),2),o=r[0],i=r[1];return(t=n).push.apply(t,W(i)),o})).join("."):(n=[e],o="?");return d&&(d.s=o,d.params=n),[o,n]};function Ed(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Sd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Ed(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ed(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var _d=n.isObject,Td=n.uuid,Rd=g.defaultConjunction,wd=f.getFieldConfig,Id=f.getWidgetForFieldOp,Ld=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return{type:"group",id:Td(),children1:M({},e.id,e),properties:{conjunction:Rd(t),not:r||!1}}},Cd=function(e,t,r,n,o){var i,a=xd(n,o,r,t,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null);return e?(i=e).type?("group"!=i.type&&"case_group"!=i.type&&(i=Ld(i,n)),i.type="case_group"):(o.errors.push("Unexpected case: ".concat(JSON.stringify(i))),i=void 0):i={id:Td(),type:"case_group",properties:{}},i&&(i.properties=Sd(Sd({},i.properties),a)),i},Ad=function(e,t,r,n){var o={},i=Cd(null,e,t,r,n);return i&&(o[i.id]=i),{type:"switch_group",id:Td(),children1:o,properties:{}}},xd=function(e,t,r,n){var o,i,a,s={},l=wd(e,"!case_value");"case_value"===(null==n?void 0:n.valueType)?o="case_value":(o=null==l?void 0:l.mainWidget,i=e.widgets[o],n&&"value"===n.valueSrc&&(n.valueType=(null===(a=i)||void 0===a?void 0:a.type)||(null==l?void 0:l.type)||n.valueType));var u=e.widgets[o];if("case_value"===o){var c=null==u?void 0:u.spelImportValue;if(c){var p,f=K(c.call(e.ctx,n),2),d=f[0];if(f[1].map((function(e){return t.errors.push(e)})),null!=d)s={value:[d],valueSrc:["value"],valueType:[null!==(p=null==u?void 0:u.type)&&void 0!==p?p:"case_value"],field:"!case_value"}}}else null!=n&&null!=(null==n?void 0:n.value)&&(s={value:[n.value],valueSrc:[n.valueSrc],valueType:[n.valueType],field:"!case_value"});return s},Nd=function(e,t,r,n,o,i){var a,s;if(!o.filter((function(e){return void 0===e})).length){var l=null!==(a=r)&&void 0!==a&&a.func?"func":"field";_d(r)&&r.valueSrc&&(l=r.valueSrc,r=r.value);var u=wd(e,r);if(u){var c=wd(e,null==i?void 0:i._groupField),p="!group"==u.type,f=(p&&u.mode,"!group"==(null==c?void 0:c.type)),d=e.operators[n],v=e.operators[null===(s=d)||void 0===s?void 0:s.reversedOp],h=(null==i?void 0:i.not)&&["between"].includes(n),g=!!v&&(!!e.settings.reverseOperatorsForNot||h||!p&&f);((null==i?void 0:i.not)&&g||h)&&(n=d.reversedOp,d=e.operators[n],i.not=!i.not);var y=!(null==i||!i.not),m=Id(e,r,n),O=e.widgets[m||u.mainWidget],b=o.map((function(e){return e.asyncListValues})).filter((function(e){return null!=e})),E=b.length?b[0]:void 0,S={type:"rule",id:Td(),properties:Sd({field:r,fieldSrc:l,operator:n,value:o.map((function(e){return e.value})),valueSrc:o.map((function(e){return e.valueSrc})),valueType:o.map((function(e){return"value"==e.valueSrc&&((null==O?void 0:O.type)||(null==u?void 0:u.type))||e.valueType}))},E?{asyncListValues:E}:{})};return y&&(S=Ld(S,e,i.not)),S}t.errors.push("No config for field ".concat(r))}};function jd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jd(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Pd=Zo,kd=function(e,t){var r,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=e.getType(),i=e.getChildren().map((function(r){return kd(r,t,e)}));if("op-or"!=o&&"op-and"!=o||(i=i.reduce((function(e,t){var r="op-and"==t.type&&2==t.children.length&&"op-ge"==t.children[0].type&&"op-le"==t.children[1].type,n="op-or"==t.type&&2==t.children.length&&"op-lt"==t.children[0].type&&"op-gt"==t.children[1].type,i=r||n,a=t.type==o&&!t.not&&!i?t.children:[t];return[].concat(W(e),W(a))}),[])),"op-not"==o)return 1!=i.length&&t.errors.push("Operator NOT should have 1 child, but got ".concat(i.length,"}")),Fd(Fd({},i[0]),{},{not:!i[0].not});if("compound"==o){var a=(i=i.filter((function(e){return!("selection"==e.type&&1==e.children.length&&"boolean"==e.children[0].type&&1==e.children[0].val)}))).find((function(e){return"selection"==e.type}));a&&1!=a.children.length&&t.errors.push("Selection should have 1 child, but got ".concat(a.children.length));var s=a?a.children[0]:null,l=i[i.length-1],u="method"==l.type&&"size"==l.val.methodName||"!func"==l.type&&"size"==l.methodName,c="property"==l.type&&"length"==l.val,p=i.filter((function(e){return e!==a&&e!==l})),f={type:"compound",children:p};if((u||c)&&null!=Vd(p))return{type:"!aggr",filter:s,source:f};if(i=(i=i.filter((function(e){var t="variable"==e.type&&"this"==e.val,r="variable"==e.type&&"root"==e.val;return!(t||r)}))).map((function(e){return"indexer"==e.type&&1==e.children.length?{type:"indexer",val:e.children[0].val,itype:e.children[0].type}:e})),"!func"==l.type){var d={},v=d;do{var h,g;Object.assign(v,l),i=i.filter((function(e){return e!==l})),"!func"==(null===(h=l=i[i.length-1])||void 0===h?void 0:h.type)?(v.obj={},v=v.obj):i.length>1?v.obj={type:"compound",children:i}:v.obj=l}while("!func"==(null===(g=l)||void 0===g?void 0:g.type));return d}}try{e.getRaw?r=e.getRaw():0==e.getValue.length&&(r=e.getValue())}catch(e){Pd.error("[spel2js] Error in getValue()",e)}if("ternary"==o&&(r=Dd(i)),"object"===D(r)&&null!==r&&(r.methodName||r.functionName)&&(r.args=r.args.map((function(r){return kd(r,t,e)}))),"list"==o&&(r=r.map((function(r){return kd(r,t,e)})),!n&&1==r.length))return r[0];if("constructorref"==o){var y=i.find((function(e){return"qualifiedidentifier"==e.type})),m=null==y?void 0:y.val;return m?{type:"!new",cls:m,args:i.filter((function(e){return"qualifiedidentifier"!=e.type}))}:void t.errors.push("Can't find qualifiedidentifier in constructorref children: ".concat(JSON.stringify(i)))}if("typeref"==o){var O=i.find((function(e){return"qualifiedidentifier"==e.type})),b=null==O?void 0:O.val;if(!b)return void t.errors.push("Can't find qualifiedidentifier in typeref children: ".concat(JSON.stringify(i)));i.filter((function(e){return"qualifiedidentifier"!=e.type}));return{type:"!type",cls:b}}if("function"==o||"method"==o){var E=r,S=E.functionName,_=E.methodName,T=E.args;return{type:"!func",methodName:S||_,isVar:"function"==o,args:T}}return{type:o,children:i,val:r}},Dd=function(e){var t=[];return function e(r){var n=K(r,3),o=n[0],i=n[1],a=n[2];t.push([o,i]),"ternary"==(null==a?void 0:a.type)?e(a.children):t.push([void 0,a])}(e),t},Vd=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,o=e.map((function(e){if("variable"==e.type||"property"==e.type||"indexer"==e.type&&"string"==e.itype)return e.val;var o,i;n=!0,r&&(null==t||null===(o=t.errors)||void 0===o||null===(i=o.push)||void 0===i||i.call(o,"Unexpected item in field path compound: ".concat(JSON.stringify(e))))}));return n?void 0:o};function Md(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Ud(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ud(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Ud(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Bd(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function qd(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Bd(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Bd(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Gd=n.isJsonCompatible,Kd=n.isObject,$d=n.uuid,Wd=n.logger,zd=f.getFieldConfig,Hd=f.getFuncConfig,Yd=f.normalizeField,Jd=f.iterateFuncs,Xd=f.getWidgetForFieldOp,Qd={number:"number",string:"text",boolean:"boolean",null:"null"},Zd={String:"text"},ev=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(e){e._groupField=null!==(o=e._groupField)&&void 0!==o?o:null==i?void 0:i._groupField;var a,s=!0;if(0===e.type.indexOf("op-")||"matches"===e.type)a=tv(e,t,r,n,i);else if("!aggr"==e.type){var l,u=ev(e.source,t,r,n,e);e._groupField=null==u?void 0:u.value;var c=ev(e.filter,t,r,n,e);"rule"==(null===(l=c)||void 0===l?void 0:l.type)&&(c=Ld(c,r,e.filter.not)),a={groupFilter:c,groupFieldValue:u},i||(a=void 0,n.errors.push("Unexpected !aggr in root"),s=!1)}else if("ternary"==e.type){var p={};e.val.forEach((function(o){var i=K(o,2),a=i[0],s=i[1],l=ev(a,t,r,n,e),u=sv(s,t,r,n,e),c=Cd(l,u,t,r,n,e);c&&(p[c.id]=c)})),a={type:"switch_group",id:$d(),children1:p,properties:{}}}if(!a&&s&&(a=rv(e,t,r,n,i)),a&&!a.type&&!i){var f=sv(e,t,r,n),d=Ad(f,t,r,n);d?a=d:(a=void 0,n.errors.push("Can't convert rule of type ".concat(e.type,", it looks like var/literal")))}return a}},tv=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=e.type.startsWith("op-")?e.type.slice(3):e.type;if(("minus"==a||"plus"==a)&&1==e.children.length){var s=e.negative;return"minus"==a&&(s=!s),e.children[0].negative=s,ev(e.children[0],t,r,n,i)}var l="and"==a&&2==e.children.length&&"op-ge"==e.children[0].type&&"op-le"==e.children[1].type,u="or"==a&&2==e.children.length&&"op-lt"==e.children[0].type&&"op-gt"==e.children[1].type;if(l||u){var c=K(e.children[0].children,2),p=c[0],f=c[1],d=K(e.children[1].children,2),v=d[0],h=d[1];if(av(p,v,e,t,r,n,i)){f.val,h.val;var g={type:"op-between",children:[p,f,h],not:u};return g._groupField=null==i?void 0:i._groupField,tv(g,t,r,n,i)}}var y=t.operators[a];"eq"==a&&"null"==e.children[1].type?y=["is_null"]:"ne"==a&&"null"==e.children[1].type?y=["is_not_null"]:"le"==a&&"string"==e.children[1].type&&""==e.children[1].val?y=["is_empty"]:"gt"==a&&"string"==e.children[1].type&&""==e.children[1].val?y=["is_not_empty"]:"between"==a&&(y=["between"]);var m=function(){var o,i=e.children.map((function(o){return ev(o,t,r,n,e)}));return i.length>=2&&"!compare"==(null===(o=i)||void 0===o||null===(o=o[0])||void 0===o?void 0:o.type)&&(i=i[0].children),i};if("and"==a||"or"==a){var O={};m().forEach((function(e){if(e){var t=$d();e.id=t,null!=e.type?O[t]=e:n.errors.push("Bad item in AND/OR: ".concat(JSON.stringify(e)))}})),o={type:"group",id:$d(),children1:O,properties:{conjunction:t.conjunctions[a],not:e.not}}}else if(y){var b,E,S,_=m(),T=_[0],R=_.slice(1),w=null==T||null===(b=T.groupFieldValue)||void 0===b?void 0:b.value,I=null===(E=R)||void 0===E?void 0:E[0],L=y[0];if(y.length>1){var C,A,x=(null===(C=_[0])||void 0===C?void 0:C.valueType)||(null===(A=_[1])||void 0===A?void 0:A.valueType),N=null==T?void 0:T.value,j=y.map((function(e){return{op:e,widget:Xd(r,N,e)}}));if("eq"==a||"ne"==a){var F=j.find((function(e){e.op;var t=e.widget;return t&&"field"!=t}));F&&(L=F.op)}else Wd.warn("[spel] Spel operator ".concat(a," can be mapped to ").concat(y,"."),"widgets:",j,"vals:",_,"valueType=",x)}null!=T&&T.groupFieldValue&&(I&&I.groupFieldValue&&"field"==I.groupFieldValue.valueSrc&&I.groupFieldValue.value==w?(L="all",R=[]):"equal"==L&&"value"==I.valueSrc&&"number"==I.valueType&&0==I.value?(L="none",R=[]):"greater"==L&&"value"==I.valueSrc&&"number"==I.valueType&&0==I.value&&(L="some",R=[]));var P=r.operators[L],k=r.operators[null===(S=P)||void 0===S?void 0:S.reversedOp],D=e.not&&["between"].includes(L),V=!!k&&(!!r.settings.reverseOperatorsForNot||D);(e.not&&V||D)&&(L=P.reversedOp,P=r.operators[L],e.not=!e.not);var M=!!e.not;if(e.not=!1,T)if(T.groupFieldValue)"field"!=T.groupFieldValue.valueSrc&&n.errors.push("Expected group field ".concat(JSON.stringify(T))),o=function(e,t,r,n,o){var i=e.groupFilter,a=e.groupFieldValue;if("field"!=a.valueSrc)throw"Bad groupFieldValue: ".concat(JSON.stringify(a));var s=a.value,l=Nd(n,o,s,t,r);if(l){var u,c=wd(n,s),p=null==c?void 0:c.mode;return(u="group"===(null==i?void 0:i.type)?Sd(Sd({},i||{}),{},{type:"rule_group",properties:Sd(Sd(Sd({},l.properties),(null==i?void 0:i.properties)||{}),{},{mode:p})}):Sd(Sd({},l||{}),{},i?{type:"rule_group",children1:[i],properties:Sd(Sd({},l.properties),{},{mode:p})}:{type:"rule_group",properties:Sd(Sd({},l.properties),{},{mode:p})})).id||(u.id=Td()),u}}(T,L,R,r,n);else{"field"!=T.valueSrc&&"func"!=T.valueSrc&&n.errors.push("Expected field/func at LHS, but got ".concat(JSON.stringify(T)));var U=T.value;o=Nd(r,n,U,L,R,e)}else;M&&("group"!==o.type?o=Ld(o,r,!0):o.properties.not=!o.properties.not)}else if(!i){var B=sv(e,t,r,n);o=Ad(B,t,r,n)}return o},rv=function(e,t,r,n){var o,i,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(null!=e){var s=r.settings.fieldSeparator;if(e._groupField=null!==(o=e._groupField)&&void 0!==o?o:null==a?void 0:a._groupField,"variable"==e.type||"property"==e.type){var l=Yd(r,e.val,e._groupField),u=zd(r,l),c="variable"==e.type;return{valueSrc:"field",valueType:null==u?void 0:u.type,isVariable:c,value:l}}if("compound"==e.type){var p=Vd(e.children,n);if(p){var f,d=Yd(r,p.join(s),e._groupField),v=zd(r,d),h="variable"==(null===(f=e.children)||void 0===f||null===(f=f[0])||void 0===f?void 0:f.type);return{valueSrc:"field",valueType:null==v?void 0:v.type,isVariable:h,value:d}}}else{if(Qd[e.type]){var g=e.val,y=Qd[e.type];return e.negative&&(g=-g),{valueSrc:"value",valueType:y,value:g}}if("!new"==e.type&&Zd[e.cls.at(-1)]){var m=e.args.map((function(o){return rv(o,t,r,n,e)})),O=null==m?void 0:m[0],b=Zd[e.cls.at(-1)];return qd(qd({},O),{},{valueType:b})}if("list"==e.type){var E,S=e.val.map((function(o){return rv(o,t,r,n,e)}));S.length&&(null===(E=S[0])||void 0===E||E.valueType);return{valueSrc:"value",valueType:"multiselect",value:S.map((function(e){return null==e?void 0:e.value}))}}if("op-plus"===e.type&&"ternary"===(null==a?void 0:a.type)&&"case_value"===(null===(i=r.settings.caseValueField)||void 0===i?void 0:i.type))return lv(e,t,r,n)}var _=nv(e,t,r,n,a);if(void 0!==_)return _;n.errors.push("Can't convert arg of type ".concat(e.type))}},nv=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=function(o){return ev(o,t,r,n,e)},s=function(e){var t=[{s:"",params:[],objs:[]}];return bd(e,t),t.map((function(e){return{s:e.s,params:e.params}})).reverse().filter((function(e){var t=e.s;return""!==t&&"?"!==t}))}(e),l=null==s||null===(o=s[0])||void 0===o?void 0:o.s;s.length&&Wd.debug("Signatures for ",e,":",l,s);var u=ov(e,t,r,n,i,s,a);if(void 0!==u)return u;var c,p,f,d=iv(e,t,r,n,i,s,a);if(void 0!==d)return d;var v,h=Md(s);try{var g=function(){var e=v.value,n=e.s,o=e.params,i=t.funcs[n];if(i){c=i[0];var s=(p=Hd(r,c)).spelFunc,l=o.map(a),u=W(s.matchAll(/\${(\w+)}/g)).map((function(e){var t=K(e,2);t[0];return t[1]}));return f=Object.fromEntries(u.map((function(e,t){return[e,l[t]]}))),1}};for(h.s();!(v=h.n()).done&&!g(););}catch(e){h.e(e)}finally{h.f()}if(!c){var y,m=Md(Jd(r));try{for(m.s();!(y=m.n()).done;){var O=K(y.value,2),b=O[0],E=O[1];if(E.spelImport){var S=void 0;try{S=E.spelImport.call(r.ctx,e)}catch(e){Wd.debug("Error while using spelImport for ".concat(b),e)}if(S){var _;for(var T in p=Hd(r,c=b),f={},S)f[T]=a(S[T]);var R=!0,w=null===(_=p)||void 0===_?void 0:_.returnType;if(["date","datetime"].includes(w)){var I,L,C=Object.keys(null!==(I=p.args)&&void 0!==I?I:[]).filter((function(e){return["date","datetime"].includes(p.args[e].type)})),A=Md(C);try{for(A.s();!(L=A.n()).done;){var x,N=L.value,j=p.args[N].type,F=null===(x=f[N])||void 0===x?void 0:x.valueType;F&&F!=j&&(R=!1)}}catch(e){A.e(e)}finally{A.f()}}if(R)break}}}}catch(e){m.e(e)}finally{m.f()}}if(c){var P={};for(var k in p.args){var D,V=p.args[k],M=f[k];if(void 0===M)if(void 0===(M=null==V?void 0:V.defaultValue)){if(null==V||!V.isOptional)return void n.errors.push("No value for arg ".concat(k," of func ").concat(c))}else M={value:M,valueSrc:null!==(D=M)&&void 0!==D&&D.func?"func":"value",valueType:V.type};M&&(P[k]=M)}return{valueSrc:"func",value:{func:c,args:P},valueType:p.returnType}}e.methodName&&n.errors.push("Signature ".concat(l," - failed to convert"))},ov=function(e,t,r,n,o,i,a){var s,l,u,c=[];for(var p in r.widgets){var f=r.widgets[p].spelImportFuncs;if(f)for(var d=0;d<f.length;d++){var v=f[d];if(Kd(v)){var h={};if(Gd(v,e,h)){for(var g in h)h[g]=a(h[g]);c.push({s:"widgets.".concat(p,".spelImportFuncs[").concat(d,"]"),w:p,argsObj:h})}}}}var y,m=Md(i);try{for(m.s();!(y=m.n()).done;){var O,b=y.value,E=b.s,S=b.params,_=Md(t.valueFuncs[E]||[]);try{var T=function(){var e=O.value,t=e.w,r=e.argsOrder,n=S.map(a),o=Object.fromEntries(r.map((function(e,t){return[e,n[t]]})));c.push({s:E,w:t,argsObj:o})};for(_.s();!(O=_.n()).done;)T()}catch(e){_.e(e)}finally{_.f()}}}catch(e){m.e(e)}finally{m.f()}for(var R=0,w=c;R<w.length;R++){var I=w[R],L=I.s,C=I.w,A=I.argsObj,x=r.widgets[C],N=x.spelImportValue,j=x.type;for(var F in u=C,l=L,s=[],A)["value"].includes(A[F].valueSrc)||s.push("".concat(F," has unsupported value src ").concat(A[F].valueSrc));var P=A.v.value;if(N&&!s.length){var k=K(N.call(r.ctx,A.v,x,A),2);P=k[0],(s=k[1])&&!Array.isArray(s)&&(s=[s])}if(!s.length)return{valueSrc:"value",valueType:j,value:P}}u&&s.length&&n.errors.push("Signature ".concat(l," - looks like convertable to ").concat(u,", but: ").concat(s.join("; ")))},iv=function(e,t,r,n,o,i,a){var s,l=[],u=Md(i);try{for(u.s();!(s=u.n()).done;){var c,p=s.value,f=p.s,d=p.params,v=Md(t.opFuncs[f]||[]);try{var h,g=function(){var e,t=c.value,n=t.op,i=t.argsOrder,s=d.map(a),u=[];if("!compare"===n){if(o.type.startsWith("op-")&&2==o.children.length&&"number"==o.children[1].type&&0===o.children[1].val)return{v:{type:"!compare",children:s}};u.push("Result of compareTo() should be compared to 0")}var p=r.operators[n].valueTypes,v=Object.fromEntries(i.map((function(e,t){return[e,s[t]]}))),h=v[0],g=Object.keys(v).filter((function(e){return parseInt(e)>0})).map((function(e){return v[e]})),y=null===(e=s.filter((function(e){return!!e&&e!==h})))||void 0===e||null===(e=e[0])||void 0===e?void 0:e.valueType;p&&y&&!p.includes(y)&&u.push("Op supports types ".concat(p,", but got ").concat(y)),l.push({opKey:n,foundSign:f,field:h,convertedArgs:g,errs:u})};for(v.s();!(c=v.n()).done;)if(h=g())return h.v}catch(e){v.e(e)}finally{v.f()}}}catch(e){u.e(e)}finally{u.f()}for(var y in r.operators){var m=r.operators[y],O=m.spelImportFuncs,b=m.valueTypes;if(O)for(var E=function(){var t=O[S];if(Kd(t)){var r={};if(Gd(t,e,r)){var n,o=[];for(var i in r)r[i]=a(r[i]);var s=r[0],u=Object.keys(r).filter((function(e){return parseInt(e)>0})).map((function(e){return r[e]})),c=null===(n=r[1])||void 0===n?void 0:n.valueType;b&&c&&!b.includes(c)&&o.push("Op supports types ".concat(b,", but got ").concat(c)),l.push({opKey:y,foundSign:"spelImportFuncs[".concat(S,"]"),field:s,convertedArgs:u,errs:o})}}},S=0;S<O.length;S++)E()}var _=l.find((function(e){return!e.errs.length}));if(_){var T=_.opKey,R=(_.foundSign,_.field),w=_.convertedArgs;_.errs;return Nd(r,n,R,T,w,e)}if(l.length){var I=l.map((function(e){var t=e.foundSign,r=e.opKey,n=e.errs;return"Looks like convertable to ".concat(r," with signature ").concat(t,", but: ").concat(n.join("; "))})).join(".  ");n.errors.push(I)}},av=function(e,t,r,n,o,i){if(e.type==t.type){if("!aggr"==e.type){var a=K([e.source,t.source].map((function(e){return rv(e,n,o,i,r)})),2),s=a[0],l=a[1];return s.value==l.value}var u=K([e,t].map((function(e){return rv(e,n,o,i,r)})),2),c=u[0],p=u[1];return c.value==p.value}return!1},sv=function(e,t,r,n){var o,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return"op-plus"===(null==e?void 0:e.type)&&"case_value"===(null===(o=r.settings.caseValueField)||void 0===o?void 0:o.type)?lv(e,t,r,n):rv(e,t,r,n,i)},lv=function(e,t,r,n){var o=[];return function i(a){a.map((function(a){if("op-plus"===a.type)i(a.children);else{var s=rv(a,t,r,n,e);s?o.push(s):n.errors.push("Can't convert ".concat(a.type," in concatenation"))}}))}(e.children),{valueSrc:"value",valueType:"case_value",value:o}},uv=Zo,cv=el,pv=function(e,t){return fv(e,t,!0)},fv=function(e,t){var r,n,o=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i={errors:[]},a=cv(t,void 0,!1),s=function(e){var t={},r=function(r){var n=e.operators[r],o=n.spelOps?n.spelOps:n.spelOp?[n.spelOp]:void 0;if(o)o.forEach((function(e){var n=e;t[n]||(t[n]=[]),t[n].push(r)}));else{var i,a=null===(i=e.operators)||void 0===i?void 0:i[n.reversedOp];(null==a?void 0:a.spelOp)||(null==a?void 0:a.spelOps)||md.includes(r)||md.includes(n.reversedOp)||Od.includes(r)||yd.warn("[spel] No spelOp for operator ".concat(r))}};for(var n in e.operators)r(n);var o={};for(var i in e.conjunctions)o[e.conjunctions[i].spelConj||i.toLowerCase()]=i;var a,s={},l=vd(gd(e));try{var u=function(){var e=K(a.value,2),t=e[0],r=e[1],n=[],o=r.spelFunc;if("string"==typeof o){var i=Object.keys(r.args||{}).reverse().filter((function(e){return!!r.args[e].isOptional||null!=r.args[e].defaultValue})),l=o.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),u=i.reduce((function(e,t){return[].concat(W(e),[[t].concat(W(e[e.length-1]||[]))])}),[]).map((function(e){return o.replace(/(?:, )?\${(\w+)}/g,(function(t,r){return e.includes(r)?"":t})).replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"}))}));n=[l].concat(W(u))}var c,p=vd(n);try{for(p.s();!(c=p.n()).done;){var f=c.value;s[f]||(s[f]=[]),s[f].push(t)}}catch(e){p.e(e)}finally{p.f()}};for(l.s();!(a=l.n()).done;)u()}catch(e){l.e(e)}finally{l.f()}var c={};for(var p in e.widgets){var f=e.widgets[p].spelImportFuncs;if(f){var d,v=vd(f);try{for(v.s();!(d=v.n()).done;){var h=d.value;if("string"==typeof h){var g=h.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),y=W(h.matchAll(/\${(\w+)}/g)).map((function(e){var t=K(e,2);return t[0],t[1]}));c[g]||(c[g]=[]),c[g].push({w:p,argsOrder:y})}}}catch(e){v.e(e)}finally{v.f()}}}var m={},O=function(t){var r=e.operators[t],n=r.spelOps?r.spelOps:r.spelOp?[r.spelOp]:void 0;null==n||n.forEach((function(e){if(null!=e&&e.includes("${0}")){var r=e.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"})),n=W(e.matchAll(/\${(\w+)}/g)).map((function(e){var t=K(e,2);return t[0],t[1]}));m[r]||(m[r]=[]),m[r].push({op:t,argsOrder:n})}}))};for(var b in e.operators)O(b);var E=uu.replace(/\?\./g,".").replace(/\${(\w+)}/g,(function(e,t){return"?"}));return m[E]=[{op:"!compare",argsOrder:["0","1"]}],{operators:t,conjunctions:o,funcs:s,valueFuncs:c,opFuncs:m}}(a),l=void 0;try{r=Lc.SpelExpressionEvaluator.compile(e)._compiledExpression}catch(e){i.errors.push(e)}r&&(n=kd(r,i),uv.debug("convertedObj:",n,i),(l=ev(n,s,a,i))&&"group"!=l.type&&"switch_group"!=l.type&&(l=Ld(l,a,n.not)),uv.debug("jsTree:",l));var u=l?Ku(l):void 0;return o?[u,i.errors]:(i.errors.length&&console.warn("Errors while importing from SpEL:",i.errors),u)};const dv={utils:{SqlString:Gl,moment:ho(),mongoFormatOp1:El,mongoFormatOp2:Sl,mongoEmptyValue:bl,escapeRegExp:Bo,sqlEmptyValue:Kl,stringifyForDisplay:$l,getTitleInListValues:Ef,spelEscape:Ml,spelFixList:ql,wrapWithBrackets:Wl}};function vv(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return hv(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?hv(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function gv(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function yv(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?gv(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):gv(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var mv={equal:{label:"==",labelForFormat:"==",sqlOp:"=",spelOp:"==",spelOps:["==","eq"],reversedOp:"not_equal",formatOp:function(e,t,r,n,o,i,a,s,l){var u=s?"=":i.label;return"boolean"==o&&s?"No"==r?"NOT ".concat(e):"".concat(e):"".concat(e," ").concat(u," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},jsonLogic2:"==",jsonLogicOps:["==","datetime==","date=="],jsonLogic:function(e,t,r,n,o,i,a,s){return null!=s&&s.fixJsonLogicDateCompareOp&&["date","datetime"].includes(a)?M({},"".concat(a,"=="),[e,r]):{"==":[e,r]}},elasticSearchQueryType:"term"},not_equal:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],spelOp:"!=",spelOps:["!=","ne"],reversedOp:"equal",formatOp:function(e,t,r,n,o,i,a,s,l){return"boolean"==o&&s?"No"==r?"".concat(e):"NOT ".concat(e):"".concat(e," ").concat(i.label," ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},jsonLogic2:"!=",jsonLogicOps:["!=","datetime!=","date!="],jsonLogic:function(e,t,r,n,o,i,a,s){return null!=s&&s.fixJsonLogicDateCompareOp&&["date","datetime"].includes(a)?M({},"".concat(a,"!="),[e,r]):{"!=":[e,r]}}},less:{label:"<",labelForFormat:"<",sqlOp:"<",spelOp:"<",spelOps:["<","lt"],reversedOp:"greater_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lt",function(e){return e},!1].concat(r))},jsonLogic:"<",elasticSearchQueryType:"range"},less_or_equal:{label:"<=",labelForFormat:"<=",sqlOp:"<=",spelOp:"<=",spelOps:["<=","le"],reversedOp:"greater",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$lte",function(e){return e},!1].concat(r))},jsonLogic:"<=",elasticSearchQueryType:"range"},greater:{label:">",labelForFormat:">",sqlOp:">",spelOp:">",spelOps:[">","gt"],reversedOp:"less_or_equal",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return e},!1].concat(r))},jsonLogic:">",elasticSearchQueryType:"range"},greater_or_equal:{label:">=",labelForFormat:">=",sqlOp:">=",spelOp:">=",spelOps:[">=","ge"],reversedOp:"less",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gte",function(e){return e},!1].concat(r))},jsonLogic:">=",elasticSearchQueryType:"range"},like:{label:"Contains",labelForFormat:"Contains",reversedOp:"not_like",sqlOp:"LIKE",sqlImport:function(e,t,r){if("LIKE"==(null==e?void 0:e.operator)||"NOT LIKE"==(null==e?void 0:e.operator)){var n,o="NOT LIKE"==(null==e?void 0:e.operator),i=K(e.children||[],2),a=(i[0],i[1]);if(null!=a&&null!==(n=a.valueType)&&void 0!==n&&n.endsWith("_quote_string")){if(null!=a&&a.value.startsWith("%")&&null!=a&&a.value.endsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(1,a.value.length-1),r),e.operator=o?"not_like":"like",e;if(null!=a&&a.value.startsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(1),r),e.operator="ends_with",e;if(null!=a&&a.value.endsWith("%"))return a.value=this.utils.SqlString.unescapeLike(a.value.substring(0,a.value.length-1),r),e.operator="starts_with",e}}},spelOp:"${0}.contains(${1})",valueTypes:["text"],mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:function(e,t,r){return{in:[r,e]}},jsonLogic2:"#in",valueSources:["value"],elasticSearchQueryType:"regexp"},not_like:{isNotOp:!0,label:"Not contains",reversedOp:"like",labelForFormat:"Not Contains",sqlOp:"NOT LIKE",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e):void 0},!0].concat(n))},jsonLogic:function(e,t,r){return{"!":{in:[r,e]}}},jsonLogic2:"#!in",_jsonLogicIsExclamationOp:!0,valueSources:["value"]},starts_with:{label:"Starts with",labelForFormat:"Starts with",sqlOp:"LIKE",spelOp:"${0}.startsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?"^"+t.utils.escapeRegExp(e):void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},ends_with:{label:"Ends with",labelForFormat:"Ends with",sqlOp:"LIKE",spelOp:"${0}.endsWith(${1})",mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$regex",function(e){return"string"==typeof e?t.utils.escapeRegExp(e)+"$":void 0},!1].concat(n))},jsonLogic:void 0,valueSources:["value"]},between:{label:"Between",labelForFormat:"BETWEEN",sqlOp:"BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,s){var l=r.first(),u=r.get(1);return s?"".concat(e," BETWEEN ").concat(l," AND ").concat(u):"".concat(e," >= ").concat(l," && ").concat(e," <= ").concat(u)},spelFormatOp:function(e,t,r,n,o,i,a,s){var l=r[0],u=r[1];return"(".concat(e," >= ").concat(l," && ").concat(e," <= ").concat(u,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!1].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"not_between",jsonLogic:"<=",validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null},elasticSearchQueryType:function(e){return"time"===e?"filter":"range"}},not_between:{isNotOp:!0,label:"Not between",labelForFormat:"NOT BETWEEN",sqlOp:"NOT BETWEEN",cardinality:2,formatOp:function(e,t,r,n,o,i,a,s){var l=r.first(),u=r.get(1);return s?"".concat(e," NOT BETWEEN ").concat(l," AND ").concat(u):"(".concat(e," < ").concat(l," || ").concat(e," > ").concat(u,")")},spelFormatOp:function(e,t,r,n,o,i,a,s){var l=r[0],u=r[1];return"(".concat(e," < ").concat(l," || ").concat(e," > ").concat(u,")")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp2.apply(e,[["$gte","$lte"],!0].concat(r))},valueLabels:["Value from","Value to"],textSeparators:[null,"and"],reversedOp:"between",jsonLogic:function(e,t,r){return{"!":{"<=":[Array.isArray(r)?r[0]:r,e,Array.isArray(r)?r[1]:r]}}},jsonLogic2:"!<=",_jsonLogicIsExclamationOp:!0,validateValues:function(e){return null!=e[0]&&null!=e[1]?e[0]<=e[1]:null}},is_empty:{label:"Is empty",labelForFormat:"IS EMPTY",cardinality:0,reversedOp:"is_not_empty",formatOp:function(e,t,r,n,o,i,a,s){return s?"".concat(e," IS EMPTY"):"!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,s){var l=this.utils.sqlEmptyValue(s);return"COALESCE(".concat(e,", ").concat(l,") = ").concat(l)},sqlImport:function(e,t,r){if("="===(null==e?void 0:e.operator)||"<>"===(null==e?void 0:e.operator)){var n,o=K(e.children||[],2),i=o[0],a=o[1];if(""===(null==a?void 0:a.value)&&"COALESCE"===(null==i?void 0:i.func)&&""===(null==i||null===(n=i.children)||void 0===n||null===(n=n[1])||void 0===n?void 0:n.value))return e.operator="="===(null==e?void 0:e.operator)?"is_empty":"is_not_empty",e.children=[i.children[0]],e}},spelFormatOp:function(e,t,r,n,o,i,a,s){return"".concat(e," <= ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!"},is_not_empty:{isNotOp:!0,label:"Is not empty",labelForFormat:"IS NOT EMPTY",cardinality:0,reversedOp:"is_empty",formatOp:function(e,t,r,n,o,i,a,s){return s?"".concat(e," IS NOT EMPTY"):"!!".concat(e)},sqlFormatOp:function(e,t,r,n,o,i,a,s){var l=this.utils.sqlEmptyValue(s);return"COALESCE(".concat(e,", ").concat(l,") <> ").concat(l)},spelFormatOp:function(e,t,r,n,o,i,a,s){return"".concat(e," > ''")},mongoFormatOp:function(){for(var e,t=this,r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e,r){return[t.utils.mongoEmptyValue(r),null]},!1].concat(n))},jsonLogic:"!!",elasticSearchQueryType:"exists"},is_null:{label:"Is null",labelForFormat:"IS NULL",sqlOp:"IS NULL",sqlImport:function(e,t,r){if("IS"===(null==e?void 0:e.operator)||"IS NOT"===(null==e?void 0:e.operator)){var n=K(e.children||[],2),o=n[0],i=n[1];if("null"==(null==i?void 0:i.valueType))return e.operator="IS"===(null==e?void 0:e.operator)?"is_null":"is_not_null",e.value=o,e}},cardinality:0,reversedOp:"is_not_null",formatOp:function(e,t,r,n,o,i,a,s){return s?"".concat(e," IS NULL"):"!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,s){return"".concat(e," == null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return null},!1].concat(r))},jsonLogic:"=="},is_not_null:{label:"Is not null",labelForFormat:"IS NOT NULL",sqlOp:"IS NOT NULL",cardinality:0,reversedOp:"is_null",formatOp:function(e,t,r,n,o,i,a,s){return s?"".concat(e," IS NOT NULL"):"!!".concat(e)},spelFormatOp:function(e,t,r,n,o,i,a,s){return"".concat(e," != null")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return null},!1].concat(r))},jsonLogic:"!=",elasticSearchQueryType:"exists"},select_equals:{label:"==",labelForFormat:"==",sqlOp:"=",formatOp:function(e,t,r,n,o,i,a,s){var l=s?"=":"==";return"".concat(e," ").concat(l," ").concat(r)},spelOp:"==",spelOps:["==","eq"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"select_not_equals",jsonLogic:"==",elasticSearchQueryType:"term"},select_not_equals:{isNotOp:!0,label:"!=",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],formatOp:function(e,t,r,n,o,i,a,s){return"".concat(e," != ").concat(r)},spelOp:"!=",spelOps:["!=","ne"],mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"select_equals",jsonLogic:"!="},select_any_in:{label:"Any in",labelForFormat:"IN",sqlOp:"IN",formatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):"".concat(e," IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," IN (").concat(r.join(", "),")"):void 0},valueTypes:["multiselect"],spelOp:"${1}.contains(${0})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))},reversedOp:"select_not_any_in",jsonLogic:"in",elasticSearchQueryType:"term"},select_not_any_in:{isNotOp:!0,label:"Not in",labelForFormat:"NOT IN",sqlOp:"NOT IN",formatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):"".concat(e," NOT IN (").concat(r,")")},sqlFormatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," NOT IN (").concat(r.join(", "),")"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$nin",function(e){return e},!1].concat(r))},reversedOp:"select_any_in",jsonLogic:function(e,t,r){return{"!":{in:[e,r]}}},jsonLogic2:"!in",_jsonLogicIsExclamationOp:!0},multiselect_contains:{label:"Contains",labelForFormat:"CONTAINS",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," CONTAINS [").concat(r.join(", "),"]"):"".concat(e," CONTAINS ").concat(r)},reversedOp:"multiselect_not_contains",jsonLogic2:"some-in",jsonLogic:function(e,t,r){return{some:[e,{in:[{var:""},r]}]}},spelOp:"T(CollectionUtils).containsAny(${0}, ${1})",spelImportFuncs:[{obj:{type:"property",val:"CollectionUtils"},methodName:"containsAny",args:[{var:"0"},{var:"1"}]}],elasticSearchQueryType:"term",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$in",function(e){return e},!1].concat(r))}},multiselect_not_contains:{isNotOp:!0,label:"Not contains",labelForFormat:"NOT CONTAINS",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," NOT CONTAINS [").concat(r.join(", "),"]"):"".concat(e," NOT CONTAINS ").concat(r)},reversedOp:"multiselect_contains",jsonLogic2:"!some-in",jsonLogic:function(e,t,r){return{"!":{some:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},multiselect_equals:{label:"Equals",labelForFormat:"==",sqlOp:"=",valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,a,s){var l=s?"=":"==";return"value"==n?"".concat(e," ").concat(l," [").concat(r.join(", "),"]"):"".concat(e," ").concat(l," ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,s){var l=this;return"value"==n?"".concat(e," = '").concat(r.map((function(e){return l.utils.SqlString.trim(e)})).join(","),"'"):void 0},spelOp:"${0}.equals(${1})",mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))},reversedOp:"multiselect_not_equals",jsonLogic2:"all-in",jsonLogic:function(e,t,r){return{all:[e,{in:[{var:""},r]}]}},elasticSearchQueryType:"term"},multiselect_not_equals:{isNotOp:!0,label:"Not equals",labelForFormat:"!=",sqlOp:"<>",sqlOps:["<>","!="],valueTypes:["multiselect"],formatOp:function(e,t,r,n,o,i,a,s){return"value"==n?"".concat(e," != [").concat(r.join(", "),"]"):"".concat(e," != ").concat(r)},sqlFormatOp:function(e,t,r,n,o,i,a,s){var l=this;return"value"==n?"".concat(e," != '").concat(r.map((function(e){return l.utils.SqlString.trim(e)})).join(","),"'"):void 0},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$ne",function(e){return e},!1].concat(r))},reversedOp:"multiselect_equals",jsonLogic2:"!all-in",jsonLogic:function(e,t,r){return{"!":{all:[e,{in:[{var:""},r]}]}}},_jsonLogicIsExclamationOp:!0},proximity:{label:"Proximity search",cardinality:2,valueLabels:[{label:"Word 1",placeholder:"Enter first word"},{label:"Word 2",placeholder:"Enter second word"}],textSeparators:[],formatOp:function(e,t,r,n,o,i,a,s){var l=r.first(),u=r.get(1),c=null==a?void 0:a.get("proximity");return"".concat(e," ").concat(l," NEAR/").concat(c," ").concat(u)},sqlFormatOp:function(e,t,r,n,o,i,a,s){var l=r.first(),u=r.get(1),c=this.utils.SqlString.trim(l),p=this.utils.SqlString.trim(u),f=null==a?void 0:a.get("proximity");return"CONTAINS(".concat(e,", 'NEAR((").concat(c,", ").concat(p,"), ").concat(f,")')")},sqlImport:function(e,t,r){if("CONTAINS"===(null==e?void 0:e.func)){var n,o=K(e.children||[],2),i=o[0],a=o[1];if(null!=a&&null!==(n=a.value)&&void 0!==n&&n.includes("NEAR(")){var s=a.value.match(/NEAR\(\((\w+), (\w+)\), (\d+)\)/);if(s)return delete e.func,e.operator="proximity",e.children=[i,{value:s[1]},{value:s[2]}],e.operatorOptions={proximity:parseInt(s[3])},e}}},mongoFormatOp:void 0,jsonLogic:void 0,options:{optionLabel:"Near",optionTextBefore:"Near",optionPlaceholder:"Select words between",minProximity:2,maxProximity:10,defaults:{proximity:2}}},some:{label:"Some",labelForFormat:"SOME",cardinality:0,jsonLogic:"some",spelFormatOp:function(e){return"".concat(e," > 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$gt",function(e){return 0},!1].concat(r))}},all:{label:"All",labelForFormat:"ALL",cardinality:0,jsonLogic:"all",spelFormatOp:function(e,t,r){return"".concat(e," == ").concat(r)},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return e},!1].concat(r))}},none:{label:"None",labelForFormat:"NONE",cardinality:0,jsonLogic:"none",spelFormatOp:function(e){return"".concat(e," == 0")},mongoFormatOp:function(){for(var e,t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];return(e=this.utils).mongoFormatOp1.apply(e,["$eq",function(e){return 0},!1].concat(r))}}},Ov={text:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"String",valuePlaceholder:"Enter string",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n,a):this.utils.SqlString.escape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},textarea:{type:"text",jsType:"string",valueSrc:"value",valueLabel:"Text",valuePlaceholder:"Enter text",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return"LIKE"==o.sqlOp||"NOT LIKE"==o.sqlOp?this.utils.SqlString.escapeLike(e,"starts_with"!=n,"ends_with"!=n,a):this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e},fullWidth:!0},number:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r){var n=r.step&&!Number.isInteger(r.step);return this.utils.spelEscape(e,n)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},slider:{type:"number",jsType:"number",valueSrc:"value",valueLabel:"Number",valuePlaceholder:"Enter number or move slider",formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},select:{type:"select",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=this.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e);return n?this.utils.stringifyForDisplay(o):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},multiselect:{type:"multiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=e.map((function(e){return o.utils.getTitleInListValues(t.fieldSettings.listValues||t.asyncListValues,e)}));return n?i.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o,i,a){var s=this;return e.map((function(e){return s.utils.SqlString.escape(e)}))},spelFormatValue:function(e,t,r,n,o){var i=o&&o.spelOp&&o.spelOp.startsWith("${1}"),a=this.utils.spelEscape(e);return i&&(a=this.utils.spelFixList(a)),a},toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},date:{type:"date",jsType:"string",valueSrc:"value",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD",valueLabel:"Date",valuePlaceholder:"Enter date",valueLabels:[{label:"Date from",placeholder:"Enter date from"},{label:"Date to",placeholder:"Enter date to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){var s=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(s.format("YYYY-MM-DD"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD");return"T(java.time.LocalDate).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDate"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o,i,a;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&null!==(n=r.fmt)&&void 0!==n&&null!==(n=n.value)&&void 0!==n&&null!==(o=n.includes)&&void 0!==o&&o.call(n," ")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&null!==(a=i.toLowerCase)&&void 0!==a&&a.call(i).includes("hh:mm"))return[void 0,"Invalid date format ".concat(JSON.stringify(r.fmt))];var s=this.utils.moment(e.value,this.utils.moment.ISO_8601);return s.isValid()?[s.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment.utc(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);if(n.isValid())return{$dateFromString:{dateString:n.format("YYYY-MM-DD"),format:"%Y-%m-%d"}}}},time:{type:"time",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",valueFormat:"HH:mm:ss",use12Hours:!1,valueLabel:"Time",valuePlaceholder:"Enter time",valueLabels:[{label:"Time from",placeholder:"Enter time from"},{label:"Time to",placeholder:"Enter time to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){var s=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(s.format("HH:mm:ss"))},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("HH:mm:ss");return"T(java.time.LocalTime).parse('".concat(i,"')")},spelImportFuncs:["T(java.time.LocalTime).parse(${v})"],spelImportValue:function(e,t,r){var n,o,i;if(!t)return[void 0,"No widget def to get value format"];if(null!=r&&r.fmt&&(null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.toLowerCase)||void 0===o||!o.call(n).includes("hh:mm")||null!==(i=r.fmt)&&void 0!==i&&null!==(i=i.value)&&void 0!==i&&i.includes(" ")))return[void 0,"Invalid time format ".concat(JSON.stringify(r.fmt))];var a=this.utils.moment(e.value,"HH:mm:ss");return a.isValid()?[a.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?60*r.get("hour")*60+60*r.get("minute")+r.get("second"):void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);return 60*n.get("hour")*60+60*n.get("minute")+n.get("second")},elasticSearchFormatValue:function(e,t,r,n){return{script:{script:{source:"doc[".concat(n,"][0].getHour() >== params.min && doc[").concat(n,"][0].getHour() <== params.max"),params:{min:t[0],max:t[1]}}}}}},datetime:{type:"datetime",jsType:"string",valueSrc:"value",timeFormat:"HH:mm",dateFormat:"DD.MM.YYYY",valueFormat:"YYYY-MM-DD HH:mm:ss",use12Hours:!1,valueLabel:"Datetime",valuePlaceholder:"Enter datetime",valueLabels:[{label:"Datetime from",placeholder:"Enter datetime from"},{label:"Datetime to",placeholder:"Enter datetime to"}],formatValue:function(e,t,r,n){var o=this.utils.moment(e,r.valueFormat);return n?o.format(r.dateFormat+" "+r.timeFormat):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){var s=this.utils.moment(e,r.valueFormat);return this.utils.SqlString.escape(s.toDate())},spelFormatValue:function(e,t,r,n,o){var i=this.utils.moment(e,r.valueFormat).format("YYYY-MM-DD HH:mm:ss");return"T(java.time.LocalDateTime).parse('".concat(i,"', T(java.time.format.DateTimeFormatter).ofPattern('").concat("yyyy-MM-dd HH:mm:ss","'))")},spelImportFuncs:[{obj:{cls:["java","time","LocalDateTime"]},methodName:"parse",args:[{var:"v"},{obj:{cls:["java","time","format","DateTimeFormatter"]},methodName:"ofPattern",args:[{var:"fmt"}]}]}],spelImportValue:function(e,t,r){var n,o;if(!t)return[void 0,"No widget def to get value format"];if(null==r||null===(n=r.fmt)||void 0===n||null===(n=n.value)||void 0===n||null===(o=n.includes)||void 0===o||!o.call(n," "))return[void 0,"Invalid datetime format ".concat(JSON.stringify(r.fmt))];var i=this.utils.moment(e.value,this.utils.moment.ISO_8601);return i.isValid()?[i.format(null==t?void 0:t.valueFormat),[]]:[void 0,"Invalid date"]},jsonLogic:function(e,t,r){return this.utils.moment(e,r.valueFormat).toDate()},toJS:function(e,t){var r=this.utils.moment(e,t.valueFormat);return r.isValid()?r.toDate():void 0},mongoFormatValue:function(e,t,r){var n=this.utils.moment(e,r.valueFormat);if(n.isValid())return{$dateFromString:{dateString:n.format("YYYY-MM-DD HH:mm:ss"),format:"%Y-%m-%d %H:%M:%S"}}}},boolean:{type:"boolean",jsType:"boolean",valueSrc:"value",labelYes:"Yes",labelNo:"No",formatValue:function(e,t,r,n){return n?e?"Yes":"No":JSON.stringify(!!e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e,t,r,n,o){return this.utils.spelEscape(e)},defaultValue:!1,toJS:function(e,t){return e},mongoFormatValue:function(e,t,r){return e}},field:{valueSrc:"field",formatValue:function(e,t,r,n,o,i,a){return n&&a.label||e},sqlFormatValue:function(e,t,r,n,o,i,a){return e},spelFormatValue:function(e,t,r,n,o){return e},valueLabel:"Field to compare",valuePlaceholder:"Select field to compare"},func:{valueSrc:"func",valueLabel:"Function",valuePlaceholder:"Select function"},case_value:{valueSrc:"value",type:"case_value",spelFormatValue:function(e){return this.utils.spelEscape(""===e?null:e)},spelImportValue:function(e){return[e.value,[]]},jsonLogic:function(e){return""===e?null:e}}},bv=yv(yv({},Ka),{},{convertableWidgets:{number:["slider","rangeslider"],slider:["number","rangeslider"],rangeslider:["number","slider"],text:["textarea"],textarea:["text"]},formatSpelField:function(e,t,r,n,o,i){var a=this,s=n.map((function(e,t){var r=e.key,n=e.parent,o=e.fieldSeparator;return 0==t?"[map]"==n?"#this[".concat(a.utils.spelEscape(r),"]"):r:"map"==n||"[map]"==n?"[".concat(a.utils.spelEscape(r),"]"):"".concat(o).concat(r)})).join("");return o.fieldName&&(s=e),o.isSpelVariable&&(s="#"+s),s},sqlFormatReverse:function(e){if(null!=e)return"NOT"+this.utils.wrapWithBrackets(e)},spelFormatReverse:function(e){if(null!=e)return"!"+this.utils.wrapWithBrackets(e)},formatReverse:function(e,t,r,n,o,i){if(null!=e)return i?"NOT "+this.utils.wrapWithBrackets(e):"!"+this.utils.wrapWithBrackets(e)},formatAggr:function(e,t,r,n,o,i,a,s,l,u){var c=a.labelForFormat,p=a.cardinality;if(0==p){var f=e?" HAVE ".concat(e):"";return"".concat(c," OF ").concat(t).concat(f)}if(null==p||1==p){var d=e?" WHERE ".concat(e):"";return"COUNT OF ".concat(t).concat(d," ").concat(c," ").concat(n)}if(2==p){var v=e?" WHERE ".concat(e):"",h=n.first(),g=n.get(1);return"COUNT OF ".concat(t).concat(v," ").concat(c," ").concat(h," AND ").concat(g)}},jsonLogic:{groupVarKey:"var",altVarKey:"var",lockedOp:"locked"},canCompareFieldWithField:function(e,t,r,n){return!0},valueSourcesInfo:{value:{label:"Value"},field:{label:"Field",widget:"field"},func:{label:"Function",widget:"func"}}}),Ev=function(e,t){var r,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],o={rangeslider:Tv,treeselect:Rv,treemultiselect:wv,rangeable__date:_v("date","date")},i=vv(t);try{for(i.s();!(r=i.n()).done;){var a=r.value,s=o[a];if(!s)throw new Error("Can't ".concat(n?"add":"remove"," mixin ").concat(a));e=s(e,n)}}catch(e){i.e(e)}finally{i.f()}return e},Sv=function(e,t){return Ev(e,t,!0)},_v=function(e,t){return function(r){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=r.types;return o=yv(yv({},o),{},M({},e,yv(yv({},o[e]),{},{widgets:yv({},o[e].widgets)}))),n?o[e].widgets[t]=yv({opProps:{between:{isSpecialRange:!0,textSeparators:[null,null]},not_between:{isSpecialRange:!0,textSeparators:[null,null]}}},o[e].widgets[t]):delete o[e].widgets[t],yv(yv({},r),{},{types:o})}},Tv=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=yv({},r),t?r.rangeslider=yv({type:"number",jsType:"number",valueSrc:"value",valueLabel:"Range",valuePlaceholder:"Select range",valueLabels:[{label:"Number from",placeholder:"Enter number from"},{label:"Number to",placeholder:"Enter number to"}],formatValue:function(e,t,r,n){return n?this.utils.stringifyForDisplay(e):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},singleWidget:"slider",toJS:function(e,t){return e}},r.rangeslider):delete r.rangeslider,n=yv(yv({},n),{},{number:yv(yv({},n.number),{},{widgets:yv({},n.number.widgets)})}),t?n.number.widgets.rangeslider=yv({opProps:{between:{isSpecialRange:!0},not_between:{isSpecialRange:!0}},operators:["between","not_between","is_null","is_not_null"]},n.number.widgets.rangeslider):delete n.number.widgets.rangeslider,yv(yv({},e),{},{widgets:r,types:n})},Rv=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=yv({},r),t?r.treeselect=yv({type:"treeselect",jsType:"string",valueSrc:"value",valueLabel:"Value",valuePlaceholder:"Select value",formatValue:function(e,t,r,n){var o=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,i=this.utils.getTitleInListValues(o,e);return n?this.utils.stringifyForDisplay(i):JSON.stringify(e)},sqlFormatValue:function(e,t,r,n,o,i,a){return this.utils.SqlString.escape(e)},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treeselect):delete r.treeselect,n=yv({},n),t?n.treeselect=yv({mainWidget:"treeselect",defaultOperator:"select_equals",widgets:{treeselect:{operators:["select_equals","select_not_equals"]},treemultiselect:{operators:["select_any_in","select_not_any_in"]}}},n.treeselect):delete n.treeselect,yv(yv({},e),{},{widgets:r,types:n})},wv=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=e.widgets,n=e.types;return r=yv({},r),t?r.treemultiselect=yv({type:"treemultiselect",jsType:"array",valueSrc:"value",valueLabel:"Values",valuePlaceholder:"Select values",formatValue:function(e,t,r,n){var o=this,i=t.fieldSettings.treeValues||t.fieldSettings.listValues||t.asyncListValues,a=e.map((function(e){return o.utils.getTitleInListValues(i,e)}));return n?a.map(this.utils.stringifyForDisplay):e.map(JSON.stringify)},sqlFormatValue:function(e,t,r,n,o,i,a){var s=this;return e.map((function(e){return s.utils.SqlString.escape(e)}))},spelFormatValue:function(e){return this.utils.spelEscape(e)},toJS:function(e,t){return e}},r.treemultiselect):delete r.treemultiselect,n=yv({},n),t?n.treemultiselect=yv({defaultOperator:"multiselect_equals",widgets:{treemultiselect:{operators:["multiselect_equals","multiselect_not_equals"]}}},n.treemultiselect):delete n.treemultiselect,yv(yv({},e),{},{widgets:r,types:n})},Iv={addMixins:Sv,removeMixins:function(e,t){return Ev(e,t,!1)}},Lv={conjunctions:{AND:{label:"And",mongoConj:"$and",jsonLogicConj:"and",sqlConj:"AND",spelConj:"and",spelConjs:["and","&&"],reversedConj:"OR",formatConj:function(e,t,r,n){var o=e.size>1?e.join(" "+(n?"AND":"&&")+" "):e.first();return(e.size>1||r)&&(o=this.utils.wrapWithBrackets(o)),r&&(o="NOT "+o),o},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" AND "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){r&&(n=!1);var o=e.size>1?e.join(" && "):e.first();return(e.size>1||r)&&!n&&(o=this.utils.wrapWithBrackets(o)),r&&(o="!"+o),o}},OR:{label:"Or",mongoConj:"$or",jsonLogicConj:"or",sqlConj:"OR",spelConj:"or",spelConjs:["or","||"],reversedConj:"AND",formatConj:function(e,t,r,n){return e.size>1?(r?"NOT ":"")+"("+e.join(" "+(n?"OR":"||")+" ")+")":(r?"NOT (":"")+e.first()+(r?")":"")},sqlFormatConj:function(e,t,r){var n=e.size>1?e.join(" OR "):e.first();return(e.size>1||r)&&(n=this.utils.wrapWithBrackets(n)),r&&(n="NOT "+n),n},spelFormatConj:function(e,t,r,n){return r&&(n=!1),e.size>1?(r?"!":"")+(n?"":"(")+e.join(" || ")+(n?"":")"):(r?"!(":"")+e.first()+(r?")":"")}}},operators:mv,widgets:Ov,types:{text:{defaultOperator:"equal",mainWidget:"text",widgets:{text:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","proximity","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},textarea:{operators:["equal","not_equal","like","not_like","starts_with","ends_with","is_empty","is_not_empty","is_null","is_not_null"],widgetProps:{},opProps:{}},field:{operators:["equal","not_equal","proximity"]}}},number:{defaultOperator:"equal",mainWidget:"number",widgets:{number:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]},slider:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","is_null","is_not_null"]}}},date:{defaultOperator:"equal",widgets:{date:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},time:{defaultOperator:"equal",widgets:{time:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},datetime:{defaultOperator:"equal",widgets:{datetime:{operators:["equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between","is_null","is_not_null"]}}},select:{mainWidget:"select",defaultOperator:"select_equals",widgets:{select:{operators:["select_equals","select_not_equals","is_null","is_not_null"]},multiselect:{operators:["select_any_in","select_not_any_in","is_null","is_not_null"]}}},multiselect:{defaultOperator:"multiselect_equals",widgets:{multiselect:{operators:["multiselect_contains","multiselect_not_contains","multiselect_equals","multiselect_not_equals","is_null","is_not_null"]}}},boolean:{defaultOperator:"equal",widgets:{boolean:{operators:["equal","not_equal","is_null","is_not_null"],widgetProps:{}},field:{operators:["equal","not_equal"]}}},"!group":{defaultOperator:"some",mainWidget:"number",widgets:{number:{widgetProps:{min:0},operators:["some","all","none","equal","not_equal","less","less_or_equal","greater","greater_or_equal","between","not_between"],opProps:{equal:{label:"Count =="},not_equal:{label:"Count !="},less:{label:"Count <"},less_or_equal:{label:"Count <="},greater:{label:"Count >"},greater_or_equal:{label:"Count >="},between:{label:"Count between"},not_between:{label:"Count not between"}}}}},case_value:{mainWidget:"case_value",widgets:{case_value:{widgetProps:{}}}}},settings:bv,ctx:dv};const Cv=Lv=Sv(Lv,["rangeslider","treeselect","treemultiselect"]);var Av="ADD_GROUP",xv="ADD_CASE_GROUP",Nv="REMOVE_GROUP",jv="SET_CONJUNCTION",Fv="SET_NOT",Pv="ADD_RULE",kv="REMOVE_RULE",Dv="SET_FIELD",Vv="SET_FIELD_SRC",Mv="SET_OPERATOR",Uv="SET_VALUE",Bv="SET_VALUE_SRC",qv="SET_FUNC_VALUE",Gv="SET_OPERATOR_OPTION",Kv="SET_LOCK",$v="SET_TREE",Wv="MOVE_ITEM",zv="after",Hv="before",Yv="append",Jv="prepend",Xv="SET_DRAG_PROGRESS",Qv="SET_DRAG_START",Zv="SET_DRAG_END",eh=r(1612),th=r.n(eh);function rh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function nh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?rh(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):rh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function oh(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return ih(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ih(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function ih(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}var ah=function(e,t,r,n,o,i){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,l=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(Ui(t)))return e;var u=(null==o||null===(a=o.get)||void 0===a?void 0:a.call(o,"id"))||n,c=i.settings.shouldCreateEmptyGroup,p=t.push(u),f=!c,d=!(null==l||!l.isDefaultCase),v=e;return(e=sh(e,t,r,u,ia(i).merge(io(o)||{}),i,s))!==v&&(s||d||(e=e.setIn(Ui(p,"children1"),new lo.OrderedMap),f&&(e=sh(e,p,"rule",co(),Jf(i,null==l?void 0:l.parentRuleGroupField),i))),e=$i(e)),e},sh=function(e,t,r,n,o,i){var a,s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;if("switch_group"===r)throw new Error("Can't add switch_group programmatically");if(!e.getIn(Ui(t)))return e;var l,u,c=(null==o||null===(a=o.get)||void 0===a?void 0:a.call(o,"id"))||n,p=i.settings,f=p.maxNumberOfCases,d=p.maxNumberOfRules,v=p.maxNesting,h="switch_group"===e.get("type"),g=h?e.getIn(Ui(t.take(2))):null,y=Ui(t,"children1"),m=e.getIn(y),O=!!m&&m.size,b=O?m.size:null;if("case_group"===r)l=b,u=f;else if("group"===r){var E=Gi(e,t);if(E.length){var S=E[0],_=S.path,T=S.field,R=Ii(i,T);l=t.size-_.length,u=null==R?void 0:R.maxNesting}else l=t.size,u=v}else{var w=Gi(e,t);if(w.length){var I=w[0],L=I.path,C=I.field,A=Ii(i,C),x=qi(e,L);u=null==A?void 0:A.maxNumberOfRules,l=Yi(x)}else l=Yi(h?g:e),u=d}var N=!u||!l||l<u,j={type:r,id:c,properties:o};fh(i,j,s);var F="case_group"===r&&O&&null==m.last().get("children1");if(N){var P=new lo.OrderedMap(M({},c,new lo.Map(j)));if(O)if(F){var k=m.last(),D=new lo.OrderedMap(M(M({},c,new lo.Map(j)),k.get("id"),k));e=(e=e.deleteIn(Ui(y,"children1",k.get("id")))).mergeIn(y,D)}else e=e.mergeIn(y,P);else e=e.setIn(y,P);e=$i(e)}return e},lh=function(e,t){return e=e.deleteIn(Ui(t)),e=$i(e)},uh=function(e,t,r,n,o){var i,a,s,l,u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{},c=e.getIn(Ui(t));if(!c)return{state:e};var p=u.isEndValue,f=u.canDropArgs;if(!r)return{state:e=lh(e,t)};var d=n.settings,v=d.fieldSeparator,h=d.setOpOnChangeField,g=d.showErrorMessage;Array.isArray(r)&&(r=r.join(v));var y=c.get("type"),m=c.get("properties"),O="rule_group"==y,b=null==m?void 0:m.get("fieldSrc"),E=Ii(n,r);if(!E)return console.warn("No config for LHS ".concat(r)),{state:e};var S=E.type;"!group"!==S&&"!struct"!==S||(S=null);var _=null==m?void 0:m.get("operator"),T=null==m?void 0:m.get("operatorOptions"),R=null==m?void 0:m.get("field"),w="!group"==E.type,I=w&&"array"==E.mode,L=O!=w,C=E&&-1!==(null===(i=E.operators)||void 0===i?void 0:i.indexOf(_))?_:null,A="func"===b&&(null==R||null===(a=R.get)||void 0===a?void 0:a.call(R,"func"))===(null===(s=r)||void 0===s||null===(l=s.get)||void 0===l?void 0:l.call(s,"func"))&&!!C,x=null,N="func"===b?ki(n,S):Di(n,r);if(N&&1==N.length)x=N[0];else if(A)x=C;else if(N&&N.length>1){var j,F=oh(h);try{for(F.s();!(j=F.n()).done;){var P=j.value;if("keep"!=P||L?"default"==P?x=ua(n,r,!1):"first"==P&&(x=Vi(n,r)):x=C,x)break}}catch(e){F.e(e)}finally{F.f()}}if(!w&&!E.operators)return console.warn("Type ".concat(E.type," is not supported")),{state:e};O&&!w&&(e=(e=(e=e.setIn(Ui(t,"type"),"rule")).deleteIn(Ui(t,"children1"))).setIn(Ui(t,"properties"),new lo.OrderedMap)),m||(e=e.setIn(Ui(t,"properties"),new lo.OrderedMap));var k=!g;if(w){e=e.setIn(Ui(t,"type"),"rule_group");var D=ff({validateValue:Mf,validateRange:Gf},n,n,m,r,x,"field",k,p,f),V=(D.canReuseValue,D.newValue),M=D.newValueSrc,U=D.newValueType,B=D.operatorCardinality,q=ia(n,E,r).merge({field:r,fieldSrc:"field",mode:E.mode});I&&(q=q.merge({operator:x,value:V,valueSrc:M,valueType:U})),e=(e=e.setIn(Ui(t,"children1"),new lo.OrderedMap)).setIn(Ui(t,"properties"),q),E.initialEmptyWhere&&1==B||(e=sh(e,t,"rule",co(),Jf(n,r),n)),e=$i(e)}else e=e.updateIn(Ui(t,"properties"),(function(e){return e.withMutations((function(e){var t=ff({validateValue:Mf,validateRange:Gf},n,n,e,r,x,"field",k,p,f),o=t.canReuseValue,i=t.newValue,a=t.newValueSrc,s=t.newValueType,l=t.newValueError,u=t.newFieldError,c=t.fixedField,d=r;c!==r&&(d=c),g&&(e=(e=e.set("fieldError",u)).set("valueError",l));var v=o?T:na(n,x,d);return e=e.set("field",d).delete("fieldType").set("fieldSrc",b).set("operator",x).set("operatorOptions",v).set("value",i).set("valueSrc",a).set("valueType",s),o||(e=e.delete("asyncListValues")),e}))}));return{state:e}},ch=function(e,t,r,n,o,i,a){var s=arguments.length>7&&void 0!==arguments[7]?arguments[7]:{};if(!e.getIn(Ui(t)))return{state:e};var l=s.canDropArgs,u=s.isEndValue,c=i.settings,p=c.fieldSeparator,f=c.showErrorMessage,d=e.getIn(Ui(t,"properties","valueSrc",r+""))||null;"field"===d&&Array.isArray(n)&&(n=n.join(p));var v=e.getIn(Ui(t,"properties","field"))||null,h=e.getIn(Ui(t,"properties","operator"))||null,g=Li(i,h,v),y=h?No(g):null,m=o||ha(n,d,i),O=K(Mf(i,v,v,h,n,m,d,a,!f,u,l),2),b=O[0],E=O[1],S=null==E?void 0:E.find((function(e){return!e.fixed&&!e.ignore})),_=S?lf(S):null,T=b!==n;T&&(n=b),e=ph(e,t,i,y);var R=Array.from({length:y},(function(o,i){return i==r?n:e.getIn(Ui(t,"properties","value",i+""))||null})),w=Array.from({length:y},(function(r,n){return e.getIn(Ui(t,"properties","valueSrc",n+""))||null})),I=Gf(i,v,h,R,w),L=I?lf(I):null;((!!f||(!_&&!L||T))&&(e=e.deleteIn(Ui(t,"properties","asyncListValues")),void 0===n?e=(e=e.setIn(Ui(t,"properties","value",r),void 0)).setIn(Ui(t,"properties","valueType",r),null):(a&&(e=e.setIn(Ui(t,"properties","asyncListValues"),a)),e=(e=e.setIn(Ui(t,"properties","value",r),n)).setIn(Ui(t,"properties","valueType",r),m))),f)&&(e.getIn(Ui(t,"properties","valueError"))||(e=e.setIn(Ui(t,"properties","valueError"),new lo.List(new Array(y)))),e=e.setIn(Ui(t,"properties","valueError",r),_),y>=2&&(e=e.setIn(Ui(t,"properties","valueError",y),L)));return{state:e}},ph=function(e,t,r,n){if(!n){var o=e.getIn(Ui(t,"properties","field"))||null,i=e.getIn(Ui(t,"properties","operator"))||null,a=Li(r,i,o);n=i?No(a):null}for(var s=0,l=["value","valueType","valueError","valueSrc"];s<l.length;s++){var u=l[s];e.getIn(Ui(t,"properties",u))||(e=e.setIn(Ui(t,"properties",u),new lo.List(n?Array.from({length:n}):[])))}return e},fh=function(e,t,r){r&&Array.isArray(r)&&(t.children1=new lo.OrderedMap(r.reduce((function(t,r){var n,o=null!==(n=r.id)&&void 0!==n?n:co(),i=nh(nh({},r),{},{properties:Xf(e,r).merge(io(r.properties)||{}),id:o});return fh(e,i,i.children1),nh(nh({},t),{},M({},o,new lo.Map(i)))}),{})))},dh={dragging:{id:null,x:null,y:null,w:null,h:null},mousePos:{},dragStart:{id:null}},vh=function(e,t){if(!e||!e.type)return null;var r,n=[$v,Qv,Xv,Zv],o=th()(Ac()(e,["config","asyncListValues"]),Uo),i=e.path&&function(e,t){return e.getIn(Ui(t,"properties","field"))||null}(t.tree,e.path)||e.field;i&&(null!==(r=i)&&void 0!==r&&r.toJS&&(i=i.toJS()),o.affectedField=i);return(n.includes(e.type)||0==e.type.indexOf("@@redux"))&&(o=null),o};var hh=function(e,t){return{type:$v,tree:t,config:e}},gh=function(e,t,r){var n=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return{type:Pv,ruleType:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"rule",children:arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,path:Mo(t),id:co(),properties:Jf(e,n).merge(io(r)||{}),config:e,meta:{parentRuleGroupField:n}}},yh=function(e,t){return{type:kv,path:Mo(t),config:e}},mh=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:xv,path:Mo(t),children:n,id:co(),properties:ia(e).merge(io(r)||{}),config:e,meta:{isDefaultCase:!0}}},Oh=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return{type:xv,path:Mo(t),children:n,id:co(),properties:ia(e).merge(io(r)||{}),config:e}},bh=function(e,t,r){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;return{type:Av,path:Mo(t),children:n,id:co(),properties:ia(e,o).merge(io(r)||{}),config:e,meta:{parentRuleGroupField:o}}},Eh=function(e,t){return{type:Nv,path:Mo(t),config:e}},Sh=function(e,t,r,n){return{type:Wv,fromPath:Mo(t),toPath:Mo(r),placement:n,config:e}},_h=function(e,t,r){return{type:jv,path:Mo(t),conjunction:r}},Th=function(e,t,r){return{type:Fv,path:Mo(t),not:r}},Rh=function(e,t,r){return{type:Kv,path:Mo(t),lock:r}},wh=function(e,t,r,n,o){return{type:Dv,path:Mo(t),field:r,config:e,asyncListValues:n,_meta:o}},Ih=function(e,t,r){return{type:Vv,path:Mo(t),srcKey:r,config:e}},Lh=function(e,t,r){return{type:Mv,path:Mo(t),operator:r,config:e}},Ch=function(e,t,r,n,o,i,a){return{type:Uv,path:Mo(t),delta:r,value:n,valueType:o,asyncListValues:i,config:e,_meta:a}},Ah=function(e,t,r,n,o){return{type:Bv,path:Mo(t),delta:r,srcKey:n,config:e,_meta:o}},xh=function(e,t,r,n,o,i,a,s,l){return{type:qv,path:Mo(t),delta:r,parentFuncs:n,argKey:o,value:i,valueType:a,asyncListValues:s,config:e,_meta:l}},Nh=function(e,t,r,n){return{type:Gv,path:Mo(t),name:r,value:n,config:e}};function jh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Fh(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jh(Object(r),!0).forEach((function(t){M(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Ph=Fh(Fh(Fh({},m),{},{Export:p,Import:O,ConfigMixins:Iv},p),O),kh=r(7028),Dh=r.n(kh);const Vh=function(e,t,r,n,o){var i=nh({tree:t},dh);return function(){var t,a,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i,l=arguments.length>1?arguments[1]:void 0,u=null!==(t=null!==(a=null==o?void 0:o())&&void 0!==a?a:null==l?void 0:l.config)&&void 0!==t?t:e,c={__lastAction:void 0},p={},f=vh(l,s);switch(null==l?void 0:l.type){case $v:var d=r(u,l.tree);p.tree=d;break;case xv:p.tree=ah(s.tree,l.path,"case_group",l.id,l.properties,u,l.children,l.meta);break;case Av:p.tree=ah(s.tree,l.path,"group",l.id,l.properties,u,l.children,l.meta);break;case Nv:p.tree=function(e,t,r){if(!e.getIn(Ui(t)))return e;e=lh(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.slice(0,-1);Zi(e,o)||n||(e=Wi(e),!Qi(e)||n)||(e=sh(e,new lo.List,"rule",co(),Jf(r,void 0,void 0,!1,!1),r));return $i(e)}(s.tree,l.path,u);break;case Pv:p.tree=sh(s.tree,l.path,l.ruleType,l.id,l.properties,u,l.children);break;case kv:p.tree=function(e,t,r){if(!e.getIn(Ui(t)))return e;e=lh(e,t);var n=r.settings.canLeaveEmptyGroup,o=t.pop(),i=e.getIn(Ui(o)),a=i.getIn(["properties","field"]),s=i.getIn(["properties","operator"]),l=a?Ii(r,a):null,u=s?Li(r,s,a):null,c=a&&s&&0!=u.cardinality,p="rule_group"==i.get("type"),f=!Zi(e,o),d=p?c&&l.initialEmptyWhere:n;f&&!d&&(p&&(e=e.deleteIn(Ui(o))),e=Wi(e),Qi(e)&&!n)&&(e=sh(e,new lo.List,"rule",co(),Jf(r,void 0,void 0,!1,!1),r));return $i(e)}(s.tree,l.path,u);break;case jv:p.tree=function(e,t,r){return e.getIn(Ui(t))?e=e.setIn(Ui(t,"properties","conjunction"),r):e}(s.tree,l.path,l.conjunction);break;case Fv:p.tree=function(e,t,r){return e.getIn(Ui(t))?e=e.setIn(Ui(t,"properties","not"),r):e}(s.tree,l.path,l.not);break;case Dv:var v=uh(s.tree,l.path,l.field,u,l.asyncListValues,l._meta).state;p.tree=v;break;case Vv:p.tree=function(e,t,r,n){var o=e.getIn(Ui(t));if(!o)return e;var i=n.settings.keepInputOnChangeFieldSrc,a=o.get("properties"),s=null==a?void 0:a.get("field"),l=null==a?void 0:a.get("fieldType"),u=Ii(n,s),c=(null==u?void 0:u.type)||l;c&&"!group"!==c&&"!struct"!==c||(c=null);var p=!ci.includes(c);return(e=i&&!ba(o,n)&&p?(e=(e=e.setIn(Ui(t,"properties","field"),null)).deleteIn(Ui(t,"properties","fieldError"))).setIn(Ui(t,"properties","fieldType"),c):e.setIn(Ui(t,"properties"),Jf(n,null,null,!1))).setIn(Ui(t,"properties","fieldSrc"),r)}(s.tree,l.path,l.srcKey,u);break;case Kv:p.tree=function(e,t,r){return e.getIn(Ui(t))?e=Ki(e.setIn(Ui(t,"properties","isLocked"),r)):e}(s.tree,l.path,l.lock);break;case Mv:p.tree=function(e,t,r,n){var o=e.getIn(Ui(t));if(!o)return e;var i=n.settings.showErrorMessage,a=o.get("properties"),s=o.get("children1"),l=a.get("field"),u=(a.get("fieldSrc"),Ii(n,l)),c="!group"==(null==u?void 0:u.type),p=Li(n,r,l),f=p?No(p):null;return e=e.updateIn(Ui(t,"properties"),(function(e){return e.withMutations((function(e){var t=e.get("field"),o=e.get("operatorOptions"),a=(e.get("value",new lo.List),e.get("valueSrc",new lo.List),e.get("operator"),ff({validateValue:Mf,validateRange:Gf},n,n,e,t,r,"operator",!0)),s=a.canReuseValue,l=a.newValue,u=a.newValueSrc,c=a.newValueType,p=a.newValueError;i&&(e=e.set("valueError",p));var f=s?o:na(n,r,t);return s||(e=e.delete("asyncListValues")),e.set("operator",r).set("operatorOptions",f).set("value",l).set("valueSrc",u).set("valueType",c)}))})),c&&0==f&&0==s.size&&(e=sh(e,t,"rule",co(),Jf(n,l),n)),e}(s.tree,l.path,l.operator,u);break;case Uv:var h=ch(s.tree,l.path,l.delta,l.value,l.valueType,u,l.asyncListValues,l._meta).state;p.tree=h;break;case qv:var g=function(e,t,r,n,o,i,a,s,l){var u=arguments.length>9&&void 0!==arguments[9]?arguments[9]:{},c=t.getIn(Ui(r));if(!c)return t;var p,f=-1===n,d=c.get("properties"),v=d.get("field"),h=d.get("value"),g=[],y=f?v:h.getIn([n]),m=oh(o||[]);try{for(m.s();!(p=m.n()).done;){var O=K(p.value,2),b=O[0],E=O[1];if(g.push([b,E,y]),b!==y.get("func")){var S=g.map((function(e){var t=K(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")||"root";throw new Error("In ".concat(f?"LHS":"RHS"," for path ").concat(S," expected func key ").concat(b," but got ").concat(y.get("func")))}y=y.getIn(["args",E,"value"])}}catch(e){m.e(e)}finally{m.f()}if(i){var _=y.get("func"),T=yi(e,_).args[i];"!valueSrc"===s?y=$f(y,i,a,T,e):(y=ja(y,i,a,T,e),l&&(y=Wf(y,i,l,T,e)))}else y=Kf(y,a,e,!0),u.canDropArgs=!0;for(var R=y;g.length;){var w=K(g.pop(),3),I=w[0],L=w[1],C=w[2],A=yi(e,I).args[L];R=ja(C,L,R,A,e)}return f?uh(t,r,R,e,void 0,u):ch(t,r,n,R,void 0,e,void 0,u)}(u,s.tree,l.path,l.delta,l.parentFuncs,l.argKey,l.value,l.valueType,l.asyncListValues,l._meta),y=g.state;p.tree=y;break;case Bv:p.tree=function(e,t,r,n,o){if(!e.getIn(Ui(t)))return e;var i=o.settings.showErrorMessage,a=e.getIn(Ui(t,"properties","field"))||null,s=e.getIn(Ui(t,"properties","operator"))||null,l=Li(o,s,a),u=s?No(l):null;if(e=(e=(e=(e=ph(e,t,o,u)).setIn(Ui(t,"properties","value",r+""),void 0)).setIn(Ui(t,"properties","valueType",r+""),null)).deleteIn(Ui(t,"properties","asyncListValues")),i&&(e=e.setIn(Ui(t,"properties","valueError",r),null),null!=l&&l.validateValues&&(e=e.setIn(Ui(t,"properties","valueError",u),null))),e=void 0===n?e.setIn(Ui(t,"properties","valueSrc",r+""),null):e.setIn(Ui(t,"properties","valueSrc",r+""),n),n){var c=e.getIn(Ui(t,"properties")),p=ff({validateValue:Mf,validateRange:Gf},o,o,c,a,s,"valueSrc",!0),f=p.canReuseValue,d=p.newValue,v=p.newValueSrc,h=p.newValueType;p.newValueError,f||v.get(r)!=n||(e=(e=e.setIn(Ui(t,"properties","value",r+""),d.get(r))).setIn(Ui(t,"properties","valueType",r+""),h.get(r)))}return e}(s.tree,l.path,l.delta,l.srcKey,u,l._meta);break;case Gv:p.tree=function(e,t,r,n){return e.getIn(Ui(t))?e.setIn(Ui(t,"properties","operatorOptions",r),n):e}(s.tree,l.path,l.name,l.value);break;case Wv:p.tree=function(e,t,r,n){var o=qi(e,t),i=t.pop(),a=t.size>1?qi(e,i):null,s=a?a.get("children1"):null,l=qi(e,r),u=n==Yv||n==Jv?r:r.pop(),c=n==Yv||n==Jv?l:r.size>1?qi(e,u):null,p=c?c.get("children1"):null;if(!a||!c||!o)return e;var f=a.get("id")==c.get("id"),d=u.size<i.size&&jo(u.toArray(),i.toArray().slice(0,u.size)),v=u.size>i.size&&jo(i.toArray(),u.toArray().slice(0,i.size)),h=null,g=null;d?h=lo.List(i.toArray().slice(u.size)):v&&(g=lo.List(u.toArray().slice(i.size)));var y=p,m=s;return v||(m=m.delete(o.get("id"))),f?y=m:d&&(y=y.updateIn(Bi(h,"children1"),(function(e){return m}))),n==Hv||n==zv?y=lo.OrderedMap().withMutations((function(e){var t,r=oh(y.entries());try{for(r.s();!(t=r.n()).done;){var i=K(t.value,2),a=i[0],s=i[1];a==(null==l?void 0:l.get("id"))&&n==Hv&&e.set(o.get("id"),o),e.set(a,s),a==(null==l?void 0:l.get("id"))&&n==zv&&e.set(o.get("id"),o)}}catch(e){r.e(e)}finally{r.f()}})):n==Yv?y=y.merge(lo.OrderedMap(M({},o.get("id"),o))):n==Jv&&(y=lo.OrderedMap(M({},o.get("id"),o)).merge(y)),v&&(m=(m=m.updateIn(Bi(g,"children1"),(function(e){return y}))).delete(o.get("id"))),f||d||(e=e.updateIn(Ui(i,"children1"),(function(e){return m}))),v||(e=e.updateIn(Ui(u,"children1"),(function(e){return y}))),$i(e)}(s.tree,l.fromPath,l.toPath,l.placement);break;case Qv:p.dragStart=l.dragStart,p.dragging=l.dragging,p.mousePos=l.mousePos;break;case Xv:p.mousePos=l.mousePos,p.dragging=l.dragging;break;case Zv:p.tree=function(e,t){return t.settings.canLeaveEmptyGroup||(e=Wi(e)),e}(s.tree,u),p=nh(nh({},p),dh)}return f&&(p.__lastAction=f),n&&p.tree&&s.tree&&n(s.tree),nh(nh(nh({},s),c),p)}},Mh=k().createContext();var Uh=r(7694),Bh=r(200),qh="after",Gh="before",Kh="append",$h="prepend",Wh=function(e,t){return{type:"SET_DRAG_PROGRESS",mousePos:e,dragging:t}},zh=function(e,t,r){return{type:"SET_DRAG_START",dragStart:e,dragging:t,mousePos:r}},Hh=function(){return{type:"SET_DRAG_END"}},Yh=b,Jh=E,Xh=S;function Qh(e,t,r){return(t=L(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Zh(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function eg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Zh(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Zh(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var tg=function(e,t,r){if(!t||!e||e.length<=t)return e;var n=e.substr(0,t-1);return(r?n.substr(0,n.lastIndexOf(" ")):n)+"..."},rg=function(e,t){return e===t||(null==e?void 0:e.equals(t))},ng=function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return e===t||(Array.isArray(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=e.length;if(t.length!==n)return!1;for(var o=0;o<n;o++){if(!(r?ng(e[o],t[o],r):e[o]===t[o]))return!1}return!0}(e,t,r):e&&"function"==typeof e.equals?e.equals(t):"object"===I(e)?function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e===t)return!0;if(!e||!t)return!1;var n=Object.keys(e),o=Object.keys(t),i=n.length;if(o.length!==i)return!1;for(var a=0;a<i;a++){var s=n[a];if(!(r?ng(e[s],t[s],r):e[s]===t[s]))return!1}return!0}(e,t,r):e===t)};var og,ig,ag,sg="undefined"!=typeof process&&"true"==(null===(ig=process)||void 0===ig||null===(ig=ig.env)||void 0===ig?void 0:ig.NODE_ENV_TEST)?eg(eg({},console),{},{log:function(){},debug:function(){},info:function(){}}):(null!=og?og:"undefined"!=typeof process&&"development"==(null===(ag=process)||void 0===ag||null===(ag=ag.env)||void 0===ag?void 0:"production"))?console:{error:function(){},log:function(){},warn:function(){},debug:function(){},info:function(){}},lg=Ph.Validation.validateAndFixTree,ug=function(e){if(e){var t,r=(t=e)._reactRootContainer?"root":Object.getOwnPropertyNames(t).filter((function(e){return e.startsWith("__reactContainer")})).length>0?"container":void 0;return void 0!==r?r:ug(e.parentNode)}},cg=function(e){return"root"===ug(e)},pg=function(e,t){return function(r,n){var o=e.props,i=e.state,a=r!=o||n!=i;if(a&&i==n&&o!=r){var s=[];for(var l in r){var u=r[l]!=o[l];u&&("ignore"==t[l]?u=!1:"shallow_deep"==t[l]?u=!ng(r[l],o[l],!0):"shallow"==t[l]?u=!ng(r[l],o[l]):"function"==typeof t[l]&&(u=t[l](r[l],o[l],r,o))),u&&s.push(l)}s.length||(a=!1)}return a}},fg=function(e){return function(t,r){return!ng(e.props,t)||!ng(e.state,r)}},dg=function(e){if(e.shouldComponentUpdate||(e.shouldComponentUpdate=fg(e)),16==(r=k().version.split(".").map(parseInt.bind(null,10)))[0]&&r[1]<3||r[0]<16)e.componentWillReceiveProps=function(t){e.onPropsChanged(t)};else{var t=e.shouldComponentUpdate;e.shouldComponentUpdate=function(r,n){return!ng(e.props,r)&&e.onPropsChanged(r),t.call(e,r,n)}.bind(e)}var r},vg=function(e,t,r){return th()(e,(function(e){return function(){for(var n=arguments.length,o=new Array(n),i=0;i<n;i++)o[i]=arguments[i];return r(e.apply(void 0,[t].concat(o)))}}))};function hg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gg(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hg(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function yg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(yg=function(){return!!e})()}var mg=function(e){function t(e){var r;w(this,t),r=function(e,t,r){return t=N(t),x(e,yg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.shouldComponentUpdate=pg(r,{tree:function(e){return e!==r.oldValidatedTree||r.oldValidatedTree!==r.validatedTree}}),dg(r),r._updateActions(e),r.validatedTree=e.getMemoizedTree(e.config,e.tree,void 0,e.sanitizeTree),r.oldValidatedTree=r.validatedTree;var n=e.getBasicConfig(e.config);return e.onInit&&e.onInit(r.validatedTree,n,void 0,r.actions),r}return F(t,e),A(t,[{key:"_updateActions",value:function(e){var t=e.config,r=e.dispatch;this.actions=vg(gg(gg(gg({},Yh),Jh),Xh),t,r)}},{key:"onPropsChanged",value:function(e){var t=e.onChange,r=this.props.config,n=e.tree,o=(this.props.tree,e.config);if(this.oldValidatedTree=this.validatedTree,this.validatedTree=n,r!==o&&(this._updateActions(e),this.validatedTree=e.getMemoizedTree(o,n,r)),!rg(this.validatedTree,this.oldValidatedTree)){var i=e.getBasicConfig(o);t&&t(this.validatedTree,i,e.__lastAction,this.actions)}}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.renderBuilder,n=e.dispatch;return r({tree:this.validatedTree,actions:this.actions,config:t,dispatch:n})}}])}(P.Component);mg.propTypes={config:Dh().object.isRequired,onChange:Dh().func,onInit:Dh().func,renderBuilder:Dh().func,tree:Dh().any};var Og=(0,Bh.connect)((function(e){return{tree:e.tree,__lastAction:e.__lastAction}}),null,null,{context:Mh})(mg);Og.displayName="ConnectedQuery";const bg=Og;function Eg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Eg=function(){return!!e})()}var Sg=Ph.DefaultUtils.defaultRoot,_g=Ph.ConfigUtils,Tg=_g.createConfigMemo,Rg=_g.extendConfig,wg=function(e){function t(e,r){var n,o,i;w(this,t),i=function(e,t,r){return t=N(t),x(e,Eg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e,r]),i.setLastTree=function(e){i.prevTree&&(i.prevprevTree=i.prevTree),i.prevTree=e},i.getConfig=function(){return i.config},i.shouldComponentUpdate=pg(i,{value:function(e,t){return!1}}),dg(i);var a=Tg({reactIndex:null!==(n=null===(o=i._reactInternals)||void 0===o?void 0:o.index)&&void 0!==n?n:-1,maxSize:2,canCompile:!0,extendConfig:Rg}),s=a.getExtendedConfig,l=a.getBasicConfig,u=a.clearConfigMemo;i.getMemoizedConfig=s,i.getBasicConfig=l,i.clearConfigMemo=u,i.getMemoizedTree=function(){var e,t,r;return function(n,o){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,a=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];return o?n.__configId===r&&(rg(o,e)||rg(o,t))?t:(r=n.__configId,e=o,t=!1===a?lg(o,null,n,i||n,!1,!1,!1):lg(o,null,n,i||n)):null}}();var c=i.getMemoizedConfig(e),p=c.settings.shouldCreateEmptyGroup,f=Sg(c,!p),d=!!e.value,v=e.value||f,h=i.getMemoizedTree(c,v,void 0,d),g=Vh(c,h,i.getMemoizedTree,i.setLastTree,i.getConfig),y=(0,Uh.createStore)(g);return i.config=c,i.state={store:y},i.QueryWrapper=function(e){return c.settings.renderProvider(e,c.ctx)},i}return F(t,e),A(t,[{key:"componentWillUnmount",value:function(){this.clearConfigMemo()}},{key:"onPropsChanged",value:function(e){var t=this.props,r=this.config,n=this.getMemoizedConfig(e),o=r!==n,i=this.state.store.getState().tree,a=!rg(e.value,this.props.value)&&!rg(e.value,i),s=a?e.value||Sg(e):i,l=a&&!rg(e.value,this.prevTree)&&!rg(e.value,this.prevprevTree);this.sanitizeTree=l||o;var u=o&&!a;if(o&&(t.settings.renderProvider!==e.settings.renderProvider&&(this.QueryWrapper=function(e){return n.settings.renderProvider(e,n.ctx)}),this.config=n),a||o){var c=this.getMemoizedTree(n,s,u?r:void 0,this.sanitizeTree);this.state.store.dispatch(Yh.setTree(n,c))}}},{key:"render",value:function(){var e=this.props,t=e.renderBuilder,r=e.get_children,n=e.onChange,o=e.onInit,i=this.state.store,a=this.config,s=this.QueryWrapper;return k().createElement(s,{config:a},k().createElement(Bh.Provider,{store:i,context:Mh},k().createElement(bg,{config:a,getMemoizedTree:this.getMemoizedTree,getBasicConfig:this.getBasicConfig,sanitizeTree:this.sanitizeTree,onChange:n,onInit:o,renderBuilder:t||r})))}}])}(P.Component);function Ig(e,t){if(null==e)return{};var r,n,o=function(e,t){if(null==e)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(-1!==t.indexOf(n))continue;r[n]=e[n]}return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}function Lg(){return Lg=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Lg.apply(null,arguments)}function Cg(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ag(e,t){if(e){if("string"==typeof e)return Cg(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Cg(e,t):void 0}}function xg(e){return function(e){if(Array.isArray(e))return Cg(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||Ag(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}wg.propTypes={conjunctions:Dh().object.isRequired,fields:Dh().object.isRequired,types:Dh().object.isRequired,operators:Dh().object.isRequired,widgets:Dh().object.isRequired,settings:Dh().object.isRequired,ctx:Dh().object.isRequired,onChange:Dh().func,onInit:Dh().func,renderBuilder:Dh().func,value:Dh().any};var Ng=r(2584),jg=r.n(Ng);function Fg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Fg=function(){return!!e})()}var Pg=Ph.ConfigUtils.getFieldConfig,kg=function(e){var t;return t=function(t){function r(e){var t;return w(this,r),t=function(e,t,r){return t=N(t),x(e,Fg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,r,[e]),t.dummyFn=function(){},t.removeSelf=function(){t.props.actions.removeRule(t.props.path)},t.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;t.props.actions.setLock(t.props.path,e)},t.setField=function(e,r,n){t.props.actions.setField(t.props.path,e,r,n)},t.setFieldSrc=function(e){t.props.actions.setFieldSrc(t.props.path,e)},t.setOperator=function(e){t.props.actions.setOperator(t.props.path,e)},t.setOperatorOption=function(e,r){t.props.actions.setOperatorOption(t.props.path,e,r)},t.setValue=function(e,r,n,o,i){t.props.actions.setValue(t.props.path,e,r,n,o,i)},t.setValueSrc=function(e,r,n){t.props.actions.setValueSrc(t.props.path,e,r,n)},t.setFuncValue=function(e,r,n,o,i,a,s){t.props.actions.setFuncValue(t.props.path,e,r,n,o,i,a,s)},t.pureShouldComponentUpdate=fg(t),t.dummyFn.isDummyFn=!0,t}return F(r,t),A(r,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var s in e){var l=e[s]!=r[s];"dragging"!=s||i||(l=!1),l&&a.push(s)}a.length||(o=!1)}return o}},{key:"render",value:function(){var t=this.props.dragging.id==this.props.id,r=Pg(this.props.config,this.props.field),n=this.props.fieldType||(null==r?void 0:r.type)||null,o=this.props.config.settings.showErrorMessage,i=(r&&r.type,!t&&this.props.isDraggingTempo),a=this.props,s=a.valueError,l=null!=([a.fieldError].concat(xg((null==s?void 0:s.toArray())||[])).filter((function(e){return!!e})).shift()||null)&&o;return k().createElement("div",{className:jg()("group-or-rule-container","rule-container",l?"rule-with-error":null),"data-id":this.props.id},[t?k().createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,setField:this.dummyFn,setFieldSrc:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setOperatorOption:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k().createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,lev:this.props.path.size-1,isDraggingMe:t,isDraggingTempo:i,onDragStart:this.props.onDragStart,setLock:i?this.dummyFn:this.setLock,removeSelf:i?this.dummyFn:this.removeSelf,setField:i?this.dummyFn:this.setField,setFieldSrc:i?this.dummyFn:this.setFieldSrc,setFuncValue:i?this.dummyFn:this.setFuncValue,setOperator:i?this.dummyFn:this.setOperator,setOperatorOption:i?this.dummyFn:this.setOperatorOption,setValue:i?this.dummyFn:this.setValue,setValueSrc:i?this.dummyFn:this.setValueSrc,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:n,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,value:this.props.value||null,valueSrc:this.props.valueSrc||null,valueType:this.props.valueType||null,valueError:this.props.valueError||null,fieldError:this.props.fieldError||null,operatorOptions:this.props.operatorOptions,config:this.props.config,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,asyncListValues:this.props.asyncListValues,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(P.Component),t.propTypes={id:Dh().string.isRequired,groupId:Dh().string,config:Dh().object.isRequired,path:Dh().any.isRequired,operator:Dh().string,field:Dh().any,fieldSrc:Dh().string,fieldType:Dh().string,actions:Dh().object.isRequired,onDragStart:Dh().func,value:Dh().any,valueSrc:Dh().any,asyncListValues:Dh().array,valueError:Dh().any,fieldError:Dh().string,operatorOptions:Dh().object,reordableNodesCnt:Dh().number,parentField:Dh().string,isLocked:Dh().bool,isTrueLocked:Dh().bool,dragging:Dh().object,isDraggingTempo:Dh().bool},t};function Dg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Dg=function(){return!!e})()}var Vg=Ph.OtherUtils.clone,Mg=Ph.TreeUtils.getFlatTree,Ug=!1,Bg=function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t=function(t){function n(e){var t;return w(this,n),t=function(e,t,r){return t=N(t),x(e,Dg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,n,[e]),t._getEventTarget=function(e,t){return e&&e.__mocked_window||document.body||window},t.onDragStart=function(e,r,n){var o=r.closest(".query-builder");if(o){void 0===t._isUsingLegacyReactDomRender&&(t._isUsingLegacyReactDomRender=cg(o)),document.body.classList.add("qb-dragging"),o.classList.add("qb-dragging");var i,a=o.closest(".query-builder-container")||o,s=(a=t._getScrollParent(a)||document.body).scrollTop,l=(t._getDraggableNodeEl(o),t._getPlaceholderNodeEl(o),o.querySelectorAll(".group--children")),u=l.length?l[0]:null;u&&(i=window.getComputedStyle(u,null).getPropertyValue("padding-left"),i=parseInt(i));var c={id:e,x:r.offsetLeft,y:r.offsetTop,w:r.offsetWidth,h:r.offsetHeight,itemInfo:t.tree.items[e],paddingLeft:i},p={id:e,x:r.offsetLeft,y:r.offsetTop,scrollTop:s,clientX:n.clientX,clientY:n.clientY,itemInfo:Vg(t.tree.items[e]),treeEl:o,treeElContainer:a},f={clientX:n.clientX,clientY:n.clientY},d=t._getEventTarget(n,p);t.eventTarget=d,d.addEventListener("mousemove",t.onDrag),d.addEventListener("mouseup",t.onDragEnd),t.props.setDragStart(p,c,f)}else console.error("Please change renderBuilder implementation of <Query>: wrap <Builder> with div.query-builder for drag-n-drop support")},t.onDrag=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=Object.assign({},t.props.dragging),i=t.props.dragStart,a=o.paddingLeft,s=i.treeElContainer.scrollTop;if(o.itemInfo=t.tree.items[o.id],o.itemInfo){var l={clientX:e.clientX,clientY:e.clientY},u={clientX:i.clientX,clientY:i.clientY};if(e.__mock_dom){var c=i.treeEl,p=t._getDraggableNodeEl(c),f=t._getPlaceholderNodeEl(c);e.__mock_dom({treeEl:c,dragEl:p,plhEl:f})}if(!i.plX){var d=i.treeEl,v=t._getPlaceholderNodeEl(d);v&&(i.plX=v.getBoundingClientRect().left+window.scrollX,i.plY=v.getBoundingClientRect().top+window.scrollY)}var h=i.x,g=i.y,y=i.clientX,m=i.clientY,O=i.scrollTop,b={x:h+(e.clientX-y),y:g+(e.clientY-m)+(s-O)};o.x=b.x,o.y=b.y,o.paddingLeft=a,o.mousePos=l,o.startMousePos=u,t.props.setDragProgress(l,o),!!n&&t.handleDrag(o,e,r)||e.preventDefault&&e.preventDefault()}},t.onDragEnd=function(){var e=t.props.dragStart.treeEl;t.props.setDragEnd(),e.classList.remove("qb-dragging"),document.body.classList.remove("qb-dragging"),t._cacheEls={};var r=t.eventTarget||t._getEventTarget();r.removeEventListener("mousemove",t.onDrag),r.removeEventListener("mouseup",t.onDragEnd)},t.pureShouldComponentUpdate=fg(t),dg(t),t.onPropsChanged(e),t}return F(n,t),A(n,[{key:"onPropsChanged",value:function(e){this.tree=Mg(e.tree,e.config)}},{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=[];for(var a in e){e[a]!=r[a]&&"dragging"!=a&&"mousePos"!=a&&i.push(a)}i.length||(o=!1)}return o}},{key:"componentDidUpdate",value:function(e,t){var r=this.props.dragging,n=this.props.dragStart;if(Ug=!1,n&&n.id&&(r.itemInfo=this.tree.items[r.id],r.itemInfo&&(r.itemInfo.index!=n.itemInfo.index||r.itemInfo.parent!=n.itemInfo.parent))){var o=n.treeEl,i=n.treeElContainer,a=this._getPlaceholderNodeEl(o,!0);if(a){var s=a.getBoundingClientRect().left+window.scrollX,l=a.getBoundingClientRect().top+window.scrollY,u=n.plX,c=n.plY,p=i.scrollTop;n.plX=s,n.plY=l,n.itemInfo=Vg(r.itemInfo),n.y=a.offsetTop,n.x=a.offsetLeft,n.clientY+=l-c,n.clientX+=s-u,i!=document.body&&(n.scrollTop=p),this.onDrag(this.props.mousePos,!1)}}}},{key:"_getNodeElById",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null==t)return null;this._cacheEls||(this._cacheEls={});var n=this._cacheEls[t];return n&&document.contains(n)&&!r||(n=e.querySelector('.group-or-rule-container[data-id="'+t+'"]'),this._cacheEls[t]=n),n}},{key:"_getDraggableNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.draggable;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-draggable");return r=n.length?n[0]:null,this._cacheEls.draggable=r,r}},{key:"_getPlaceholderNodeEl",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this._cacheEls||(this._cacheEls={});var r=this._cacheEls.placeholder;if(r&&document.contains(r)&&!t)return r;var n=e.getElementsByClassName("qb-placeholder");return r=n.length?n[0]:null,this._cacheEls.placeholder=r,r}},{key:"_isScrollable",value:function(e){var t=window.getComputedStyle(e)["overflow-y"];return("scroll"===t||"auto"===t)&&e.scrollHeight>e.offsetHeight}},{key:"_getScrollParent",value:function(e){return null==e?null:e===document.body||this._isScrollable(e)?e:this._getScrollParent(e.parentNode)}},{key:"handleDrag",value:function(e,t,r){var n,o,i,a,s=this,l=e.itemInfo,u=e.paddingLeft,c=null,p=this.props.dragStart.treeEl,f=e.id,d=this._getDraggableNodeEl(p),v=this._getPlaceholderNodeEl(p);if(d&&v){if(n=d.getBoundingClientRect(),!(o=v.getBoundingClientRect()).width)return;var h={hrz:0,vrt:0};n.top<o.top?h.vrt=-1:n.bottom>o.bottom&&(h.vrt=1),n.left>o.left?h.hrz=1:n.left<o.left&&(h.hrz=-1);var g,y={x:(a=p.getBoundingClientRect()).left+(a.right-a.left)/2,y:h.vrt>=0?n.bottom:n.top};if(t.__mocked_hov_container)g=t.__mocked_hov_container;else{var m=document.elementFromPoint(y.x,y.y-1);if(!(g=m?m.closest(".group-or-rule-container"):null)&&m&&m.classList.contains("query-builder-container")){var O,b=null==m||null===(O=m.firstChild)||void 0===O?void 0:O.firstChild;b&&b.classList.contains("group-or-rule-container")&&(g=b)}}if(g){var E=g.classList.contains("group-container"),S=g.getAttribute("data-id"),_=g,T=!1,R=!1;if(_){var w=(i=_.getBoundingClientRect()).bottom-i.top,I=this.tree.items[S];if(!I)throw new Error("There is an issue with rendering. If you use Next.js, please check getServerSideProps() method.");var L=null,C=null,A=null,x=null;if(0==h.vrt)A=l,(C=v)&&(L=C.getBoundingClientRect());else if(E){if(h.vrt>0){var N=g.getElementsByClassName("group--header"),j=N.length?N[0]:null;if(j){var F=j.getBoundingClientRect(),P=F.bottom-F.top;n.bottom-F.top>3*P/4&&I.top>e.itemInfo.top&&(A=I,L=F,C=j,R=!0)}}else if(h.vrt<0){if(I.lev>=l.lev)i.bottom-n.top>=2&&I.top<e.itemInfo.top&&(A=I,L=i,C=_,T=!0)}(h.vrt<0?i.bottom-n.top>w-5:n.bottom-i.top>w-5)&&(R||T||(A=I,L=i,C=_),x=I)}else{(h.vrt<0?i.bottom-n.top>w/2:n.bottom-i.top>w/2)&&(A=I,L=i,C=_)}var k=A&&A.id==f;if(L){var D=n.left-a.left,V=(L.left,a.left,Math.max(0,Math.round(D/u))),M=[],U=[];if(k);else{if(E&&(T?M.push([Kh,A,A.lev+1]):R&&M.push([$h,A,A.lev+1]),x)){var B=0==x.lev,q="case_group"==x.type&&"case_group"!=l.type,G=x.prev&&this.tree.items[x.prev].caseId,K=x.next&&this.tree.items[x.next].caseId;l.caseId==G&&(G=null),l.caseId==K&&(K=null);var $=G&&this.tree.items[G],W=K&&this.tree.items[K];h.vrt>0?B?U.push([Kh,x,x.lev+1]):q&&W?U.push([$h,W,W.lev+1]):U.push([qh,x,x.lev]):h.vrt<0&&(B?U.push([$h,x,x.lev+1]):q&&$?U.push([Kh,$,$.lev+1]):U.push([Gh,x,x.lev]))}T||R||(h.vrt<0?M.push([Gh,A,A.lev]):h.vrt>0&&M.push([qh,A,A.lev]))}var z=function(e){var t=e[1],r=l.caseId?s.tree.items[l.caseId]:null,n=t.caseId?s.tree.items[t.caseId]:null;return[].concat(xg(e),[r,n])};M=M.map(z),U=U.map(z);var H=null,Y=(M=M.filter((function(e){var t=e[0],r=e[1];if((t==Gh||t==qh)&&null==r.parent)return!1;if(r.collapsed&&(t==Kh||t==$h))return!1;var n=r.id==l.id;if(!n)for(var o=r;o.parent;)if((o=s.tree.items[o.parent]).id==l.id){n=!0;break}return!n})).map((function(e){var t=e[0],r=e[1],n=(e[2],e[3],e[4],null);return(n=t==Kh||t==$h?r:s.tree.items[r.parent])&&null==n.parent&&(n=null),e[5]=n,e}))).filter((function(e){return s.canMove(l,e[1],e[0],e[3],e[4],e[5],r)}));0==Y.length&&U.length>0&&(Y=U.filter((function(e){return s.canMove(l,e[1],e[0],e[3],e[4],e[5],r)})));var J=Y.map((function(e){return e[2]})),X=l.lev,Q=J.concat(X),Z=null;-1!=Q.indexOf(V)?Z=V:V>Math.max.apply(Math,xg(Q))?Z=Math.max.apply(Math,xg(Q)):V<Math.min.apply(Math,xg(Q))&&(Z=Math.min.apply(Math,xg(Q))),H=Y.find((function(e){return e[2]==Z})),k||H||!Y.length||(H=Y[0]),c=H}}}else sg.log("out of tree bounds!")}return!!c&&(this.move(l,c[1],c[0],c[3]),!0)}},{key:"canMove",value:function(e,t,r,n,o,i,a){if(!e||!t)return!1;if(e.id===t.id)return!1;var s=this.props.config.settings,l=s.canRegroup,u=s.canRegroupCases,c=s.maxNesting,p=s.maxNumberOfRules,f=s.canLeaveEmptyCase,d=(i?i.nextAtomicLev:t.atomicLev)+(e.closestRuleGroupId?0:e.depth||("group"==e.type?1:0)),v=r==Gh||r==qh,h=r==$h||r==Kh,g=v&&1==t.lev||h&&0==t.lev,y=e.parent!=t.parent,m=h||y,O="rule_group"==e.type||!!e.closestRuleGroupId||"rule_group"==t.type||!!t.closestRuleGroupId,b=h&&"rule_group"==t.type?t.id:t.closestRuleGroupId,E=h&&"rule_group"==t.type?t.maxNesting:t.closestRuleGroupMaxNesting,S=0!=(h&&"rule_group"==t.type?t.canRegroup:t.closestRuleGroupCanRegroup),_=h&&"rule_group"==t.type?t.lev:t.closestRuleGroupLev,T=(i?i.lev+1:t.lev)+(e.depth||("group"==e.type?1:0))-(_||0),R=O&&e.closestRuleGroupId!=b,w="case_group"==e.type&&!g||"case_group"!=e.type&&"case_group"==t.type&&v||"case_group"!=e.type&&"switch_group"==t.type||!u&&e.caseId!=t.caseId||R,I=t.isLocked||e.isLocked||i&&i.isLocked;if(c&&d>c)return!1;if(E&&T>E)return!1;if(m&&(!l||w||I))return!1;if(O&&m&&!S)return!1;if("case_group"!=e.type&&e.caseId!=t.caseId){var L=!!n&&2==n._height,C=o?o.atomicRulesCountInCase+1:0;if(p&&C>p)return!1;if(L&&!f)return!1}if("case_group"==e.type&&(e.isDefaultCase||t.isDefaultCase||"switch_group"==t.type&&r==Kh))return!1;var A=!0;return a&&(A=a(e.node.toJS(),t.node.toJS(),r,i?i.node.toJS():null)),A}},{key:"move",value:function(e,t,r,n){this._isUsingLegacyReactDomRender||(Ug=!0),this.props.actions.moveItem(e.path,t.path,r)}},{key:"render",value:function(){return k().createElement(e,Lg({},this.props,{onDragStart:this.onDragStart}))}}])}(P.Component),t.propTypes={tree:Dh().any.isRequired,actions:Dh().object.isRequired},t};var qg=["isDraggingTempo","isDraggingMe","dragging"];function Gg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Gg=function(){return!!e})()}const Kg=function(e){return function(t){var r;return r=function(r){function n(e){var t;return w(this,n),t=function(e,t,r){return t=N(t),x(e,Gg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,n,[e]),t.handleDraggerMouseDown=function(e){var r=t.props.id,n=t.wrapper.current;t.props.onDragStart&&t.props.onDragStart(r,n,e)},t.wrapper=k().createRef(),t}return F(n,r),A(n,[{key:"render",value:function(){var r=this.props,n=r.isDraggingTempo,o=r.isDraggingMe,i=r.dragging,a=Ig(r,qg),s=a.isTrueLocked,l={};o&&n&&(Ug||(l={top:i.y,left:i.x,width:i.w}));var u=jg()(e,"group-or-rule",o&&n?"qb-draggable":null,o&&!n?"qb-placeholder":null,s?"locked":null);return k().createElement("div",{className:u,style:l,ref:this.wrapper,"data-id":this.props.id},k().createElement(t,Lg({handleDraggerMouseDown:this.handleDraggerMouseDown,isDraggingMe:o,isDraggingTempo:n},a)))}}])}(P.PureComponent),r.propTypes={isDraggingTempo:Dh().bool,isDraggingMe:Dh().bool,onDragStart:Dh().func,dragging:Dh().object,isLocked:Dh().bool,isTrueLocked:Dh().bool},r}};var $g=r(3790),Wg=r.n($g),zg=r(350),Hg=r.n(zg);function Yg(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Jg(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Jg=function(){return!!e})()}var Xg=Ph.ConfigUtils,Qg=Xg.getFieldConfig,Zg=Xg.getOperatorConfig,ey=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,Jg()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.shouldComponentUpdate=pg(r,{selectedField:function(e,t){return!1}}),dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","selectedField","selectedFieldSrc","selectedFieldType","selectedOperator"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.selectedField,o=e.selectedFieldType,i=e.selectedOperator,a=Qg(r,n),s=xg((null==a?void 0:a.operators)||(null===(t=r.types[o])||void 0===t?void 0:t.operators)||[]);n||s.includes(i)||s.push(i);var l=th()(Hg()(r.operators,(function(e,t){return-1!==(null==s?void 0:s.indexOf(t))})),(function(e,t){return Zg(r,t,n)})),u=this.buildOptions(r,l,s),c=l[i]||{},p=i?[i]:null;return{placeholder:this.props.config.settings.operatorPlaceholder,items:u,selectedKey:i,selectedKeys:p,selectedPath:p,selectedLabel:c.label,selectedAltLabel:c.label2||c.tooltip,selectedOpts:c,fieldConfig:a}}},{key:"buildOptions",value:function(e,t,r){return t&&r?Wg()(t).sort((function(e,t){return r.indexOf(e)-r.indexOf(t)})).map((function(e){var r=t[e];return{key:e,path:e,label:r.label,altLabel:r.label2,tooltip:r.tooltip}})):null}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setOperator,o=e.readonly,i=e.id,a=e.groupId,s=t.settings.renderOperator,l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Yg(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Yg(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:n},this.meta);return l.items?s(l,t.ctx):null}}])}(P.Component);function ty(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,o,i,a,s=[],l=!0,u=!1;try{if(i=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=i.call(r)).done)&&(s.push(n.value),s.length!==t);l=!0);}catch(e){u=!0,o=e}finally{try{if(!l&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(u)throw o}}return s}}(e,t)||Ag(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}ey.propTypes={id:Dh().string,groupId:Dh().string,config:Dh().object.isRequired,selectedField:Dh().any,selectedFieldId:Dh().string,selectedFieldType:Dh().string,selectedFieldSrc:Dh().string,selectedOperator:Dh().string,readonly:Dh().bool,customProps:Dh().object,setOperator:Dh().func.isRequired};var ry=["children"],ny=function(e){var t=e.children,r=Ig(e,ry);return k().createElement("div",r,t)},oy=function(){},iy=function(){return k().createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"gray",width:"18px",height:"18px"},k().createElement("path",{d:"M0 0h24v24H0V0z",fill:"none"}),k().createElement("path",{d:"M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"}))},ay=function(e){return function(t){var r=t.config.settings.useConfirm,n=r?r.call(t.config.ctx,t.config.ctx):null;return k().createElement(e,Lg({},t,{confirmFn:n}))}},sy=function(e){var t=e.id,r=e.isLHS,n=e.delta;return[t,r?"L":"R",r?-1:n||0,(e.parentFuncs||[]).map((function(e){var t=ty(e,2),r=t[0],n=t[1];return"".concat(r,"(").concat(n,")")})).join("/")].join(":")},ly=function(e,t){var r;return"function"==typeof t?(r=function(r){return null==t?void 0:t(r,e.ctx)}).displayName=t.name:r=t,r};function uy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(uy=function(){return!!e})()}var cy=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,uy()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,a=e.setOperator,s=e.selectedFieldId,l=e.showOperator,u=e.showOperatorLabel,c=e.selectedFieldWidgetConfig,p=e.readonly,f=e.id,d=e.groupId;return[l&&k().createElement(ny,{key:"operators-for-"+s,className:"rule--operator"},t.settings.showLabels&&k().createElement("label",{className:"rule--label"},t.settings.operatorLabel),k().createElement(ey,{key:"operator",config:t,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,selectedFieldId:s,selectedOperator:i,setOperator:a,customProps:t.settings.customOperatorSelectProps,readonly:p,id:f,groupId:d})),u&&k().createElement(ny,{key:"operators-for-"+s,className:"rule--operator"},k().createElement("div",{className:"rule--operator-wrapper"},t.settings.showLabels?k().createElement("label",{className:"rule--label"},""):null,k().createElement("div",{className:"rule--operator-text-wrapper"},k().createElement("span",{className:"rule--operator-text"},c.operatorInlineLabel))))]}}])}(P.PureComponent);function py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function fy(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fy=function(){return!!e})()}var dy=Ph.RuleUtils.getFieldPathLabels,vy=Ph.ConfigUtils,hy=vy.getFieldConfig,gy=vy.getFieldParts,yy=vy.getFieldPathParts,my=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,fy()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.setField=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=r.props.id;if(!n.widgetId){var i=[o,"L",-1].join(":");n.widgetId=i}r.props.setField(e,t,n)},dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","config","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.config,o=e.parentField,i=t,a=n.settings,s=a.maxLabelsLength,l=a.fieldSeparatorDisplay,u=a.fieldPlaceholder,c=(a.fieldSeparator,!!t),p=c?null:tg(u,s),f=c?hy(n,i):null,d=f||{},v=yy(i,n),h=yy(i,n,!0),g=this.getFieldLabel(f,i,n),y=dy(i,n),m=y?y.join(l):null;(m==g||o)&&(m=null);var O=d.label2||d.tooltip,b=gy(o,n),E=o?hy(n,o):null,S=o?E&&E.subfields:n.fields,_=!c&&r,T=this.buildOptions(b,n,S,_,b),R=_?"Please select field":null;return i&&"object"===I(i)&&(i=void 0),{placeholder:p,items:T,parentField:o,selectedKey:i,selectedKeys:v,selectedPath:h,selectedLabel:g,selectedOpts:d,selectedAltLabel:O,selectedFullLabel:m,errorText:R}}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=gy(t,r),i=(null==e?void 0:e.label)||va()(o);return i=tg(i,n)}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;if(!r)return null;var s=t.settings,l=s.fieldSeparator,u=s.fieldSeparatorDisplay,c=null!=i&&i.length?i.join(l)+l:"",p=function(e){return Object.keys(e||{}).reduce((function(t,r){var n=e[r];return"!struct"===n.type?t+p(n.subfields):t+(n.type===o?1:0)}),0)};return Wg()(r).map((function(s){var l=[].concat(xg(null!=i?i:[]),[s]),f=r[s],d=n.getFieldLabel(f,l,t),v=dy(l,t).join(u);(v==d||null!=e&&e.length)&&(v=null);var h=f.label2,g=f.tooltip,y=f.disabled;if(!f.hideForSelect){if("!struct"==f.type){var m=n.buildOptions(e,t,f.subfields,o,l,{label:d,tooltip:g}),O=p(f.subfields)>0;return{disabled:y,key:s,path:c+s,label:d,fullLabel:v,altLabel:h,tooltip:g,items:m,matchesType:O}}var b=void 0!==o?f.type===o:void 0;return{disabled:y,key:s,path:c+s,label:d,fullLabel:v,altLabel:h,tooltip:g,grouplabel:null==a?void 0:a.label,group:a,matchesType:b}}})).filter((function(e){return!!e}))}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setFieldSrc,o=e.readonly,i=e.id,a=e.groupId,s=t.settings.renderField;if(!this.meta.items)return null;var l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?py(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):py(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({id:i,groupId:a,config:t,customProps:r,readonly:o,setField:this.setField,setFieldSrc:n},this.meta);return s(l,t.ctx)}}])}(P.Component);function Oy(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function by(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(by=function(){return!!e})()}my.propTypes={id:Dh().string,groupId:Dh().string,config:Dh().object.isRequired,selectedField:Dh().any,selectedFieldSrc:Dh().string,selectedFieldType:Dh().string,parentField:Dh().string,customProps:Dh().object,readonly:Dh().bool,setField:Dh().func.isRequired,setFieldSrc:Dh().func};var Ey=Ph.clone,Sy=Ph.ConfigUtils,_y=Sy.getFieldConfig,Ty=Sy.getFuncConfig,Ry=Sy.getFieldParts,wy=Sy.getFieldPathParts,Iy=Sy.getWidgetForFieldOp,Ly=Ph.RuleUtils.getFuncPathLabels,Cy=Ph.OtherUtils.shallowEqual,Ay=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,by()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldType","fieldSrc","operator","isFuncArg","isLHS","parentFuncs"].map((function(r){return"parentFuncs"===r?!Cy(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0;(!this.meta||["config","field","fieldType","fieldSrc","value","isLHS"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r&&(this.items=this.getItems(e,this.meta))}},{key:"getItems",value:function(e,t){var r=e.config,n=e.field,o=e.fieldType,i=e.isLHS,a=e.operator,s=e.parentFuncs,l=e.fieldDefinition,u=e.isFuncArg,c=t.lookingForFieldType,p=r.settings.canUseFuncForField,f=this.filterFuncs(r,r.funcs,n,o,i,a,p,s,u,l);return this.buildOptions(r,f,c)}},{key:"getMeta",value:function(e){var t=e.config,r=(e._field,e.fieldType),n=e.value,o=e.isLHS,i=e.isFuncArg,a=t.settings,s=a.funcPlaceholder,l=a.fieldSeparatorDisplay,u=n,c=!!n,p=c?null:s,f=c?Ty(t,u):null,d=f||{},v=wy(u,t),h=wy(u,t,!0),g=this.getFuncLabel(f,u,t),y=Ly(u,t),m=y?y.join(l):null;m==g&&(m=null);var O=o&&!i&&!c&&r;return{placeholder:p,selectedKey:u,selectedKeys:v,selectedPath:h,selectedLabel:g,selectedOpts:d,selectedFullLabel:m,errorText:O?"Please select function":null,lookingForFieldType:O}}},{key:"filterFuncs",value:function(e,t,r,n,o,i,a,s,l,u){t=Ey(t);var c,p=e.settings.fieldSeparator,f=_y(e,r),d=f,v=Iy(e,r,i,"value");v&&e.widgets[v];return l?(d=u,c=null==u?void 0:u.type):f?c=f.type:o||(c=n),function t(n,o){for(var l in n){var u=n[l].subfields,v=(o||[]).concat(l),h=v.join(p),g=Ty(e,h);if("!struct"==g.type)0==t(u,v)&&delete n[l];else{var y,m=!c||g.returnType==c;null!==(y=d)&&void 0!==y&&y.funcs&&(m=m&&d.funcs.includes(h)),a&&(m=m&&a(r,f,h,g,i)),!g.allowSelfNesting&&s&&s.map((function(e){var t=ty(e,2),r=t[0];t[1];return r})).includes(h)&&(m=!1),m||delete n[l]}}return Wg()(n).length}(t,[]),t}},{key:"buildOptions",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!t)return null;var a=e.settings,s=a.fieldSeparator,l=a.fieldSeparatorDisplay,u=null!=o&&o.length?o.join(s)+s:"",c=function(e){return Object.keys(e||{}).reduce((function(t,r){var o=e[r];return"!struct"===o.type?t+c(o.subfields):t+(o.type===n?1:0)}),0)};return Wg()(t).map((function(a){var s=[].concat(xg(null!=o?o:[]),[a]),p=t[a],f=r.getFuncLabel(p,s,e),d=Ly(s,e).join(l);d==f&&(d=null);var v=p.tooltip;if("!struct"==p.type){var h=r.buildOptions(e,p.subfields,n,s,{label:f,tooltip:v}),g=c(p.subfields)>0;return{key:a,path:u+a,label:f,fullLabel:d,tooltip:v,items:h,matchesType:g}}var y=void 0!==n?p.returnType===n:void 0;return{key:a,path:u+a,label:f,fullLabel:d,tooltip:v,grouplabel:null==i?void 0:i.label,group:i,matchesType:y}}))}},{key:"getFuncLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=Ry(t,r),i=(null==e?void 0:e.label)||va()(o);return i=tg(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,a=e.groupId,s=t.settings.renderFunc,l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Oy(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Oy(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({config:t,customProps:r,readonly:o,setField:n,items:this.items,id:i,groupId:a},this.meta);return s(l,t.ctx)}}])}(P.Component);Ay.propTypes={id:Dh().string,groupId:Dh().string,config:Dh().object.isRequired,field:Dh().any,fieldType:Dh().string,fieldSrc:Dh().string,operator:Dh().string,customProps:Dh().object,value:Dh().string,setValue:Dh().func.isRequired,readonly:Dh().bool,parentFuncs:Dh().array,fieldDefinition:Dh().object,isFuncArg:Dh().bool,isLHS:Dh().bool};var xy=r(2285),Ny=r.n(xy),jy=["widgetFactory"],Fy=["factory"];function Py(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ky(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Py(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Py(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Dy=Ph.ListUtils.getTitleInListValues,Vy=Ph.ConfigUtils._widgetDefKeysToOmit,My=Ph.TreeUtils,Uy=My._fixImmutableValue,By=My.isImmutable,qy=(0,P.memo)((function(e){var t=e.widgetFactory,r=Ig(e,jy),n=r.config,o=r.isFuncArg,i=r.fieldDefinition||{},a=i.fieldSettings,s=i.defaultValue,l=i.valueSources,u=o&&1==(null==l?void 0:l.length)&&"const"===(null==l?void 0:l[0]),c=(null==a?void 0:a.treeValues)||(null==a?void 0:a.listValues);return u&&s?"boolean"==typeof s?s?r.labelYes||"YES":r.labelNo||"NO":c?Array.isArray(s)?s.map((function(e){return Dy(c,e)||e})).join(", "):Dy(c,s)||s:""+s:t?t(r,n.ctx):"?"}));qy.displayName="WidgetFactoryMemo";var Gy=function(e){var t=e.delta,r=e.parentDelta,n=e.isFuncArg,o=e.valueSrc,i=e.value,a=e.valueError,s=e.fieldError,l=e.asyncListValues,u=e.isSpecialRange,c=e.fieldDefinition,p=e.widget,f=e.widgetDefinition,d=e.widgetValueLabel,v=e.valueLabels,h=e.textSeparators,g=e.setValue,y=e.setFuncValue,m=e.config,O=e.field,b=e.fieldSrc,E=e.fieldPath,S=e.fieldType,_=e.isLHS,T=e.operator,R=e.readonly,w=e.parentField,I=e.parentFuncs,L=e.id,C=e.groupId,A=e.widgetId,x=f.factory,N=Ig(f,Fy),j=i?i.map((function(e){return Uy(e)})):void 0,F=(0,P.useMemo)((function(){if(u){var e=[null==j?void 0:j.get(0),null==j?void 0:j.get(1)];return void 0===e[0]&&void 0===e[1]&&(e=void 0),e}return null==j?void 0:j.get(t)}),[u,i]),D=(0,P.useMemo)((function(){var e;return a?u?[a.get(0),a.get(1),a.get(2)]:null==a||null===(e=a.get)||void 0===e?void 0:e.call(a,t):null}),[u,i]),V=_?s:D,M=(c||{}).fieldSettings,U=d.label,B=d.placeholder,q=v?v.placeholder:null,G=By(O)?null:O,K=Ac()(ky(ky(ky({},N),M),{},{config:m,field:G,fieldPath:E,fieldSrc:b,fieldType:S,isLHS:_,parentField:w,parentFuncs:I,fieldDefinition:c,operator:T,delta:t,parentDelta:r,isSpecialRange:u,isFuncArg:n,value:F,valueSrc:o,valueError:D,fieldError:s,errorMessage:V,label:U,placeholder:B,placeholders:q,textSeparators:h,setValue:g,setFuncValue:y,readonly:R,asyncListValues:l,id:L,groupId:C,widgetId:A,widgetFactory:x,widget:p}),[].concat(xg(Vy),["toJS"]));return k().createElement(qy,Lg({widgetFactory:x},K))};Gy.displayName="WidgetFactory";const Ky=Gy;function $y(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return($y=function(){return!!e})()}var Wy=Ph.ConfigUtils,zy=Wy.getFieldConfig,Hy=Wy.getOperatorConfig,Yy=Wy.getFieldWidgetConfig,Jy=Wy.getWidgetForFieldOp,Xy=Wy.getValueSourcesForFieldOp,Qy=Ph.RuleUtils.getValueLabel,Zy=Ph.DefaultUtils.createListWithOneElement,em=Ph.OtherUtils.shallowEqual,tm=(Ph.TreeUtils.isImmutable,{cardinality:1}),rm=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,$y()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r._setValue=function(e,t,n,o,i,a){var s=arguments.length>6&&void 0!==arguments[6]?arguments[6]:{};if(s.widgetId||(s.widgetId=o),e&&Array.isArray(i)){var l=[r.props.value.get(0),r.props.value.get(1)];l[0]!=i[0]&&r.props.setValue(0,i[0],n,a,s),l[1]!=i[1]&&r.props.setValue(1,i[1],n,a,s)}else r.props.setValue(t,i,n,a,s)},r._setValueSrc=function(e,t,n){var o={widgetId:t};r.props.setValueSrc(e,n,o)},r.renderWidget=function(e,t,r){var n=r.config,o=r.isFuncArg,i=r.leftField,a=r.operator,s=r.value,l=r.valueError,u=r.fieldError,c=r.readonly,p=r.parentField,f=r.parentFuncs,d=r.id,v=r.groupId,h=r.fieldSrc,g=r.fieldType,y=r.isLHS,m=r.setFuncValue,O=r.parentDelta,b=n.settings,E=t.widgets,S=t.iValues,_=t.aField,T=t.valueSources,R=o?S:s,w=o?i:_,I=E[e],L=I.valueSrc,C=I.valueLabel,A=I.widgetId,x=T.length>1&&!c,N=b.showLabels?k().createElement("label",{key:"label-"+A,className:"rule--label"},C.label):null;return k().createElement("div",{key:"wrapper-"+A,className:jg()("func"===L?"widget--func":"widget--widget",x?"widget--has-valuesrcs":"widget--has-no-valuesrcs")},"func"===L?null:N,k().createElement(Ky,Lg({key:A,id:d,groupId:v,widgetId:A,valueSrc:L,delta:e,value:R,valueError:l,fieldError:u,isFuncArg:o,isLHS:y},ni()(t,["isSpecialRange","fieldDefinition","asyncListValues"]),ni()(E[e],["widget","widgetDefinition","widgetValueLabel","valueLabels","textSeparators","setValue"]),{setFuncValue:m,config:n,field:w,fieldSrc:h,fieldType:g,parentField:p,parentFuncs:f,parentDelta:null!=O?O:e,operator:a,readonly:c})))},r.renderValueSources=function(e,t,n){var o=n.config,i=n.isFuncArg,a=n.leftField,s=n.operator,l=n.readonly,u=o.settings,c=t.valueSources,p=t.widgets,f=t.aField,d=t.valueSourcesOptions,v=i?a:f,h=p[e],g=h.valueSrc,y=h.setValueSrc,m=r.ValueSources,O=u.showLabels?k().createElement("label",{className:"rule--label"},""):null;return c.length>1&&!l&&k().createElement("div",{key:"wrapper-valuesrc-"+e,className:"widget--valuesrc"},O,k().createElement(m,{key:"valuesrc-"+e,delta:e,valueSources:d,valueSrc:g,config:o,field:v,operator:s,setValueSrc:y,readonly:l,title:u.valueSourcesPopupTitle}))},r.renderSep=function(e,t,r){var n=r.config,o=t.widgets,i=n.settings,a=o[e].sepText,s=i.showLabels?k().createElement("label",{className:"rule--label"},""):null;return a&&k().createElement("div",{key:"widget-separators-"+e,className:jg()("widget--sep",0==e&&"widget--sep-first")},s,k().createElement("span",null,a))},r.renderWidgetDelta=function(e){return[r.renderSep(e,r.meta,r.props),r.renderValueSources(e,r.meta,r.props),r.renderWidget(e,r.meta,r.props)]},dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config),n=["config","id","parentFuncs","field","fieldId","fieldSrc","fieldType","fieldFunc","fieldArg","leftField","operator","valueSrc","asyncListValues","isLHS","isFuncArg","isForRuleGroup","isCaseValue","value","parentDelta"].filter((function(r){return"parentFuncs"===r?!em(e[r],t[r],!0):"field"===r?e.fieldId!==t.fieldId:e[r]!==t[r]}));if((!this.meta||n.length>0)&&(this.meta=this.getMeta(e,n)),r){var o=e.config,i=o.settings.renderValueSources;this.ValueSources=ly(o,i)}}},{key:"getMeta",value:function(e){var t,r,n,o,i=this,a=e.config,s=e.field,l=(e.fieldSrc,e.fieldType),u=e.fieldFunc,c=e.fieldArg,p=e.operator,f=e.valueSrc,d=e.value,v=e.isForRuleGroup,h=e.isCaseValue,g=e.isFuncArg,y=(e.leftField,e.asyncListValues),m=e.parentFuncs,O=e.isLHS,b=e.id,E=e.parentDelta,S=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],_=a.settings.valueSourcesInfo,T=g?{func:u,arg:c}:s,R=!s&&l,w=f,I=d;(g||v||h)&&(w=Zy(f),I=Zy(d));var L=zy(a,T);!L&&R&&(L=a.types[l]);var C,A=Jy(a,T,p);!A&&R&&(A=null===(C=a.types[l])||void 0===C?void 0:C.mainWidget);var x=g?tm:Hy(a,p,T);if((null==L||null==x)&&!h)return null;var N,j,F=null==x?void 0:x.isSpecialRange,P=F&&("field"===(null===(t=w)||void 0===t?void 0:t.get(0))||"field"===(null===(r=w)||void 0===r?void 0:r.get(1))),k=F&&!P,D=k?1:null!==(j=null==(N=x)?void 0:N.cardinality)&&void 0!==j?j:1;if(0===D)return null;var V=null===(n=this.meta)||void 0===n?void 0:n.valueSources,M=null===(o=this.meta)||void 0===o?void 0:o.valueSourcesOptions,U={value:"Value",field:"Field",func:"Function"};V&&!["field","operator","config","fieldDefinition","isForRuleGroup"].filter((function(e){return S.includes(e)})).length||(V=Xy(a,T,p,L),v&&(V=["value"]),T||(V=Object.keys(_)),M=V.map((function(e){var t,r,n;return[e,{label:null!==(t=null!==(r=null===(n=_[e])||void 0===n?void 0:n.label)&&void 0!==r?r:U[e])&&void 0!==t?t:e}]})));var B=(g?[0]:Ny()(0,D)).map((function(e){var t,r,n,o,s=null===(t=i.meta)||void 0===t||null===(t=t.widgets)||void 0===t?void 0:t[e],l=(null===(r=w)||void 0===r?void 0:r.get(e))||null,u=Jy(a,T,p,l),c=Yy(a,T,p,u,l);P&&(u=c.singleWidget,c=Yy(a,T,p,u,l)),!c&&R&&(u=["func","field"].includes(l)?l:A,c=a.widgets[u]);var f=null===(n=c)||void 0===n?void 0:n.type,d=Qy(a,T,p,e,l,k),v=Qy(a,T,p,e,null,k),h=null!=x&&x.textSeparators?null==x?void 0:x.textSeparators[e]:null,g=null,y=null;F&&(g={placeholder:[(g=[Qy(a,T,p,0),Qy(a,T,p,1)])[0].placeholder,g[1].placeholder],label:[g[0].label,g[1].label]},y=null==x?void 0:x.textSeparators);var S=sy({id:b,isLHS:O,delta:null!=E?E:e,parentFuncs:m}),_=S+":VS",I=null==s?void 0:s.setValueSrc;I&&(null==s?void 0:s.widgetId)===S||(I=i._setValueSrc.bind(i,e,_));var L=null==s?void 0:s.setValue;return L&&(null==s?void 0:s.widgetId)===S&&(null==s?void 0:s.widgetType)===f&&(null===(o=i.meta)||void 0===o?void 0:o.isSpecialRange)===F||(L=i._setValue.bind(i,F,e,f,S)),{valueSrc:l,valueLabel:d,widget:u,sepText:h,widgetDefinition:c,widgetValueLabel:v,valueLabels:g,textSeparators:y,setValueSrc:I,setValue:L,widgetId:S,widgetType:f}}));return{defaultWidget:A,fieldDefinition:L,operatorDefinition:x,isSpecialRange:k,cardinality:D,valueSources:V,valueSourcesOptions:M,widgets:B,iValues:I,aField:T,asyncListValues:y}}},{key:"render",value:function(){if(!this.meta)return null;var e=this.meta,t=e.defaultWidget,r=e.cardinality,n=this.meta.isFuncArg;if(!t)return null;var o=t;return k().createElement(ny,{className:"rule--widget rule--widget--".concat(o.toUpperCase()),key:"widget-col-"+o},(n?[0]:Ny()(0,r)).map(this.renderWidgetDelta))}}])}(P.Component);function nm(e,t,r){return t=N(t),x(e,om()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}function om(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(om=function(){return!!e})()}rm.propTypes={config:Dh().object.isRequired,value:Dh().any,valueSrc:Dh().any,valueError:Dh().any,fieldError:Dh().string,field:Dh().any,fieldSrc:Dh().string,fieldType:Dh().string,fieldId:Dh().string,operator:Dh().string,readonly:Dh().bool,asyncListValues:Dh().array,id:Dh().string,groupId:Dh().string,setValue:Dh().func,setValueSrc:Dh().func,setFuncValue:Dh().func,isFuncArg:Dh().bool,fieldFunc:Dh().string,fieldArg:Dh().string,leftField:Dh().any,isForRuleGroup:Dh().bool,parentField:Dh().string,parentFuncs:Dh().array,isLHS:Dh().bool,parentDelta:Dh().number,isCaseValue:Dh().bool};var im=Ph.ConfigUtils.getFuncConfig,am=Ph.OtherUtils.shallowEqual,sm=function(e){function t(e){var r;return w(this,t),(r=nm(this,t,[e])).setFunc=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=r.props,o=n.isLHS,i=n.parentDelta,a=n.parentFuncs,s=n.id;if(!t.widgetId){var l=sy({id:s,isLHS:o,delta:i,parentFuncs:a});t.widgetId=l}r.props.setFuncValue(o?-1:i||0,a,null,e,"!func",void 0,t)},r.setArgValue=function(e,t,n,o,i){var a=r.props,s=(a.config,a.parentDelta),l=a.isLHS,u=a.parentFuncs;r.props.setFuncValue(l?-1:s||0,u,e,t,n,o,i)},r.setArgValueSrc=function(e,t,n){var o=r.props,i=(o.config,o.parentDelta),a=o.isLHS,s=o.parentFuncs;r.props.setFuncValue(a?-1:i||0,s,e,t,"!valueSrc",void 0,n)},r.renderFuncSelect=function(){var e,t,n=r.props,o=n.config,i=n.field,a=n.fieldType,s=n.fieldSrc,l=n.isLHS,u=n.operator,c=n.customProps,p=n.value,f=n.readonly,d=n.parentFuncs,v=n.id,h=n.groupId,g=n.isFuncArg,y=n.fieldDefinition,m=(n.parentDelta,{value:null!==(e=null==p||null===(t=p.get)||void 0===t?void 0:t.call(p,"func"))&&void 0!==e?e:null,setValue:r.setFunc,config:o,field:i,fieldType:a,fieldSrc:s,isLHS:l,operator:u,customProps:c,readonly:f,parentFuncs:d,isFuncArg:g,fieldDefinition:y,id:v,groupId:h}),O=o.settings,b=O.showLabels,E=O.funcLabel,S=b?k().createElement("label",{className:"rule--label"},E):null;return k().createElement(ny,{key:"func",className:"rule--func"},S,k().createElement(Ay,m))},r.renderArgLabel=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,a=t.label,s=r.props.config,l=n&&1==n.length&&"const"==n[0];return!s.settings.showLabels&&("boolean"==o||l)&&i?k().createElement(ny,{className:"rule--func--arg-label"},a||e):null},r.renderArgLabelSep=function(e,t){var n=t.valueSources,o=t.type,i=t.showPrefix,a=r.props.config,s=n&&1==n.length&&"const"==n[0];return!a.settings.showLabels&&("boolean"==o||s)&&i?k().createElement(ny,{className:"rule--func--arg-label-sep"},":"):null},r.renderArgVal=function(e,t,n){var o=r.props,i=o.config,a=o.field,s=o.fieldType,l=o.fieldSrc,u=o.isLHS,c=(o.operator,o.value),p=o.readonly,f=o.parentFuncs,d=o.id,v=o.groupId,h=o.fieldError,g=o.valueError,y=o.setFuncValue,m=o.parentDelta,O=c?c.getIn(["args",t]):null,b=O?O.get("value"):void 0,E=1==n.valueSources.length?n.valueSources[0]:void 0,S={config:i,fieldFunc:e,fieldArg:t,leftField:a,fieldType:s,fieldSrc:l,fieldError:h,valueError:g,isLHS:u,operator:null,value:b,valueSrc:O?O.get("valueSrc")||E||"value":E,asyncListValues:null==O?void 0:O.get("asyncListValues"),setValue:r.setArgValue,setValueSrc:r.setArgValueSrc,setFuncValue:y,funcKey:e,argKey:t,argDefinition:n,readonly:p,parentFuncs:f,id:d,groupId:v,parentDelta:m};return k().createElement(ny,{className:"rule--func--arg-value"},k().createElement(lm,S))},r.renderArgSep=function(e,t,r,n){var o=n.renderSeps;return r?k().createElement(ny,{className:"rule--func--arg-sep"},o?o[r-1]:", "):null},r.renderBracketBefore=function(e){var t=e.renderBrackets;return k().createElement(ny,{key:"before_args",className:"rule--func--bracket-before"},t?t[0]:"(")},r.renderBracketAfter=function(e){var t=e.renderBrackets;return k().createElement(ny,{key:"after_args",className:"rule--func--bracket-after"},t?t[1]:")")},r.renderFuncArgs=function(){var e=r.meta,t=e.funcDefinition,n=e.funcKey;if(!n)return null;var o=(t||{}).args;return o?k().createElement(k().Fragment,null,r.renderBracketBefore(t),k().createElement(ny,{key:"args-".concat(n),className:"rule--func--args rule--func--".concat(n,"--args")},Object.keys(o).map((function(e,i){return k().createElement(ny,{key:"arg-".concat(e,"-").concat(i),className:"rule--func--arg rule--func--".concat(n,"--arg--").concat(e)},r.renderArgSep(e,o[e],i,t),r.renderArgLabel(e,o[e]),r.renderArgLabelSep(e,o[e]),r.renderArgVal(n,e,o[e]))}))),r.renderBracketAfter(t)):null},dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["config","field","operator","value","fieldSrc","fieldType","isLHS"].map((function(r){return"parentFuncs"===r?!am(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t,r,n=e.config,o=(e.field,e.operator,e.value),i=null!==(t=null==o||null===(r=o.get)||void 0===r?void 0:r.call(o,"func"))&&void 0!==t?t:null;return{funcDefinition:i?im(n,i):null,funcKey:i}}},{key:"render",value:function(){var e=this.props.parentFuncs,t=e?e.map((function(e){var t=ty(e,2),r=t[0],n=t[1];return"".concat(r,"_").concat(n)})).join("-"):"root",r=(null==e?void 0:e.length)||0;return k().createElement(ny,{className:"rule--func--wrapper rule--func--wrapper--under-".concat(t," rule--func--wrapper--lev-").concat(r)},this.renderFuncSelect(),this.renderFuncArgs())}}])}(P.Component);sm.propTypes={id:Dh().string,groupId:Dh().string,config:Dh().object.isRequired,field:Dh().any,fieldSrc:Dh().string,fieldType:Dh().string,fieldError:Dh().string,operator:Dh().string,customProps:Dh().object,value:Dh().object,setValue:Dh().func.isRequired,setFuncValue:Dh().func,readonly:Dh().bool,parentFuncs:Dh().array,parentDelta:Dh().number,fieldDefinition:Dh().object,isFuncArg:Dh().bool,isLHS:Dh().bool,valueError:Dh().string};var lm=function(e){function t(e){var r;return w(this,t),(r=nm(this,t,[e])).setValue=function(e,t,n,o,i){var a=r.props;(0,a.setValue)(a.argKey,t,n,o,i)},r.setValueSrc=function(e,t,n){var o=r.props;(0,o.setValueSrc)(o.argKey,t,n)},dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props;(!this.meta||["parentFuncs","funcKey","argKey"].map((function(r){return"parentFuncs"===r?!am(e[r],t[r],!0):e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e))}},{key:"getMeta",value:function(e){var t=e.parentFuncs,r=e.funcKey,n=e.argKey;return{parentFuncs:[].concat(xg(t||[]),[[r,n]])}}},{key:"render",value:function(){var e=this.meta.parentFuncs;return k().createElement(rm,Lg({},this.props,{parentDelta:this.props.parentDelta,setValue:this.setValue,setValueSrc:this.setValueSrc,isFuncArg:!0,parentFuncs:e}))}}])}(P.Component);function um(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(um=function(){return!!e})()}lm.propTypes={funcKey:Dh().string.isRequired,argKey:Dh().string.isRequired,setValue:Dh().func.isRequired,setValueSrc:Dh().func.isRequired,readonly:Dh().bool,isLHS:Dh().bool,parentFuncs:Dh().array,id:Dh().string,groupId:Dh().string};var cm=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,um()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.renderField=function(){var e=r.props,t=e.config,n=e.classname,o=e.selectedField,i=e.selectedFieldSrc,a=e.selectedFieldType,s=e.setField,l=e.setFuncValue,u=e.parentField,c=e.readonly,p=e.id,f=e.groupId,d=e.fieldError,v=e.valueError;if(!["func","field"].includes(i))return"?";var h="func"===i?k().createElement(sm,{isLHS:!0,config:t,value:o,fieldSrc:i,fieldType:a,fieldError:d,valueError:v,parentField:u,setValue:s,setFuncValue:l,readonly:c,id:p,groupId:f,key:"field-func-"+p}):k().createElement(my,{config:t,selectedField:o,selectedFieldSrc:i,selectedFieldType:a,parentField:u,setField:s,customProps:t.settings.customFieldSelectProps,readonly:c,id:p,groupId:f,key:"field-"+p}),g="func"===i?t.settings.funcLabel:t.settings.fieldLabel,y=t.settings.showLabels&&"func"!==i&&k().createElement("label",{className:"rule--label"},g);return k().createElement("div",{key:i,className:n},y,h)},r.renderFieldSources=function(){if(!r.meta)return null;var e=r.props,t=e.config,n=e.readonly,o=e.selectedFieldSrc,i=e.setFieldSrc,a=e.id,s=r.meta.fieldSourcesOptions,l=t.settings,u=r.ValueSources,c=l.showLabels?k().createElement("label",{className:"rule--label"},""):null;return s.length>1&&!n&&k().createElement("div",{key:"fieldsrc",className:"rule--fieldsrc"},c,k().createElement(u,{key:"fieldsrc-"+a,valueSources:s,valueSrc:o,config:t,setValueSrc:i,readonly:n,title:l.fieldSourcesPopupTitle}))},dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.ValueSources||(null==t?void 0:t.config)!==(null==e?void 0:e.config);if((!this.meta||["config"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),r){var n=e.config,o=n.settings.renderValueSources;this.ValueSources=function(e){return o(e,n.ctx)}}}},{key:"getMeta",value:function(e){var t=e.config,r={value:"Value",field:"Field",func:"Function"},n=t.settings,o=n.valueSourcesInfo;return{fieldSourcesOptions:n.fieldSources.map((function(e){var t,n,i;return[e,{label:null!==(t=null!==(n=null===(i=o[e])||void 0===i?void 0:i.label)&&void 0!==n?n:r[e])&&void 0!==t?t:e}]}))}}},{key:"render",value:function(){var e=this.props,t=(e.classname,e.canSelectFieldSource),r=t&&this.renderFieldSources(),n=this.renderField();return t?k().createElement(ny,{className:"rule--field-wrapper"},r,n):n}}])}(P.Component),pm=["factory"];function fm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(fm=function(){return!!e})()}var dm=Ph.ConfigUtils.getOperatorConfig,vm=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,fm()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){if(!this.props.selectedOperator)return null;var e=dm(this.props.config,this.props.selectedOperator,this.props.selectedField);if(void 0===e.options)return null;var t=e.options,r=t.factory,n=Ig(t,pm),o=r(Object.assign({},n,{config:this.props.config,field:this.props.selectedField,fieldSrc:this.props.selectedFieldSrc,operator:this.props.selectedOperator,options:this.props.operatorOptions,setOption:this.props.setOperatorOption,readonly:this.props.readonly}),this.props.config.ctx),i=this.props.selectedOperator;return k().createElement("div",{className:"rule--operator rule--operator--".concat(i.toUpperCase())},o)}}])}(P.PureComponent);function hm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function gm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?hm(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):hm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function ym(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(ym=function(){return!!e})()}vm.propTypes={config:Dh().object.isRequired,operatorOptions:Dh().any.isRequired,selectedField:Dh().any,selectedFieldSrc:Dh().string,selectedOperator:Dh().string.isRequired,readonly:Dh().bool,setOperatorOption:Dh().func.isRequired};var mm=Ph.ConfigUtils,Om=mm.getFieldConfig,bm=mm.getOperatorConfig,Em=mm.getFieldWidgetConfig,Sm=mm.getFieldId,_m=Ph.RuleUtils.isEmptyRuleProperties,Tm=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,ym()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),dg(r),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props,n=!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if((!this.meta||["selectedField","selectedFieldSrc","selectedFieldType","selectedOperator","config","reordableNodesCnt","isLocked","parentField","parentFieldCanReorder"].map((function(t){return e[t]!==r[t]})).filter((function(e){return e})).length>0)&&(this.meta=this.getMeta(e)),n){var o=e.config,i=o.settings,a=i.renderIcon,s=i.renderButton,l=i.renderButtonGroup,u=i.renderSwitch,c=i.renderBeforeWidget,p=i.renderAfterWidget,f=i.renderRuleError;this.Icon=ly(o,a),this.Btn=ly(o,s),this.BtnGrp=ly(o,l),this.Switch=ly(o,u),this.BeforeWidget=ly(o,c),this.AfterWidget=ly(o,p),this.RuleError=ly(o,f)}this.doRemove=function(){t.props.removeSelf()}}},{key:"getMeta",value:function(e){var t=e.selectedField,r=e.selectedFieldType,n=e.selectedOperator,o=e.config,i=e.reordableNodesCnt,a=e.isLocked,s=e.parentField,l=e.parentFieldCanReorder,u=o.settings.keepInputOnChangeFieldSrc,c=Sm(t,o),p=Om(o,t),f=p&&"!struct"===p.type,d=!!t||u&&r,v=d&&n,h=bm(o,n,t),g=h&&null!=h.options,y=Em(o,t,n,null,null)||{},m=y.hideOperator,O=o.settings.canReorder&&i>1&&!a;return s&&(O=O&&l),{selectedFieldId:c,selectedFieldWidgetConfig:y,showDragIcon:O,showOperator:d&&!m,showOperatorLabel:d&&m&&y.operatorInlineLabel,showWidget:v&&!f,showOperatorOptions:v&&g}}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeRuleConfirmOptions;i&&!this.isEmptyCurrentRule()?o.call(r.ctx,gm(gm({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"_buildWidgetProps",value:function(e,t){var r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.selectedOperator,a=e.operatorOptions,s=e.value,l=e.valueType,u=e.valueSrc,c=e.asyncListValues,p=e.valueError,f=e.fieldError,d=e.parentField;return{field:r,fieldSrc:n,fieldType:o,fieldId:t.selectedFieldId,operator:i,operatorOptions:a,value:s,valueType:l,valueSrc:u,asyncListValues:c,valueError:p,fieldError:f,parentField:d}}},{key:"isEmptyCurrentRule",value:function(){var e=this.props.config,t=this._buildWidgetProps(this.props,this.meta);return _m(t,e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.parentField,o=e.groupId,i=e.id,a=e.selectedFieldSrc,s=e.selectedField,l=e.selectedFieldType,u=e.setField,c=e.setFuncValue,p=e.setFieldSrc,f=e.fieldError,d=t.settings.immutableFieldsMode,v=this.meta.selectedFieldId;return k().createElement(cm,{key:"field",classname:jg()("func"==a?"rule--field--func":"rule--field"),config:t,canSelectFieldSource:!n,selectedField:s,selectedFieldSrc:a,selectedFieldType:l,selectedFieldId:v,fieldError:f,setField:d?oy:u,setFuncValue:d?oy:c,setFieldSrc:d?oy:p,parentField:n,readonly:d||r,id:i,groupId:o})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta,o=n.selectedFieldId,i=n.selectedFieldWidgetConfig,a=n.showOperator,s=n.showOperatorLabel,l=t.settings.immutableOpsMode;return k().createElement(cy,{key:"operator",config:t,selectedField:this.props.selectedField,selectedFieldSrc:this.props.selectedFieldSrc,selectedFieldType:this.props.selectedFieldType,selectedFieldId:o,selectedOperator:this.props.selectedOperator,setOperator:l?oy:this.props.setOperator,showOperator:a,showOperatorLabel:s,selectedFieldWidgetConfig:i,readonly:l||r,id:this.props.id,groupId:this.props.groupId})}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=this.meta.showWidget,o=t.settings.immutableValuesMode;if(!n)return null;var i=k().createElement(rm,Lg({key:"values"},this._buildWidgetProps(this.props,this.meta),{config:t,setValue:o?oy:this.props.setValue,setValueSrc:o?oy:this.props.setValueSrc,setFuncValue:o?oy:this.props.setFuncValue,readonly:o||r,id:this.props.id,groupId:this.props.groupId}));return k().createElement(ny,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},i)}},{key:"renderOperatorOptions",value:function(){var e=this.props.config,t=this.meta.showOperatorOptions,r=e.settings,n=r.immutableOpsMode,o=r.immutableValuesMode;if(!t)return null;var i=k().createElement(vm,{key:"operatorOptions",selectedField:this.props.selectedField,selectedOperator:this.props.selectedOperator,operatorOptions:this.props.operatorOptions,setOperatorOption:n?oy:this.props.setOperatorOption,config:e,readonly:o});return k().createElement(ny,{key:"op-options-for-"+this.props.selectedOperator,className:"rule--operator-options"},i)}},{key:"renderBeforeWidget",value:function(){var e=this.BeforeWidget;return e?k().createElement(ny,{key:"before-widget-for-"+this.props.selectedOperator,className:"rule--before-widget"},k().createElement(e,this.props)):null}},{key:"renderAfterWidget",value:function(){var e=this.AfterWidget;return e?k().createElement(ny,{key:"after-widget-for-"+this.props.selectedOperator,className:"rule--after-widget"},k().createElement(e,this.props)):null}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=e.fieldError,o=t.settings.showErrorMessage,i=this.RuleError,a=[n].concat(xg((null==r?void 0:r.toArray())||[])).filter((function(e){return!!e})).shift()||null;return o&&a&&k().createElement("div",{className:"rule--error"},i?k().createElement(i,{error:a}):a)}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.meta.showDragIcon,r=this.Icon,n=k().createElement(r,{type:"drag"});return t&&k().createElement("div",{key:"rule-drag-icon",onMouseDown:e,className:"qb-drag-handler rule--drag-handler"},n)}},{key:"renderDel",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=t.settings,o=n.deleteLabel,i=n.immutableGroupsMode,a=n.canDeleteLocked,s=this.Icon,l=this.Btn;return!i&&(!r||r&&a)&&k().createElement(l,{key:"rule-del",type:"delRule",onClick:this.removeSelf,label:o,config:t,renderIcon:s})}},{key:"renderLock",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.isTrueLocked,o=e.id,i=t.settings,a=i.lockLabel,s=i.lockedLabel,l=i.showLock,u=this.Switch;return l&&!(r&&!n)&&k().createElement(u,{key:"rule-lock",type:"lock",id:o,value:r,setValue:this.setLock,label:a,checkedLabel:s,hideLabel:!0,config:t})}},{key:"render",value:function(){var e=this.meta,t=e.showOperatorOptions,r=e.selectedFieldWidgetConfig,n=this.props,o=n.valueSrc,i=n.value,a=n.config,s="value"==(null==o?void 0:o.first())&&!t&&1==i.size&&r.fullWidth,l=this.BtnGrp,u=[this.renderField(),this.renderOperator(),this.renderBeforeWidget(),this.renderWidget(),this.renderAfterWidget(),this.renderOperatorOptions()],c=k().createElement("div",{key:"rule-body",className:jg()("rule--body",s&&"can--shrink--value")},u),p=this.renderError(),f=this.renderDrag(),d=this.renderLock(),v=this.renderDel();return k().createElement(k().Fragment,null,f,k().createElement("div",{key:"rule-body-wrapper",className:"rule--body--wrapper"},c,p),k().createElement("div",{key:"rule-header-wrapper",className:"rule--header"},k().createElement(l,{key:"rule-header-group",config:a},d,v)))}}])}(P.Component);Tm.propTypes={id:Dh().string.isRequired,groupId:Dh().string,selectedField:Dh().any,selectedFieldSrc:Dh().string,selectedFieldType:Dh().string,selectedOperator:Dh().string,operatorOptions:Dh().object,config:Dh().object.isRequired,value:Dh().any,valueSrc:Dh().any,valueType:Dh().any,asyncListValues:Dh().array,isDraggingMe:Dh().bool,isDraggingTempo:Dh().bool,parentField:Dh().string,valueError:Dh().any,fieldError:Dh().string,isLocked:Dh().bool,isTrueLocked:Dh().bool,handleDraggerMouseDown:Dh().func,setField:Dh().func,setFieldSrc:Dh().func,setOperator:Dh().func,setOperatorOption:Dh().func,setLock:Dh().func,removeSelf:Dh().func,setValue:Dh().func,setValueSrc:Dh().func,setFuncValue:Dh().func,reordableNodesCnt:Dh().number,totalRulesCnt:Dh().number,parentReordableNodesCnt:Dh().number,parentFieldCanReorder:Dh().bool};const Rm=function(e){var t=(0,Bh.connect)((function(e){return{dragging:e.dragging}}),null,null,{context:Mh})(kg(e));return t.displayName="ConnectedRuleContainer",t}(Kg("rule")(ay(Tm)));var wm=r(3547),Im=r.n(wm);function Lm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Lm=function(){return!!e})()}var Cm=Ph.DefaultUtils.defaultGroupConjunction,Am=Ph.ConfigUtils.getFieldConfig,xm=function(e,t){var r;return r=function(r){function n(e){var r;return w(this,n),r=function(e,t,r){return t=N(t),x(e,Lm()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,n,[e]),r._selectedConjunction=function(e){return(e=e||r.props).conjunction||Cm(e.config,e.field)},r.setConjunction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setConjunction(r.props.path,e)},r.setNot=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setNot(r.props.path,e)},r.setLock=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;r.props.actions.setLock(r.props.path,e)},r.dummyFn=function(){},r.removeSelf=function(){r.props.actions.removeGroup(r.props.path)},r.addGroup=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addGroup(r.props.path,void 0,void 0,e)},r.addCaseGroup=function(){r.props.actions.addCaseGroup(r.props.path)},r.addDefaultCaseGroup=function(){r.props.actions.addDefaultCaseGroup(r.props.path)},r.addRule=function(){var e="rule_group"==t?r.props.field:r.props.parentField;r.props.actions.addRule(r.props.path,void 0,void 0,void 0,e)},r.setField=function(e,t,n){r.props.actions.setField(r.props.path,e,t,n)},r.setOperator=function(e){r.props.actions.setOperator(r.props.path,e)},r.setValue=function(e,t,n,o,i){r.props.actions.setValue(r.props.path,e,t,n,o,i)},r.setValueSrc=function(e,t,n){r.props.actions.setValueSrc(r.props.path,e,t,n)},r.setFuncValue=function(e,t,n,o,i,a,s){r.props.actions.setFuncValue(r.props.path,e,t,n,o,i,a,s)},r.pureShouldComponentUpdate=fg(r),dg(r),r.selectedConjunction=r._selectedConjunction(e),r.conjunctionOptions=r._getConjunctionOptions(e),r.dummyFn.isDummyFn=!0,r}return F(n,r),A(n,[{key:"shouldComponentUpdate",value:function(e,t){var r=this.props,n=this.state,o=this.pureShouldComponentUpdate(e,t);if(o&&n==t&&r!=e){var i=(e.dragging.id||r.dragging.id)==e.id,a=[];for(var s in e){var l=e[s]!=r[s];"dragging"!=s||i||(l=!1),l&&a.push(s)}a.length||(o=!1)}return o}},{key:"onPropsChanged",value:function(e){var t=e.config,r=(e.id,e.conjunction),n=this.props.config,o=this.props.conjunction;n==t&&o==r||(this.selectedConjunction=this._selectedConjunction(e),this.conjunctionOptions=this._getConjunctionOptions(e))}},{key:"_getConjunctionOptions",value:function(e){var t=this;return th()(e.config.conjunctions,(function(r,n){return{id:"conjunction-".concat(e.id,"-").concat(n),name:"conjunction[".concat(e.id,"]"),key:n,label:r.label,checked:n===t._selectedConjunction(e)}}))}},{key:"render",value:function(){var t=this.props.config.settings.showErrorMessage,r=this.props.dragging.id==this.props.id,n=this.props.path.size,o=this.props.config.settings.maxNesting,i=1==n;if(this.props.parentField&&this.props.parentFieldPathSize){var a=Am(this.props.config,this.props.parentField);n=this.props.path.size-this.props.parentFieldPathSize+1,o=null==a?void 0:a.maxNesting,i=!1}else if(this.props.field){var s=Am(this.props.config,this.props.field);n=1,o=null==s?void 0:s.maxNesting,i=!1}var l=!r&&this.props.isDraggingTempo,u=this.props.fieldType||null,c=this.props.valueError,p=null!=(xg((null==c?void 0:c.toArray())||[]).filter((function(e){return!!e})).shift()||null)&&t,f=void 0===o||n<o,d=o&&n>o;return k().createElement("div",{className:jg()("group-or-rule-container","group-container",p?"group-with-error":null),"data-id":this.props.id},[r?k().createElement(e,{key:"dragging",id:this.props.id,groupId:this.props.groupId,isDraggingMe:!0,isDraggingTempo:!0,dragging:this.props.dragging,isRoot:i,lev:this.props.path.size-1,allowFurtherNesting:f,isMaxNestingExceeded:d,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:this.dummyFn,setNot:this.dummyFn,setLock:this.dummyFn,removeSelf:this.dummyFn,addGroup:this.dummyFn,addCaseGroup:this.dummyFn,addDefaultCaseGroup:this.dummyFn,addRule:this.dummyFn,setField:this.dummyFn,setFuncValue:this.dummyFn,setOperator:this.dummyFn,setValue:this.dummyFn,setValueSrc:this.dummyFn,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:u,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt}):null,k().createElement(e,{key:this.props.id,id:this.props.id,groupId:this.props.groupId,isDraggingMe:r,isDraggingTempo:l,onDragStart:this.props.onDragStart,isRoot:i,lev:this.props.path.size-1,allowFurtherNesting:f,isMaxNestingExceeded:d,conjunctionOptions:this.conjunctionOptions,not:this.props.not,selectedConjunction:this.selectedConjunction,setConjunction:l?this.dummyFn:this.setConjunction,setNot:l?this.dummyFn:this.setNot,setLock:l?this.dummyFn:this.setLock,removeSelf:l?this.dummyFn:this.removeSelf,addGroup:l?this.dummyFn:this.addGroup,addCaseGroup:l?this.dummyFn:this.addCaseGroup,addDefaultCaseGroup:l?this.dummyFn:this.addDefaultCaseGroup,addRule:l?this.dummyFn:this.addRule,setField:l?this.dummyFn:this.setField,setFuncValue:l?this.dummyFn:this.setFuncValue,setOperator:l?this.dummyFn:this.setOperator,setValue:l?this.dummyFn:this.setValue,setValueSrc:l?this.dummyFn:this.setValueSrc,value:this.props.value||null,valueError:this.props.valueError||null,valueSrc:this.props.valueSrc||null,config:this.props.config,children1:this.props.children1,actions:this.props.actions,reordableNodesCnt:this.props.reordableNodesCnt,totalRulesCnt:this.props.totalRulesCnt,selectedField:this.props.field||null,selectedFieldSrc:this.props.fieldSrc||"field",selectedFieldType:u,parentField:this.props.parentField||null,parentFieldPathSize:this.props.parentFieldPathSize,parentFieldCanReorder:this.props.parentFieldCanReorder,selectedOperator:this.props.operator||null,isLocked:this.props.isLocked,isTrueLocked:this.props.isTrueLocked,parentReordableNodesCnt:this.props.parentReordableNodesCnt})])}}])}(P.Component),r.propTypes={config:Dh().object.isRequired,actions:Dh().object.isRequired,path:Dh().any.isRequired,id:Dh().string.isRequired,groupId:Dh().string,not:Dh().bool,conjunction:Dh().string,children1:Dh().any,onDragStart:Dh().func,reordableNodesCnt:Dh().number,field:Dh().any,fieldSrc:Dh().string,fieldType:Dh().string,parentField:Dh().string,value:Dh().any,valueSrc:Dh().any,valueError:Dh().any,isLocked:Dh().bool,isTrueLocked:Dh().bool,dragging:Dh().object,isDraggingTempo:Dh().bool},r};const Nm=function(e,t){var r=(0,Bh.connect)((function(e){return{dragging:e.dragging}}),null,null,{context:Mh})(xm(e,t));return r.displayName="ConnectedGroupContainer",r};function jm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(jm=function(){return!!e})()}var Fm={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},Pm=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,jm()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.removeSelf,i=e.setLock,a=e.isLocked,s=e.isTrueLocked,l=e.id,u=e.parentField,c=e.canAddGroup,p=e.canAddRule,f=e.canDeleteGroup,d=t.settings,v=d.immutableGroupsMode,h=d.addRuleLabel,g=d.addGroupLabel,y=d.addSubRuleLabel,m=d.addSubGroupLabel,O=d.delGroupLabel,b=d.groupActionsPosition,E=d.renderButton,S=d.renderIcon,_=d.renderSwitch,T=d.renderButtonGroup,R=d.lockLabel,w=d.lockedLabel,I=d.showLock,L=d.canDeleteLocked,C=function(e){return S(e,t.ctx)},A=function(e){return E(e,t.ctx)},x=function(e){return _(e,t.ctx)},N=function(e){return T(e,t.ctx)},j=Fm[b||"topRight"],F=I&&!(a&&!s)&&k().createElement(x,{type:"lock",id:l,value:a,setValue:i,label:R,checkedLabel:w,config:t}),P=!v&&p&&!a&&k().createElement(A,{type:u?"addSubRule":"addRule",onClick:r,label:u?y:h,readonly:a,config:t,renderIcon:C}),D=!v&&c&&!a&&k().createElement(A,{type:u?"addSubGroup":"addGroup",onClick:n,label:u?m:g,readonly:a,config:t,renderIcon:C}),V=!v&&f&&(!a||a&&L)&&k().createElement(A,{type:"delGroup",onClick:o,label:O,config:t,renderIcon:C});return k().createElement("div",{className:"group--actions ".concat(j)},k().createElement(N,{config:t},F,P,D,V))}}])}(P.PureComponent);function km(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return Dm(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Dm(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var n=0,o=function(){};return{s:o,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,s=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){s=!0,i=e},f:function(){try{a||null==r.return||r.return()}finally{if(s)throw i}}}}function Dm(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Vm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Mm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Vm(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Vm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Um(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Um=function(){return!!e})()}var Bm=Ph.ConfigUtils.getFieldConfig,qm=Ph.RuleUtils.isEmptyGroupChildren,Gm=Ph.TreeUtils,Km=(Gm.getTotalReordableNodesCountInTree,Gm.getTotalRulesCountInTree),$m=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,Um()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.childrenClassName=function(){return""},r.renderBeforeActions=function(){var e=r.BeforeActions;return null==e?null:k().createElement(e,Lg({key:"group-actions-before"},r.props))},r.renderAfterActions=function(){var e=r.AfterActions;return null==e?null:k().createElement(e,Lg({key:"group-actions-after"},r.props))},dg(r),r.onPropsChanged(e),r.removeSelf=r.removeSelf.bind(r),r.setLock=r.setLock.bind(r),r.renderItem=r.renderItem.bind(r),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this,r=this.props;if(!this.Icon||(null==r?void 0:r.config)!==(null==e?void 0:e.config)){var n=e.config,o=n.settings,i=o.renderIcon,a=o.renderConjs,s=o.renderBeforeActions,l=o.renderAfterActions;this.Icon=ly(n,i),this.Conjs=ly(n,a),this.BeforeActions=ly(n,s),this.AfterActions=ly(n,l)}this.doRemove=function(){t.props.removeSelf()}}},{key:"isGroupTopPosition",value:function(){return Im()(this.props.config.settings.groupActionsPosition||"topRight","top")}},{key:"setLock",value:function(e){this.props.setLock(e)}},{key:"removeSelf",value:function(){var e=this.props,t=e.confirmFn,r=e.config,n=r.settings,o=n.renderConfirm,i=n.removeGroupConfirmOptions;i&&!this.isEmptyCurrentGroup()?o.call(r.ctx,Mm(Mm({},i),{},{onOk:this.doRemove,onCancel:null,confirmFn:t}),r.ctx):this.doRemove()}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config;return qm(t,r)}},{key:"showNot",value:function(){var e=this.props,t=e.config,r=e.parentField,n=t.settings.showNot;if(r){var o,i=Bm(t,r);n=n&&(null===(o=null==i?void 0:i.showNot)||void 0===o||o)}return n}},{key:"showConjs",value:function(){var e=this.props.config.settings.forceShowConj,t=this.conjunctionOptions();return Object.keys(t).length>1&&!this.isOneChild()||this.showNot()||e}},{key:"isNoChildren",value:function(){var e=this.props.children1;return!e||0==e.size}},{key:"isOneChild",value:function(){var e=this.props.children1;return!e||e.size<2}},{key:"renderChildrenWrapper",value:function(){return this.props.children1&&k().createElement("div",{key:"group-children",className:jg()("group--children",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isOneChild()?"one--child":"",this.childrenClassName())},this.renderChildren())}},{key:"renderHeaderWrapper",value:function(){var e=this.isGroupTopPosition();return k().createElement("div",{key:"group-header",className:jg()("group--header",this.isOneChild()?"one--child":"",this.showConjs()?"":"hide--conjs",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"")},this.renderHeader(),e&&this.renderBeforeActions(),e&&this.renderActions(),e&&this.renderAfterActions())}},{key:"renderFooterWrapper",value:function(){return!this.isGroupTopPosition()&&k().createElement("div",{key:"group-footer",className:"group--footer"},this.renderBeforeActions(),this.renderActions(),this.renderAfterActions())}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id,s=e.parentField;return k().createElement(Pm,{key:"group-actions",config:t,addRule:r,addGroup:n,canAddGroup:this.canAddGroup(),canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a,parentField:s})}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.totalRulesCnt,r=e.isMaxNestingExceeded,n=e.parentField,o=this.props.config.settings.maxNumberOfRules;n&&(o=Bm(this.props.config,n).maxNumberOfRules);return!r&&(!o||t<o)}},{key:"canDeleteGroup",value:function(){return!this.props.isRoot}},{key:"renderChildren",value:function(){var e=this.props.children1;return e?e.valueSeq().toArray().map(this.renderItem):null}},{key:"renderItem",value:function(e){if(e){var t=this.props,r=t.config,n=t.actions,o=t.onDragStart,i=t.isLocked,a=t.parentField,s=t.parentFieldPathSize,l=t.parentFieldCanReorder,u="group"==e.get("type")&&null!=e.getIn(["properties","field"])?"rule_group":e.get("type");return k().createElement(DO,Lg({key:e.get("id"),id:e.get("id"),groupId:t.id,path:e.get("path"),type:u,properties:e.get("properties"),config:r,actions:n,children1:e.get("children1"),parentField:a,parentFieldPathSize:s,parentFieldCanReorder:l,reordableNodesCnt:this.reordableNodesCntForItem(e),totalRulesCnt:this.totalRulesCntForItem(e),parentReordableNodesCnt:this.reordableNodesCnt(),onDragStart:o,isDraggingTempo:this.props.isDraggingTempo,isParentLocked:i},this.extraPropsForItem(e)))}}},{key:"extraPropsForItem",value:function(e){return{}}},{key:"reordableNodesCnt",value:function(){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return"rule_group"===e.get("type")?Km(e):this.props.totalRulesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.reordableNodesCnt()}},{key:"showDragIcon",value:function(){var e=this.props,t=e.config,r=e.isRoot,n=e.isLocked,o=e.parentField,i=e.parentFieldCanReorder,a=this.reordableNodesCnt(),s=t.settings.canReorder&&!r&&a>1&&!n;return o&&(s=s&&i),s}},{key:"renderDrag",value:function(){var e=this.props.handleDraggerMouseDown,t=this.Icon,r=k().createElement(t,{type:"drag"});return this.showDragIcon()&&k().createElement("div",{key:"group-drag-icon",onMouseDown:e,className:"qb-drag-handler group--drag-handler"},r)}},{key:"conjunctionOptions",value:function(){var e=this.props,t=e.parentField,r=e.conjunctionOptions;return t?this.conjunctionOptionsForGroupField(t):r}},{key:"conjunctionOptionsForGroupField",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this.props,r=t.config,n=t.conjunctionOptions,o=Bm(r,e);if(null!=o&&o.conjunctions){var i,a={},s=km(o.conjunctions);try{for(s.s();!(i=s.n()).done;){var l=i.value,u=n[l];u&&(a[l]=u)}}catch(e){s.e(e)}finally{s.f()}return a}return n}},{key:"renderConjs",value:function(){var e=this.props,t=e.config,r=e.children1,n=e.id,o=e.selectedConjunction,i=e.setConjunction,a=e.not,s=e.setNot,l=e.isLocked,u=t.settings,c=u.immutableGroupsMode,p=u.notLabel,f=this.conjunctionOptions();if(!this.showConjs())return null;if(!r||!r.size)return null;var d={disabled:this.isOneChild(),readonly:c||l,selectedConjunction:o,setConjunction:c?oy:i,conjunctionOptions:f,config:t,not:a||!1,id:n,setNot:c?oy:s,notLabel:p,showNot:this.showNot(),isLocked:l},v=this.Conjs;return k().createElement(v,Lg({key:"group-conjs"},d))}},{key:"renderHeader",value:function(){return k().createElement("div",{key:"group-conjunctions",className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"render",value:function(){return k().createElement(k().Fragment,null,this.renderHeaderWrapper(),this.renderChildrenWrapper(),this.renderFooterWrapper())}}])}(P.Component);$m.propTypes={reordableNodesCnt:Dh().number,conjunctionOptions:Dh().object.isRequired,allowFurtherNesting:Dh().bool.isRequired,isMaxNestingExceeded:Dh().bool,isRoot:Dh().bool.isRequired,not:Dh().bool,selectedConjunction:Dh().string,config:Dh().object.isRequired,id:Dh().string.isRequired,groupId:Dh().string,path:Dh().any,children1:Dh().any,isDraggingMe:Dh().bool,isDraggingTempo:Dh().bool,isLocked:Dh().bool,isTrueLocked:Dh().bool,parentField:Dh().string,handleDraggerMouseDown:Dh().func,onDragStart:Dh().func,addRule:Dh().func.isRequired,addGroup:Dh().func.isRequired,removeSelf:Dh().func.isRequired,setConjunction:Dh().func.isRequired,setNot:Dh().func.isRequired,setLock:Dh().func.isRequired,actions:Dh().object.isRequired};const Wm=Nm(Kg("group")(ay($m)),"group");function zm(){return zm="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!{}.hasOwnProperty.call(e,t)&&null!==(e=N(e)););return e}(e,t);if(n){var o=Object.getOwnPropertyDescriptor(n,t);return o.get?o.get.call(arguments.length<3?e:r):o.value}},zm.apply(null,arguments)}function Hm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Hm=function(){return!!e})()}var Ym=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,Hm()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.canAddRule,o=e.canDeleteGroup,i=e.removeSelf,a=e.setLock,s=e.isLocked,l=e.isTrueLocked,u=e.id,c=t.settings,p=c.immutableGroupsMode,f=c.addRuleLabel,d=c.delGroupLabel,v=c.renderButton,h=c.renderIcon,g=c.renderSwitch,y=c.renderButtonGroup,m=c.lockLabel,O=c.lockedLabel,b=c.showLock,E=c.canDeleteLocked,S=function(e){return h(e,t.ctx)},_=function(e){return v(e,t.ctx)},T=function(e){return g(e,t.ctx)},R=function(e){return y(e,t.ctx)},w=b&&!(s&&!l)&&k().createElement(T,{type:"lock",id:u,value:s,setValue:a,label:m,checkedLabel:O,hideLabel:!0,config:t}),I=!p&&n&&!s&&k().createElement(_,{type:"addSubRuleSimple",onClick:r,label:f,readonly:s,config:t,renderIcon:S}),L=!p&&o&&(!s||s&&E)&&k().createElement(_,{type:"delRuleGroup",onClick:i,label:d,config:t,renderIcon:S});return k().createElement("div",{className:"group--actions"},k().createElement(R,{config:t},w,I,L))}}])}(P.PureComponent);function Jm(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Xm(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Jm(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Jm(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function Qm(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(Qm=function(){return!!e})()}function Zm(e,t,r,n){var o=zm(N(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}var eO=Ph.ConfigUtils.getFieldConfig,tO=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,Qm()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.childrenClassName=function(){return"rule_group--children"},r.renderHeaderWrapper=function(){return null},r.renderFooterWrapper=function(){return null},r.renderConjs=function(){return null},r.canAddGroup=function(){return!1},r.canAddRule=function(){return!0},r.canDeleteGroup=function(){return!1},r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){Zm(t,"onPropsChanged",this,3)([e])}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props.children1;return(null==t?void 0:t.size)||0}},{key:"renderChildrenWrapper",value:function(){return k().createElement(k().Fragment,null,this.renderDrag(),this.renderField(),this.renderActions(),Zm(t,"renderChildrenWrapper",this,3)([]))}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,a=e.setFuncValue,s=e.setFieldSrc,l=e.parentField,u=e.id,c=e.groupId,p=e.isLocked,f=t.settings.immutableFieldsMode;return k().createElement(cm,{key:"field",classname:"group--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:a,setFieldSrc:s,parentField:l,readonly:f||p,id:u,groupId:c})}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.isLocked,o=e.isTrueLocked,i=e.id;return k().createElement(Ym,{config:t,addRule:r,canAddRule:this.canAddRule(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:n,isTrueLocked:o,id:i})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,a=eO(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==a?void 0:a.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}($m);tO.propTypes=Xm(Xm({},$m.propTypes),{},{selectedField:Dh().any,selectedFieldSrc:Dh().string,parentField:Dh().string,setField:Dh().func,setFieldSrc:Dh().func,lev:Dh().number});const rO=Nm(Kg("group rule_group")(ay(tO)),"rule_group");function nO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(nO=function(){return!!e})()}var oO=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,nO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.canAddRule,i=e.canAddGroup,a=e.canDeleteGroup,s=e.removeSelf,l=e.setLock,u=e.isLocked,c=e.isTrueLocked,p=e.id,f=t.settings,d=f.immutableGroupsMode,v=f.addSubRuleLabel,h=f.addSubGroupLabel,g=f.delGroupLabel,y=f.renderButton,m=f.renderIcon,O=f.renderSwitch,b=f.renderButtonGroup,E=f.lockLabel,S=f.lockedLabel,_=f.showLock,T=f.canDeleteLocked,R=function(e){return m(e,t.ctx)},w=function(e){return y(e,t.ctx)},I=function(e){return O(e,t.ctx)},L=function(e){return b(e,t.ctx)},C=_&&!(u&&!c)&&k().createElement(I,{type:"lock",id:p,value:u,setValue:l,label:E,checkedLabel:S,config:t}),A=!d&&o&&!u&&k().createElement(w,{type:"addSubRule",onClick:r,label:v,readonly:u,config:t,renderIcon:R}),x=!d&&i&&!u&&k().createElement(w,{type:"addSubGroup",onClick:n,label:h,readonly:u,config:t,renderIcon:R}),N=!d&&a&&(!u||u&&T)&&k().createElement(w,{type:"delRuleGroup",onClick:s,label:g,config:t,renderIcon:R});return k().createElement("div",{className:"group--actions group--actions--tr"},k().createElement(L,{config:t},C,A,x,N))}}])}(P.PureComponent);function iO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function aO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?iO(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):iO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function sO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(sO=function(){return!!e})()}var lO=Ph.ConfigUtils,uO=lO.getFieldConfig,cO=lO.getFieldWidgetConfig,pO=Ph.RuleUtils.isEmptyRuleGroupExtPropertiesAndChildren,fO=Ph.TreeUtils.getTotalReordableNodesCountInTree,dO=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,sO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.childrenClassName=function(){return"rule_group_ext--children"},r.renderFooterWrapper=function(){return null},r.canDeleteGroup=function(){return!0},r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){!function(e,t,r,n){var o=zm(N(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}(t,"onPropsChanged",this,3)([e])}},{key:"canAddGroup",value:function(){return this.props.allowFurtherNesting}},{key:"canAddRule",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=uO(t,r),o=null==n?void 0:n.maxNumberOfRules,i=this.props.totalRulesCnt;return!o||i<o}},{key:"renderHeaderWrapper",value:function(){return k().createElement("div",{key:"group-header",className:jg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderGroupField(),this.renderActions())}},{key:"renderHeader",value:function(){return k().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderGroupField",value:function(){return k().createElement("div",{className:"group--field--count--rule"},this.renderField(),this.renderOperator(),this.renderWidget(),this.renderError())}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings,o=n.renderRuleError,i=n.showErrorMessage,a=xg((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return i&&a&&k().createElement("div",{className:"rule_group--error"},o?o({error:a},t.ctx):a)}},{key:"showNot",value:function(){var e,t=this.props,r=t.config,n=t.selectedField,o=uO(r,n);return null!==(e=null==o?void 0:o.showNot)&&void 0!==e?e:r.settings.showNot}},{key:"conjunctionOptions",value:function(){var e=this.props.selectedField;return this.conjunctionOptionsForGroupField(e)}},{key:"renderField",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedFieldType,i=e.setField,a=e.setFieldSrc,s=e.setFuncValue,l=e.parentField,u=e.id,c=e.groupId,p=e.isLocked,f=t.settings.immutableFieldsMode;return k().createElement(cm,{key:"field",classname:"rule--field",config:t,canSelectFieldSource:!1,selectedField:r,selectedFieldSrc:n,selectedFieldType:o,setField:i,setFuncValue:s,setFieldSrc:a,parentField:l,readonly:f||p,id:u,groupId:c})}},{key:"renderOperator",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedFieldSrc,o=e.selectedOperator,i=(e.setField,e.setOperator),a=e.isLocked,s=t.settings.immutableFieldsMode,l=cO(t,r,o)||{},u=l.hideOperator,c=r&&u&&l.operatorInlineLabel,p=r&&!u;return k().createElement(cy,{key:"operator",classname:"group--operator",config:t,selectedField:r,selectedFieldSrc:n,selectedOperator:o,setOperator:i,showOperator:p,showOperatorLabel:c,selectedFieldWidgetConfig:l,readonly:s||a,id:this.props.id,groupId:this.props.groupId})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props,t=e.children1,r=e.config,n=this._buildWidgetProps(this.props);return pO(n,t,r)}},{key:"_buildWidgetProps",value:function(e){var t=e.selectedField,r=e.selectedFieldSrc,n=e.selectedFieldType,o=e.selectedOperator,i=e.operatorOptions,a=e.value,s=e.valueType,l=(e.valueSrc,e.asyncListValues,e.valueError);e.fieldError;return{field:t,fieldSrc:r,fieldType:n,operator:o,operatorOptions:i,value:a,valueType:s,valueSrc:["value"],valueError:l,fieldError:null,parentField:e.parentField}}},{key:"renderWidget",value:function(){var e=this.props,t=e.config,r=e.selectedField,n=e.selectedOperator,o=e.isLocked,i=t.settings.immutableValuesMode;if(!(r&&n))return null;var a=k().createElement(rm,Lg({key:"values",isForRuleGroup:!0},this._buildWidgetProps(this.props),{config:t,setValue:i?oy:this.props.setValue,setValueSrc:oy,readonly:i||o,id:this.props.id,groupId:this.props.groupId}));return k().createElement(ny,{key:"widget-for-"+this.props.selectedOperator,className:"rule--value"},a)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addRule,n=e.addGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return k().createElement(oO,{config:t,addRule:r,addGroup:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"reordableNodesCntForItem",value:function(e){if(this.props.isLocked)return 0;var t=this.props,r=t.children1,n=t.id;return fO({id:n,type:"rule_group",children1:r})}},{key:"extraPropsForItem",value:function(e){var t,r=this.props,n=r.selectedField,o=r.lev,i=r.config,a=uO(i,n);return{parentField:n,parentFieldPathSize:o+1,parentFieldCanReorder:null!==(t=null==a?void 0:a.canReorder)&&void 0!==t?t:i.settings.canReorder}}}])}($m);dO.propTypes=aO(aO({},$m.propTypes),{},{selectedField:Dh().any,selectedFieldSrc:Dh().string,selectedOperator:Dh().string,value:Dh().any,parentField:Dh().string,setField:Dh().func,setFieldSrc:Dh().func,setOperator:Dh().func,setValue:Dh().func,valueError:Dh().any,lev:Dh().number});const vO=Nm(Kg("group rule_group_ext")(ay(dO)),"rule_group");function hO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(hO=function(){return!!e})()}var gO={topLeft:"group--actions--tl",topCenter:"group--actions--tc",topRight:"group--actions--tr",bottomLeft:"group--actions--bl",bottomCenter:"group--actions--bc",bottomRight:"group--actions--br"},yO=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,hO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.setLock,i=e.isLocked,a=e.isTrueLocked,s=e.id,l=e.canAddGroup,u=e.canAddDefault,c=t.settings,p=c.immutableGroupsMode,f=c.addCaseLabel,d=c.addDefaultCaseLabel,v=c.groupActionsPosition,h=c.renderButton,g=c.renderIcon,y=c.renderSwitch,m=c.renderButtonGroup,O=c.lockLabel,b=c.lockedLabel,E=c.showLock,S=function(e){return g(e,t.ctx)},_=function(e){return h(e,t.ctx)},T=function(e){return y(e,t.ctx)},R=function(e){return m(e,t.ctx)},w=gO[v||"topRight"],I=E&&!(i&&!a)&&k().createElement(T,{type:"lock",id:s,value:i,setValue:o,label:O,checkedLabel:b,config:t}),L=!p&&l&&!i&&k().createElement(_,{type:"addCaseGroup",onClick:r,label:f,readonly:i,config:t,renderIcon:S}),C=!p&&u&&!i&&k().createElement(_,{type:"addDefaultCaseGroup",onClick:n,label:d,readonly:i,config:t,renderIcon:S});return k().createElement("div",{className:"group--actions ".concat(w)},k().createElement(R,{config:t},I,L,C))}}])}(P.PureComponent);function mO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function OO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(OO=function(){return!!e})()}var bO=Ph.TreeUtils,EO=bO.getTotalReordableNodesCountInTree,SO=bO.getTotalRulesCountInTree,_O=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,OO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.childrenClassName=function(){return"switch_group--children"},r.renderFooterWrapper=function(){return null},r.hasDefaultCase=function(){var e;return(null===(e=r.props.children1)||void 0===e?void 0:e.size)&&r.props.children1.filter((function(e){return null==e.get("children1")})).size>0},r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){!function(e,t,r,n){var o=zm(N(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}(t,"onPropsChanged",this,3)([e])}},{key:"canAddGroup",value:function(){var e,t=this.props.config.settings.maxNumberOfCases,r=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return!t||r<t}},{key:"canAddRule",value:function(){return!1}},{key:"reordableNodesCnt",value:function(){var e,t=(null===(e=this.props.children1)||void 0===e?void 0:e.size)||0;return this.hasDefaultCase()&&t--,t}},{key:"totalRulesCntForItem",value:function(e){return SO(e)}},{key:"reordableNodesCntForItem",value:function(e){var t;if(this.props.isLocked)return 0;var r=this.props.config.settings,n=r.canLeaveEmptyCase,o=r.canRegroupCases,i=(null===(t=this.props.children1)||void 0===t?void 0:t.size)||0;this.hasDefaultCase()&&i--;var a=EO(e);return 1==a&&o&&n&&i>1&&(a=111),a}},{key:"showConjs",value:function(){return!0}},{key:"renderHeaderWrapper",value:function(){return k().createElement("div",{key:"group-header",className:jg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",this.showConjs()?"with--conjs":"hide--conjs")},this.renderHeader(),this.renderActions())}},{key:"renderHeader",value:function(){return k().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag())}},{key:"renderConjs",value:function(){return this.props.config.settings.renderSwitchPrefix||null}},{key:"showNot",value:function(){return!1}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addCaseGroup,n=e.addDefaultCaseGroup,o=e.isLocked,i=e.isTrueLocked,a=e.id;return k().createElement(yO,{config:t,addCaseGroup:r,addDefaultCaseGroup:n,canAddDefault:!this.hasDefaultCase(),canAddGroup:this.canAddGroup(),setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}}])}($m);_O.propTypes=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?mO(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):mO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({},$m.propTypes);const TO=Nm(Kg("group switch_group")(ay(_O)),"switch_group");function RO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function wO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?RO(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):RO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function IO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(IO=function(){return!!e})()}function LO(e,t,r,n){var o=zm(N(1&n?e.prototype:e),t,r);return 2&n&&"function"==typeof o?function(e){return o.apply(r,e)}:o}var CO=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,IO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.childrenClassName=function(){return"case_group--children"},r.renderFooterWrapper=function(){return null},r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var r=this.props,n=!this.renderBeforeCaseValue||(null==r?void 0:r.config)!==(null==e?void 0:e.config);if(LO(t,"onPropsChanged",this,3)([e]),n){var o=e.config,i=o.settings,a=i.renderBeforeCaseValue,s=i.renderAfterCaseValue,l=i.renderRuleError;this.BeforeCaseValue=ly(o,a),this.AfterCaseValue=ly(o,s),this.RuleError=ly(o,l)}}},{key:"isDefaultCase",value:function(){return null==this.props.children1}},{key:"reordableNodesCnt",value:function(){return this.props.parentReordableNodesCnt}},{key:"reordableNodesCntForItem",value:function(e){return this.props.isLocked?0:this.props.reordableNodesCnt}},{key:"totalRulesCntForItem",value:function(e){return this.props.totalRulesCnt}},{key:"showDragIcon",value:function(){return!this.isDefaultCase()&&LO(t,"showDragIcon",this,3)([])}},{key:"renderHeaderWrapper",value:function(){return k().createElement("div",{key:"group-header",className:jg()("group--header",this.isOneChild()?"one--child":"",this.isOneChild()?"hide--line":"",this.isNoChildren()?"no--children":"",this.showDragIcon()?"with--drag":"hide--drag",!this.showConjs()||this.isOneChild()&&!this.showNot()?"hide--conjs":"with--conjs")},this.renderHeaderLeft(),this.renderHeaderCenter(),this.renderActions())}},{key:"renderChildrenWrapper",value:function(){return this.isDefaultCase()?null:k().createElement("div",{className:"case_group--body"},this.renderCondition(),this.renderBeforeValue(),this.renderValue(),this.renderAfterValue())}},{key:"renderHeaderLeft",value:function(){return this.isDefaultCase()?this.props.config.settings.defaultCaseLabel||"":k().createElement("div",{className:"group--conjunctions"},this.renderConjs(),this.renderDrag(),this.renderError())}},{key:"renderCondition",value:function(){return this.isDefaultCase()?null:LO(t,"renderChildrenWrapper",this,3)([])}},{key:"renderHeaderCenter",value:function(){return this.isDefaultCase()?k().createElement("div",null,this.renderValue(),this.renderError()):null}},{key:"canAddGroup",value:function(){return!this.isDefaultCase()&&LO(t,"canAddGroup",this,3)([])}},{key:"canAddRule",value:function(){return!this.isDefaultCase()&&LO(t,"canAddRule",this,3)([])}},{key:"renderBeforeValue",value:function(){var e=this.BeforeCaseValue;return null==e?null:k().createElement(e,Lg({key:"values-before"},this.props))}},{key:"renderAfterValue",value:function(){var e=this.AfterCaseValue;return null==e?null:k().createElement(e,Lg({key:"values-after"},this.props))}},{key:"renderError",value:function(){var e=this.props,t=e.config,r=e.valueError,n=t.settings.showErrorMessage,o=this.RuleError,i=xg((null==r?void 0:r.toArray())||[]).filter((function(e){return!!e})).shift()||null;return n&&i&&k().createElement("div",{className:"rule--error"},o?k().createElement(o,{error:i}):i)}},{key:"renderValue",value:function(){var e=this.props,t=e.config,r=e.isLocked,n=e.value,o=e.valueSrc,i=e.valueError,a=e.setValue,s=e.setValueSrc,l=e.setFuncValue,u=e.id,c=t.settings.immutableValuesMode,p=k().createElement(rm,{key:"values",isCaseValue:!0,field:"!case_value",operator:null,value:n,valueSrc:null!=o?o:"value",valueError:i,fieldError:null,config:t,setValue:c?oy:a,setValueSrc:c?oy:s,setFuncValue:c?oy:l,readonly:c||r,id:u,groupId:null});return k().createElement(ny,{className:"case_group--value"},p)}},{key:"renderActions",value:function(){var e=this.props,t=e.config,r=e.addGroup,n=e.addRule,o=e.isLocked,i=e.isTrueLocked,a=e.id;return k().createElement(Pm,{config:t,addGroup:r,addRule:n,canAddRule:this.canAddRule(),canAddGroup:this.canAddGroup(),canDeleteGroup:this.canDeleteGroup(),removeSelf:this.removeSelf,setLock:this.setLock,isLocked:o,isTrueLocked:i,id:a})}},{key:"isEmptyCurrentGroup",value:function(){var e=this.props.value,r=e&&e.size?e.get(0):null,n=null!=r&&(!Array.isArray(r)||r.length>0);return LO(t,"isEmptyCurrentGroup",this,3)([])&&!n}}])}($m);CO.propTypes=wO(wO({},$m.propTypes),{},{parentReordableNodesCnt:Dh().number,value:Dh().any,setValue:Dh().func});const AO=Nm(Kg("group case_group")(ay(CO)),"case_group");var xO=["type"];function NO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(NO=function(){return!!e})()}function jO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function FO(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?jO(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):jO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var PO=function(e){var t,r=(null===(t=e.properties)||void 0===t?void 0:t.toObject())||{},n=FO({},r);return e.isParentLocked&&(n.isLocked=!0),r.isLocked&&(n.isTrueLocked=!0),n},kO={rule:function(e){return k().createElement(Rm,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,config:e.config,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},group:function(e){return k().createElement(Wm,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group:function(e){return k().createElement(rO,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},rule_group_ext:function(e){return k().createElement(vO,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:e.parentField,parentFieldPathSize:e.parentFieldPathSize,parentReordableNodesCnt:e.parentReordableNodesCnt,parentFieldCanReorder:e.parentFieldCanReorder}))},switch_group:function(e){return k().createElement(TO,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))},case_group:function(e){return k().createElement(AO,Lg({},PO(e),{id:e.id,groupId:e.groupId,path:e.path,actions:e.actions,config:e.config,reordableNodesCnt:e.reordableNodesCnt,totalRulesCnt:e.totalRulesCnt,onDragStart:e.onDragStart,isDraggingTempo:e.isDraggingTempo,children1:e.children1,parentField:null,parentReordableNodesCnt:e.parentReordableNodesCnt}))}},DO=function(e){function t(){return w(this,t),function(e,t,r){return t=N(t),x(e,NO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,arguments)}return F(t,e),A(t,[{key:"render",value:function(){var e,t=this.props,r=t.type,n=Ig(t,xO),o="array"==(null===(e=n.properties)||void 0===e?void 0:e.get("mode"))?"_ext":"",i=n.config.settings.renderItem,a=kO[r+o];return i?i(FO(FO({},n),{},{type:r,itemComponent:a}),n.config.ctx):a?a(n):null}}])}(P.PureComponent);function VO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(VO=function(){return!!e})()}DO.propTypes={config:Dh().object.isRequired,id:Dh().string.isRequired,groupId:Dh().string,type:Dh().oneOf(["rule","group","rule_group","switch_group","case_group"]).isRequired,path:Dh().any.isRequired,properties:Dh().any,children1:Dh().any,actions:Dh().object.isRequired,reordableNodesCnt:Dh().number,onDragStart:Dh().func,parentField:Dh().string,isDraggingTempo:Dh().bool,isParentLocked:Dh().bool};var MO=Ph.TreeUtils,UO=MO.getTotalReordableNodesCountInTree,BO=MO.getTotalRulesCountInTree,qO=Ph.DefaultUtils,GO=qO.createListWithOneElement,KO=qO.emptyProperties,$O=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,VO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),r.pureShouldComponentUpdate=fg(r),r._updPath(e),r}return F(t,e),A(t,[{key:"shouldComponentUpdate",value:function(e,t){return this.pureShouldComponentUpdate(e,t)}},{key:"_updPath",value:function(e){var t=e.tree.get("id");this.path=GO(t)}},{key:"render",value:function(){var e=this.props,t=e.tree,r=e.config,n=e.actions,o=e.onDragStart,i=t.get("type"),a="switch_group"==i,s=a?null:UO(t),l=a?null:BO(t),u=t.get("id");return k().createElement(DO,{key:u,id:u,path:this.path,type:i,properties:t.get("properties")||KO(),config:r,actions:n,children1:t.get("children1")||KO(),reordableNodesCnt:s,totalRulesCnt:l,parentReordableNodesCnt:0,onDragStart:o})}}])}(P.Component);$O.propTypes={tree:Dh().any.isRequired,config:Dh().object.isRequired,actions:Dh().object.isRequired,onDragStart:Dh().func};const WO=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=(0,Bh.connect)((function(e){return{dragging:e.dragging,dragStart:e.dragStart,mousePos:e.mousePos}}),{setDragStart:zh,setDragProgress:Wh,setDragEnd:Hh},null,{context:Mh})(Bg(e,t));return r.displayName="ConnectedSortableContainer",r}($O);function zO(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function HO(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(HO=function(){return!!e})()}var YO=Ph.OtherUtils.clone,JO=Ph.ConfigUtils,XO=JO.getFieldConfig,QO=JO.getFieldParts,ZO=JO.getFieldPathParts,eb=JO.getWidgetForFieldOp,tb=Ph.RuleUtils.getFieldPathLabels,rb=function(e){function t(e){var r;return w(this,t),r=function(e,t,r){return t=N(t),x(e,HO()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[e]),dg(r),r.onPropsChanged(e),r}return F(t,e),A(t,[{key:"onPropsChanged",value:function(e){var t=this.props,r=!this.items||["config","field","fieldSrc","fieldType","operator","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0,n=!this.meta||["config","field","fieldSrc","fieldType","operator","value","placeholder","isFuncArg","parentField"].map((function(r){return e[r]!==t[r]})).filter((function(e){return e})).length>0;r&&(this.items=this.getItems(e)),n&&(this.meta=this.getMeta(e))}},{key:"getItems",value:function(e){var t=e.config,r=e.field,n=e.fieldType,o=e.operator,i=e.parentField,a=e.isFuncArg,s=e.fieldDefinition,l=t.settings.canCompareFieldWithField,u=QO(i,t),c=i?XO(t,i):null,p=i?null==c?void 0:c.subfields:t.fields,f=this.filterFields(t,p,r,i,u,o,l,a,s,n);return this.buildOptions(u,t,f,u)}},{key:"getMeta",value:function(e){var t,r=e.config,n=e.field,o=(e.fieldType,e.operator,e.value),i=e.placeholder,a=e.isFuncArg,s=e.parentField,l=r.settings,u=l.fieldPlaceholder,c=l.fieldSeparatorDisplay,p=o,f=!!o,d=n?XO(r,n):{},v=null==d||null===(t=d.widgets)||void 0===t?void 0:t.field,h=(null==v?void 0:v.widgetProps)||{},g=f?null:a&&i||h.valuePlaceholder||u,y=f?XO(r,p):null,m=y||{},O=ZO(p,r),b=ZO(p,r,!0),E=this.getFieldLabel(y,p,r),S=tb(p,r),_=S?S.join(c):null;return(_==E||s)&&(_=null),{placeholder:g,selectedKey:p,selectedKeys:O,selectedPath:b,selectedLabel:E,selectedOpts:m,selectedAltLabel:m.label2||m.tooltip,selectedFullLabel:_}}},{key:"filterFields",value:function(e,t,r,n,o,i,a,s,l,u){t=YO(t);var c,p=e.settings.fieldSeparator,f=XO(e,r),d=eb(e,r,i,"value"),v=(e.widgets[d],e.operators[i]);return c=s?null==l?void 0:l.type:null!=v&&v.valueTypes?null==v?void 0:v.valueTypes[0]:f?f.type:u,function t(n,o){for(var l in n){var u=n[l].subfields,d=(o||[]).concat(l),v=d.join(p),h=XO(e,v);if(h)if("!struct"==h.type||"!group"==h.type)0==t(u,d)&&delete n[l];else{var g=!(c&&h.type!=c||!s&&v==r),y=a||e.settings.canCompareFieldWithField;y&&(g=g&&y(r,f,v,h,i)),g||delete n[l]}else delete n[l]}return Wg()(n).length}(t,o||[]),t}},{key:"buildOptions",value:function(e,t,r){var n=this,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;if(!r)return null;var a=t.settings,s=a.fieldSeparator,l=a.fieldSeparatorDisplay,u=null!=o&&o.length?o.join(s)+s:"";return Wg()(r).map((function(a){var s=[].concat(xg(null!=o?o:[]),[a]),c=r[a],p=n.getFieldLabel(c,s,t),f=tb(s,t).join(l);(f==p||e)&&(f=null);var d=c.label2,v=c.tooltip;if(!c.hideForCompare)return"!struct"==c.type||"!group"==c.type?{key:a,path:u+a,label:p,fullLabel:f,altLabel:d,tooltip:v,items:n.buildOptions(e,t,c.subfields,s,{label:p,tooltip:v})}:{key:a,path:u+a,label:p,fullLabel:f,altLabel:d,tooltip:v,grouplabel:null==i?void 0:i.label,group:i}})).filter((function(e){return!!e}))}},{key:"getFieldLabel",value:function(e,t,r){if(!t)return null;var n=r.settings.maxLabelsLength,o=QO(t,r),i=(null==e?void 0:e.label)||va()(o);return i=tg(i,n)}},{key:"render",value:function(){var e=this.props,t=e.config,r=e.customProps,n=e.setValue,o=e.readonly,i=e.id,a=e.groupId,s=t.settings.renderField,l=function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?zO(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):zO(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}({isValueField:!0,config:t,customProps:r,setField:n,readonly:o,items:this.items,id:i,groupId:a},this.meta);return s(l,t.ctx)}}])}(P.Component);rb.propTypes={id:Dh().string,groupId:Dh().string,setValue:Dh().func.isRequired,config:Dh().object.isRequired,field:Dh().any,fieldSrc:Dh().string,fieldType:Dh().string,value:Dh().string,operator:Dh().string,customProps:Dh().object,readonly:Dh().bool,parentField:Dh().string,fieldDefinition:Dh().object,isFuncArg:Dh().bool};const nb=function(e){var t=e.value,r=e.setValue,n=(e.config,e.labelYes),o=e.labelNo,i=e.readonly,a=(e.widgetId,e.customProps),s=void 0===a?{}:a,l=s.radioYes||{},u=s.radioNo||{},c=function(e){return r("true"==e.target.value)};return k().createElement(k().Fragment,null,k().createElement("input",Lg({type:"radio",value:!0,checked:!!t,disabled:i,onChange:c},l))," ",n,k().createElement("input",Lg({type:"radio",value:!1,checked:!t,disabled:i,onChange:c},u))," ",o)},ob=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=e.customProps,s=t||"";return k().createElement("input",Lg({type:"text",value:s,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i},a))},ib=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.placeholder,i=e.maxLength,a=(e.maxRows,e.fullWidth),s=e.customProps,l=t||"";return k().createElement("textarea",Lg({value:l,placeholder:o,disabled:n,onChange:function(e){var t=e.target.value;""===t&&(t=void 0),r(t)},maxLength:i,style:{width:a?"100%":void 0}},s))};Ph.moment;const ab=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.readonly),o=e.customProps;return k().createElement("input",Lg({type:"date",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))},sb=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat,e.use12Hours,e.readonly),o=e.customProps;return k().createElement("input",Lg({type:"time",value:t||"",disabled:n,onChange:function(e){var t=e.target.value;""==t&&(t=void 0),r(t)}},o))};var lb=Ph.moment;const ub=function(e){var t=e.value,r=e.setValue,n=(e.config,e.valueFormat),o=(e.use12Hours,e.readonly),i=e.customProps,a=t;return a=t?lb(t).format("YYYY-MM-DDTHH:mm"):"",k().createElement("input",Lg({type:"datetime-local",value:a,disabled:o,onChange:function(e){var t=e.target.value;t=""==t?void 0:lb(new Date(t)).format(n),r(t)}},i))};var cb=Ph.ListUtils.mapListValues;const pb=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps;return k().createElement("select",Lg({multiple:!0,onChange:function(e){return n(function(e){for(var t=[],r=e.options,n=0;n<r.length;n++){var o=r[n];o.selected&&t.push(o.value)}return t.length||(t=void 0),t}(e.target))},value:r,disabled:o},Ac()(i,["showSearch","input","showCheckboxes"])),cb(t,(function(e){var t=e.title,r=e.value;return k().createElement("option",{key:r,value:r},t)})))};var fb=Ph.ListUtils.mapListValues;const db=function(e){var t=e.listValues,r=e.value,n=e.setValue,o=(e.allowCustomValues,e.readonly),i=e.customProps,a=null!=r;return k().createElement("select",Lg({onChange:function(e){return n(e.target.value)},value:a?r:"",disabled:o},Ac()(i,["showSearch","input"])),!a&&k().createElement("option",{disabled:!0,value:""}),fb(t,(function(e){var t=e.title,r=e.value;return k().createElement("option",{key:r,value:r},t)})))},vb=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,s=e.placeholder,l=e.customProps,u=null==t?"":t;return k().createElement("input",Lg({type:"number",value:u,placeholder:s,disabled:n,min:o,max:i,step:a,onChange:function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)}},l))},hb=function(e){var t=e.value,r=e.setValue,n=(e.config,e.readonly),o=e.min,i=e.max,a=e.step,s=e.placeholder,l=e.customProps,u=void 0===l?{}:l,c=u.input||{},p=u.slider||u,f=function(e){var t=e.target.value;t=""===t||null===t?void 0:Number(t),r(t)},d=null==t?"":t;return k().createElement("div",{style:{display:"inline-flex"}},k().createElement("input",Lg({key:"number",type:"number",value:d,placeholder:s,disabled:n,min:o,max:i,step:a,onChange:f},c)),k().createElement("input",Lg({key:"range",type:"range",value:d,disabled:n,min:o,max:i,step:a,onChange:f},p)))},gb=function(e){var t=e.items,r=e.setField,n=e.selectedKey,o=e.readonly,i=e.errorText,a=function(e){return e.map((function(e){var t=e.items,r=e.path,n=e.label,o=e.disabled,i=e.matchesType;if(t)return k().createElement("optgroup",{disabled:o,key:r,label:n},a(t));var s=i?{fontWeight:"bold"}:{};return k().createElement("option",{disabled:o,key:r,value:r,style:s},n)}))},s=null!=n;return k().createElement("select",{onChange:function(e){return r(e.target.value)},value:s?n:"",disabled:o,style:{color:i?"red":null}},!s&&k().createElement("option",{disabled:!0,value:""}),a(t))},yb=function(e){var t,r=e.id,n=e.not,o=e.setNot,i=e.conjunctionOptions,a=e.setConjunction,s=e.disabled,l=e.readonly,u=e.config,c=e.showNot,p=e.notLabel,f=Object.keys(i).length,d=s,v=u.settings.forceShowConj||f>1&&!d,h=function(e){return a(e.target.value)},g=function(e){return o(e.target.checked)};return[c&&(t="not",[k().createElement("input",{key:r+t,type:"checkbox",id:r+t,checked:n,disabled:l,onChange:g}),k().createElement("label",{key:r+t+"label",htmlFor:r+t},p||"NOT")]),v&&Object.keys(i).map((function(e){var t=i[e],r=t.id,n=t.name,o=t.label,u=t.checked,c=a.isDummyFn?"__dummy":"";return!l&&!s||u?[k().createElement("input",{key:r+c,type:"radio",id:r+c,name:n+c,checked:u,disabled:l||s,value:e,onChange:h}),k().createElement("label",{key:r+c+"label",htmlFor:r+c},o)]:null}))]};var mb={addSubRuleSimple:"+",addSubRule:"+",addSubGroup:"+",delGroup:"x",delRuleGroup:"x",delRule:"x"};const Ob=function(e){var t=e.type,r=e.label,n=e.onClick,o=e.readonly,i=r||mb[t];return k().createElement("button",{onClick:n,type:"button",disabled:o},i)},bb=function(e){var t=e.type,r={}[t]||null;return r||"drag"!==t||(r=k().createElement(iy,null)),r},Eb=function(e){var t=e.children;e.config;return k().createElement(k().Fragment,null,t)},Sb=function(e){e.config;var t=e.valueSources,r=e.valueSrc,n=(e.title,e.setValueSrc),o=e.readonly;return k().createElement("select",{onChange:function(e){return n(e.target.value)},value:r||"",disabled:o},function(e){return e.map((function(e){var t=ty(e,2),r=t[0],n=t[1];return k().createElement("option",{key:r,value:r},n.label)}))}(t))},_b=function(e){var t=e.value,r=e.setValue,n=e.label,o=e.id,i=(e.config,e.type);return[k().createElement("input",{key:o+i,type:"checkbox",id:o+i,checked:!!t,onChange:function(e){return r(e.target.checked)}}),k().createElement("label",{key:o+i+"label",htmlFor:o+i},n)]},Tb=function(e){var t=e.onOk,r=(e.okText,e.cancelText,e.title);confirm(r)&&t()};var Rb=function(e){e.config;return e.children};function wb(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(e){}return(wb=function(){return!!e})()}var Ib=function(e){function t(){var e;w(this,t);for(var r=arguments.length,n=new Array(r),o=0;o<r;o++)n[o]=arguments[o];return e=function(e,t,r){return t=N(t),x(e,wb()?Reflect.construct(t,r||[],N(e).constructor):t.apply(e,r))}(this,t,[].concat(n)),e.handleChange=function(t){e.props.setOption("proximity",parseInt(t))},e}return F(t,e),A(t,[{key:"render",value:function(){var e=this.props,t=e.defaults,r=e.options,n=e.config,o=e.optionLabel,i=e.optionPlaceholder,a=e.customProps,s=e.minProximity,l=e.maxProximity,u=e.optionTextBefore,c=e.readonly,p=n.settings,f=n.widgets,d=n.ctx,v=t?t.proximity:void 0,h=p.showLabels,g=r.get("proximity",v),y=Ny()(s,l+1).map((function(e){return{title:e,value:e}})),m=f.select.factory,O=function(e){return m(e,d)};return k().createElement("div",{className:"operator--PROXIMITY"},k().createElement("div",{className:"operator--options"},h&&k().createElement("label",{className:"rule--label"},o),!h&&u&&k().createElement("div",{className:"operator--options--sep"},k().createElement("span",null,u)),k().createElement(O,Lg({config:n,value:g,listValues:y,setValue:this.handleChange,readonly:c,placeholder:i},a))),k().createElement("div",{className:"operator--widgets"},this.props.children))}}])}(P.PureComponent);function Lb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Cb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Lb(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Lb(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}Ib.propTypes={config:Dh().object.isRequired,setOption:Dh().func.isRequired,options:Dh().any.isRequired,minProximity:Dh().number,maxProximity:Dh().number,optionPlaceholder:Dh().string,optionTextBefore:Dh().string,optionLabel:Dh().string,customProps:Dh().object,readonly:Dh().bool},Ib.defaultProps={customProps:{},minProximity:2,maxProximity:10,optionPlaceholder:"Select words between",optionLabel:"Words between",optionTextBefore:null};var Ab={conjunctions:Cb({},Cv.conjunctions),operators:Cb(Cb({},Cv.operators),{},{proximity:Cb(Cb({},Cv.operators.proximity),{},{options:Cb(Cb({},Cv.operators.proximity.options),{},{factory:function(e,t){return(0,t.RCE)(t.O.ProximityOperator,e)}})})}),widgets:{text:Cb(Cb({},Cv.widgets.text),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}}),textarea:Cb(Cb({},Cv.widgets.textarea),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextAreaWidget,e)}}),number:Cb(Cb({},Cv.widgets.number),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaNumberWidget,e)}}),slider:Cb(Cb({},Cv.widgets.slider),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSliderWidget,e)}}),select:Cb(Cb({},Cv.widgets.select),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaSelectWidget,e)}}),multiselect:Cb(Cb({},Cv.widgets.multiselect),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaMultiSelectWidget,e)}}),date:Cb(Cb({},Cv.widgets.date),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateWidget,e)}}),time:Cb(Cb({},Cv.widgets.time),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTimeWidget,e)}}),datetime:Cb(Cb({},Cv.widgets.datetime),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaDateTimeWidget,e)}}),boolean:Cb(Cb({},Cv.widgets.boolean),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaBooleanWidget,e)}}),field:Cb(Cb({},Cv.widgets.field),{},{factory:function(e,t){return(0,t.RCE)(t.W.ValueFieldWidget,e)},customProps:{showSearch:!0}}),func:Cb(Cb({},Cv.widgets.func),{},{factory:function(e,t){return(0,t.RCE)(t.W.FuncWidget,e)},customProps:{}}),case_value:Cb(Cb({},Cv.widgets.case_value),{},{factory:function(e,t){return(0,t.RCE)(t.W.VanillaTextWidget,e)}})},types:Cb(Cb({},Cv.types),{},{select:Cb(Cb({},Cv.types.select),{},{widgets:Cb(Cb({},Cv.types.select.widgets),{},{select:Cb(Cb({},Cv.types.select.widgets.select),{},{widgetProps:{customProps:{showSearch:!0}}})})})}),settings:Cb(Cb({},Cv.settings),{},{renderField:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderOperator:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderFunc:function(e,t){return(0,t.RCE)(t.W.VanillaFieldSelect,e)},renderConjs:function(e,t){return(0,t.RCE)(t.W.VanillaConjs,e)},renderSwitch:function(e,t){return(0,t.RCE)(t.W.VanillaSwitch,e)},renderButton:function(e,t){return(0,t.RCE)(t.W.VanillaButton,e)},renderIcon:function(e,t){return(0,t.RCE)(t.W.VanillaIcon,e)},renderButtonGroup:function(e,t){return(0,t.RCE)(t.W.VanillaButtonGroup,e)},renderProvider:function(e,t){return(0,t.RCE)(t.W.VanillaProvider,e)},renderValueSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderFieldSources:function(e,t){return(0,t.RCE)(t.W.VanillaValueSources,e)},renderConfirm:function(e,t){return(0,t.W.vanillaConfirm)(e)},renderSwitchPrefix:"IF",renderBeforeCaseValue:function(e,t){return(0,t.RCE)("span",{children:[" then "]})},customFieldSelectProps:{showSearch:!0},customOperatorSelectProps:{},defaultSliderWidth:"200px",defaultSelectWidth:"200px",defaultSearchWidth:"100px",defaultMaxRows:5,renderSize:"small",maxLabelsLength:100,showLock:!1,showNot:!0,forceShowConj:!1,groupActionsPosition:"topRight"}),ctx:Cb(Cb({},Cv.ctx),{},{W:Cb({},T),O:Cb({},R),RCE:function(e,t){return k().createElement(e,t)}})};const xb=Ab=Ph.ConfigMixins.removeMixins(Ab,["rangeslider","treeselect","treemultiselect"]);r(9471),r(9517);var Nb=Ph.Autocomplete,jb=(Nb.mergeListValues,Nb.listValueToOption,Nb.optionToListValue,Nb.optionsToListValues,Nb.fixListValuesGroupOrder,Ph.ListUtils);jb.mapListValues,jb.listValuesToArray,jb.getListValue,jb.makeCustomListValue,jb.searchListValue,jb.getItemInListValues;function Fb(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Pb(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Fb(Object(r),!0).forEach((function(t){Qh(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Fb(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const kb=Pb(Pb({},Ph),{},{ReactUtils:_,DragIcon:iy})},3523:e=>{var t=function(){"use strict";function e(e,t){return null!=t&&e instanceof t}var t,r,n;try{t=Map}catch(e){t=function(){}}try{r=Set}catch(e){r=function(){}}try{n=Promise}catch(e){n=function(){}}function o(i,s,l,u,c){"object"==typeof s&&(l=s.depth,u=s.prototype,c=s.includeNonEnumerable,s=s.circular);var p=[],f=[],d="undefined"!=typeof Buffer;return void 0===s&&(s=!0),void 0===l&&(l=1/0),function i(l,v){if(null===l)return null;if(0===v)return l;var h,g;if("object"!=typeof l)return l;if(e(l,t))h=new t;else if(e(l,r))h=new r;else if(e(l,n))h=new n((function(e,t){l.then((function(t){e(i(t,v-1))}),(function(e){t(i(e,v-1))}))}));else if(o.__isArray(l))h=[];else if(o.__isRegExp(l))h=new RegExp(l.source,a(l)),l.lastIndex&&(h.lastIndex=l.lastIndex);else if(o.__isDate(l))h=new Date(l.getTime());else{if(d&&Buffer.isBuffer(l))return h=Buffer.allocUnsafe?Buffer.allocUnsafe(l.length):new Buffer(l.length),l.copy(h),h;e(l,Error)?h=Object.create(l):void 0===u?(g=Object.getPrototypeOf(l),h=Object.create(g)):(h=Object.create(u),g=u)}if(s){var y=p.indexOf(l);if(-1!=y)return f[y];p.push(l),f.push(h)}for(var m in e(l,t)&&l.forEach((function(e,t){var r=i(t,v-1),n=i(e,v-1);h.set(r,n)})),e(l,r)&&l.forEach((function(e){var t=i(e,v-1);h.add(t)})),l){var O;g&&(O=Object.getOwnPropertyDescriptor(g,m)),O&&null==O.set||(h[m]=i(l[m],v-1))}if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(l);for(m=0;m<b.length;m++){var E=b[m];(!(_=Object.getOwnPropertyDescriptor(l,E))||_.enumerable||c)&&(h[E]=i(l[E],v-1),_.enumerable||Object.defineProperty(h,E,{enumerable:!1}))}}if(c){var S=Object.getOwnPropertyNames(l);for(m=0;m<S.length;m++){var _,T=S[m];(_=Object.getOwnPropertyDescriptor(l,T))&&_.enumerable||(h[T]=i(l[T],v-1),Object.defineProperty(h,T,{enumerable:!1}))}}return h}(i,l)}function i(e){return Object.prototype.toString.call(e)}function a(e){var t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),t}return o.clonePrototype=function(e){if(null===e)return null;var t=function(){};return t.prototype=e,new t},o.__objToStr=i,o.__isDate=function(e){return"object"==typeof e&&"[object Date]"===i(e)},o.__isArray=function(e){return"object"==typeof e&&"[object Array]"===i(e)},o.__isRegExp=function(e){return"object"==typeof e&&"[object RegExp]"===i(e)},o.__getRegExpFlags=a,o}();e.exports&&(e.exports=t)},502:function(e,t,r){var n,o;n=function(){"use strict";function e(e){for(var t=[],r=0,n=e.length;r<n;r++)-1===t.indexOf(e[r])&&t.push(e[r]);return t}Array.isArray||(Array.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)});var t={},r={"==":function(e,t){return e==t},"===":function(e,t){return e===t},"!=":function(e,t){return e!=t},"!==":function(e,t){return e!==t},">":function(e,t){return e>t},">=":function(e,t){return e>=t},"<":function(e,t,r){return void 0===r?e<t:e<t&&t<r},"<=":function(e,t,r){return void 0===r?e<=t:e<=t&&t<=r},"!!":function(e){return t.truthy(e)},"!":function(e){return!t.truthy(e)},"%":function(e,t){return e%t},log:function(e){return e},in:function(e,t){return!(!t||void 0===t.indexOf)&&-1!==t.indexOf(e)},cat:function(){return Array.prototype.join.call(arguments,"")},substr:function(e,t,r){if(r<0){var n=String(e).substr(t);return n.substr(0,n.length+r)}return String(e).substr(t,r)},"+":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)+parseFloat(t,10)}),0)},"*":function(){return Array.prototype.reduce.call(arguments,(function(e,t){return parseFloat(e,10)*parseFloat(t,10)}))},"-":function(e,t){return void 0===t?-e:e-t},"/":function(e,t){return e/t},min:function(){return Math.min.apply(this,arguments)},max:function(){return Math.max.apply(this,arguments)},merge:function(){return Array.prototype.reduce.call(arguments,(function(e,t){return e.concat(t)}),[])},var:function(e,t){var r=void 0===t?null:t,n=this;if(void 0===e||""===e||null===e)return n;for(var o=String(e).split("."),i=0;i<o.length;i++){if(null==n)return r;if(void 0===(n=n[o[i]]))return r}return n},missing:function(){for(var e=[],r=Array.isArray(arguments[0])?arguments[0]:arguments,n=0;n<r.length;n++){var o=r[n],i=t.apply({var:o},this);null!==i&&""!==i||e.push(o)}return e},missing_some:function(e,r){var n=t.apply({missing:r},this);return r.length-n.length>=e?[]:n}};return t.is_logic=function(e){return"object"==typeof e&&null!==e&&!Array.isArray(e)&&1===Object.keys(e).length},t.truthy=function(e){return!(Array.isArray(e)&&0===e.length||!e)},t.get_operator=function(e){return Object.keys(e)[0]},t.get_values=function(e){return e[t.get_operator(e)]},t.apply=function(e,n){if(Array.isArray(e))return e.map((function(e){return t.apply(e,n)}));if(!t.is_logic(e))return e;var o,i,a,s,l,u=t.get_operator(e),c=e[u];if(Array.isArray(c)||(c=[c]),"if"===u||"?:"==u){for(o=0;o<c.length-1;o+=2)if(t.truthy(t.apply(c[o],n)))return t.apply(c[o+1],n);return c.length===o+1?t.apply(c[o],n):null}if("and"===u){for(o=0;o<c.length;o+=1)if(i=t.apply(c[o],n),!t.truthy(i))return i;return i}if("or"===u){for(o=0;o<c.length;o+=1)if(i=t.apply(c[o],n),t.truthy(i))return i;return i}if("filter"===u)return s=t.apply(c[0],n),a=c[1],Array.isArray(s)?s.filter((function(e){return t.truthy(t.apply(a,e))})):[];if("map"===u)return s=t.apply(c[0],n),a=c[1],Array.isArray(s)?s.map((function(e){return t.apply(a,e)})):[];if("reduce"===u)return s=t.apply(c[0],n),a=c[1],l=void 0!==c[2]?c[2]:null,Array.isArray(s)?s.reduce((function(e,r){return t.apply(a,{current:r,accumulator:e})}),l):l;if("all"===u){if(s=t.apply(c[0],n),a=c[1],!Array.isArray(s)||!s.length)return!1;for(o=0;o<s.length;o+=1)if(!t.truthy(t.apply(a,s[o])))return!1;return!0}if("none"===u){if(s=t.apply(c[0],n),a=c[1],!Array.isArray(s)||!s.length)return!0;for(o=0;o<s.length;o+=1)if(t.truthy(t.apply(a,s[o])))return!1;return!0}if("some"===u){if(s=t.apply(c[0],n),a=c[1],!Array.isArray(s)||!s.length)return!1;for(o=0;o<s.length;o+=1)if(t.truthy(t.apply(a,s[o])))return!0;return!1}if(c=c.map((function(e){return t.apply(e,n)})),r.hasOwnProperty(u)&&"function"==typeof r[u])return r[u].apply(n,c);if(u.indexOf(".")>0){var p=String(u).split("."),f=r;for(o=0;o<p.length;o++){if(!f.hasOwnProperty(p[o]))throw new Error("Unrecognized operation "+u+" (failed at "+p.slice(0,o+1).join(".")+")");f=f[p[o]]}return f.apply(n,c)}throw new Error("Unrecognized operation "+u)},t.uses_data=function(r){var n=[];if(t.is_logic(r)){var o=t.get_operator(r),i=r[o];Array.isArray(i)||(i=[i]),"var"===o?n.push(i[0]):i.forEach((function(e){n.push.apply(n,t.uses_data(e))}))}return e(n)},t.add_operation=function(e,t){r[e]=t},t.rm_operation=function(e){delete r[e]},t.rule_like=function(e,r){if(r===e)return!0;if("@"===r)return!0;if("number"===r)return"number"==typeof e;if("string"===r)return"string"==typeof e;if("array"===r)return Array.isArray(e)&&!t.is_logic(e);if(t.is_logic(r)){if(t.is_logic(e)){var n=t.get_operator(r),o=t.get_operator(e);if("@"===n||n===o)return t.rule_like(t.get_values(e,!1),t.get_values(r,!1))}return!1}if(Array.isArray(r)){if(Array.isArray(e)){if(r.length!==e.length)return!1;for(var i=0;i<r.length;i+=1)if(!t.rule_like(e[i],r[i]))return!1;return!0}return!1}return!1},t},void 0===(o="function"==typeof n?n.call(t,r,t,e):n)||(e.exports=o)},5948:(e,t,r)=>{var n=r(2062)(r(9965),"DataView");e.exports=n},4845:(e,t,r)=>{var n=r(5504),o=r(5270),i=r(4769),a=r(2637),s=r(1077);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},1999:(e,t,r)=>{var n=r(7718),o=r(4272),i=r(5107),a=r(1055),s=r(4647);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},5455:(e,t,r)=>{var n=r(2062)(r(9965),"Map");e.exports=n},1549:(e,t,r)=>{var n=r(6400),o=r(7014),i=r(1793),a=r(6429),s=r(821);function l(e){var t=-1,r=null==e?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}l.prototype.clear=n,l.prototype.delete=o,l.prototype.get=i,l.prototype.has=a,l.prototype.set=s,e.exports=l},6420:(e,t,r)=>{var n=r(2062)(r(9965),"Promise");e.exports=n},2833:(e,t,r)=>{var n=r(2062)(r(9965),"Set");e.exports=n},8283:(e,t,r)=>{var n=r(1549),o=r(228),i=r(3683);function a(e){var t=-1,r=null==e?0:e.length;for(this.__data__=new n;++t<r;)this.add(e[t])}a.prototype.add=a.prototype.push=o,a.prototype.has=i,e.exports=a},8545:(e,t,r)=>{var n=r(1999),o=r(5052),i=r(4250),a=r(4773),s=r(6921),l=r(5745);function u(e){var t=this.__data__=new n(e);this.size=t.size}u.prototype.clear=o,u.prototype.delete=i,u.prototype.get=a,u.prototype.has=s,u.prototype.set=l,e.exports=u},2609:(e,t,r)=>{var n=r(9965).Symbol;e.exports=n},3604:(e,t,r)=>{var n=r(9965).Uint8Array;e.exports=n},8143:(e,t,r)=>{var n=r(2062)(r(9965),"WeakMap");e.exports=n},1929:e=>{e.exports=function(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}},6433:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==t(e[r],r,e););return e}},9386:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=0,i=[];++r<n;){var a=e[r];t(a,r,e)&&(i[o++]=a)}return i}},6791:(e,t,r)=>{var n=r(2784),o=r(5196),i=r(4913),a=r(4264),s=r(6665),l=r(5087),u=Object.prototype.hasOwnProperty;e.exports=function(e,t){var r=i(e),c=!r&&o(e),p=!r&&!c&&a(e),f=!r&&!c&&!p&&l(e),d=r||c||p||f,v=d?n(e.length,String):[],h=v.length;for(var g in e)!t&&!u.call(e,g)||d&&("length"==g||p&&("offset"==g||"parent"==g)||f&&("buffer"==g||"byteLength"==g||"byteOffset"==g)||s(g,h))||v.push(g);return v}},1428:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length,o=Array(n);++r<n;)o[r]=t(e[r],r,e);return o}},8256:e=>{e.exports=function(e,t){for(var r=-1,n=t.length,o=e.length;++r<n;)e[o+r]=t[r];return e}},9272:e=>{e.exports=function(e,t){for(var r=-1,n=null==e?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}},237:(e,t,r)=>{var n=r(2464),o=r(6424);e.exports=function(e,t,r){(void 0!==r&&!o(e[t],r)||void 0===r&&!(t in e))&&n(e,t,r)}},8131:(e,t,r)=>{var n=r(2464),o=r(6424),i=Object.prototype.hasOwnProperty;e.exports=function(e,t,r){var a=e[t];i.call(e,t)&&o(a,r)&&(void 0!==r||t in e)||n(e,t,r)}},3481:(e,t,r)=>{var n=r(6424);e.exports=function(e,t){for(var r=e.length;r--;)if(n(e[r][0],t))return r;return-1}},4861:(e,t,r)=>{var n=r(4735),o=r(3790);e.exports=function(e,t){return e&&n(t,o(t),e)}},7838:(e,t,r)=>{var n=r(4735),o=r(5961);e.exports=function(e,t){return e&&n(t,o(t),e)}},2464:(e,t,r)=>{var n=r(9611);e.exports=function(e,t,r){"__proto__"==t&&n?n(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}},5725:e=>{e.exports=function(e,t,r){return e==e&&(void 0!==r&&(e=e<=r?e:r),void 0!==t&&(e=e>=t?e:t)),e}},6575:(e,t,r)=>{var n=r(8545),o=r(6433),i=r(8131),a=r(4861),s=r(7838),l=r(8986),u=r(1231),c=r(1711),p=r(1476),f=r(130),d=r(869),v=r(6053),h=r(509),g=r(1343),y=r(1225),m=r(4913),O=r(4264),b=r(146),E=r(9834),S=r(8696),_=r(3790),T=r(5961),R="[object Arguments]",w="[object Function]",I="[object Object]",L={};L[R]=L["[object Array]"]=L["[object ArrayBuffer]"]=L["[object DataView]"]=L["[object Boolean]"]=L["[object Date]"]=L["[object Float32Array]"]=L["[object Float64Array]"]=L["[object Int8Array]"]=L["[object Int16Array]"]=L["[object Int32Array]"]=L["[object Map]"]=L["[object Number]"]=L[I]=L["[object RegExp]"]=L["[object Set]"]=L["[object String]"]=L["[object Symbol]"]=L["[object Uint8Array]"]=L["[object Uint8ClampedArray]"]=L["[object Uint16Array]"]=L["[object Uint32Array]"]=!0,L["[object Error]"]=L[w]=L["[object WeakMap]"]=!1,e.exports=function e(t,r,C,A,x,N){var j,F=1&r,P=2&r,k=4&r;if(C&&(j=x?C(t,A,x,N):C(t)),void 0!==j)return j;if(!E(t))return t;var D=m(t);if(D){if(j=h(t),!F)return u(t,j)}else{var V=v(t),M=V==w||"[object GeneratorFunction]"==V;if(O(t))return l(t,F);if(V==I||V==R||M&&!x){if(j=P||M?{}:y(t),!F)return P?p(t,s(j,t)):c(t,a(j,t))}else{if(!L[V])return x?t:{};j=g(t,V,F)}}N||(N=new n);var U=N.get(t);if(U)return U;N.set(t,j),S(t)?t.forEach((function(n){j.add(e(n,r,C,n,t,N))})):b(t)&&t.forEach((function(n,o){j.set(o,e(n,r,C,o,t,N))}));var B=D?void 0:(k?P?d:f:P?T:_)(t);return o(B||t,(function(n,o){B&&(n=t[o=n]),i(j,o,e(n,r,C,o,t,N))})),j}},3088:(e,t,r)=>{var n=r(9834),o=Object.create,i=function(){function e(){}return function(t){if(!n(t))return{};if(o)return o(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}();e.exports=i},3323:e=>{e.exports=function(e,t,r,n){for(var o=e.length,i=r+(n?1:-1);n?i--:++i<o;)if(t(e[i],i,e))return i;return-1}},1360:(e,t,r)=>{var n=r(8256),o=r(5043);e.exports=function e(t,r,i,a,s){var l=-1,u=t.length;for(i||(i=o),s||(s=[]);++l<u;){var c=t[l];r>0&&i(c)?r>1?e(c,r-1,i,a,s):n(s,c):a||(s[s.length]=c)}return s}},6057:(e,t,r)=>{var n=r(5845)();e.exports=n},5473:(e,t,r)=>{var n=r(6057),o=r(3790);e.exports=function(e,t){return e&&n(e,t,o)}},2718:(e,t,r)=>{var n=r(2361),o=r(8197);e.exports=function(e,t){for(var r=0,i=(t=n(t,e)).length;null!=e&&r<i;)e=e[o(t[r++])];return r&&r==i?e:void 0}},8359:(e,t,r)=>{var n=r(8256),o=r(4913);e.exports=function(e,t,r){var i=t(e);return o(e)?i:n(i,r(e))}},9048:(e,t,r)=>{var n=r(2609),o=r(2899),i=r(7222),a=n?n.toStringTag:void 0;e.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?o(e):i(e)}},3613:e=>{e.exports=function(e,t){return null!=e&&t in Object(e)}},9555:(e,t,r)=>{var n=r(3323),o=r(8967),i=r(5951);e.exports=function(e,t,r){return t==t?i(e,t,r):n(e,o,r)}},3070:(e,t,r)=>{var n=r(9048),o=r(9466);e.exports=function(e){return o(e)&&"[object Arguments]"==n(e)}},590:(e,t,r)=>{var n=r(9132),o=r(9466);e.exports=function e(t,r,i,a,s){return t===r||(null==t||null==r||!o(t)&&!o(r)?t!=t&&r!=r:n(t,r,i,a,e,s))}},9132:(e,t,r)=>{var n=r(8545),o=r(4807),i=r(898),a=r(3409),s=r(6053),l=r(4913),u=r(4264),c=r(5087),p="[object Arguments]",f="[object Array]",d="[object Object]",v=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,h,g,y){var m=l(e),O=l(t),b=m?f:s(e),E=O?f:s(t),S=(b=b==p?d:b)==d,_=(E=E==p?d:E)==d,T=b==E;if(T&&u(e)){if(!u(t))return!1;m=!0,S=!1}if(T&&!S)return y||(y=new n),m||c(e)?o(e,t,r,h,g,y):i(e,t,b,r,h,g,y);if(!(1&r)){var R=S&&v.call(e,"__wrapped__"),w=_&&v.call(t,"__wrapped__");if(R||w){var I=R?e.value():e,L=w?t.value():t;return y||(y=new n),g(I,L,r,h,y)}}return!!T&&(y||(y=new n),a(e,t,r,h,g,y))}},2052:(e,t,r)=>{var n=r(6053),o=r(9466);e.exports=function(e){return o(e)&&"[object Map]"==n(e)}},7799:(e,t,r)=>{var n=r(8545),o=r(590);e.exports=function(e,t,r,i){var a=r.length,s=a,l=!i;if(null==e)return!s;for(e=Object(e);a--;){var u=r[a];if(l&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++a<s;){var c=(u=r[a])[0],p=e[c],f=u[1];if(l&&u[2]){if(void 0===p&&!(c in e))return!1}else{var d=new n;if(i)var v=i(p,f,c,e,t,d);if(!(void 0===v?o(f,p,3,i,d):v))return!1}}return!0}},8967:e=>{e.exports=function(e){return e!=e}},4363:(e,t,r)=>{var n=r(1866),o=r(3248),i=r(9834),a=r(3761),s=/^\[object .+?Constructor\]$/,l=Function.prototype,u=Object.prototype,c=l.toString,p=u.hasOwnProperty,f=RegExp("^"+c.call(p).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=function(e){return!(!i(e)||o(e))&&(n(e)?f:s).test(a(e))}},5206:(e,t,r)=>{var n=r(6053),o=r(9466);e.exports=function(e){return o(e)&&"[object Set]"==n(e)}},9653:(e,t,r)=>{var n=r(9048),o=r(582),i=r(9466),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,e.exports=function(e){return i(e)&&o(e.length)&&!!a[n(e)]}},3245:(e,t,r)=>{var n=r(8271),o=r(4458),i=r(912),a=r(4913),s=r(6711);e.exports=function(e){return"function"==typeof e?e:null==e?i:"object"==typeof e?a(e)?o(e[0],e[1]):n(e):s(e)}},6504:(e,t,r)=>{var n=r(5735),o=r(9458),i=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return o(e);var t=[];for(var r in Object(e))i.call(e,r)&&"constructor"!=r&&t.push(r);return t}},9399:(e,t,r)=>{var n=r(9834),o=r(5735),i=r(2693),a=Object.prototype.hasOwnProperty;e.exports=function(e){if(!n(e))return i(e);var t=o(e),r=[];for(var s in e)("constructor"!=s||!t&&a.call(e,s))&&r.push(s);return r}},8271:(e,t,r)=>{var n=r(7799),o=r(520),i=r(7405);e.exports=function(e){var t=o(e);return 1==t.length&&t[0][2]?i(t[0][0],t[0][1]):function(r){return r===e||n(r,e,t)}}},4458:(e,t,r)=>{var n=r(590),o=r(5612),i=r(4055),a=r(6394),s=r(2308),l=r(7405),u=r(8197);e.exports=function(e,t){return a(e)&&s(t)?l(u(e),t):function(r){var a=o(r,e);return void 0===a&&a===t?i(r,e):n(t,a,3)}}},9058:(e,t,r)=>{var n=r(8545),o=r(237),i=r(6057),a=r(8120),s=r(9834),l=r(5961),u=r(4302);e.exports=function e(t,r,c,p,f){t!==r&&i(r,(function(i,l){if(f||(f=new n),s(i))a(t,r,l,c,e,p,f);else{var d=p?p(u(t,l),i,l+"",t,r,f):void 0;void 0===d&&(d=i),o(t,l,d)}}),l)}},8120:(e,t,r)=>{var n=r(237),o=r(8986),i=r(7961),a=r(1231),s=r(1225),l=r(5196),u=r(4913),c=r(7965),p=r(4264),f=r(1866),d=r(9834),v=r(5219),h=r(5087),g=r(4302),y=r(5148);e.exports=function(e,t,r,m,O,b,E){var S=g(e,r),_=g(t,r),T=E.get(_);if(T)n(e,r,T);else{var R=b?b(S,_,r+"",e,t,E):void 0,w=void 0===R;if(w){var I=u(_),L=!I&&p(_),C=!I&&!L&&h(_);R=_,I||L||C?u(S)?R=S:c(S)?R=a(S):L?(w=!1,R=o(_,!0)):C?(w=!1,R=i(_,!0)):R=[]:v(_)||l(_)?(R=S,l(S)?R=y(S):d(S)&&!f(S)||(R=s(_))):w=!1}w&&(E.set(_,R),O(R,_,m,b,E),E.delete(_)),n(e,r,R)}}},1:(e,t,r)=>{var n=r(9916),o=r(4055);e.exports=function(e,t){return n(e,t,(function(t,r){return o(e,r)}))}},9916:(e,t,r)=>{var n=r(2718),o=r(3746),i=r(2361);e.exports=function(e,t,r){for(var a=-1,s=t.length,l={};++a<s;){var u=t[a],c=n(e,u);r(c,u)&&o(l,i(u,e),c)}return l}},645:e=>{e.exports=function(e){return function(t){return null==t?void 0:t[e]}}},5319:(e,t,r)=>{var n=r(2718);e.exports=function(e){return function(t){return n(t,e)}}},9383:e=>{var t=Math.ceil,r=Math.max;e.exports=function(e,n,o,i){for(var a=-1,s=r(t((n-e)/(o||1)),0),l=Array(s);s--;)l[i?s:++a]=e,e+=o;return l}},3840:e=>{var t=Math.floor;e.exports=function(e,r){var n="";if(!e||r<1||r>9007199254740991)return n;do{r%2&&(n+=e),(r=t(r/2))&&(e+=e)}while(r);return n}},1110:(e,t,r)=>{var n=r(912),o=r(709),i=r(7281);e.exports=function(e,t){return i(o(e,t,n),e+"")}},3746:(e,t,r)=>{var n=r(8131),o=r(2361),i=r(6665),a=r(9834),s=r(8197);e.exports=function(e,t,r,l){if(!a(e))return e;for(var u=-1,c=(t=o(t,e)).length,p=c-1,f=e;null!=f&&++u<c;){var d=s(t[u]),v=r;if("__proto__"===d||"constructor"===d||"prototype"===d)return e;if(u!=p){var h=f[d];void 0===(v=l?l(h,d,f):void 0)&&(v=a(h)?h:i(t[u+1])?[]:{})}n(f,d,v),f=f[d]}return e}},4450:(e,t,r)=>{var n=r(6534),o=r(9611),i=r(912),a=o?function(e,t){return o(e,"toString",{configurable:!0,enumerable:!1,value:n(t),writable:!0})}:i;e.exports=a},312:e=>{e.exports=function(e,t,r){var n=-1,o=e.length;t<0&&(t=-t>o?0:o+t),(r=r>o?o:r)<0&&(r+=o),o=t>r?0:r-t>>>0,t>>>=0;for(var i=Array(o);++n<o;)i[n]=e[n+t];return i}},2784:e=>{e.exports=function(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}},9764:(e,t,r)=>{var n=r(2609),o=r(1428),i=r(4913),a=r(7386),s=n?n.prototype:void 0,l=s?s.toString:void 0;e.exports=function e(t){if("string"==typeof t)return t;if(i(t))return o(t,e)+"";if(a(t))return l?l.call(t):"";var r=t+"";return"0"==r&&1/t==-1/0?"-0":r}},7248:(e,t,r)=>{var n=r(1272),o=/^\s+/;e.exports=function(e){return e?e.slice(0,n(e)+1).replace(o,""):e}},277:e=>{e.exports=function(e){return function(t){return e(t)}}},6744:(e,t,r)=>{var n=r(2361),o=r(8906),i=r(2473),a=r(8197);e.exports=function(e,t){return t=n(t,e),null==(e=i(e,t))||delete e[a(o(t))]}},1282:(e,t,r)=>{var n=r(1428);e.exports=function(e,t){return n(t,(function(t){return e[t]}))}},1459:e=>{e.exports=function(e,t){return e.has(t)}},2361:(e,t,r)=>{var n=r(4913),o=r(6394),i=r(266),a=r(3158);e.exports=function(e,t){return n(e)?e:o(e,t)?[e]:i(a(e))}},7749:(e,t,r)=>{var n=r(3604);e.exports=function(e){var t=new e.constructor(e.byteLength);return new n(t).set(new n(e)),t}},8986:(e,t,r)=>{e=r.nmd(e);var n=r(9965),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o?n.Buffer:void 0,s=a?a.allocUnsafe:void 0;e.exports=function(e,t){if(t)return e.slice();var r=e.length,n=s?s(r):new e.constructor(r);return e.copy(n),n}},3081:(e,t,r)=>{var n=r(7749);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}},6945:e=>{var t=/\w*$/;e.exports=function(e){var r=new e.constructor(e.source,t.exec(e));return r.lastIndex=e.lastIndex,r}},6952:(e,t,r)=>{var n=r(2609),o=n?n.prototype:void 0,i=o?o.valueOf:void 0;e.exports=function(e){return i?Object(i.call(e)):{}}},7961:(e,t,r)=>{var n=r(7749);e.exports=function(e,t){var r=t?n(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}},1231:e=>{e.exports=function(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}},4735:(e,t,r)=>{var n=r(8131),o=r(2464);e.exports=function(e,t,r,i){var a=!r;r||(r={});for(var s=-1,l=t.length;++s<l;){var u=t[s],c=i?i(r[u],e[u],u,r,e):void 0;void 0===c&&(c=e[u]),a?o(r,u,c):n(r,u,c)}return r}},1711:(e,t,r)=>{var n=r(4735),o=r(6600);e.exports=function(e,t){return n(e,o(e),t)}},1476:(e,t,r)=>{var n=r(4735),o=r(8455);e.exports=function(e,t){return n(e,o(e),t)}},2489:(e,t,r)=>{var n=r(9965)["__core-js_shared__"];e.exports=n},9511:(e,t,r)=>{var n=r(1110),o=r(3632);e.exports=function(e){return n((function(t,r){var n=-1,i=r.length,a=i>1?r[i-1]:void 0,s=i>2?r[2]:void 0;for(a=e.length>3&&"function"==typeof a?(i--,a):void 0,s&&o(r[0],r[1],s)&&(a=i<3?void 0:a,i=1),t=Object(t);++n<i;){var l=r[n];l&&e(t,l,n,a)}return t}))}},5845:e=>{e.exports=function(e){return function(t,r,n){for(var o=-1,i=Object(t),a=n(t),s=a.length;s--;){var l=a[e?s:++o];if(!1===r(i[l],l,i))break}return t}}},8580:(e,t,r)=>{var n=r(9383),o=r(3632),i=r(1144);e.exports=function(e){return function(t,r,a){return a&&"number"!=typeof a&&o(t,r,a)&&(r=a=void 0),t=i(t),void 0===r?(r=t,t=0):r=i(r),a=void 0===a?t<r?1:-1:i(a),n(t,r,a,e)}}},2050:(e,t,r)=>{var n=r(5219);e.exports=function(e){return n(e)?void 0:e}},9611:(e,t,r)=>{var n=r(2062),o=function(){try{var e=n(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();e.exports=o},4807:(e,t,r)=>{var n=r(8283),o=r(9272),i=r(1459);e.exports=function(e,t,r,a,s,l){var u=1&r,c=e.length,p=t.length;if(c!=p&&!(u&&p>c))return!1;var f=l.get(e),d=l.get(t);if(f&&d)return f==t&&d==e;var v=-1,h=!0,g=2&r?new n:void 0;for(l.set(e,t),l.set(t,e);++v<c;){var y=e[v],m=t[v];if(a)var O=u?a(m,y,v,t,e,l):a(y,m,v,e,t,l);if(void 0!==O){if(O)continue;h=!1;break}if(g){if(!o(t,(function(e,t){if(!i(g,t)&&(y===e||s(y,e,r,a,l)))return g.push(t)}))){h=!1;break}}else if(y!==m&&!s(y,m,r,a,l)){h=!1;break}}return l.delete(e),l.delete(t),h}},898:(e,t,r)=>{var n=r(2609),o=r(3604),i=r(6424),a=r(4807),s=r(9885),l=r(6295),u=n?n.prototype:void 0,c=u?u.valueOf:void 0;e.exports=function(e,t,r,n,u,p,f){switch(r){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":return!(e.byteLength!=t.byteLength||!p(new o(e),new o(t)));case"[object Boolean]":case"[object Date]":case"[object Number]":return i(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var d=s;case"[object Set]":var v=1&n;if(d||(d=l),e.size!=t.size&&!v)return!1;var h=f.get(e);if(h)return h==t;n|=2,f.set(e,t);var g=a(d(e),d(t),n,u,p,f);return f.delete(e),g;case"[object Symbol]":if(c)return c.call(e)==c.call(t)}return!1}},3409:(e,t,r)=>{var n=r(130),o=Object.prototype.hasOwnProperty;e.exports=function(e,t,r,i,a,s){var l=1&r,u=n(e),c=u.length;if(c!=n(t).length&&!l)return!1;for(var p=c;p--;){var f=u[p];if(!(l?f in t:o.call(t,f)))return!1}var d=s.get(e),v=s.get(t);if(d&&v)return d==t&&v==e;var h=!0;s.set(e,t),s.set(t,e);for(var g=l;++p<c;){var y=e[f=u[p]],m=t[f];if(i)var O=l?i(m,y,f,t,e,s):i(y,m,f,e,t,s);if(!(void 0===O?y===m||a(y,m,r,i,s):O)){h=!1;break}g||(g="constructor"==f)}if(h&&!g){var b=e.constructor,E=t.constructor;b==E||!("constructor"in e)||!("constructor"in t)||"function"==typeof b&&b instanceof b&&"function"==typeof E&&E instanceof E||(h=!1)}return s.delete(e),s.delete(t),h}},8496:(e,t,r)=>{var n=r(9234),o=r(709),i=r(7281);e.exports=function(e){return i(o(e,void 0,n),e+"")}},6392:(e,t,r)=>{var n="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g;e.exports=n},130:(e,t,r)=>{var n=r(8359),o=r(6600),i=r(3790);e.exports=function(e){return n(e,i,o)}},869:(e,t,r)=>{var n=r(8359),o=r(8455),i=r(5961);e.exports=function(e){return n(e,i,o)}},3707:(e,t,r)=>{var n=r(9178);e.exports=function(e,t){var r=e.__data__;return n(t)?r["string"==typeof t?"string":"hash"]:r.map}},520:(e,t,r)=>{var n=r(2308),o=r(3790);e.exports=function(e){for(var t=o(e),r=t.length;r--;){var i=t[r],a=e[i];t[r]=[i,a,n(a)]}return t}},2062:(e,t,r)=>{var n=r(4363),o=r(5240);e.exports=function(e,t){var r=o(e,t);return n(r)?r:void 0}},6607:(e,t,r)=>{var n=r(8303)(Object.getPrototypeOf,Object);e.exports=n},2899:(e,t,r)=>{var n=r(2609),o=Object.prototype,i=o.hasOwnProperty,a=o.toString,s=n?n.toStringTag:void 0;e.exports=function(e){var t=i.call(e,s),r=e[s];try{e[s]=void 0;var n=!0}catch(e){}var o=a.call(e);return n&&(t?e[s]=r:delete e[s]),o}},6600:(e,t,r)=>{var n=r(9386),o=r(8721),i=Object.prototype.propertyIsEnumerable,a=Object.getOwnPropertySymbols,s=a?function(e){return null==e?[]:(e=Object(e),n(a(e),(function(t){return i.call(e,t)})))}:o;e.exports=s},8455:(e,t,r)=>{var n=r(8256),o=r(6607),i=r(6600),a=r(8721),s=Object.getOwnPropertySymbols?function(e){for(var t=[];e;)n(t,i(e)),e=o(e);return t}:a;e.exports=s},6053:(e,t,r)=>{var n=r(5948),o=r(5455),i=r(6420),a=r(2833),s=r(8143),l=r(9048),u=r(3761),c="[object Map]",p="[object Promise]",f="[object Set]",d="[object WeakMap]",v="[object DataView]",h=u(n),g=u(o),y=u(i),m=u(a),O=u(s),b=l;(n&&b(new n(new ArrayBuffer(1)))!=v||o&&b(new o)!=c||i&&b(i.resolve())!=p||a&&b(new a)!=f||s&&b(new s)!=d)&&(b=function(e){var t=l(e),r="[object Object]"==t?e.constructor:void 0,n=r?u(r):"";if(n)switch(n){case h:return v;case g:return c;case y:return p;case m:return f;case O:return d}return t}),e.exports=b},5240:e=>{e.exports=function(e,t){return null==e?void 0:e[t]}},1518:(e,t,r)=>{var n=r(2361),o=r(5196),i=r(4913),a=r(6665),s=r(582),l=r(8197);e.exports=function(e,t,r){for(var u=-1,c=(t=n(t,e)).length,p=!1;++u<c;){var f=l(t[u]);if(!(p=null!=e&&r(e,f)))break;e=e[f]}return p||++u!=c?p:!!(c=null==e?0:e.length)&&s(c)&&a(f,c)&&(i(e)||o(e))}},5504:(e,t,r)=>{var n=r(8034);e.exports=function(){this.__data__=n?n(null):{},this.size=0}},5270:e=>{e.exports=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}},4769:(e,t,r)=>{var n=r(8034),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;if(n){var r=t[e];return"__lodash_hash_undefined__"===r?void 0:r}return o.call(t,e)?t[e]:void 0}},2637:(e,t,r)=>{var n=r(8034),o=Object.prototype.hasOwnProperty;e.exports=function(e){var t=this.__data__;return n?void 0!==t[e]:o.call(t,e)}},1077:(e,t,r)=>{var n=r(8034);e.exports=function(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=n&&void 0===t?"__lodash_hash_undefined__":t,this}},509:e=>{var t=Object.prototype.hasOwnProperty;e.exports=function(e){var r=e.length,n=new e.constructor(r);return r&&"string"==typeof e[0]&&t.call(e,"index")&&(n.index=e.index,n.input=e.input),n}},1343:(e,t,r)=>{var n=r(7749),o=r(3081),i=r(6945),a=r(6952),s=r(7961);e.exports=function(e,t,r){var l=e.constructor;switch(t){case"[object ArrayBuffer]":return n(e);case"[object Boolean]":case"[object Date]":return new l(+e);case"[object DataView]":return o(e,r);case"[object Float32Array]":case"[object Float64Array]":case"[object Int8Array]":case"[object Int16Array]":case"[object Int32Array]":case"[object Uint8Array]":case"[object Uint8ClampedArray]":case"[object Uint16Array]":case"[object Uint32Array]":return s(e,r);case"[object Map]":case"[object Set]":return new l;case"[object Number]":case"[object String]":return new l(e);case"[object RegExp]":return i(e);case"[object Symbol]":return a(e)}}},1225:(e,t,r)=>{var n=r(3088),o=r(6607),i=r(5735);e.exports=function(e){return"function"!=typeof e.constructor||i(e)?{}:n(o(e))}},5043:(e,t,r)=>{var n=r(2609),o=r(5196),i=r(4913),a=n?n.isConcatSpreadable:void 0;e.exports=function(e){return i(e)||o(e)||!!(a&&e&&e[a])}},6665:e=>{var t=/^(?:0|[1-9]\d*)$/;e.exports=function(e,r){var n=typeof e;return!!(r=null==r?9007199254740991:r)&&("number"==n||"symbol"!=n&&t.test(e))&&e>-1&&e%1==0&&e<r}},3632:(e,t,r)=>{var n=r(6424),o=r(7134),i=r(6665),a=r(9834);e.exports=function(e,t,r){if(!a(r))return!1;var s=typeof t;return!!("number"==s?o(r)&&i(t,r.length):"string"==s&&t in r)&&n(r[t],e)}},6394:(e,t,r)=>{var n=r(4913),o=r(7386),i=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;e.exports=function(e,t){if(n(e))return!1;var r=typeof e;return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=e&&!o(e))||(a.test(e)||!i.test(e)||null!=t&&e in Object(t))}},9178:e=>{e.exports=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}},3248:(e,t,r)=>{var n,o=r(2489),i=(n=/[^.]+$/.exec(o&&o.keys&&o.keys.IE_PROTO||""))?"Symbol(src)_1."+n:"";e.exports=function(e){return!!i&&i in e}},5735:e=>{var t=Object.prototype;e.exports=function(e){var r=e&&e.constructor;return e===("function"==typeof r&&r.prototype||t)}},2308:(e,t,r)=>{var n=r(9834);e.exports=function(e){return e==e&&!n(e)}},7718:e=>{e.exports=function(){this.__data__=[],this.size=0}},4272:(e,t,r)=>{var n=r(3481),o=Array.prototype.splice;e.exports=function(e){var t=this.__data__,r=n(t,e);return!(r<0)&&(r==t.length-1?t.pop():o.call(t,r,1),--this.size,!0)}},5107:(e,t,r)=>{var n=r(3481);e.exports=function(e){var t=this.__data__,r=n(t,e);return r<0?void 0:t[r][1]}},1055:(e,t,r)=>{var n=r(3481);e.exports=function(e){return n(this.__data__,e)>-1}},4647:(e,t,r)=>{var n=r(3481);e.exports=function(e,t){var r=this.__data__,o=n(r,e);return o<0?(++this.size,r.push([e,t])):r[o][1]=t,this}},6400:(e,t,r)=>{var n=r(4845),o=r(1999),i=r(5455);e.exports=function(){this.size=0,this.__data__={hash:new n,map:new(i||o),string:new n}}},7014:(e,t,r)=>{var n=r(3707);e.exports=function(e){var t=n(this,e).delete(e);return this.size-=t?1:0,t}},1793:(e,t,r)=>{var n=r(3707);e.exports=function(e){return n(this,e).get(e)}},6429:(e,t,r)=>{var n=r(3707);e.exports=function(e){return n(this,e).has(e)}},821:(e,t,r)=>{var n=r(3707);e.exports=function(e,t){var r=n(this,e),o=r.size;return r.set(e,t),this.size+=r.size==o?0:1,this}},9885:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e,n){r[++t]=[n,e]})),r}},7405:e=>{e.exports=function(e,t){return function(r){return null!=r&&(r[e]===t&&(void 0!==t||e in Object(r)))}}},2848:(e,t,r)=>{var n=r(3272);e.exports=function(e){var t=n(e,(function(e){return 500===r.size&&r.clear(),e})),r=t.cache;return t}},8034:(e,t,r)=>{var n=r(2062)(Object,"create");e.exports=n},9458:(e,t,r)=>{var n=r(8303)(Object.keys,Object);e.exports=n},2693:e=>{e.exports=function(e){var t=[];if(null!=e)for(var r in Object(e))t.push(r);return t}},1977:(e,t,r)=>{e=r.nmd(e);var n=r(6392),o=t&&!t.nodeType&&t,i=o&&e&&!e.nodeType&&e,a=i&&i.exports===o&&n.process,s=function(){try{var e=i&&i.require&&i.require("util").types;return e||a&&a.binding&&a.binding("util")}catch(e){}}();e.exports=s},7222:e=>{var t=Object.prototype.toString;e.exports=function(e){return t.call(e)}},8303:e=>{e.exports=function(e,t){return function(r){return e(t(r))}}},709:(e,t,r)=>{var n=r(1929),o=Math.max;e.exports=function(e,t,r){return t=o(void 0===t?e.length-1:t,0),function(){for(var i=arguments,a=-1,s=o(i.length-t,0),l=Array(s);++a<s;)l[a]=i[t+a];a=-1;for(var u=Array(t+1);++a<t;)u[a]=i[a];return u[t]=r(l),n(e,this,u)}}},2473:(e,t,r)=>{var n=r(2718),o=r(312);e.exports=function(e,t){return t.length<2?e:n(e,o(t,0,-1))}},9965:(e,t,r)=>{var n=r(6392),o="object"==typeof self&&self&&self.Object===Object&&self,i=n||o||Function("return this")();e.exports=i},4302:e=>{e.exports=function(e,t){if(("constructor"!==t||"function"!=typeof e[t])&&"__proto__"!=t)return e[t]}},228:e=>{e.exports=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this}},3683:e=>{e.exports=function(e){return this.__data__.has(e)}},6295:e=>{e.exports=function(e){var t=-1,r=Array(e.size);return e.forEach((function(e){r[++t]=e})),r}},7281:(e,t,r)=>{var n=r(4450),o=r(435)(n);e.exports=o},435:e=>{var t=Date.now;e.exports=function(e){var r=0,n=0;return function(){var o=t(),i=16-(o-n);if(n=o,i>0){if(++r>=800)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}},5052:(e,t,r)=>{var n=r(1999);e.exports=function(){this.__data__=new n,this.size=0}},4250:e=>{e.exports=function(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}},4773:e=>{e.exports=function(e){return this.__data__.get(e)}},6921:e=>{e.exports=function(e){return this.__data__.has(e)}},5745:(e,t,r)=>{var n=r(1999),o=r(5455),i=r(1549);e.exports=function(e,t){var r=this.__data__;if(r instanceof n){var a=r.__data__;if(!o||a.length<199)return a.push([e,t]),this.size=++r.size,this;r=this.__data__=new i(a)}return r.set(e,t),this.size=r.size,this}},5951:e=>{e.exports=function(e,t,r){for(var n=r-1,o=e.length;++n<o;)if(e[n]===t)return n;return-1}},266:(e,t,r)=>{var n=r(2848),o=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,i=/\\(\\)?/g,a=n((function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(o,(function(e,r,n,o){t.push(n?o.replace(i,"$1"):r||e)})),t}));e.exports=a},8197:(e,t,r)=>{var n=r(7386);e.exports=function(e){if("string"==typeof e||n(e))return e;var t=e+"";return"0"==t&&1/e==-1/0?"-0":t}},3761:e=>{var t=Function.prototype.toString;e.exports=function(e){if(null!=e){try{return t.call(e)}catch(e){}try{return e+""}catch(e){}}return""}},1272:e=>{var t=/\s/;e.exports=function(e){for(var r=e.length;r--&&t.test(e.charAt(r)););return r}},6534:e=>{e.exports=function(e){return function(){return e}}},9517:(e,t,r)=>{var n=r(9834),o=r(2220),i=r(3662),a=Math.max,s=Math.min;e.exports=function(e,t,r){var l,u,c,p,f,d,v=0,h=!1,g=!1,y=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function m(t){var r=l,n=u;return l=u=void 0,v=t,p=e.apply(n,r)}function O(e){var r=e-d;return void 0===d||r>=t||r<0||g&&e-v>=c}function b(){var e=o();if(O(e))return E(e);f=setTimeout(b,function(e){var r=t-(e-d);return g?s(r,c-(e-v)):r}(e))}function E(e){return f=void 0,y&&l?m(e):(l=u=void 0,p)}function S(){var e=o(),r=O(e);if(l=arguments,u=this,d=e,r){if(void 0===f)return function(e){return v=e,f=setTimeout(b,t),h?m(e):p}(d);if(g)return clearTimeout(f),f=setTimeout(b,t),m(d)}return void 0===f&&(f=setTimeout(b,t)),p}return t=i(t)||0,n(r)&&(h=!!r.leading,c=(g="maxWait"in r)?a(i(r.maxWait)||0,t):c,y="trailing"in r?!!r.trailing:y),S.cancel=function(){void 0!==f&&clearTimeout(f),v=0,l=d=u=f=void 0},S.flush=function(){return void 0===f?p:E(o())},S}},6424:e=>{e.exports=function(e,t){return e===t||e!=e&&t!=t}},8472:(e,t,r)=>{var n=r(3158),o=/[\\^$.*+?()[\]{}|]/g,i=RegExp(o.source);e.exports=function(e){return(e=n(e))&&i.test(e)?e.replace(o,"\\$&"):e}},9234:(e,t,r)=>{var n=r(1360);e.exports=function(e){return(null==e?0:e.length)?n(e,1):[]}},5612:(e,t,r)=>{var n=r(2718);e.exports=function(e,t,r){var o=null==e?void 0:n(e,t);return void 0===o?r:o}},4055:(e,t,r)=>{var n=r(3613),o=r(1518);e.exports=function(e,t){return null!=e&&o(e,t,n)}},912:e=>{e.exports=function(e){return e}},1283:(e,t,r)=>{var n=r(9555),o=r(7134),i=r(8951),a=r(5729),s=r(1624),l=Math.max;e.exports=function(e,t,r,u){e=o(e)?e:s(e),r=r&&!u?a(r):0;var c=e.length;return r<0&&(r=l(c+r,0)),i(e)?r<=c&&e.indexOf(t,r)>-1:!!c&&n(e,t,r)>-1}},5196:(e,t,r)=>{var n=r(3070),o=r(9466),i=Object.prototype,a=i.hasOwnProperty,s=i.propertyIsEnumerable,l=n(function(){return arguments}())?n:function(e){return o(e)&&a.call(e,"callee")&&!s.call(e,"callee")};e.exports=l},4913:e=>{var t=Array.isArray;e.exports=t},7134:(e,t,r)=>{var n=r(1866),o=r(582);e.exports=function(e){return null!=e&&o(e.length)&&!n(e)}},7965:(e,t,r)=>{var n=r(7134),o=r(9466);e.exports=function(e){return o(e)&&n(e)}},4264:(e,t,r)=>{e=r.nmd(e);var n=r(9965),o=r(9375),i=t&&!t.nodeType&&t,a=i&&e&&!e.nodeType&&e,s=a&&a.exports===i?n.Buffer:void 0,l=(s?s.isBuffer:void 0)||o;e.exports=l},7969:(e,t,r)=>{var n=r(6504),o=r(6053),i=r(5196),a=r(4913),s=r(7134),l=r(4264),u=r(5735),c=r(5087),p=Object.prototype.hasOwnProperty;e.exports=function(e){if(null==e)return!0;if(s(e)&&(a(e)||"string"==typeof e||"function"==typeof e.splice||l(e)||c(e)||i(e)))return!e.length;var t=o(e);if("[object Map]"==t||"[object Set]"==t)return!e.size;if(u(e))return!n(e).length;for(var r in e)if(p.call(e,r))return!1;return!0}},1866:(e,t,r)=>{var n=r(9048),o=r(9834);e.exports=function(e){if(!o(e))return!1;var t=n(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},582:e=>{e.exports=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}},146:(e,t,r)=>{var n=r(2052),o=r(277),i=r(1977),a=i&&i.isMap,s=a?o(a):n;e.exports=s},9834:e=>{e.exports=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},9466:e=>{e.exports=function(e){return null!=e&&"object"==typeof e}},5219:(e,t,r)=>{var n=r(9048),o=r(6607),i=r(9466),a=Function.prototype,s=Object.prototype,l=a.toString,u=s.hasOwnProperty,c=l.call(Object);e.exports=function(e){if(!i(e)||"[object Object]"!=n(e))return!1;var t=o(e);if(null===t)return!0;var r=u.call(t,"constructor")&&t.constructor;return"function"==typeof r&&r instanceof r&&l.call(r)==c}},8696:(e,t,r)=>{var n=r(5206),o=r(277),i=r(1977),a=i&&i.isSet,s=a?o(a):n;e.exports=s},8951:(e,t,r)=>{var n=r(9048),o=r(4913),i=r(9466);e.exports=function(e){return"string"==typeof e||!o(e)&&i(e)&&"[object String]"==n(e)}},7386:(e,t,r)=>{var n=r(9048),o=r(9466);e.exports=function(e){return"symbol"==typeof e||o(e)&&"[object Symbol]"==n(e)}},5087:(e,t,r)=>{var n=r(9653),o=r(277),i=r(1977),a=i&&i.isTypedArray,s=a?o(a):n;e.exports=s},3790:(e,t,r)=>{var n=r(6791),o=r(6504),i=r(7134);e.exports=function(e){return i(e)?n(e):o(e)}},5961:(e,t,r)=>{var n=r(6791),o=r(9399),i=r(7134);e.exports=function(e){return i(e)?n(e,!0):o(e)}},8906:e=>{e.exports=function(e){var t=null==e?0:e.length;return t?e[t-1]:void 0}},1612:(e,t,r)=>{var n=r(2464),o=r(5473),i=r(3245);e.exports=function(e,t){var r={};return t=i(t,3),o(e,(function(e,o,i){n(r,o,t(e,o,i))})),r}},3272:(e,t,r)=>{var n=r(1549);function o(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw new TypeError("Expected a function");var r=function(){var n=arguments,o=t?t.apply(this,n):n[0],i=r.cache;if(i.has(o))return i.get(o);var a=e.apply(this,n);return r.cache=i.set(o,a)||i,a};return r.cache=new(o.Cache||n),r}o.Cache=n,e.exports=o},4308:(e,t,r)=>{var n=r(9058),o=r(9511)((function(e,t,r){n(e,t,r)}));e.exports=o},2815:(e,t,r)=>{var n=r(9058),o=r(9511)((function(e,t,r,o){n(e,t,r,o)}));e.exports=o},2220:(e,t,r)=>{var n=r(9965);e.exports=function(){return n.Date.now()}},7027:(e,t,r)=>{var n=r(1428),o=r(6575),i=r(6744),a=r(2361),s=r(4735),l=r(2050),u=r(8496),c=r(869),p=u((function(e,t){var r={};if(null==e)return r;var u=!1;t=n(t,(function(t){return t=a(t,e),u||(u=t.length>1),t})),s(e,c(e),r),u&&(r=o(r,7,l));for(var p=t.length;p--;)i(r,t[p]);return r}));e.exports=p},8831:(e,t,r)=>{var n=r(1),o=r(8496)((function(e,t){return null==e?{}:n(e,t)}));e.exports=o},350:(e,t,r)=>{var n=r(1428),o=r(3245),i=r(9916),a=r(869);e.exports=function(e,t){if(null==e)return{};var r=n(a(e),(function(e){return[e]}));return t=o(t),i(e,r,(function(e,r){return t(e,r[0])}))}},6711:(e,t,r)=>{var n=r(645),o=r(5319),i=r(6394),a=r(8197);e.exports=function(e){return i(e)?n(a(e)):o(e)}},2285:(e,t,r)=>{var n=r(8580)();e.exports=n},9901:(e,t,r)=>{var n=r(3840),o=r(3632),i=r(5729),a=r(3158);e.exports=function(e,t,r){return t=(r?o(e,t,r):void 0===t)?1:i(t),n(a(e),t)}},3547:(e,t,r)=>{var n=r(5725),o=r(9764),i=r(5729),a=r(3158);e.exports=function(e,t,r){return e=a(e),r=null==r?0:n(i(r),0,e.length),t=o(t),e.slice(r,r+t.length)==t}},8721:e=>{e.exports=function(){return[]}},9375:e=>{e.exports=function(){return!1}},1144:(e,t,r)=>{var n=r(3662),o=1/0;e.exports=function(e){return e?(e=n(e))===o||e===-1/0?17976931348623157e292*(e<0?-1:1):e==e?e:0:0===e?e:0}},5729:(e,t,r)=>{var n=r(1144);e.exports=function(e){var t=n(e),r=t%1;return t==t?r?t-r:t:0}},3662:(e,t,r)=>{var n=r(7248),o=r(9834),i=r(7386),a=/^[-+]0x[0-9a-f]+$/i,s=/^0b[01]+$/i,l=/^0o[0-7]+$/i,u=parseInt;e.exports=function(e){if("number"==typeof e)return e;if(i(e))return NaN;if(o(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=o(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=n(e);var r=s.test(e);return r||l.test(e)?u(e.slice(2),r?2:8):a.test(e)?NaN:+e}},5148:(e,t,r)=>{var n=r(4735),o=r(5961);e.exports=function(e){return n(e,o(e))}},3158:(e,t,r)=>{var n=r(9764);e.exports=function(e){return null==e?"":n(e)}},1624:(e,t,r)=>{var n=r(1282),o=r(3790);e.exports=function(e){return null==e?[]:n(e,o(e))}},4790:(e,t,r)=>{"use strict";var n=r(4621);function o(){}function i(){}i.resetWarningCache=o,e.exports=function(){function e(e,t,r,o,i,a){if(a!==n){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:i,resetWarningCache:o};return r.PropTypes=r,r}},7028:(e,t,r)=>{e.exports=r(4790)()},4621:e=>{"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},8044:(e,t,r)=>{"use strict";var n=r(5959),o=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,r){var n,i={},u=null,c=null;for(n in void 0!==r&&(u=""+r),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)a.call(t,n)&&!l.hasOwnProperty(n)&&(i[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps)void 0===i[n]&&(i[n]=t[n]);return{$$typeof:o,type:e,key:u,ref:c,props:i,_owner:s.current}}t.Fragment=i,t.jsx=u,t.jsxs=u},9728:(e,t,r)=>{"use strict";e.exports=r(8044)},138:function(e){var t;t=function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{configurable:!1,enumerable:!0,get:n})},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=3)}([function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpelNode={create:function(e,t){var r,n={},o=e||"Abstract",i=[],a=null;if(n._type=o,n.getType=function(){return o},n.setType=function(e){o=e},n.getChildren=function(){return i},n.addChild=function(e){if(e){if(!e.setParent)throw{name:"Error",message:"Trying to add a child which is not a node: "+JSON.stringify(e)};e.setParent(n),i.push(e)}},n.getParent=function(){return a},n.setParent=function(e){a=e},n.getContext=function(e){return r||e.activeContext.peek()},n.setContext=function(e){r=e},n.getStartPosition=function(){return t>>16},n.getEndPosition=function(){return 65535&t},n.getValue=function(){throw{name:"MethodNotImplementedException",message:"SpelNode#getValue() must be overridden."}},n.toString=function(){var e="Kind: "+n.getType();e+=", Children: [";for(var t=0,r=n.getChildren().length;t<r;t+=1)e+="{"+n.getChildren()[t]+"}, ";return e+="]"},0===t)throw{name:"Error",message:"Position cannot be 0"};for(var s=arguments.length,l=Array(s>2?s-2:0),u=2;u<s;u++)l[u-2]=arguments[u];return l&&l.forEach((function(e){n.addChild(e)})),n}}},function(e,t,r){"use strict";function n(e){this.elements=e||[]}Object.defineProperty(t,"__esModule",{value:!0}),t.Stack=n,n.prototype.push=function(e){return this.elements.push(e),e},n.prototype.pop=function(){return this.elements.pop()},n.prototype.peek=function(){return this.elements[this.elements.length-1]},n.prototype.empty=function(){return this.elements.length>0},n.prototype.search=function(e){return this.elements.length-this.elements.indexOf(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={LITERAL_INT:1,LITERAL_LONG:2,LITERAL_HEXINT:3,LITERAL_HEXLONG:4,LITERAL_STRING:5,LITERAL_REAL:6,LITERAL_REAL_FLOAT:7,LPAREN:"(",RPAREN:")",COMMA:",",IDENTIFIER:0,COLON:":",HASH:"#",RSQUARE:"]",LSQUARE:"[",LCURLY:"{",RCURLY:"}",DOT:".",PLUS:"+",STAR:"*",MINUS:"-",SELECT_FIRST:"^[",SELECT_LAST:"$[",QMARK:"?",PROJECT:"![",DIV:"/",GE:">=",GT:">",LE:"<=",LT:"<",EQ:"==",NE:"!=",MOD:"%",NOT:"!",ASSIGN:"=",INSTANCEOF:"instanceof",MATCHES:"matches",BETWEEN:"between",SELECT:"?[",POWER:"^",ELVIS:"?:",SAFE_NAVI:"?.",BEAN_REF:"@",SYMBOLIC_OR:"||",SYMBOLIC_AND:"&&",INC:"++",DEC:"--"};function o(e){this.type=e,this.tokenChars=n[e],this._hasPayload="string"!=typeof n[e],"number"==typeof n[e]&&(this._ordinal=n[e])}for(var i in n)n.hasOwnProperty(i)&&(o[i]=new o(i));o.prototype.toString=function(){return this.type+(0!==this.tokenChars.length?"("+this.tokenChars+")":"")},o.prototype.getLength=function(){return this.tokenChars.length},o.prototype.hasPayload=function(){return this._hasPayload},o.prototype.valueOf=function(e){for(var t in n)if(n.hasOwnProperty(t)&&n[t]===e)return o[t]},o.prototype.ordinal=function(){return this._ordinal},t.TokenKind=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardContext=t.SpelExpressionEvaluator=void 0;var n=r(4),o=r(50);t.SpelExpressionEvaluator=n.SpelExpressionEvaluator,t.StandardContext=o.StandardContext},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpelExpressionEvaluator=void 0;var n=r(5),o=r(1),i={compile:function(e){var t=(0,n.SpelExpressionParser)().parse(e);return{eval:function(e,r){return function(e,t,r){var n,i=new o.Stack;return t||(t={}),i.push(t),n={rootContext:t,activeContext:i,locals:r},e.getValue(n)}(t,e,r)},_compiledExpression:t}},eval:function(e,t,r){return i.compile(e).eval(t,r)}};t.SpelExpressionEvaluator=i},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SpelExpressionParser=void 0;var n=r(2),o=r(6),i=r(8),a=r(9),s=r(10),l=r(11),u=r(12),c=r(13),p=r(14),f=r(15),d=r(16),v=r(17),h=r(18),g=r(19),y=r(20),m=r(21),O=r(22),b=r(23),E=r(24),S=r(25),_=r(26),T=r(27),R=r(28),w=r(29),I=r(30),L=r(31),C=r(32),A=r(33),x=r(34),N=r(35),j=r(36),F=r(37),P=r(38),k=r(39),D=r(40),V=r(41),M=r(42),U=r(43),B=r(44),q=r(45),G=r(46),K=r(47),$=r(48),W=r(49);t.SpelExpressionParser=function(){var e,t,r,z,H=new RegExp("[\\p{L}\\p{N}_$]+"),Y=[];function J(){var e=X();if(Se()){var t=Te();if(t.getKind()===n.TokenKind.ASSIGN){null===e&&(e=l.NullLiteral.create(Ce(t.startPos-1,t.endPos-1))),_e();var r=X();return h.Assign.create(Le(t),e,r)}if(t.getKind()===n.TokenKind.ELVIS){null===e&&(e=l.NullLiteral.create(Ce(t.startPos-1,t.endPos-2))),_e();var o=J();return null===o&&(o=l.NullLiteral.create(Ce(t.startPos+1,t.endPos+1))),P.Elvis.create(Le(t),e,o)}if(t.getKind()===n.TokenKind.QMARK){null===e&&(e=l.NullLiteral.create(Ce(t.startPos-1,t.endPos-1))),_e();var i=J();ye(n.TokenKind.COLON);var a=J();return F.Ternary.create(Le(t),e,i,a)}}return e}function X(){for(var e=Q();Ee("or")||me(n.TokenKind.SYMBOLIC_OR);){var t=_e(),r=Q();we(t,e,r),e=N.OpOr.create(Le(t),e,r)}return e}function Q(){for(var e=Z();Ee("and")||me(n.TokenKind.SYMBOLIC_AND);){var t=_e(),r=Z();we(t,e,r),e=x.OpAnd.create(Le(t),e,r)}return e}function Z(){var e=ee(),t=function(){var e=Te();if(null===e)return null;if(e.isNumericRelationalOperator())return e;if(e.isIdentifier()){var t=e.stringValue();if("instanceof"===t.toLowerCase())return e.asInstanceOfToken();if("matches"===t.toLowerCase())return e.asMatchesToken();if("between"===t.toLowerCase())return e.asBetweenToken()}return null}();if(null!==t){var r=_e(),o=ee();we(r,e,o);var i=t.kind;if(t.isNumericRelationalOperator()){var a=Le(r);return i===n.TokenKind.GT?O.OpGT.create(a,e,o):i===n.TokenKind.LT?E.OpLT.create(a,e,o):i===n.TokenKind.LE?b.OpLE.create(a,e,o):i===n.TokenKind.GE?m.OpGE.create(a,e,o):i===n.TokenKind.EQ?g.OpEQ.create(a,e,o):y.OpNE.create(a,e,o)}return i===n.TokenKind.INSTANCEOF?U.OpInstanceof.create(Le(r),e,o):i===n.TokenKind.MATCHES?j.OpMatches.create(Le(r),e,o):B.OpBetween.create(Le(r),e,o)}return e}function ee(){for(var e=te();be(n.TokenKind.PLUS,n.TokenKind.MINUS,n.TokenKind.INC);){var t=_e(),r=te();Ie(t,r),t.getKind()===n.TokenKind.PLUS?e=S.OpPlus.create(Le(t),e,r):t.getKind()===n.TokenKind.MINUS&&(e=_.OpMinus.create(Le(t),e,r))}return e}function te(){for(var e=re();be(n.TokenKind.STAR,n.TokenKind.DIV,n.TokenKind.MOD);){var t=_e(),r=re();we(t,e,r),e=t.getKind()===n.TokenKind.STAR?T.OpMultiply.create(Le(t),e,r):t.getKind()===n.TokenKind.DIV?R.OpDivide.create(Le(t),e,r):w.OpModulus.create(Le(t),e,r)}return e}function re(){var e,t=ne();if(me(n.TokenKind.POWER)){e=_e();var r=ne();return Ie(e,r),I.OpPower.create(Le(e),t,r)}return null!==t&&be(n.TokenKind.INC,n.TokenKind.DEC)?(e=_e()).getKind()===n.TokenKind.INC?L.OpInc.create(Le(e),!0,t):C.OpDec.create(Le(e),!0,t):t}function ne(){var e,t;return be(n.TokenKind.PLUS,n.TokenKind.MINUS,n.TokenKind.NOT)?(e=_e(),t=ne(),e.getKind()===n.TokenKind.NOT?A.OpNot.create(Le(e),t):e.getKind()===n.TokenKind.PLUS?S.OpPlus.create(Le(e),t):_.OpMinus.create(Le(e),t)):be(n.TokenKind.INC,n.TokenKind.DEC)?(e=_e(),t=ne(),e.getKind()===n.TokenKind.INC?L.OpInc.create(Le(e),!1,t):C.OpDec.create(Le(e),!1,t)):function(){var e=[],t=function(){var e=Te();if(null===e)return!1;if(e.getKind()===n.TokenKind.LITERAL_INT||e.getKind()===n.TokenKind.LITERAL_LONG)he(a.NumberLiteral.create(parseInt(e.stringValue(),10),Le(e)));else if(e.getKind()===n.TokenKind.LITERAL_REAL||e.getKind()===n.TokenKind.LITERAL_REAL_FLOAT)he(a.NumberLiteral.create(parseFloat(e.stringValue()),Le(e)));else if(e.getKind()===n.TokenKind.LITERAL_HEXINT||e.getKind()===n.TokenKind.LITERAL_HEXLONG)he(a.NumberLiteral.create(parseInt(e.stringValue(),16),Le(e)));else if(Ee("true"))he(i.BooleanLiteral.create(!0,Le(e)));else if(Ee("false"))he(i.BooleanLiteral.create(!1,Le(e)));else{if(e.getKind()!==n.TokenKind.LITERAL_STRING)return!1;he(s.StringLiteral.create(e.stringValue(),Le(e)))}return _e(),!0}()||function(){if(me(n.TokenKind.LPAREN)){_e();var e=J();return ye(n.TokenKind.RPAREN),he(e),!0}return!1}()||function(){if(me(n.TokenKind.IDENTIFIER)){var e=Te();if("T"!==e.stringValue())return!1;var t=_e();if(me(n.TokenKind.RSQUARE))return he(p.PropertyReference.create(t.stringValue(),Le(t))),!0;ye(n.TokenKind.LPAREN);for(var r=fe(),o=0;Oe(n.TokenKind.LSQUARE,!0);)ye(n.TokenKind.RSQUARE),o++;return ye(n.TokenKind.RPAREN),he(q.TypeReference.create(Le(e),r,o)),!0}return!1}()||function(){if(me(n.TokenKind.IDENTIFIER)){var e=Te();return"null"===e.stringValue().toLowerCase()&&(_e(),he(l.NullLiteral.create(Le(e))),!0)}return!1}()||function(){if(Ee("new")){var e=_e();if(me(n.TokenKind.RSQUARE))return he(p.PropertyReference.create(e.stringValue(),Le(e))),!0;var t=fe(),r=[];if(r.push(t),me(n.TokenKind.LSQUARE)){for(var o=[];Oe(n.TokenKind.LSQUARE,!0);)me(n.TokenKind.RSQUARE)?o.push(null):o.push(J()),ye(n.TokenKind.RSQUARE);ue()&&r.push(ge()),he(W.ConstructorReference.create(Le(e),o,r))}else i=r,me(n.TokenKind.LPAREN)||Re(Le(Te()),"MISSING_CONSTRUCTOR_ARGS"),se(i),ye(n.TokenKind.RPAREN),he(W.ConstructorReference.create(Le(e),r));return!0}var i;return!1}()||ve(!1)||ie()||function(){if(me(n.TokenKind.BEAN_REF)){var e=_e(),t=null,r=null;return me(n.TokenKind.IDENTIFIER)?r=(t=ye(n.TokenKind.IDENTIFIER)).data:me(n.TokenKind.LITERAL_STRING)?r=(r=(t=ye(n.TokenKind.LITERAL_STRING)).stringValue()).substring(1,r.length()-1):Re(e.startPos,"INVALID_BEAN_REFERENCE"),he(G.BeanReference.create(Le(t),r)),!0}return!1}()||le(!1)||pe(!1)||ce()||ue()?ge():null;for(e.push(t);oe();)e.push(ge());return 1===e.length?e[0]:d.CompoundExpression.create(Ce(t.getStartPosition(),e[e.length-1].getEndPosition()),e)}()}function oe(){var e,t,r=null;return null!==(r=be(n.TokenKind.DOT,n.TokenKind.SAFE_NAVI)?(e=_e(),ve(t=e.getKind()===n.TokenKind.SAFE_NAVI)||ie()||le(t)||pe(t)?ge():(null===Te()?Re(e.startPos,"OOD"):Re(e.startPos,"UNEXPECTED_DATA_AFTER_DOT",function(e){return e.getKind().hasPayload()?e.stringValue():e.getKind().toString().toLowerCase()}(Te())),null)):me(n.TokenKind.LSQUARE)&&ce()?ge():null)&&(he(r),!0)}function ie(){if(!me(n.TokenKind.HASH))return!1;var e=_e(),t=ye(n.TokenKind.IDENTIFIER),r=ae();return null===r?(he(f.VariableReference.create(t.data,Ce(e.startPos,t.endPos))),!0):(he(u.FunctionReference.create(t.data,Ce(e.startPos,t.endPos),r)),!0)}function ae(){if(!me(n.TokenKind.LPAREN))return null;var e=[];return se(e),ye(n.TokenKind.RPAREN),e}function se(e){var t,r=Te().startPos;do{_e();var o=Te();null===o&&Re(r,"RUN_OUT_OF_ARGUMENTS"),o.getKind()!==n.TokenKind.RPAREN&&e.push(J()),t=Te()}while(null!==t&&t.kind===n.TokenKind.COMMA);null===t&&Re(r,"RUN_OUT_OF_ARGUMENTS")}function le(e){var t=Te();if(!Oe(n.TokenKind.PROJECT,!0))return!1;var r=J();return ye(n.TokenKind.RSQUARE),he(M.Projection.create(e,Le(t),r)),!0}function ue(){var e=Te(),t=[];if(!Oe(n.TokenKind.LCURLY,!0))return!1;var r=null,o=Te();if(Oe(n.TokenKind.RCURLY,!0))r=k.InlineList.create(Ce(e.startPos,o.endPos));else if(Oe(n.TokenKind.COLON,!0))o=ye(n.TokenKind.RCURLY),r=D.InlineMap.create(Ce(e.startPos,o.endPos));else{var i=J();if(me(n.TokenKind.RCURLY))t.push(i),o=ye(n.TokenKind.RCURLY),r=k.InlineList.create(Ce(e.startPos,o.endPos),t);else if(Oe(n.TokenKind.COMMA,!0)){t.push(i);do{t.push(J())}while(Oe(n.TokenKind.COMMA,!0));o=ye(n.TokenKind.RCURLY),r=k.InlineList.create(Le(e.startPos,o.endPos),t)}else if(Oe(n.TokenKind.COLON,!0)){var a=[];for(a.push(i),a.push(J());Oe(n.TokenKind.COMMA,!0);)a.push(J()),ye(n.TokenKind.COLON),a.push(J());o=ye(n.TokenKind.RCURLY),r=D.InlineMap.create(Ce(e.startPos,o.endPos),a)}else Re(e.startPos,"OOD")}return he(r),!0}function ce(){var e=Te();if(!Oe(n.TokenKind.LSQUARE,!0))return!1;var t=J();return ye(n.TokenKind.RSQUARE),he(v.Indexer.create(Le(e),t)),!0}function pe(e){var t=Te();if(!function(){if(!Se())return!1;var e=Te();return e.getKind()===n.TokenKind.SELECT||e.getKind()===n.TokenKind.SELECT_FIRST||e.getKind()===n.TokenKind.SELECT_LAST}())return!1;_e();var r=J();return null===r&&Re(Le(t),"MISSING_SELECTION_EXPRESSION"),ye(n.TokenKind.RSQUARE),t.getKind()===n.TokenKind.SELECT_FIRST?he(V.Selection.create(e,V.Selection.FIRST,Le(t),r)):t.getKind()===n.TokenKind.SELECT_LAST?he(V.Selection.create(e,V.Selection.LAST,Le(t),r)):he(V.Selection.create(e,V.Selection.ALL,Le(t),r)),!0}function fe(){for(var t=[],r=Te();de(r);)_e(),r.kind!==n.TokenKind.DOT&&t.push(K.Identifier.create(r.stringValue(),Le(r))),r=Te();t.length||(null===r&&Re(e.length(),"OOD"),Re(r.startPos,"NOT_EXPECTED_TOKEN","qualified ID",r.getKind().toString().toLowerCase()));var o=Ce(t[0].getStartPosition(),t[t.length-1].getEndPosition());return $.QualifiedIdentifier.create(o,t)}function de(e){if(null===e||e.kind===n.TokenKind.LITERAL_STRING)return!1;if(e.kind===n.TokenKind.DOT||e.kind===n.TokenKind.IDENTIFIER)return!0;var t=e.stringValue();return t&&t.length&&H.test(t)}function ve(e){if(me(n.TokenKind.IDENTIFIER)){var t=_e(),r=ae();return null===r?(he(p.PropertyReference.create(e,t.stringValue(),Le(t))),!0):(he(c.MethodReference.create(e,t.stringValue(),Le(t),r)),!0)}return!1}function he(e){Y.push(e)}function ge(){return Y.pop()}function ye(t){var r=_e();return null===r&&Re(e.length,"OOD"),r.getKind()!==t&&Re(r.startPos,"NOT_EXPECTED_TOKEN",t.toString().toLowerCase(),r.getKind().toString().toLowerCase()),r}function me(e){return Oe(e,!1)}function Oe(e,t){if(!Se())return!1;var r=Te();return r.getKind()===e?(t&&z++,!0):e===n.TokenKind.IDENTIFIER&&r.getKind().ordinal()>=n.TokenKind.DIV.ordinal()&&r.getKind().ordinal()<=n.TokenKind.NOT.ordinal()&&null!==r.data}function be(){if(!Se())return!1;for(var e=Te(),t=Array.prototype.slice.call(arguments),r=0,n=t.length;r<n;r+=1)if(e.getKind()===t[r])return!0;return!1}function Ee(e){if(!Se())return!1;var t=Te();return t.getKind()===n.TokenKind.IDENTIFIER&&t.stringValue().toLowerCase()===e.toLowerCase()}function Se(){return z<t.length}function _e(){return z>=r?null:t[z++]}function Te(){return z>=r?null:t[z]}function Re(t,r,n,o){throw n&&(r+="\nExpected: "+n),o&&(r+="\nActual: "+o),{name:"InternalParseException",message:"Error occurred while attempting to parse expression '"+e+"' at position "+t+". Message: "+r}}function we(e,t,r){!function(e,t){null===t&&Re(e.startPos,"LEFT_OPERAND_PROBLEM")}(e,t),Ie(e,r)}function Ie(e,t){null===t&&Re(e.startPos,"RIGHT_OPERAND_PROBLEM")}function Le(e){return(e.startPos<<16)+e.endPos}function Ce(e,t){return(e<<16)+t}return{setConfiguration:function(e){},parse:function(n,i){try{e=n,t=o.Tokenizer.tokenize(n),r=t.length,z=0,Y=[];var a=J();return Se()&&Re(Te().startPos,"MORE_INPUT",_e().toString()),a}catch(e){throw e.message}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Tokenizer=void 0;var n=r(7),o=r(2),i=["DIV","EQ","GE","GT","LE","LT","MOD","NE","NOT"],a=[];!function(){var e;for(e="0".charCodeAt(0);e<="9".charCodeAt(0);e+=1)a[e]|=3;for(e="A".charCodeAt(0);e<="F".charCodeAt(0);e+=1)a[e]|=2;for(e="a".charCodeAt(0);e<="f".charCodeAt(0);e+=1)a[e]|=2;for(e="A".charCodeAt(0);e<="Z".charCodeAt(0);e+=1)a[e]|=4;for(e="a".charCodeAt(0);e<="z".charCodeAt(0);e+=1)a[e]|=4}(),t.Tokenizer={tokenize:function(e){var t=e,r=e+"\0",s=r.length,l=0,u=[];function c(){for(var e,i=l,a=!1;!a;)if("'"===(e=r[l+=1])&&("'"===r[l+1]?l+=1:a=!0),0===e.charCodeAt(0))throw{name:"SpelParseException",message:"Non-terminating quoted string in expression ("+t+") at position "+l};l+=1,u.push(new n.Token(o.TokenKind.LITERAL_STRING,y(i,l),i,l))}function p(){for(var e,i=l,a=!1;!a;)if('"'===(e=r[l+=1])&&('"'===r[l+1]?l+=1:a=!0),0===e.charCodeAt(0))throw{name:"SpelParseException",message:"Non-terminating double-quoted string in expression ("+t+") at position "+l};l+=1,u.push(new n.Token(o.TokenKind.LITERAL_STRING,y(i,l),i,l))}function f(e){var n,o,i,a=!1,s=l,u=r[l+1];if(!e||"x"!==u&&"X"!==u){do{l+=1}while(T(r[l]));if("."===(u=r[l])){a=!0,n=l;do{l+=1}while(T(r[l]));if(l===n+1)return void v(y(s,l=n),!1,s,l)}if(o=l,E("L","l")){if(a)throw{name:"SpelParseException",message:"Real cannot be long in expression ("+t+") at position "+l};v(y(s,o),!0,s,o),l+=1}else if(function(e){return"e"===e||"E"===e}(r[l])){a=!0,function(e){return"+"===e||"-"===e}(r[l+=1])&&(l+=1);do{l+=1}while(T(r[l]));i=!1,S(r[l])?(i=!0,o=l+=1):_(r[l])&&(o=l+=1),g(y(s,l),i,s,l)}else i=!1,S(u=r[l])?(a=!0,i=!0,o=l+=1):_(u)&&(a=!0,o=l+=1),a?g(y(s,o),i,s,o):v(y(s,o),!1,s,o)}else{l+=1;do{l+=1}while(w(r[l]));E("L","l")?(h(y(s+2,l),!0,s,l),l+=1):h(y(s+2,l),!1,s,l)}}function d(){var e,t,a,s=l;do{l+=1}while(R(a=r[l])||T(a)||"_"===a||"$"===a);e=y(s,l),(l-s==2||l-s==3)&&(t=e.toUpperCase(),i.indexOf(t)>=0)?function(e,t,r){u.push(new n.Token(e,r,t,t+e.getLength()))}(o.TokenKind.valueOf(t),s,e):u.push(new n.Token(o.TokenKind.IDENTIFIER,e.replace("\0",""),s,l))}function v(e,t,r,i){t?u.push(new n.Token(o.TokenKind.LITERAL_LONG,e,r,i)):u.push(new n.Token(o.TokenKind.LITERAL_INT,e,r,i))}function h(e,r,i,a){if(0===e.length)throw r?{name:"SpelParseException",message:"Not a long in expression ("+t+") at position "+l}:{name:"SpelParseException",message:"Not an int in expression ("+t+") at position "+l};r?u.push(new n.Token(o.TokenKind.LITERAL_HEXLONG,e,i,a)):u.push(new n.Token(o.TokenKind.LITERAL_HEXINT,e,i,a))}function g(e,t,r,i){t?u.push(new n.Token(o.TokenKind.LITERAL_REAL_FLOAT,e,r,i)):u.push(new n.Token(o.TokenKind.LITERAL_REAL,e,r,i))}function y(e,t){return r.substring(e,t)}function m(e){return 2===e.tokenChars.length&&r[l]===e.tokenChars[0]&&r[l+1]===e.tokenChars[1]}function O(e){u.push(new n.Token(e,null,l,l+1)),l+=1}function b(e){u.push(new n.Token(e,null,l,l+2)),l+=2}function E(e,t){var n=r[l];return n===e||n===t}function S(e){return"f"===e||"F"===e}function _(e){return"d"===e||"D"===e}function T(e){return!(e.charCodeAt(0)>255||!(1&a[e.charCodeAt(0)]))}function R(e){return!(e.charCodeAt(0)>255||!(4&a[e.charCodeAt(0)]))}function w(e){return!(e.charCodeAt(0)>255||!(2&a[e.charCodeAt(0)]))}return function(){for(var e;l<s;)if(R(e=r[l]))d();else switch(e){case"+":m(o.TokenKind.INC)?b(o.TokenKind.INC):O(o.TokenKind.PLUS);break;case"_":d();break;case"-":m(o.TokenKind.DEC)?b(o.TokenKind.DEC):O(o.TokenKind.MINUS);break;case":":O(o.TokenKind.COLON);break;case".":O(o.TokenKind.DOT);break;case",":O(o.TokenKind.COMMA);break;case"*":O(o.TokenKind.STAR);break;case"/":O(o.TokenKind.DIV);break;case"%":O(o.TokenKind.MOD);break;case"(":O(o.TokenKind.LPAREN);break;case")":O(o.TokenKind.RPAREN);break;case"[":O(o.TokenKind.LSQUARE);break;case"#":O(o.TokenKind.HASH);break;case"]":O(o.TokenKind.RSQUARE);break;case"{":O(o.TokenKind.LCURLY);break;case"}":O(o.TokenKind.RCURLY);break;case"@":O(o.TokenKind.BEAN_REF);break;case"^":m(o.TokenKind.SELECT_FIRST)?b(o.TokenKind.SELECT_FIRST):O(o.TokenKind.POWER);break;case"!":m(o.TokenKind.NE)?b(o.TokenKind.NE):m(o.TokenKind.PROJECT)?b(o.TokenKind.PROJECT):O(o.TokenKind.NOT);break;case"=":m(o.TokenKind.EQ)?b(o.TokenKind.EQ):O(o.TokenKind.ASSIGN);break;case"&":if(!m(o.TokenKind.SYMBOLIC_AND))throw{name:"SpelParseException",message:"Missing character '&' in expression ("+t+") at position "+l};b(o.TokenKind.SYMBOLIC_AND);break;case"|":if(!m(o.TokenKind.SYMBOLIC_OR))throw{name:"SpelParseException",message:"Missing character '|' in expression ("+t+") at position "+l};b(o.TokenKind.SYMBOLIC_OR);break;case"?":m(o.TokenKind.SELECT)?b(o.TokenKind.SELECT):m(o.TokenKind.ELVIS)?b(o.TokenKind.ELVIS):m(o.TokenKind.SAFE_NAVI)?b(o.TokenKind.SAFE_NAVI):O(o.TokenKind.QMARK);break;case"$":m(o.TokenKind.SELECT_LAST)?b(o.TokenKind.SELECT_LAST):d();break;case">":m(o.TokenKind.GE)?b(o.TokenKind.GE):O(o.TokenKind.GT);break;case"<":m(o.TokenKind.LE)?b(o.TokenKind.LE):O(o.TokenKind.LT);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":f("0"===e);break;case" ":case"\t":case"\r":case"\n":case"\0":l+=1;break;case"'":c();break;case'"':p();break;case"\\":throw{name:"SpelParseException",message:"Unexpected escape character in expression ("+t+") at position "+l};default:throw{name:"SpelParseException",message:"Cannot handle character '"+e+"' in expression ("+t+") at position "+l}}}(),u}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Token=void 0;var n=r(2);function o(e,t,r,n){this.kind=e,this.startPos=r,this.endPos=n,t&&(this.data=t)}o.prototype.getKind=function(){return this.kind},o.prototype.toString=function(){var e="[";return e+=this.kind.toString(),this.kind.hasPayload()&&(e+=":"+this.data),e+="]",e+="("+this.startPos+","+this.endPos+")"},o.prototype.isIdentifier=function(){return this.kind===n.TokenKind.IDENTIFIER},o.prototype.isNumericRelationalOperator=function(){return this.kind===n.TokenKind.GT||this.kind===n.TokenKind.GE||this.kind===n.TokenKind.LT||this.kind===n.TokenKind.LE||this.kind===n.TokenKind.EQ||this.kind===n.TokenKind.NE},o.prototype.stringValue=function(){return this.data},o.prototype.asInstanceOfToken=function(){return new o(n.TokenKind.INSTANCEOF,this.startPos,this.endPos)},o.prototype.asMatchesToken=function(){return new o(n.TokenKind.MATCHES,this.startPos,this.endPos)},o.prototype.asBetweenToken=function(){return new o(n.TokenKind.BETWEEN,this.startPos,this.endPos)},o.prototype.getStartPosition=function(){return this.startPos},o.prototype.getEndPosition=function(){return this.endPos},t.Token=o},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BooleanLiteral=void 0;var n=r(0);t.BooleanLiteral={create:function(e,t){var r=n.SpelNode.create("boolean",t);return r.getValue=function(){return e},r.setValue=function(t){return e=t},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NumberLiteral=void 0;var n=r(0);t.NumberLiteral={create:function(e,t){var r=n.SpelNode.create("number",t);return r.getValue=function(){return e},r.setValue=function(t){return e=t},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StringLiteral=void 0;var n=r(0);t.StringLiteral={create:function(e,t){var r=n.SpelNode.create("string",t);return e=function(e){return("'"===e[0]&&"'"===e[e.length-1]||'"'===e[0]&&'"'===e[e.length-1])&&(e=e.substring(1,e.length-1)),e.replace(/''/g,"'").replace(/""/g,'"')}(e),r.getValue=function(){return e},r.setValue=function(t){return e=t},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NullLiteral=void 0;var n=r(0);t.NullLiteral={create:function(e,t){var r=n.SpelNode.create("null",t);return r.getValue=function(){return null},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FunctionReference=void 0;var n=r(0),o=r(1);t.FunctionReference={create:function(e,t,r){var i=n.SpelNode.create("function",t);return i.getRaw=function(){return{functionName:e,args:r}},i.getValue=function(t){var n=t.locals||{},i=t.rootContext,a=[];if(r.forEach((function(e){var r=t.activeContext;t.activeContext=new o.Stack,t.activeContext.push(t.rootContext),a.push(e.getValue(t)),t.activeContext=r})),n[e])return n[e].apply(i,a);throw{name:"FunctionDoesNotExistException",message:"Function '"+e+"' does not exist."}},i}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MethodReference=void 0;var n=r(0),o=r(1);t.MethodReference={create:function(e,t,r,i){var a=n.SpelNode.create("method",r);return a.getRaw=function(){return{methodName:t,args:i}},a.getValue=function(r){var n,a=r.activeContext.peek(),s=[];if(!a)throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+t+"' for an undefined context."};function l(r){if(null==r){if(e)return null;throw{name:"NullPointerException",message:"Method "+t+" does not exist."}}return r}if(i.forEach((function(e){var t=r.activeContext;r.activeContext=new o.Stack,r.activeContext.push(r.rootContext),s.push(e.getValue(r)),r.activeContext=t})),"get"===t.substr(0,3)&&!a[t])return l(a[t.charAt(3).toLowerCase()+t.substring(4)]);if("set"===t.substr(0,3)&&!a[t])return a[t.charAt(3).toLowerCase()+t.substring(4)]=s[0];if(Array.isArray(a)){if("size"===t)return a.length;if("contains"===t)return a.includes(s[0])}return(n=l(a[t]))?n.apply(a,s):null},a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropertyReference=void 0;var n=r(0);t.PropertyReference={create:function(e,t,r){var o=n.SpelNode.create("property",r);return o.getRaw=function(){return t},o.getValue=function(r){var n=r.activeContext.peek();if(!n){if(e)return null;throw{name:"ContextDoesNotExistException",message:"Attempting to look up property '"+t+"' for an undefined context."}}if(void 0===n[t]||null===n[t]){if(e)return null;if("size"===t&&Array.isArray(n))return n.length;throw{name:"NullPointerException",message:"Property '"+t+"' does not exist."}}return n[t]},o.setValue=function(e,r){var n=r.activeContext.peek();if(!n)throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+t+"' for an undefined context."};return n[t]=e},o.getName=function(){return t},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.VariableReference=void 0;var n=r(0);t.VariableReference={create:function(e,t){var r=n.SpelNode.create("variable",t);return r.getRaw=function(){return e},r.getValue=function(t){var r=t.activeContext.peek(),n=t.locals;if(!r)throw{name:"ContextDoesNotExistException",message:"Attempting to look up variable '"+e+"' for an undefined context."};return"this"===e?r:"root"===e?t.rootContext:n[e]},r.setValue=function(t,r){return r.locals[e]=t},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CompoundExpression=void 0;var n=r(0);t.CompoundExpression={create:function(e,t){var r=n.SpelNode.create.apply(null,["compound",e].concat(t));function o(e){var t,n=r.getChildren().length;for(t=0;t<n;t+=1)"indexer"===r.getChildren()[t].getType()?e.activeContext.push(e.activeContext.peek()[r.getChildren()[t].getValue(e)]):e.activeContext.push(r.getChildren()[t].getValue(e));return function(){for(t=0;t<n;t+=1)e.activeContext.pop()}}return r.getValue=function(e){var t;if(!e.activeContext.peek())throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};var r=o(e);return t=e.activeContext.peek(),r(),t},r.setValue=function(e,t){var n=o(t),i=r.getChildren().length;return t.activeContext.pop(),e=r.getChildren()[i-1].setValue(e,t),t.activeContext.push(null),n(),e},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Indexer=void 0;var n=r(0),o=r(1);t.Indexer={create:function(e,t){var r=n.SpelNode.create.apply(null,["indexer",e].concat(t));return r.getValue=function(e){var t,n,i=e.activeContext,a=r.getChildren().length;if(e.activeContext=new o.Stack,e.activeContext.push(e.rootContext),!e.activeContext.peek())throw{name:"ContextDoesNotExistException",message:"Attempting to evaluate compound expression with an undefined context."};for(t=0;t<a;t+=1)e.activeContext.push(r.getChildren()[t].getValue(e));for(n=e.activeContext.peek(),t=0;t<a;t+=1)e.activeContext.pop();return e.activeContext=i,n},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Assign=void 0;var n=r(0);t.Assign={create:function(e,t,r){var o=n.SpelNode.create("assign",e,t,r);return o.getValue=function(e){if(!e.activeContext.peek())throw{name:"ContextDoesNotExistException",message:"Attempting to assign property '"+t.getValue(e)+"' for an undefined context."};return t.setValue(r.getValue(e),e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpEQ=void 0;var n=r(0);t.OpEQ={create:function(e,t,r){var o=n.SpelNode.create("op-eq",e,t,r);return o.getValue=function(e){return t.getValue(e)===r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpNE=void 0;var n=r(0);t.OpNE={create:function(e,t,r){var o=n.SpelNode.create("op-ne",e,t,r);return o.getValue=function(e){return t.getValue(e)!==r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpGE=void 0;var n=r(0);t.OpGE={create:function(e,t,r){var o=n.SpelNode.create("op-ge",e,t,r);return o.getValue=function(e){return t.getValue(e)>=r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpGT=void 0;var n=r(0);t.OpGT={create:function(e,t,r){var o=n.SpelNode.create("op-gt",e,t,r);return o.getValue=function(e){return t.getValue(e)>r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpLE=void 0;var n=r(0);t.OpLE={create:function(e,t,r){var o=n.SpelNode.create("op-le",e,t,r);return o.getValue=function(e){return t.getValue(e)<=r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpLT=void 0;var n=r(0);t.OpLT={create:function(e,t,r){var o=n.SpelNode.create("op-lt",e,t,r);return o.getValue=function(e){return t.getValue(e)<r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpPlus=void 0;var n=r(0);t.OpPlus={create:function(e,t,r){var o=n.SpelNode.create("op-plus",e,t,r);return o.getValue=function(e){return r?t.getValue(e)+r.getValue(e):+t.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpMinus=void 0;var n=r(0);t.OpMinus={create:function(e,t,r){var o=n.SpelNode.create("op-minus",e,t,r);return o.getValue=function(e){return r?t.getValue(e)-r.getValue(e):-t.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpMultiply=void 0;var n=r(0);t.OpMultiply={create:function(e,t,r){var o=n.SpelNode.create("op-multiply",e,t,r);return o.getValue=function(e){var n=t.getValue(e),o=r.getValue(e);if("number"==typeof n&&"number"==typeof o)return n*o;if("string"==typeof n&&"number"==typeof o){for(var i="",a=0;a<o;a+=1)i+=n;return i}return null},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpDivide=void 0;var n=r(0);t.OpDivide={create:function(e,t,r){var o=n.SpelNode.create("op-divide",e,t,r);return o.getValue=function(e){return t.getValue(e)/r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpModulus=void 0;var n=r(0);t.OpModulus={create:function(e,t,r){var o=n.SpelNode.create("op-modulus",e,t,r);return o.getValue=function(e){return t.getValue(e)%r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpPower=void 0;var n=r(0);t.OpPower={create:function(e,t,r){var o=n.SpelNode.create("op-power",e,t,r);return o.getValue=function(e){return Math.pow(t.getValue(e),r.getValue(e))},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpInc=void 0;var n=r(0);t.OpInc={create:function(e,t,r){var o=n.SpelNode.create("op-inc",e,r);return o.getValue=function(e){var n=r.getValue(e);return r.setValue(n+1,e),t?n:n+1},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpDec=void 0;var n=r(0);t.OpDec={create:function(e,t,r){var o=n.SpelNode.create("op-dec",e,r);return o.getValue=function(e){var n=r.getValue(e);return r.setValue(n-1,e),t?n:n-1},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpNot=void 0;var n=r(0);t.OpNot={create:function(e,t){var r=n.SpelNode.create("op-not",e,t);return r.getValue=function(e){return!t.getValue(e)},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpAnd=void 0;var n=r(0);t.OpAnd={create:function(e,t,r){var o=n.SpelNode.create("op-and",e,t,r);return o.getValue=function(e){return!!t.getValue(e)&&!!r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpOr=void 0;var n=r(0);t.OpOr={create:function(e,t,r){var o=n.SpelNode.create("op-or",e,t,r);return o.getValue=function(e){return!!t.getValue(e)||!!r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpMatches=void 0;var n=r(0);t.OpMatches={create:function(e,t,r){var o=n.SpelNode.create("matches",e,t,r);return o.getValue=function(e){var n=t.getValue(e),o=r.getValue(e);try{return!!new RegExp(o).exec(n)}catch(e){throw{name:"EvaluationException",message:e.toString()}}},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Ternary=void 0;var n=r(0);t.Ternary={create:function(e,t,r,o){var i=n.SpelNode.create("ternary",e,t,r,o);return i.getValue=function(e){return t.getValue(e)?r.getValue(e):o.getValue(e)},i}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Elvis=void 0;var n=r(0);t.Elvis={create:function(e,t,r){var o=n.SpelNode.create("elvis",e,t,r);return o.getValue=function(e){return null!==t.getValue(e)?t.getValue(e):r.getValue(e)},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineList=void 0;var n=r(0);t.InlineList={create:function(e,t){var r=n.SpelNode.create("list",e),o=[].concat(t||[]);return r.getRaw=function(){return o},r.getValue=function(e){return o.map((function(t){return t.getValue(e)}))},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.InlineMap=void 0;var n=r(0);t.InlineMap={create:function(e,t){var r=n.SpelNode.create("map",e),o=[].concat(t||[]);return r.getValue=function(e){var t=!0,r=null,n={};return o.forEach((function(o){t?r="property"===o.getType()?o.getName():o.getValue(e):n[r]=o.getValue(e),t=!t})),n},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Selection=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(0);function i(e,t,r){var n;return r.activeContext.push(e),n=t.getValue(r),r.activeContext.pop(),n}t.Selection={create:function(e,t,r,a){var s=o.SpelNode.create("selection",r,a);return s.getValue=function(e){var r=e.activeContext.peek();if(r){if(Array.isArray(r))return function(e,t,r,n){var o=e.filter((function(e){return i(e,r,n)}));switch(t){case"ALL":return o;case"FIRST":return o[0]||null;case"LAST":return o.length?o[o.length-1]:null}}(r,t,a,e);if("object"===(void 0===r?"undefined":n(r)))return function(e,t,r,n){var o,a,s={},l=[],u={};for(a in e)e.hasOwnProperty(a)&&i(o={key:a,value:e[a]},r,n)&&l.push(o);switch(t){case"ALL":return l.forEach((function(e){s[e.key]=e.value})),s;case"FIRST":return l.length?(u[l[0].key]=l[0].value,u):null;case"LAST":return l.length?(u[l[l.length-1].key]=l[l.length-1].value,u):null}l.forEach((function(e){s[e.key]=e.value}))}(r,t,a,e)}return null},s},FIRST:"FIRST",LAST:"LAST",ALL:"ALL"}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Projection=void 0;var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=r(0);function i(e,t,r){return e.map((function(e){var n;return r.activeContext.push(e),n=t.getValue(r),r.activeContext.pop(),n}))}t.Projection={create:function(e,t,r){var a=o.SpelNode.create("projection",t,r);return a.getValue=function(e){var t,o=e.activeContext.peek(),a=[];if(Array.isArray(o))return i(o,r,e);if("object"===(void 0===o?"undefined":n(o))){for(t in o)o.hasOwnProperty(t)&&a.push(o[t]);return i(a,r,e)}return null},a}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpInstanceof=void 0;var n=r(0);t.OpInstanceof={create:function(e,t,r){var o=n.SpelNode.create("instanceof",e,t,r);return o.getValue=function(e){throw{name:"MethodNotImplementedException",message:"OpInstanceOf: Not implemented"}},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.OpBetween=void 0;var n=r(0);t.OpBetween={create:function(e,t,r){var o=n.SpelNode.create("between",e,t,r);return o.getValue=function(e){throw{name:"MethodNotImplementedException",message:"OpBetween: Not implemented"}},o}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TypeReference=void 0;var n=r(0);t.TypeReference={create:function(e,t,r){return(t=n.SpelNode.create("typeref",e,t)).getValue=function(e){throw{name:"MethodNotImplementedException",message:"TypeReference: Not implemented"}},t}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BeanReference=void 0;var n=r(0);t.BeanReference={create:function(e,t){var r=n.SpelNode.create("beanref",e);return r.getValue=function(e){throw{name:"MethodNotImplementedException",message:"BeanReference: Not implemented"}},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Identifier=void 0;var n=r(0);t.Identifier={create:function(e,t){var r=n.SpelNode.create("identifier",t);return r.getRaw=function(){return e},r.getValue=function(e){throw{name:"MethodNotImplementedException",message:"Identifier: Not implemented"}},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.QualifiedIdentifier=void 0;var n=r(0);t.QualifiedIdentifier={create:function(e,t){var r=n.SpelNode.create.apply(n.SpelNode,["qualifiedidentifier",e].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(t)));return r.getRaw=function(){return t.map((function(e){return e.getRaw()}))},r.getValue=function(e){throw{name:"MethodNotImplementedException",message:"QualifiedIdentifier: Not implemented"}},r}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConstructorReference=void 0;var n=r(0),o=r(1);t.ConstructorReference={create:function(e,t,r){var i,a=void 0!==r;a?i=t.length&&t[0]&&"number"===t[0].getType()?t[0].getValue():null:(r=t,t=void 0);var s,l=(s=r,Array.isArray(s)?s:Array.from(s)),u=(l[0],l.slice(1)),c=n.SpelNode.create.apply(n.SpelNode,["constructorref",e].concat(function(e){if(Array.isArray(e)){for(var t=0,r=Array(e.length);t<e.length;t++)r[t]=e[t];return r}return Array.from(e)}(r)));return c.getRaw=function(){return i},c.getValue=function(e){if(a&&u.length<=1){var t=[];return u.forEach((function(r){var n=e.activeContext;e.activeContext=new o.Stack,e.activeContext.push(e.rootContext),t.push(r.getValue(e)),e.activeContext=n})),1===u.length?t[0]:i?new Array(i):[]}throw{name:"MethodNotImplementedException",message:"ConstructorReference: Not implemented"}},c}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.StandardContext={create:function(e,t){var r={};return r.authentication=e||{},r.principal=t||{},r.hasRole=function(e){var t=!1;return!!e&&!(!r.authentication&&!Array.isArray(r.authentication.authorities))&&(r.authentication.authorities.forEach((function(r){r.authority.toLowerCase()===e.toLowerCase()&&(t=!0)})),t)},r.hasPermission=function(){var e=Array.prototype.slice.call(arguments);if(1===e.length)return r.hasRole(e[0])},r}}}])},e.exports=t()},9157:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=l(r(1283)),o=l(r(1025)),i=l(r(2520)),a=l(r(9137)),s=l(r(9429));function l(e){return e&&e.__esModule?e:{default:e}}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var c=function(e){return e.replace(/[\t ]+$/,"")},p=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t||{},this.indentation=new i.default(this.cfg.indent),this.inlineBlock=new a.default,this.params=new s.default(this.cfg.params),this.tokenizer=r,this.tokenOverride=n,this.previousReservedWord={},this.tokens=[],this.index=0}var t,r,l;return t=e,r=[{key:"format",value:function(e){return this.tokens=this.tokenizer.tokenize(e),this.getFormattedQueryFromTokens().trim()}},{key:"getFormattedQueryFromTokens",value:function(){var e=this,t="";return this.tokens.forEach((function(r,n){e.index=n,e.tokenOverride&&(r=e.tokenOverride(r,e.previousReservedWord)||r),r.type===o.default.WHITESPACE||(r.type===o.default.LINE_COMMENT?t=e.formatLineComment(r,t):r.type===o.default.BLOCK_COMMENT?t=e.formatBlockComment(r,t):r.type===o.default.RESERVED_TOP_LEVEL?(t=e.formatTopLevelReservedWord(r,t),e.previousReservedWord=r):r.type===o.default.RESERVED_TOP_LEVEL_NO_INDENT?(t=e.formatTopLevelReservedWordNoIndent(r,t),e.previousReservedWord=r):r.type===o.default.RESERVED_NEWLINE?(t=e.formatNewlineReservedWord(r,t),e.previousReservedWord=r):r.type===o.default.RESERVED?(t=e.formatWithSpaces(r,t),e.previousReservedWord=r):t=r.type===o.default.OPEN_PAREN?e.formatOpeningParentheses(r,t):r.type===o.default.CLOSE_PAREN?e.formatClosingParentheses(r,t):r.type===o.default.PLACEHOLDER?e.formatPlaceholder(r,t):","===r.value?e.formatComma(r,t):":"===r.value?e.formatWithSpaceAfter(r,t):"."===r.value?e.formatWithoutSpaces(r,t):";"===r.value?e.formatQuerySeparator(r,t):e.formatWithSpaces(r,t))})),t}},{key:"formatLineComment",value:function(e,t){return this.addNewline(t+e.value)}},{key:"formatBlockComment",value:function(e,t){return this.addNewline(this.addNewline(t)+this.indentComment(e.value))}},{key:"indentComment",value:function(e){return e.replace(/\n[\t ]*/g,"\n"+this.indentation.getIndent()+" ")}},{key:"formatTopLevelReservedWordNoIndent",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t)+this.equalizeWhitespace(this.formatReservedWord(e.value)),this.addNewline(t)}},{key:"formatTopLevelReservedWord",value:function(e,t){return this.indentation.decreaseTopLevel(),t=this.addNewline(t),this.indentation.increaseTopLevel(),t+=this.equalizeWhitespace(this.formatReservedWord(e.value)),this.addNewline(t)}},{key:"formatNewlineReservedWord",value:function(e,t){return this.addNewline(t)+this.equalizeWhitespace(this.formatReservedWord(e.value))+" "}},{key:"equalizeWhitespace",value:function(e){return e.replace(/[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+/g," ")}},{key:"formatOpeningParentheses",value:function(e,t){var r=[o.default.WHITESPACE,o.default.OPEN_PAREN,o.default.LINE_COMMENT];return(0,n.default)(r,this.previousToken().type)||(t=c(t)),t+=this.cfg.uppercase?e.value.toUpperCase():e.value,this.inlineBlock.beginIfPossible(this.tokens,this.index),this.inlineBlock.isActive()||(this.indentation.increaseBlockLevel(),t=this.addNewline(t)),t}},{key:"formatClosingParentheses",value:function(e,t){return e.value=this.cfg.uppercase?e.value.toUpperCase():e.value,this.inlineBlock.isActive()?(this.inlineBlock.end(),this.formatWithSpaceAfter(e,t)):(this.indentation.decreaseBlockLevel(),this.formatWithSpaces(e,this.addNewline(t)))}},{key:"formatPlaceholder",value:function(e,t){return t+this.params.get(e)+" "}},{key:"formatComma",value:function(e,t){return t=c(t)+e.value+" ",this.inlineBlock.isActive()||/^LIMIT$/i.test(this.previousReservedWord.value)?t:this.addNewline(t)}},{key:"formatWithSpaceAfter",value:function(e,t){return c(t)+e.value+" "}},{key:"formatWithoutSpaces",value:function(e,t){return c(t)+e.value}},{key:"formatWithSpaces",value:function(e,t){return t+("reserved"===e.type?this.formatReservedWord(e.value):e.value)+" "}},{key:"formatReservedWord",value:function(e){return this.cfg.uppercase?e.toUpperCase():e}},{key:"formatQuerySeparator",value:function(e,t){return this.indentation.resetIndentation(),c(t)+e.value+"\n".repeat(this.cfg.linesBetweenQueries||1)}},{key:"addNewline",value:function(e){return(e=c(e)).endsWith("\n")||(e+="\n"),e+this.indentation.getIndent()}},{key:"previousToken",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return this.tokens[this.index-e]||{}}}],r&&u(t.prototype,r),l&&u(t,l),e}();t.default=p,e.exports=t.default},2520:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(9901)),o=i(r(8906));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s="top-level",l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indent=t||"  ",this.indentTypes=[]}var t,r,i;return t=e,(r=[{key:"getIndent",value:function(){return(0,n.default)(this.indent,this.indentTypes.length)}},{key:"increaseTopLevel",value:function(){this.indentTypes.push(s)}},{key:"increaseBlockLevel",value:function(){this.indentTypes.push("block-level")}},{key:"decreaseTopLevel",value:function(){(0,o.default)(this.indentTypes)===s&&this.indentTypes.pop()}},{key:"decreaseBlockLevel",value:function(){for(;this.indentTypes.length>0&&this.indentTypes.pop()===s;);}},{key:"resetIndentation",value:function(){this.indentTypes=[]}}])&&a(t.prototype,r),i&&a(t,i),e}();t.default=l,e.exports=t.default},9137:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n,o=(n=r(1025))&&n.__esModule?n:{default:n};function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.level=0}var t,r,n;return t=e,(r=[{key:"beginIfPossible",value:function(e,t){0===this.level&&this.isInlineBlock(e,t)?this.level=1:this.level>0?this.level++:this.level=0}},{key:"end",value:function(){this.level--}},{key:"isActive",value:function(){return this.level>0}},{key:"isInlineBlock",value:function(e,t){for(var r=0,n=0,i=t;i<e.length;i++){var a=e[i];if((r+=a.value.length)>50)return!1;if(a.type===o.default.OPEN_PAREN)n++;else if(a.type===o.default.CLOSE_PAREN&&0==--n)return!0;if(this.isForbiddenToken(a))return!1}return!1}},{key:"isForbiddenToken",value:function(e){var t=e.type,r=e.value;return t===o.default.RESERVED_TOP_LEVEL||t===o.default.RESERVED_NEWLINE||t===o.default.COMMENT||t===o.default.BLOCK_COMMENT||";"===r}}])&&i(t.prototype,r),n&&i(t,n),e}();t.default=a,e.exports=t.default},9429:(e,t)=>{"use strict";function r(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.params=t,this.index=0}var t,n,o;return t=e,(n=[{key:"get",value:function(e){var t=e.key,r=e.value;return this.params?t?this.params[t]:this.params[this.index++]:r}}])&&r(t.prototype,n),o&&r(t,o),e}();t.default=n,e.exports=t.default},3202:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(7969)),o=a(r(8472)),i=a(r(1025));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.WHITESPACE_REGEX=/^([\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]+)/,this.NUMBER_REGEX=/^((\x2D[\t-\r \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000\uFEFF]*)?[0-9]+(\.[0-9]+)?|0x[0-9A-Fa-f]+|0b[01]+)\b/,this.OPERATOR_REGEX=/^(!=|<>|==|<=|>=|!<|!>|\|\||::|\x2D>>|\x2D>|~~\*|~~|!~~\*|!~~|~\*|!~\*|!~|:=|(?:[\0-\t\x0B\f\x0E-\u2027\u202A-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]))/,this.BLOCK_COMMENT_REGEX=/^(\/\*(?:[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])*?(?:\*\/|$))/,this.LINE_COMMENT_REGEX=this.createLineCommentRegex(t.lineCommentTypes),this.RESERVED_TOP_LEVEL_REGEX=this.createReservedWordRegex(t.reservedTopLevelWords),this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX=this.createReservedWordRegex(t.reservedTopLevelWordsNoIndent),this.RESERVED_NEWLINE_REGEX=this.createReservedWordRegex(t.reservedNewlineWords),this.RESERVED_PLAIN_REGEX=this.createReservedWordRegex(t.reservedWords),this.WORD_REGEX=this.createWordRegex(t.specialWordChars),this.STRING_REGEX=this.createStringRegex(t.stringTypes),this.OPEN_PAREN_REGEX=this.createParenRegex(t.openParens),this.CLOSE_PAREN_REGEX=this.createParenRegex(t.closeParens),this.INDEXED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.indexedPlaceholderTypes,"[0-9]*"),this.IDENT_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.namedPlaceholderTypes,"[a-zA-Z0-9._$]+"),this.STRING_NAMED_PLACEHOLDER_REGEX=this.createPlaceholderRegex(t.namedPlaceholderTypes,this.createStringPattern(t.stringTypes))}var t,r,a;return t=e,r=[{key:"createLineCommentRegex",value:function(e){return new RegExp("^((?:".concat(e.map((function(e){return(0,o.default)(e)})).join("|"),").*?(?:\r\n|\r|\n|$))"),"u")}},{key:"createReservedWordRegex",value:function(e){var t=e.join("|").replace(/ /g,"\\s+");return new RegExp("^(".concat(t,")\\b"),"iu")}},{key:"createWordRegex",value:function(){return new RegExp("^([\\p{Alphabetic}\\p{Mark}\\p{Decimal_Number}\\p{Connector_Punctuation}\\p{Join_Control}".concat((arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).join(""),"]+)"),"u")}},{key:"createStringRegex",value:function(e){return new RegExp("^("+this.createStringPattern(e)+")","u")}},{key:"createStringPattern",value:function(e){var t={"``":"((`[^`]*($|`))+)","[]":"((\\[[^\\]]*($|\\]))(\\][^\\]]*($|\\]))*)",'""':'(("[^"\\\\]*(?:\\\\.[^"\\\\]*)*("|$))+)',"''":"(('[^'\\\\]*(?:\\\\.[^'\\\\]*)*('|$))+)","N''":"((N'[^N'\\\\]*(?:\\\\.[^N'\\\\]*)*('|$))+)"};return e.map((function(e){return t[e]})).join("|")}},{key:"createParenRegex",value:function(e){var t=this;return new RegExp("^("+e.map((function(e){return t.escapeParen(e)})).join("|")+")","iu")}},{key:"escapeParen",value:function(e){return 1===e.length?(0,o.default)(e):"\\b"+e+"\\b"}},{key:"createPlaceholderRegex",value:function(e,t){if((0,n.default)(e))return!1;var r=e.map(o.default).join("|");return new RegExp("^((?:".concat(r,")(?:").concat(t,"))"),"u")}},{key:"tokenize",value:function(e){if(!e)return[];for(var t,r=[];e.length;)t=this.getNextToken(e,t),e=e.substring(t.value.length),r.push(t);return r}},{key:"getNextToken",value:function(e,t){return this.getWhitespaceToken(e)||this.getCommentToken(e)||this.getStringToken(e)||this.getOpenParenToken(e)||this.getCloseParenToken(e)||this.getPlaceholderToken(e)||this.getNumberToken(e)||this.getReservedWordToken(e,t)||this.getWordToken(e)||this.getOperatorToken(e)}},{key:"getWhitespaceToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.WHITESPACE,regex:this.WHITESPACE_REGEX})}},{key:"getCommentToken",value:function(e){return this.getLineCommentToken(e)||this.getBlockCommentToken(e)}},{key:"getLineCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.LINE_COMMENT,regex:this.LINE_COMMENT_REGEX})}},{key:"getBlockCommentToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.BLOCK_COMMENT,regex:this.BLOCK_COMMENT_REGEX})}},{key:"getStringToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.STRING,regex:this.STRING_REGEX})}},{key:"getOpenParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.OPEN_PAREN,regex:this.OPEN_PAREN_REGEX})}},{key:"getCloseParenToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.CLOSE_PAREN,regex:this.CLOSE_PAREN_REGEX})}},{key:"getPlaceholderToken",value:function(e){return this.getIdentNamedPlaceholderToken(e)||this.getStringNamedPlaceholderToken(e)||this.getIndexedPlaceholderToken(e)}},{key:"getIdentNamedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.IDENT_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getStringNamedPlaceholderToken",value:function(e){var t=this;return this.getPlaceholderTokenWithKey({input:e,regex:this.STRING_NAMED_PLACEHOLDER_REGEX,parseKey:function(e){return t.getEscapedPlaceholderKey({key:e.slice(2,-1),quoteChar:e.slice(-1)})}})}},{key:"getIndexedPlaceholderToken",value:function(e){return this.getPlaceholderTokenWithKey({input:e,regex:this.INDEXED_PLACEHOLDER_REGEX,parseKey:function(e){return e.slice(1)}})}},{key:"getPlaceholderTokenWithKey",value:function(e){var t=e.input,r=e.regex,n=e.parseKey,o=this.getTokenOnFirstMatch({input:t,regex:r,type:i.default.PLACEHOLDER});return o&&(o.key=n(o.value)),o}},{key:"getEscapedPlaceholderKey",value:function(e){var t=e.key,r=e.quoteChar;return t.replace(new RegExp((0,o.default)("\\"+r),"gu"),r)}},{key:"getNumberToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.NUMBER,regex:this.NUMBER_REGEX})}},{key:"getOperatorToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.OPERATOR,regex:this.OPERATOR_REGEX})}},{key:"getReservedWordToken",value:function(e,t){if(!t||!t.value||"."!==t.value)return this.getTopLevelReservedToken(e)||this.getNewlineReservedToken(e)||this.getTopLevelReservedTokenNoIndent(e)||this.getPlainReservedToken(e)}},{key:"getTopLevelReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_TOP_LEVEL,regex:this.RESERVED_TOP_LEVEL_REGEX})}},{key:"getNewlineReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_NEWLINE,regex:this.RESERVED_NEWLINE_REGEX})}},{key:"getTopLevelReservedTokenNoIndent",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED_TOP_LEVEL_NO_INDENT,regex:this.RESERVED_TOP_LEVEL_NO_INDENT_REGEX})}},{key:"getPlainReservedToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.RESERVED,regex:this.RESERVED_PLAIN_REGEX})}},{key:"getWordToken",value:function(e){return this.getTokenOnFirstMatch({input:e,type:i.default.WORD,regex:this.WORD_REGEX})}},{key:"getTokenOnFirstMatch",value:function(e){var t=e.input,r=e.type,n=e.regex,o=t.match(n);if(o)return{type:r,value:o[1]}}}],r&&s(t.prototype,r),a&&s(t,a),e}();t.default=l,e.exports=t.default},1025:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default={WHITESPACE:"whitespace",WORD:"word",STRING:"string",RESERVED:"reserved",RESERVED_TOP_LEVEL:"reserved-top-level",RESERVED_TOP_LEVEL_NO_INDENT:"reserved-top-level-no-indent",RESERVED_NEWLINE:"reserved-newline",OPERATOR:"operator",OPEN_PAREN:"open-paren",CLOSE_PAREN:"close-paren",LINE_COMMENT:"line-comment",BLOCK_COMMENT:"block-comment",NUMBER:"number",PLACEHOLDER:"placeholder"},e.exports=t.default},4377:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(9157)),o=i(r(3202));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,l=["ABS","ACTIVATE","ALIAS","ALL","ALLOCATE","ALLOW","ALTER","ANY","ARE","ARRAY","AS","ASC","ASENSITIVE","ASSOCIATE","ASUTIME","ASYMMETRIC","AT","ATOMIC","ATTRIBUTES","AUDIT","AUTHORIZATION","AUX","AUXILIARY","AVG","BEFORE","BEGIN","BETWEEN","BIGINT","BINARY","BLOB","BOOLEAN","BOTH","BUFFERPOOL","BY","CACHE","CALL","CALLED","CAPTURE","CARDINALITY","CASCADED","CASE","CAST","CCSID","CEIL","CEILING","CHAR","CHARACTER","CHARACTER_LENGTH","CHAR_LENGTH","CHECK","CLOB","CLONE","CLOSE","CLUSTER","COALESCE","COLLATE","COLLECT","COLLECTION","COLLID","COLUMN","COMMENT","COMMIT","CONCAT","CONDITION","CONNECT","CONNECTION","CONSTRAINT","CONTAINS","CONTINUE","CONVERT","CORR","CORRESPONDING","COUNT","COUNT_BIG","COVAR_POP","COVAR_SAMP","CREATE","CROSS","CUBE","CUME_DIST","CURRENT","CURRENT_DATE","CURRENT_DEFAULT_TRANSFORM_GROUP","CURRENT_LC_CTYPE","CURRENT_PATH","CURRENT_ROLE","CURRENT_SCHEMA","CURRENT_SERVER","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_TIMEZONE","CURRENT_TRANSFORM_GROUP_FOR_TYPE","CURRENT_USER","CURSOR","CYCLE","DATA","DATABASE","DATAPARTITIONNAME","DATAPARTITIONNUM","DATE","DAY","DAYS","DB2GENERAL","DB2GENRL","DB2SQL","DBINFO","DBPARTITIONNAME","DBPARTITIONNUM","DEALLOCATE","DEC","DECIMAL","DECLARE","DEFAULT","DEFAULTS","DEFINITION","DELETE","DENSERANK","DENSE_RANK","DEREF","DESCRIBE","DESCRIPTOR","DETERMINISTIC","DIAGNOSTICS","DISABLE","DISALLOW","DISCONNECT","DISTINCT","DO","DOCUMENT","DOUBLE","DROP","DSSIZE","DYNAMIC","EACH","EDITPROC","ELEMENT","ELSE","ELSEIF","ENABLE","ENCODING","ENCRYPTION","END","END-EXEC","ENDING","ERASE","ESCAPE","EVERY","EXCEPTION","EXCLUDING","EXCLUSIVE","EXEC","EXECUTE","EXISTS","EXIT","EXP","EXPLAIN","EXTENDED","EXTERNAL","EXTRACT","FALSE","FENCED","FETCH","FIELDPROC","FILE","FILTER","FINAL","FIRST","FLOAT","FLOOR","FOR","FOREIGN","FREE","FULL","FUNCTION","FUSION","GENERAL","GENERATED","GET","GLOBAL","GOTO","GRANT","GRAPHIC","GROUP","GROUPING","HANDLER","HASH","HASHED_VALUE","HINT","HOLD","HOUR","HOURS","IDENTITY","IF","IMMEDIATE","IN","INCLUDING","INCLUSIVE","INCREMENT","INDEX","INDICATOR","INDICATORS","INF","INFINITY","INHERIT","INNER","INOUT","INSENSITIVE","INSERT","INT","INTEGER","INTEGRITY","INTERSECTION","INTERVAL","INTO","IS","ISOBID","ISOLATION","ITERATE","JAR","JAVA","KEEP","KEY","LABEL","LANGUAGE","LARGE","LATERAL","LC_CTYPE","LEADING","LEAVE","LEFT","LIKE","LINKTYPE","LN","LOCAL","LOCALDATE","LOCALE","LOCALTIME","LOCALTIMESTAMP","LOCATOR","LOCATORS","LOCK","LOCKMAX","LOCKSIZE","LONG","LOOP","LOWER","MAINTAINED","MATCH","MATERIALIZED","MAX","MAXVALUE","MEMBER","MERGE","METHOD","MICROSECOND","MICROSECONDS","MIN","MINUTE","MINUTES","MINVALUE","MOD","MODE","MODIFIES","MODULE","MONTH","MONTHS","MULTISET","NAN","NATIONAL","NATURAL","NCHAR","NCLOB","NEW","NEW_TABLE","NEXTVAL","NO","NOCACHE","NOCYCLE","NODENAME","NODENUMBER","NOMAXVALUE","NOMINVALUE","NONE","NOORDER","NORMALIZE","NORMALIZED","NOT","NULL","NULLIF","NULLS","NUMERIC","NUMPARTS","OBID","OCTET_LENGTH","OF","OFFSET","OLD","OLD_TABLE","ON","ONLY","OPEN","OPTIMIZATION","OPTIMIZE","OPTION","ORDER","OUT","OUTER","OVER","OVERLAPS","OVERLAY","OVERRIDING","PACKAGE","PADDED","PAGESIZE","PARAMETER","PART","PARTITION","PARTITIONED","PARTITIONING","PARTITIONS","PASSWORD","PATH","PERCENTILE_CONT","PERCENTILE_DISC","PERCENT_RANK","PIECESIZE","PLAN","POSITION","POWER","PRECISION","PREPARE","PREVVAL","PRIMARY","PRIQTY","PRIVILEGES","PROCEDURE","PROGRAM","PSID","PUBLIC","QUERY","QUERYNO","RANGE","RANK","READ","READS","REAL","RECOVERY","RECURSIVE","REF","REFERENCES","REFERENCING","REFRESH","REGR_AVGX","REGR_AVGY","REGR_COUNT","REGR_INTERCEPT","REGR_R2","REGR_SLOPE","REGR_SXX","REGR_SXY","REGR_SYY","RELEASE","RENAME","REPEAT","RESET","RESIGNAL","RESTART","RESTRICT","RESULT","RESULT_SET_LOCATOR","RETURN","RETURNS","REVOKE","RIGHT","ROLE","ROLLBACK","ROLLUP","ROUND_CEILING","ROUND_DOWN","ROUND_FLOOR","ROUND_HALF_DOWN","ROUND_HALF_EVEN","ROUND_HALF_UP","ROUND_UP","ROUTINE","ROW","ROWNUMBER","ROWS","ROWSET","ROW_NUMBER","RRN","RUN","SAVEPOINT","SCHEMA","SCOPE","SCRATCHPAD","SCROLL","SEARCH","SECOND","SECONDS","SECQTY","SECURITY","SENSITIVE","SEQUENCE","SESSION","SESSION_USER","SIGNAL","SIMILAR","SIMPLE","SMALLINT","SNAN","SOME","SOURCE","SPECIFIC","SPECIFICTYPE","SQL","SQLEXCEPTION","SQLID","SQLSTATE","SQLWARNING","SQRT","STACKED","STANDARD","START","STARTING","STATEMENT","STATIC","STATMENT","STAY","STDDEV_POP","STDDEV_SAMP","STOGROUP","STORES","STYLE","SUBMULTISET","SUBSTRING","SUM","SUMMARY","SYMMETRIC","SYNONYM","SYSFUN","SYSIBM","SYSPROC","SYSTEM","SYSTEM_USER","TABLE","TABLESAMPLE","TABLESPACE","THEN","TIME","TIMESTAMP","TIMEZONE_HOUR","TIMEZONE_MINUTE","TO","TRAILING","TRANSACTION","TRANSLATE","TRANSLATION","TREAT","TRIGGER","TRIM","TRUE","TRUNCATE","TYPE","UESCAPE","UNDO","UNIQUE","UNKNOWN","UNNEST","UNTIL","UPPER","USAGE","USER","USING","VALIDPROC","VALUE","VARCHAR","VARIABLE","VARIANT","VARYING","VAR_POP","VAR_SAMP","VCAT","VERSION","VIEW","VOLATILE","VOLUMES","WHEN","WHENEVER","WHILE","WIDTH_BUCKET","WINDOW","WITH","WITHIN","WITHOUT","WLM","WRITE","XMLELEMENT","XMLEXISTS","XMLNAMESPACES","YEAR","YEARS"],u=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INTERSECT","LIMIT","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],c=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","CROSS JOIN","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN"],f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t}var t,r,i;return t=e,(r=[{key:"format",value:function(e){return s||(s=new o.default({reservedWords:l,reservedTopLevelWords:u,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:c,stringTypes:['""',"''","``","[]"],openParens:["("],closeParens:[")"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["#","@"]})),new n.default(this.cfg,s).format(e)}}])&&a(t.prototype,r),i&&a(t,i),e}();t.default=f,e.exports=t.default},9445:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(9157)),o=i(r(3202));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,l=["ALL","ALTER","ANALYZE","AND","ANY","ARRAY","AS","ASC","BEGIN","BETWEEN","BINARY","BOOLEAN","BREAK","BUCKET","BUILD","BY","CALL","CASE","CAST","CLUSTER","COLLATE","COLLECTION","COMMIT","CONNECT","CONTINUE","CORRELATE","COVER","CREATE","DATABASE","DATASET","DATASTORE","DECLARE","DECREMENT","DELETE","DERIVED","DESC","DESCRIBE","DISTINCT","DO","DROP","EACH","ELEMENT","ELSE","END","EVERY","EXCEPT","EXCLUDE","EXECUTE","EXISTS","EXPLAIN","FALSE","FETCH","FIRST","FLATTEN","FOR","FORCE","FROM","FUNCTION","GRANT","GROUP","GSI","HAVING","IF","IGNORE","ILIKE","IN","INCLUDE","INCREMENT","INDEX","INFER","INLINE","INNER","INSERT","INTERSECT","INTO","IS","JOIN","KEY","KEYS","KEYSPACE","KNOWN","LAST","LEFT","LET","LETTING","LIKE","LIMIT","LSM","MAP","MAPPING","MATCHED","MATERIALIZED","MERGE","MISSING","NAMESPACE","NEST","NOT","NULL","NUMBER","OBJECT","OFFSET","ON","OPTION","OR","ORDER","OUTER","OVER","PARSE","PARTITION","PASSWORD","PATH","POOL","PREPARE","PRIMARY","PRIVATE","PRIVILEGE","PROCEDURE","PUBLIC","RAW","REALM","REDUCE","RENAME","RETURN","RETURNING","REVOKE","RIGHT","ROLE","ROLLBACK","SATISFIES","SCHEMA","SELECT","SELF","SEMI","SET","SHOW","SOME","START","STATISTICS","STRING","SYSTEM","THEN","TO","TRANSACTION","TRIGGER","TRUE","TRUNCATE","UNDER","UNION","UNIQUE","UNKNOWN","UNNEST","UNSET","UPDATE","UPSERT","USE","USER","USING","VALIDATE","VALUE","VALUED","VALUES","VIA","VIEW","WHEN","WHERE","WHILE","WITH","WITHIN","WORK","XOR"],u=["DELETE FROM","EXCEPT ALL","EXCEPT","EXPLAIN DELETE FROM","EXPLAIN UPDATE","EXPLAIN UPSERT","FROM","GROUP BY","HAVING","INFER","INSERT INTO","LET","LIMIT","MERGE","NEST","ORDER BY","PREPARE","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UNNEST","UPDATE","UPSERT","USE KEYS","VALUES","WHERE"],c=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","XOR"],f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t}var t,r,i;return t=e,(r=[{key:"format",value:function(e){return s||(s=new o.default({reservedWords:l,reservedTopLevelWords:u,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:c,stringTypes:['""',"''","``"],openParens:["(","[","{"],closeParens:[")","]","}"],namedPlaceholderTypes:["$"],lineCommentTypes:["#","--"]})),new n.default(this.cfg,s).format(e)}}])&&a(t.prototype,r),i&&a(t,i),e}();t.default=f,e.exports=t.default},7881:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=a(r(9157)),o=a(r(3202)),i=a(r(1025));function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var l,u=["A","ACCESSIBLE","AGENT","AGGREGATE","ALL","ALTER","ANY","ARRAY","AS","ASC","AT","ATTRIBUTE","AUTHID","AVG","BETWEEN","BFILE_BASE","BINARY_INTEGER","BINARY","BLOB_BASE","BLOCK","BODY","BOOLEAN","BOTH","BOUND","BREADTH","BULK","BY","BYTE","C","CALL","CALLING","CASCADE","CASE","CHAR_BASE","CHAR","CHARACTER","CHARSET","CHARSETFORM","CHARSETID","CHECK","CLOB_BASE","CLONE","CLOSE","CLUSTER","CLUSTERS","COALESCE","COLAUTH","COLLECT","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPILED","COMPRESS","CONNECT","CONSTANT","CONSTRUCTOR","CONTEXT","CONTINUE","CONVERT","COUNT","CRASH","CREATE","CREDENTIAL","CURRENT","CURRVAL","CURSOR","CUSTOMDATUM","DANGLING","DATA","DATE_BASE","DATE","DAY","DECIMAL","DEFAULT","DEFINE","DELETE","DEPTH","DESC","DETERMINISTIC","DIRECTORY","DISTINCT","DO","DOUBLE","DROP","DURATION","ELEMENT","ELSIF","EMPTY","END","ESCAPE","EXCEPTIONS","EXCLUSIVE","EXECUTE","EXISTS","EXIT","EXTENDS","EXTERNAL","EXTRACT","FALSE","FETCH","FINAL","FIRST","FIXED","FLOAT","FOR","FORALL","FORCE","FROM","FUNCTION","GENERAL","GOTO","GRANT","GROUP","HASH","HEAP","HIDDEN","HOUR","IDENTIFIED","IF","IMMEDIATE","IN","INCLUDING","INDEX","INDEXES","INDICATOR","INDICES","INFINITE","INSTANTIABLE","INT","INTEGER","INTERFACE","INTERVAL","INTO","INVALIDATE","IS","ISOLATION","JAVA","LANGUAGE","LARGE","LEADING","LENGTH","LEVEL","LIBRARY","LIKE","LIKE2","LIKE4","LIKEC","LIMITED","LOCAL","LOCK","LONG","MAP","MAX","MAXLEN","MEMBER","MERGE","MIN","MINUTE","MLSLABEL","MOD","MODE","MONTH","MULTISET","NAME","NAN","NATIONAL","NATIVE","NATURAL","NATURALN","NCHAR","NEW","NEXTVAL","NOCOMPRESS","NOCOPY","NOT","NOWAIT","NULL","NULLIF","NUMBER_BASE","NUMBER","OBJECT","OCICOLL","OCIDATE","OCIDATETIME","OCIDURATION","OCIINTERVAL","OCILOBLOCATOR","OCINUMBER","OCIRAW","OCIREF","OCIREFCURSOR","OCIROWID","OCISTRING","OCITYPE","OF","OLD","ON","ONLY","OPAQUE","OPEN","OPERATOR","OPTION","ORACLE","ORADATA","ORDER","ORGANIZATION","ORLANY","ORLVARY","OTHERS","OUT","OVERLAPS","OVERRIDING","PACKAGE","PARALLEL_ENABLE","PARAMETER","PARAMETERS","PARENT","PARTITION","PASCAL","PCTFREE","PIPE","PIPELINED","PLS_INTEGER","PLUGGABLE","POSITIVE","POSITIVEN","PRAGMA","PRECISION","PRIOR","PRIVATE","PROCEDURE","PUBLIC","RAISE","RANGE","RAW","READ","REAL","RECORD","REF","REFERENCE","RELEASE","RELIES_ON","REM","REMAINDER","RENAME","RESOURCE","RESULT_CACHE","RESULT","RETURN","RETURNING","REVERSE","REVOKE","ROLLBACK","ROW","ROWID","ROWNUM","ROWTYPE","SAMPLE","SAVE","SAVEPOINT","SB1","SB2","SB4","SEARCH","SECOND","SEGMENT","SELF","SEPARATE","SEQUENCE","SERIALIZABLE","SHARE","SHORT","SIZE_T","SIZE","SMALLINT","SOME","SPACE","SPARSE","SQL","SQLCODE","SQLDATA","SQLERRM","SQLNAME","SQLSTATE","STANDARD","START","STATIC","STDDEV","STORED","STRING","STRUCT","STYLE","SUBMULTISET","SUBPARTITION","SUBSTITUTABLE","SUBTYPE","SUCCESSFUL","SUM","SYNONYM","SYSDATE","TABAUTH","TABLE","TDO","THE","THEN","TIME","TIMESTAMP","TIMEZONE_ABBR","TIMEZONE_HOUR","TIMEZONE_MINUTE","TIMEZONE_REGION","TO","TRAILING","TRANSACTION","TRANSACTIONAL","TRIGGER","TRUE","TRUSTED","TYPE","UB1","UB2","UB4","UID","UNDER","UNIQUE","UNPLUG","UNSIGNED","UNTRUSTED","USE","USER","USING","VALIDATE","VALIST","VALUE","VARCHAR","VARCHAR2","VARIABLE","VARIANCE","VARRAY","VARYING","VIEW","VIEWS","VOID","WHENEVER","WHILE","WITH","WORK","WRAPPED","WRITE","YEAR","ZONE"],c=["ADD","ALTER COLUMN","ALTER TABLE","BEGIN","CONNECT BY","DECLARE","DELETE FROM","DELETE","END","EXCEPT","EXCEPTION","FETCH FIRST","FROM","GROUP BY","HAVING","INSERT INTO","INSERT","LIMIT","LOOP","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","START WITH","UPDATE","VALUES","WHERE"],p=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],f=["AND","CROSS APPLY","CROSS JOIN","ELSE","END","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],d=function(e,t){if(e.type===i.default.RESERVED_TOP_LEVEL&&"SET"===e.value&&"BY"===t.value)return e.type=i.default.RESERVED,e},v=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t}var t,r,i;return t=e,(r=[{key:"format",value:function(e){return l||(l=new o.default({reservedWords:u,reservedTopLevelWords:c,reservedNewlineWords:f,reservedTopLevelWordsNoIndent:p,stringTypes:['""',"N''","''","``"],openParens:["(","CASE","BEGIN"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:[":"],lineCommentTypes:["--"],specialWordChars:["_","$","#",".","@"]})),new n.default(this.cfg,l,d).format(e)}}])&&s(t.prototype,r),i&&s(t,i),e}();t.default=v,e.exports=t.default},1432:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=i(r(9157)),o=i(r(3202));function i(e){return e&&e.__esModule?e:{default:e}}function a(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var s,l=["ACCESSIBLE","ACTION","AGAINST","AGGREGATE","ALGORITHM","ALL","ALTER","ANALYSE","ANALYZE","AS","ASC","AUTOCOMMIT","AUTO_INCREMENT","BACKUP","BEGIN","BETWEEN","BINLOG","BOTH","CASCADE","CASE","CHANGE","CHANGED","CHARACTER SET","CHARSET","CHECK","CHECKSUM","COLLATE","COLLATION","COLUMN","COLUMNS","COMMENT","COMMIT","COMMITTED","COMPRESSED","CONCURRENT","CONSTRAINT","CONTAINS","CONVERT","CREATE","CROSS","CURRENT_TIMESTAMP","DATABASE","DATABASES","DAY","DAY_HOUR","DAY_MINUTE","DAY_SECOND","DEFAULT","DEFINER","DELAYED","DELETE","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DO","DROP","DUMPFILE","DUPLICATE","DYNAMIC","ELSE","ENCLOSED","END","ENGINE","ENGINES","ENGINE_TYPE","ESCAPE","ESCAPED","EVENTS","EXEC","EXECUTE","EXISTS","EXPLAIN","EXTENDED","FAST","FETCH","FIELDS","FILE","FIRST","FIXED","FLUSH","FOR","FORCE","FOREIGN","FULL","FULLTEXT","FUNCTION","GLOBAL","GRANT","GRANTS","GROUP_CONCAT","HEAP","HIGH_PRIORITY","HOSTS","HOUR","HOUR_MINUTE","HOUR_SECOND","IDENTIFIED","IF","IFNULL","IGNORE","IN","INDEX","INDEXES","INFILE","INSERT","INSERT_ID","INSERT_METHOD","INTERVAL","INTO","INVOKER","IS","ISOLATION","KEY","KEYS","KILL","LAST_INSERT_ID","LEADING","LEVEL","LIKE","LINEAR","LINES","LOAD","LOCAL","LOCK","LOCKS","LOGS","LOW_PRIORITY","MARIA","MASTER","MASTER_CONNECT_RETRY","MASTER_HOST","MASTER_LOG_FILE","MATCH","MAX_CONNECTIONS_PER_HOUR","MAX_QUERIES_PER_HOUR","MAX_ROWS","MAX_UPDATES_PER_HOUR","MAX_USER_CONNECTIONS","MEDIUM","MERGE","MINUTE","MINUTE_SECOND","MIN_ROWS","MODE","MODIFY","MONTH","MRG_MYISAM","MYISAM","NAMES","NATURAL","NOT","NOW()","NULL","OFFSET","ON DELETE","ON UPDATE","ON","ONLY","OPEN","OPTIMIZE","OPTION","OPTIONALLY","OUTFILE","PACK_KEYS","PAGE","PARTIAL","PARTITION","PARTITIONS","PASSWORD","PRIMARY","PRIVILEGES","PROCEDURE","PROCESS","PROCESSLIST","PURGE","QUICK","RAID0","RAID_CHUNKS","RAID_CHUNKSIZE","RAID_TYPE","RANGE","READ","READ_ONLY","READ_WRITE","REFERENCES","REGEXP","RELOAD","RENAME","REPAIR","REPEATABLE","REPLACE","REPLICATION","RESET","RESTORE","RESTRICT","RETURN","RETURNS","REVOKE","RLIKE","ROLLBACK","ROW","ROWS","ROW_FORMAT","SECOND","SECURITY","SEPARATOR","SERIALIZABLE","SESSION","SHARE","SHOW","SHUTDOWN","SLAVE","SONAME","SOUNDS","SQL","SQL_AUTO_IS_NULL","SQL_BIG_RESULT","SQL_BIG_SELECTS","SQL_BIG_TABLES","SQL_BUFFER_RESULT","SQL_CACHE","SQL_CALC_FOUND_ROWS","SQL_LOG_BIN","SQL_LOG_OFF","SQL_LOG_UPDATE","SQL_LOW_PRIORITY_UPDATES","SQL_MAX_JOIN_SIZE","SQL_NO_CACHE","SQL_QUOTE_SHOW_CREATE","SQL_SAFE_UPDATES","SQL_SELECT_LIMIT","SQL_SLAVE_SKIP_COUNTER","SQL_SMALL_RESULT","SQL_WARNINGS","START","STARTING","STATUS","STOP","STORAGE","STRAIGHT_JOIN","STRING","STRIPED","SUPER","TABLE","TABLES","TEMPORARY","TERMINATED","THEN","TO","TRAILING","TRANSACTIONAL","TRUE","TRUNCATE","TYPE","TYPES","UNCOMMITTED","UNIQUE","UNLOCK","UNSIGNED","USAGE","USE","USING","VARIABLES","VIEW","WHEN","WITH","WORK","WRITE","YEAR_MONTH"],u=["ADD","AFTER","ALTER COLUMN","ALTER TABLE","DELETE FROM","EXCEPT","FETCH FIRST","FROM","GROUP BY","GO","HAVING","INSERT INTO","INSERT","LIMIT","MODIFY","ORDER BY","SELECT","SET CURRENT SCHEMA","SET SCHEMA","SET","UPDATE","VALUES","WHERE"],c=["INTERSECT","INTERSECT ALL","MINUS","UNION","UNION ALL"],p=["AND","CROSS APPLY","CROSS JOIN","ELSE","INNER JOIN","JOIN","LEFT JOIN","LEFT OUTER JOIN","OR","OUTER APPLY","OUTER JOIN","RIGHT JOIN","RIGHT OUTER JOIN","WHEN","XOR"],f=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.cfg=t}var t,r,i;return t=e,(r=[{key:"format",value:function(e){return s||(s=new o.default({reservedWords:l,reservedTopLevelWords:u,reservedNewlineWords:p,reservedTopLevelWordsNoIndent:c,stringTypes:['""',"N''","''","``","[]"],openParens:["(","CASE"],closeParens:[")","END"],indexedPlaceholderTypes:["?"],namedPlaceholderTypes:["@",":"],lineCommentTypes:["#","--"]})),new n.default(this.cfg,s).format(e)}}])&&a(t.prototype,r),i&&a(t,i),e}();t.default=f,e.exports=t.default},7409:(e,t,r)=>{"use strict";t.Ay=void 0;var n=s(r(4377)),o=s(r(9445)),i=s(r(7881)),a=s(r(1432));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(t.language){case"db2":return new n.default(t).format(e);case"n1ql":return new o.default(t).format(e);case"pl/sql":return new i.default(t).format(e);case"sql":case void 0:return new a.default(t).format(e);default:throw Error("Unsupported SQL dialect: ".concat(t.language))}};var u={format:l};t.Ay=u},358:(e,t,r)=>{e.exports=r(3231)},3231:(e,t)=>{var r=t,n=/`/g,o=/\./g,i=/[\0\b\t\n\r\x1a\"\'\\]/g,a={"\0":"\\0","\b":"\\b","\t":"\\t","\n":"\\n","\r":"\\r","":"\\Z",'"':'\\"',"'":"\\'","\\":"\\\\"};function s(e){for(var t,r=i.lastIndex=0,n="";t=i.exec(e);)n+=e.slice(r,t.index)+a[t[0]],r=i.lastIndex;return 0===r?"'"+e+"'":r<e.length?"'"+n+e.slice(r)+"'":"'"+n+"'"}function l(e,t){for(e=e.toString();e.length<t;)e="0"+e;return e}r.escapeId=function(e,t){if(Array.isArray(e)){for(var i="",a=0;a<e.length;a++)i+=(0===a?"":", ")+r.escapeId(e[a],t);return i}return t?"`"+String(e).replace(n,"``")+"`":"`"+String(e).replace(n,"``").replace(o,"`.`")+"`"},r.escape=function(e,t,n){if(null==e)return"NULL";switch(typeof e){case"boolean":return e?"true":"false";case"number":return e+"";case"object":return"[object Date]"===Object.prototype.toString.call(e)?r.dateToString(e,n||"local"):Array.isArray(e)?r.arrayToList(e,n):Buffer.isBuffer(e)?r.bufferToString(e):"function"==typeof e.toSqlString?String(e.toSqlString()):t?s(e.toString()):r.objectToValues(e,n);default:return s(e)}},r.arrayToList=function(e,t){for(var n="",o=0;o<e.length;o++){var i=e[o];Array.isArray(i)?n+=(0===o?"":", ")+"("+r.arrayToList(i,t)+")":n+=(0===o?"":", ")+r.escape(i,!0,t)}return n},r.format=function(e,t,n,o){if(null==t)return e;Array.isArray(t)||(t=[t]);for(var i,a=0,s=/\?+/g,l="",u=0;u<t.length&&(i=s.exec(e));){var c=i[0].length;if(!(c>2)){var p=2===c?r.escapeId(t[u]):r.escape(t[u],n,o);l+=e.slice(a,i.index)+p,a=s.lastIndex,u++}}return 0===a?e:a<e.length?l+e.slice(a):l},r.dateToString=function(e,t){var r,n,o,i,a,u,c,p=new Date(e);if(isNaN(p.getTime()))return"NULL";if("local"===t)r=p.getFullYear(),n=p.getMonth()+1,o=p.getDate(),i=p.getHours(),a=p.getMinutes(),u=p.getSeconds(),c=p.getMilliseconds();else{var f=function(e){if("Z"===e)return 0;var t=e.match(/([\+\-\s])(\d\d):?(\d\d)?/);if(t)return("-"===t[1]?-1:1)*(parseInt(t[2],10)+(t[3]?parseInt(t[3],10):0)/60)*60;return!1}(t);!1!==f&&0!==f&&p.setTime(p.getTime()+6e4*f),r=p.getUTCFullYear(),n=p.getUTCMonth()+1,o=p.getUTCDate(),i=p.getUTCHours(),a=p.getUTCMinutes(),u=p.getUTCSeconds(),c=p.getUTCMilliseconds()}return s(l(r,4)+"-"+l(n,2)+"-"+l(o,2)+" "+l(i,2)+":"+l(a,2)+":"+l(u,2)+"."+l(c,3))},r.bufferToString=function(e){return"X"+s(e.toString("hex"))},r.objectToValues=function(e,t){var n="";for(var o in e){var i=e[o];"function"!=typeof i&&(n+=(0===n.length?"":", ")+r.escapeId(o)+" = "+r.escape(i,!0,t))}return n},r.raw=function(e){if("string"!=typeof e)throw new TypeError("argument sql must be a string");return{toSqlString:function(){return e}}}},9556:(e,t,r)=>{"use strict";r.d(t,{$0:()=>O,AY:()=>E,Hp:()=>c,IP:()=>p,LE:()=>y,MB:()=>n,NY:()=>o,Nm:()=>S,bE:()=>u,d_:()=>i,fY:()=>l,jQ:()=>s,k8:()=>d,mz:()=>b,rT:()=>a,tS:()=>m,tv:()=>g,w2:()=>v,wQ:()=>h,wi:()=>_,y6:()=>f});const n="en-US",o="fr-FR",i="es-ES",a="de-DE",s="pt-BR",l="zh-Hans",u="it-IT",c="ja-JP",p="id-ID",f="ko-KR",d="ru-RU",v="cs-CZ",h="nl-NL",g="hu-HU",y="pt-PT",m="pl-PL",O="sv-SE",b="tr-TR",E="zh-Hant",S=n,_="pseudo"},7314:(e,t,r)=>{"use strict";r.d(t,{x6:()=>Me,t:()=>Ve});var n=r(9728);const o=e=>"string"==typeof e,i=()=>{let e,t;const r=new Promise(((r,n)=>{e=r,t=n}));return r.resolve=e,r.reject=t,r},a=e=>null==e?"":""+e,s=/###/g,l=e=>e&&e.indexOf("###")>-1?e.replace(s,"."):e,u=e=>!e||o(e),c=(e,t,r)=>{const n=o(t)?t.split("."):t;let i=0;for(;i<n.length-1;){if(u(e))return{};const t=l(n[i]);!e[t]&&r&&(e[t]=new r),e=Object.prototype.hasOwnProperty.call(e,t)?e[t]:{},++i}return u(e)?{}:{obj:e,k:l(n[i])}},p=(e,t,r)=>{const{obj:n,k:o}=c(e,t,Object);if(void 0!==n||1===t.length)return void(n[o]=r);let i=t[t.length-1],a=t.slice(0,t.length-1),s=c(e,a,Object);for(;void 0===s.obj&&a.length;)i=`${a[a.length-1]}.${i}`,a=a.slice(0,a.length-1),s=c(e,a,Object),s?.obj&&void 0!==s.obj[`${s.k}.${i}`]&&(s.obj=void 0);s.obj[`${s.k}.${i}`]=r},f=(e,t)=>{const{obj:r,k:n}=c(e,t);if(r&&Object.prototype.hasOwnProperty.call(r,n))return r[n]},d=(e,t,r)=>{for(const n in t)"__proto__"!==n&&"constructor"!==n&&(n in e?o(e[n])||e[n]instanceof String||o(t[n])||t[n]instanceof String?r&&(e[n]=t[n]):d(e[n],t[n],r):e[n]=t[n]);return e},v=e=>e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");var h={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};const g=e=>o(e)?e.replace(/[&<>"'\/]/g,(e=>h[e])):e;const y=[" ",",","?","!",";"],m=new class{constructor(e){this.capacity=e,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(e){const t=this.regExpMap.get(e);if(void 0!==t)return t;const r=new RegExp(e);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(e,r),this.regExpQueue.push(e),r}}(20),O=(e,t,r=".")=>{if(!e)return;if(e[t]){if(!Object.prototype.hasOwnProperty.call(e,t))return;return e[t]}const n=t.split(r);let o=e;for(let e=0;e<n.length;){if(!o||"object"!=typeof o)return;let t,i="";for(let a=e;a<n.length;++a)if(a!==e&&(i+=r),i+=n[a],t=o[i],void 0!==t){if(["string","number","boolean"].indexOf(typeof t)>-1&&a<n.length-1)continue;e+=a-e+1;break}o=t}return o},b=e=>e?.replace("_","-"),E={type:"logger",log(e){this.output("log",e)},warn(e){this.output("warn",e)},error(e){this.output("error",e)},output(e,t){console?.[e]?.apply?.(console,t)}};class S{constructor(e,t={}){this.init(e,t)}init(e,t={}){this.prefix=t.prefix||"i18next:",this.logger=e||E,this.options=t,this.debug=t.debug}log(...e){return this.forward(e,"log","",!0)}warn(...e){return this.forward(e,"warn","",!0)}error(...e){return this.forward(e,"error","")}deprecate(...e){return this.forward(e,"warn","WARNING DEPRECATED: ",!0)}forward(e,t,r,n){return n&&!this.debug?null:(o(e[0])&&(e[0]=`${r}${this.prefix} ${e[0]}`),this.logger[t](e))}create(e){return new S(this.logger,{prefix:`${this.prefix}:${e}:`,...this.options})}clone(e){return(e=e||this.options).prefix=e.prefix||this.prefix,new S(this.logger,e)}}var _=new S;class T{constructor(){this.observers={}}on(e,t){return e.split(" ").forEach((e=>{this.observers[e]||(this.observers[e]=new Map);const r=this.observers[e].get(t)||0;this.observers[e].set(t,r+1)})),this}off(e,t){this.observers[e]&&(t?this.observers[e].delete(t):delete this.observers[e])}emit(e,...t){if(this.observers[e]){Array.from(this.observers[e].entries()).forEach((([e,r])=>{for(let n=0;n<r;n++)e(...t)}))}if(this.observers["*"]){Array.from(this.observers["*"].entries()).forEach((([r,n])=>{for(let o=0;o<n;o++)r.apply(r,[e,...t])}))}}}class R extends T{constructor(e,t={ns:["translation"],defaultNS:"translation"}){super(),this.data=e||{},this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),void 0===this.options.ignoreJSONStructure&&(this.options.ignoreJSONStructure=!0)}addNamespaces(e){this.options.ns.indexOf(e)<0&&this.options.ns.push(e)}removeNamespaces(e){const t=this.options.ns.indexOf(e);t>-1&&this.options.ns.splice(t,1)}getResource(e,t,r,n={}){const i=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,a=void 0!==n.ignoreJSONStructure?n.ignoreJSONStructure:this.options.ignoreJSONStructure;let s;e.indexOf(".")>-1?s=e.split("."):(s=[e,t],r&&(Array.isArray(r)?s.push(...r):o(r)&&i?s.push(...r.split(i)):s.push(r)));const l=f(this.data,s);return!l&&!t&&!r&&e.indexOf(".")>-1&&(e=s[0],t=s[1],r=s.slice(2).join(".")),!l&&a&&o(r)?O(this.data?.[e]?.[t],r,i):l}addResource(e,t,r,n,o={silent:!1}){const i=void 0!==o.keySeparator?o.keySeparator:this.options.keySeparator;let a=[e,t];r&&(a=a.concat(i?r.split(i):r)),e.indexOf(".")>-1&&(a=e.split("."),n=t,t=a[1]),this.addNamespaces(t),p(this.data,a,n),o.silent||this.emit("added",e,t,r,n)}addResources(e,t,r,n={silent:!1}){for(const n in r)(o(r[n])||Array.isArray(r[n]))&&this.addResource(e,t,n,r[n],{silent:!0});n.silent||this.emit("added",e,t,r)}addResourceBundle(e,t,r,n,o,i={silent:!1,skipCopy:!1}){let a=[e,t];e.indexOf(".")>-1&&(a=e.split("."),n=r,r=t,t=a[1]),this.addNamespaces(t);let s=f(this.data,a)||{};i.skipCopy||(r=JSON.parse(JSON.stringify(r))),n?d(s,r,o):s={...s,...r},p(this.data,a,s),i.silent||this.emit("added",e,t,r)}removeResourceBundle(e,t){this.hasResourceBundle(e,t)&&delete this.data[e][t],this.removeNamespaces(t),this.emit("removed",e,t)}hasResourceBundle(e,t){return void 0!==this.getResource(e,t)}getResourceBundle(e,t){return t||(t=this.options.defaultNS),this.getResource(e,t)}getDataByLanguage(e){return this.data[e]}hasLanguageSomeTranslations(e){const t=this.getDataByLanguage(e);return!!(t&&Object.keys(t)||[]).find((e=>t[e]&&Object.keys(t[e]).length>0))}toJSON(){return this.data}}var w={processors:{},addPostProcessor(e){this.processors[e.name]=e},handle(e,t,r,n,o){return e.forEach((e=>{t=this.processors[e]?.process(t,r,n,o)??t})),t}};const I={},L=e=>!o(e)&&"boolean"!=typeof e&&"number"!=typeof e;class C extends T{constructor(e,t={}){super(),((e,t,r)=>{e.forEach((e=>{t[e]&&(r[e]=t[e])}))})(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],e,this),this.options=t,void 0===this.options.keySeparator&&(this.options.keySeparator="."),this.logger=_.create("translator")}changeLanguage(e){e&&(this.language=e)}exists(e,t={interpolation:{}}){const r={...t};if(null==e)return!1;const n=this.resolve(e,r);return void 0!==n?.res}extractFromKey(e,t){let r=void 0!==t.nsSeparator?t.nsSeparator:this.options.nsSeparator;void 0===r&&(r=":");const n=void 0!==t.keySeparator?t.keySeparator:this.options.keySeparator;let i=t.ns||this.options.defaultNS||[];const a=r&&e.indexOf(r)>-1,s=!(this.options.userDefinedKeySeparator||t.keySeparator||this.options.userDefinedNsSeparator||t.nsSeparator||((e,t,r)=>{t=t||"",r=r||"";const n=y.filter((e=>t.indexOf(e)<0&&r.indexOf(e)<0));if(0===n.length)return!0;const o=m.getRegExp(`(${n.map((e=>"?"===e?"\\?":e)).join("|")})`);let i=!o.test(e);if(!i){const t=e.indexOf(r);t>0&&!o.test(e.substring(0,t))&&(i=!0)}return i})(e,r,n));if(a&&!s){const t=e.match(this.interpolator.nestingRegexp);if(t&&t.length>0)return{key:e,namespaces:o(i)?[i]:i};const a=e.split(r);(r!==n||r===n&&this.options.ns.indexOf(a[0])>-1)&&(i=a.shift()),e=a.join(n)}return{key:e,namespaces:o(i)?[i]:i}}translate(e,t,r){let n="object"==typeof t?{...t}:t;if("object"!=typeof n&&this.options.overloadTranslationOptionHandler&&(n=this.options.overloadTranslationOptionHandler(arguments)),"object"==typeof options&&(n={...n}),n||(n={}),null==e)return"";Array.isArray(e)||(e=[String(e)]);const i=void 0!==n.returnDetails?n.returnDetails:this.options.returnDetails,a=void 0!==n.keySeparator?n.keySeparator:this.options.keySeparator,{key:s,namespaces:l}=this.extractFromKey(e[e.length-1],n),u=l[l.length-1];let c=void 0!==n.nsSeparator?n.nsSeparator:this.options.nsSeparator;void 0===c&&(c=":");const p=n.lng||this.language,f=n.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if("cimode"===p?.toLowerCase())return f?i?{res:`${u}${c}${s}`,usedKey:s,exactUsedKey:s,usedLng:p,usedNS:u,usedParams:this.getUsedParamsDetails(n)}:`${u}${c}${s}`:i?{res:s,usedKey:s,exactUsedKey:s,usedLng:p,usedNS:u,usedParams:this.getUsedParamsDetails(n)}:s;const d=this.resolve(e,n);let v=d?.res;const h=d?.usedKey||s,g=d?.exactUsedKey||s,y=void 0!==n.joinArrays?n.joinArrays:this.options.joinArrays,m=!this.i18nFormat||this.i18nFormat.handleAsObject,O=void 0!==n.count&&!o(n.count),b=C.hasDefaultValue(n),E=O?this.pluralResolver.getSuffix(p,n.count,n):"",S=n.ordinal&&O?this.pluralResolver.getSuffix(p,n.count,{ordinal:!1}):"",_=O&&!n.ordinal&&0===n.count,T=_&&n[`defaultValue${this.options.pluralSeparator}zero`]||n[`defaultValue${E}`]||n[`defaultValue${S}`]||n.defaultValue;let R=v;m&&!v&&b&&(R=T);const w=L(R),I=Object.prototype.toString.apply(R);if(!(m&&R&&w&&["[object Number]","[object Function]","[object RegExp]"].indexOf(I)<0)||o(y)&&Array.isArray(R))if(m&&o(y)&&Array.isArray(v))v=v.join(y),v&&(v=this.extendTranslation(v,e,n,r));else{let t=!1,o=!1;!this.isValidLookup(v)&&b&&(t=!0,v=T),this.isValidLookup(v)||(o=!0,v=s);const i=(n.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&o?void 0:v,l=b&&T!==v&&this.options.updateMissing;if(o||t||l){if(this.logger.log(l?"updateKey":"missingKey",p,u,s,l?T:v),a){const e=this.resolve(s,{...n,keySeparator:!1});e&&e.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let e=[];const t=this.languageUtils.getFallbackCodes(this.options.fallbackLng,n.lng||this.language);if("fallback"===this.options.saveMissingTo&&t&&t[0])for(let r=0;r<t.length;r++)e.push(t[r]);else"all"===this.options.saveMissingTo?e=this.languageUtils.toResolveHierarchy(n.lng||this.language):e.push(n.lng||this.language);const r=(e,t,r)=>{const o=b&&r!==v?r:i;this.options.missingKeyHandler?this.options.missingKeyHandler(e,u,t,o,l,n):this.backendConnector?.saveMissing&&this.backendConnector.saveMissing(e,u,t,o,l,n),this.emit("missingKey",e,u,t,v)};this.options.saveMissing&&(this.options.saveMissingPlurals&&O?e.forEach((e=>{const t=this.pluralResolver.getSuffixes(e,n);_&&n[`defaultValue${this.options.pluralSeparator}zero`]&&t.indexOf(`${this.options.pluralSeparator}zero`)<0&&t.push(`${this.options.pluralSeparator}zero`),t.forEach((t=>{r([e],s+t,n[`defaultValue${t}`]||T)}))})):r(e,s,T))}v=this.extendTranslation(v,e,n,d,r),o&&v===s&&this.options.appendNamespaceToMissingKey&&(v=`${u}${c}${s}`),(o||t)&&this.options.parseMissingKeyHandler&&(v=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${u}${c}${s}`:s,t?v:void 0,n))}else{if(!n.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const e=this.options.returnedObjectHandler?this.options.returnedObjectHandler(h,R,{...n,ns:l}):`key '${s} (${this.language})' returned an object instead of string.`;return i?(d.res=e,d.usedParams=this.getUsedParamsDetails(n),d):e}if(a){const e=Array.isArray(R),t=e?[]:{},r=e?g:h;for(const e in R)if(Object.prototype.hasOwnProperty.call(R,e)){const o=`${r}${a}${e}`;t[e]=b&&!v?this.translate(o,{...n,defaultValue:L(T)?T[e]:void 0,joinArrays:!1,ns:l}):this.translate(o,{...n,joinArrays:!1,ns:l}),t[e]===o&&(t[e]=R[e])}v=t}}return i?(d.res=v,d.usedParams=this.getUsedParamsDetails(n),d):v}extendTranslation(e,t,r,n,i){if(this.i18nFormat?.parse)e=this.i18nFormat.parse(e,{...this.options.interpolation.defaultVariables,...r},r.lng||this.language||n.usedLng,n.usedNS,n.usedKey,{resolved:n});else if(!r.skipInterpolation){r.interpolation&&this.interpolator.init({...r,interpolation:{...this.options.interpolation,...r.interpolation}});const a=o(e)&&(void 0!==r?.interpolation?.skipOnVariables?r.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let s;if(a){const t=e.match(this.interpolator.nestingRegexp);s=t&&t.length}let l=r.replace&&!o(r.replace)?r.replace:r;if(this.options.interpolation.defaultVariables&&(l={...this.options.interpolation.defaultVariables,...l}),e=this.interpolator.interpolate(e,l,r.lng||this.language||n.usedLng,r),a){const t=e.match(this.interpolator.nestingRegexp);s<(t&&t.length)&&(r.nest=!1)}!r.lng&&n&&n.res&&(r.lng=this.language||n.usedLng),!1!==r.nest&&(e=this.interpolator.nest(e,((...e)=>i?.[0]!==e[0]||r.context?this.translate(...e,t):(this.logger.warn(`It seems you are nesting recursively key: ${e[0]} in key: ${t[0]}`),null)),r)),r.interpolation&&this.interpolator.reset()}const a=r.postProcess||this.options.postProcess,s=o(a)?[a]:a;return null!=e&&s?.length&&!1!==r.applyPostProcessor&&(e=w.handle(s,e,t,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...n,usedParams:this.getUsedParamsDetails(r)},...r}:r,this)),e}resolve(e,t={}){let r,n,i,a,s;return o(e)&&(e=[e]),e.forEach((e=>{if(this.isValidLookup(r))return;const l=this.extractFromKey(e,t),u=l.key;n=u;let c=l.namespaces;this.options.fallbackNS&&(c=c.concat(this.options.fallbackNS));const p=void 0!==t.count&&!o(t.count),f=p&&!t.ordinal&&0===t.count,d=void 0!==t.context&&(o(t.context)||"number"==typeof t.context)&&""!==t.context,v=t.lngs?t.lngs:this.languageUtils.toResolveHierarchy(t.lng||this.language,t.fallbackLng);c.forEach((e=>{this.isValidLookup(r)||(s=e,I[`${v[0]}-${e}`]||!this.utils?.hasLoadedNamespace||this.utils?.hasLoadedNamespace(s)||(I[`${v[0]}-${e}`]=!0,this.logger.warn(`key "${n}" for languages "${v.join(", ")}" won't get resolved as namespace "${s}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),v.forEach((n=>{if(this.isValidLookup(r))return;a=n;const o=[u];if(this.i18nFormat?.addLookupKeys)this.i18nFormat.addLookupKeys(o,u,n,e,t);else{let e;p&&(e=this.pluralResolver.getSuffix(n,t.count,t));const r=`${this.options.pluralSeparator}zero`,i=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(p&&(o.push(u+e),t.ordinal&&0===e.indexOf(i)&&o.push(u+e.replace(i,this.options.pluralSeparator)),f&&o.push(u+r)),d){const n=`${u}${this.options.contextSeparator}${t.context}`;o.push(n),p&&(o.push(n+e),t.ordinal&&0===e.indexOf(i)&&o.push(n+e.replace(i,this.options.pluralSeparator)),f&&o.push(n+r))}}let s;for(;s=o.pop();)this.isValidLookup(r)||(i=s,r=this.getResource(n,e,s,t))})))}))})),{res:r,usedKey:n,exactUsedKey:i,usedLng:a,usedNS:s}}isValidLookup(e){return!(void 0===e||!this.options.returnNull&&null===e||!this.options.returnEmptyString&&""===e)}getResource(e,t,r,n={}){return this.i18nFormat?.getResource?this.i18nFormat.getResource(e,t,r,n):this.resourceStore.getResource(e,t,r,n)}getUsedParamsDetails(e={}){const t=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],r=e.replace&&!o(e.replace);let n=r?e.replace:e;if(r&&void 0!==e.count&&(n.count=e.count),this.options.interpolation.defaultVariables&&(n={...this.options.interpolation.defaultVariables,...n}),!r){n={...n};for(const e of t)delete n[e]}return n}static hasDefaultValue(e){const t="defaultValue";for(const r in e)if(Object.prototype.hasOwnProperty.call(e,r)&&t===r.substring(0,12)&&void 0!==e[r])return!0;return!1}}class A{constructor(e){this.options=e,this.supportedLngs=this.options.supportedLngs||!1,this.logger=_.create("languageUtils")}getScriptPartFromCode(e){if(!(e=b(e))||e.indexOf("-")<0)return null;const t=e.split("-");return 2===t.length?null:(t.pop(),"x"===t[t.length-1].toLowerCase()?null:this.formatLanguageCode(t.join("-")))}getLanguagePartFromCode(e){if(!(e=b(e))||e.indexOf("-")<0)return e;const t=e.split("-");return this.formatLanguageCode(t[0])}formatLanguageCode(e){if(o(e)&&e.indexOf("-")>-1){let t;try{t=Intl.getCanonicalLocales(e)[0]}catch(e){}return t&&this.options.lowerCaseLng&&(t=t.toLowerCase()),t||(this.options.lowerCaseLng?e.toLowerCase():e)}return this.options.cleanCode||this.options.lowerCaseLng?e.toLowerCase():e}isSupportedCode(e){return("languageOnly"===this.options.load||this.options.nonExplicitSupportedLngs)&&(e=this.getLanguagePartFromCode(e)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(e)>-1}getBestMatchFromCodes(e){if(!e)return null;let t;return e.forEach((e=>{if(t)return;const r=this.formatLanguageCode(e);this.options.supportedLngs&&!this.isSupportedCode(r)||(t=r)})),!t&&this.options.supportedLngs&&e.forEach((e=>{if(t)return;const r=this.getScriptPartFromCode(e);if(this.isSupportedCode(r))return t=r;const n=this.getLanguagePartFromCode(e);if(this.isSupportedCode(n))return t=n;t=this.options.supportedLngs.find((e=>e===n?e:e.indexOf("-")<0&&n.indexOf("-")<0?void 0:e.indexOf("-")>0&&n.indexOf("-")<0&&e.substring(0,e.indexOf("-"))===n||0===e.indexOf(n)&&n.length>1?e:void 0))})),t||(t=this.getFallbackCodes(this.options.fallbackLng)[0]),t}getFallbackCodes(e,t){if(!e)return[];if("function"==typeof e&&(e=e(t)),o(e)&&(e=[e]),Array.isArray(e))return e;if(!t)return e.default||[];let r=e[t];return r||(r=e[this.getScriptPartFromCode(t)]),r||(r=e[this.formatLanguageCode(t)]),r||(r=e[this.getLanguagePartFromCode(t)]),r||(r=e.default),r||[]}toResolveHierarchy(e,t){const r=this.getFallbackCodes((!1===t?[]:t)||this.options.fallbackLng||[],e),n=[],i=e=>{e&&(this.isSupportedCode(e)?n.push(e):this.logger.warn(`rejecting language code not found in supportedLngs: ${e}`))};return o(e)&&(e.indexOf("-")>-1||e.indexOf("_")>-1)?("languageOnly"!==this.options.load&&i(this.formatLanguageCode(e)),"languageOnly"!==this.options.load&&"currentOnly"!==this.options.load&&i(this.getScriptPartFromCode(e)),"currentOnly"!==this.options.load&&i(this.getLanguagePartFromCode(e))):o(e)&&i(this.formatLanguageCode(e)),r.forEach((e=>{n.indexOf(e)<0&&i(this.formatLanguageCode(e))})),n}}const x={zero:0,one:1,two:2,few:3,many:4,other:5},N={select:e=>1===e?"one":"other",resolvedOptions:()=>({pluralCategories:["one","other"]})};class j{constructor(e,t={}){this.languageUtils=e,this.options=t,this.logger=_.create("pluralResolver"),this.pluralRulesCache={}}addRule(e,t){this.rules[e]=t}clearCache(){this.pluralRulesCache={}}getRule(e,t={}){const r=b("dev"===e?"en":e),n=t.ordinal?"ordinal":"cardinal",o=JSON.stringify({cleanedCode:r,type:n});if(o in this.pluralRulesCache)return this.pluralRulesCache[o];let i;try{i=new Intl.PluralRules(r,{type:n})}catch(r){if(!Intl)return this.logger.error("No Intl support, please use an Intl polyfill!"),N;if(!e.match(/-|_/))return N;const n=this.languageUtils.getLanguagePartFromCode(e);i=this.getRule(n,t)}return this.pluralRulesCache[o]=i,i}needsPlural(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?.resolvedOptions().pluralCategories.length>1}getPluralFormsOfKey(e,t,r={}){return this.getSuffixes(e,r).map((e=>`${t}${e}`))}getSuffixes(e,t={}){let r=this.getRule(e,t);return r||(r=this.getRule("dev",t)),r?r.resolvedOptions().pluralCategories.sort(((e,t)=>x[e]-x[t])).map((e=>`${this.options.prepend}${t.ordinal?`ordinal${this.options.prepend}`:""}${e}`)):[]}getSuffix(e,t,r={}){const n=this.getRule(e,r);return n?`${this.options.prepend}${r.ordinal?`ordinal${this.options.prepend}`:""}${n.select(t)}`:(this.logger.warn(`no plural rule found for: ${e}`),this.getSuffix("dev",t,r))}}const F=(e,t,r,n=".",i=!0)=>{let a=((e,t,r)=>{const n=f(e,r);return void 0!==n?n:f(t,r)})(e,t,r);return!a&&i&&o(r)&&(a=O(e,r,n),void 0===a&&(a=O(t,r,n))),a},P=e=>e.replace(/\$/g,"$$$$");class k{constructor(e={}){this.logger=_.create("interpolator"),this.options=e,this.format=e?.interpolation?.format||(e=>e),this.init(e)}init(e={}){e.interpolation||(e.interpolation={escapeValue:!0});const{escape:t,escapeValue:r,useRawValueToEscape:n,prefix:o,prefixEscaped:i,suffix:a,suffixEscaped:s,formatSeparator:l,unescapeSuffix:u,unescapePrefix:c,nestingPrefix:p,nestingPrefixEscaped:f,nestingSuffix:d,nestingSuffixEscaped:h,nestingOptionsSeparator:y,maxReplaces:m,alwaysFormat:O}=e.interpolation;this.escape=void 0!==t?t:g,this.escapeValue=void 0===r||r,this.useRawValueToEscape=void 0!==n&&n,this.prefix=o?v(o):i||"{{",this.suffix=a?v(a):s||"}}",this.formatSeparator=l||",",this.unescapePrefix=u?"":c||"-",this.unescapeSuffix=this.unescapePrefix?"":u||"",this.nestingPrefix=p?v(p):f||v("$t("),this.nestingSuffix=d?v(d):h||v(")"),this.nestingOptionsSeparator=y||",",this.maxReplaces=m||1e3,this.alwaysFormat=void 0!==O&&O,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const e=(e,t)=>e?.source===t?(e.lastIndex=0,e):new RegExp(t,"g");this.regexp=e(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=e(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=e(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(e,t,r,n){let i,s,l;const u=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{},c=e=>{if(e.indexOf(this.formatSeparator)<0){const o=F(t,u,e,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(o,void 0,r,{...n,...t,interpolationkey:e}):o}const o=e.split(this.formatSeparator),i=o.shift().trim(),a=o.join(this.formatSeparator).trim();return this.format(F(t,u,i,this.options.keySeparator,this.options.ignoreJSONStructure),a,r,{...n,...t,interpolationkey:i})};this.resetRegExp();const p=n?.missingInterpolationHandler||this.options.missingInterpolationHandler,f=void 0!==n?.interpolation?.skipOnVariables?n.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:e=>P(e)},{regex:this.regexp,safeValue:e=>this.escapeValue?P(this.escape(e)):P(e)}].forEach((t=>{for(l=0;i=t.regex.exec(e);){const r=i[1].trim();if(s=c(r),void 0===s)if("function"==typeof p){const t=p(e,i,n);s=o(t)?t:""}else if(n&&Object.prototype.hasOwnProperty.call(n,r))s="";else{if(f){s=i[0];continue}this.logger.warn(`missed to pass in variable ${r} for interpolating ${e}`),s=""}else o(s)||this.useRawValueToEscape||(s=a(s));const u=t.safeValue(s);if(e=e.replace(i[0],u),f?(t.regex.lastIndex+=s.length,t.regex.lastIndex-=i[0].length):t.regex.lastIndex=0,l++,l>=this.maxReplaces)break}})),e}nest(e,t,r={}){let n,i,s;const l=(e,t)=>{const r=this.nestingOptionsSeparator;if(e.indexOf(r)<0)return e;const n=e.split(new RegExp(`${r}[ ]*{`));let o=`{${n[1]}`;e=n[0],o=this.interpolate(o,s);const i=o.match(/'/g),a=o.match(/"/g);((i?.length??0)%2==0&&!a||a.length%2!=0)&&(o=o.replace(/'/g,'"'));try{s=JSON.parse(o),t&&(s={...t,...s})}catch(t){return this.logger.warn(`failed parsing options string in nesting for key ${e}`,t),`${e}${r}${o}`}return s.defaultValue&&s.defaultValue.indexOf(this.prefix)>-1&&delete s.defaultValue,e};for(;n=this.nestingRegexp.exec(e);){let u=[];s={...r},s=s.replace&&!o(s.replace)?s.replace:s,s.applyPostProcessor=!1,delete s.defaultValue;const c=/{.*}/.test(n[1])?n[1].lastIndexOf("}")+1:n[1].indexOf(this.formatSeparator);if(-1!==c&&(u=n[1].slice(c).split(this.formatSeparator).map((e=>e.trim())).filter(Boolean),n[1]=n[1].slice(0,c)),i=t(l.call(this,n[1].trim(),s),s),i&&n[0]===e&&!o(i))return i;o(i)||(i=a(i)),i||(this.logger.warn(`missed to resolve ${n[1]} for nesting ${e}`),i=""),u.length&&(i=u.reduce(((e,t)=>this.format(e,t,r.lng,{...r,interpolationkey:n[1].trim()})),i.trim())),e=e.replace(n[0],i),this.regexp.lastIndex=0}return e}}const D=e=>{const t={};return(r,n,o)=>{let i=o;o&&o.interpolationkey&&o.formatParams&&o.formatParams[o.interpolationkey]&&o[o.interpolationkey]&&(i={...i,[o.interpolationkey]:void 0});const a=n+JSON.stringify(i);let s=t[a];return s||(s=e(b(n),o),t[a]=s),s(r)}},V=e=>(t,r,n)=>e(b(r),n)(t);class M{constructor(e={}){this.logger=_.create("formatter"),this.options=e,this.init(e)}init(e,t={interpolation:{}}){this.formatSeparator=t.interpolation.formatSeparator||",";const r=t.cacheInBuiltFormats?D:V;this.formats={number:r(((e,t)=>{const r=new Intl.NumberFormat(e,{...t});return e=>r.format(e)})),currency:r(((e,t)=>{const r=new Intl.NumberFormat(e,{...t,style:"currency"});return e=>r.format(e)})),datetime:r(((e,t)=>{const r=new Intl.DateTimeFormat(e,{...t});return e=>r.format(e)})),relativetime:r(((e,t)=>{const r=new Intl.RelativeTimeFormat(e,{...t});return e=>r.format(e,t.range||"day")})),list:r(((e,t)=>{const r=new Intl.ListFormat(e,{...t});return e=>r.format(e)}))}}add(e,t){this.formats[e.toLowerCase().trim()]=t}addCached(e,t){this.formats[e.toLowerCase().trim()]=D(t)}format(e,t,r,n={}){const o=t.split(this.formatSeparator);if(o.length>1&&o[0].indexOf("(")>1&&o[0].indexOf(")")<0&&o.find((e=>e.indexOf(")")>-1))){const e=o.findIndex((e=>e.indexOf(")")>-1));o[0]=[o[0],...o.splice(1,e)].join(this.formatSeparator)}return o.reduce(((e,t)=>{const{formatName:o,formatOptions:i}=(e=>{let t=e.toLowerCase().trim();const r={};if(e.indexOf("(")>-1){const n=e.split("(");t=n[0].toLowerCase().trim();const o=n[1].substring(0,n[1].length-1);"currency"===t&&o.indexOf(":")<0?r.currency||(r.currency=o.trim()):"relativetime"===t&&o.indexOf(":")<0?r.range||(r.range=o.trim()):o.split(";").forEach((e=>{if(e){const[t,...n]=e.split(":"),o=n.join(":").trim().replace(/^'+|'+$/g,""),i=t.trim();r[i]||(r[i]=o),"false"===o&&(r[i]=!1),"true"===o&&(r[i]=!0),isNaN(o)||(r[i]=parseInt(o,10))}}))}return{formatName:t,formatOptions:r}})(t);if(this.formats[o]){let t=e;try{const a=n?.formatParams?.[n.interpolationkey]||{},s=a.locale||a.lng||n.locale||n.lng||r;t=this.formats[o](e,s,{...i,...n,...a})}catch(e){this.logger.warn(e)}return t}return this.logger.warn(`there was no format function for ${o}`),e}),e)}}class U extends T{constructor(e,t,r,n={}){super(),this.backend=e,this.store=t,this.services=r,this.languageUtils=r.languageUtils,this.options=n,this.logger=_.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=n.maxParallelReads||10,this.readingCalls=0,this.maxRetries=n.maxRetries>=0?n.maxRetries:5,this.retryTimeout=n.retryTimeout>=1?n.retryTimeout:350,this.state={},this.queue=[],this.backend?.init?.(r,n.backend,n)}queueLoad(e,t,r,n){const o={},i={},a={},s={};return e.forEach((e=>{let n=!0;t.forEach((t=>{const a=`${e}|${t}`;!r.reload&&this.store.hasResourceBundle(e,t)?this.state[a]=2:this.state[a]<0||(1===this.state[a]?void 0===i[a]&&(i[a]=!0):(this.state[a]=1,n=!1,void 0===i[a]&&(i[a]=!0),void 0===o[a]&&(o[a]=!0),void 0===s[t]&&(s[t]=!0)))})),n||(a[e]=!0)})),(Object.keys(o).length||Object.keys(i).length)&&this.queue.push({pending:i,pendingCount:Object.keys(i).length,loaded:{},errors:[],callback:n}),{toLoad:Object.keys(o),pending:Object.keys(i),toLoadLanguages:Object.keys(a),toLoadNamespaces:Object.keys(s)}}loaded(e,t,r){const n=e.split("|"),o=n[0],i=n[1];t&&this.emit("failedLoading",o,i,t),!t&&r&&this.store.addResourceBundle(o,i,r,void 0,void 0,{skipCopy:!0}),this.state[e]=t?-1:2,t&&r&&(this.state[e]=0);const a={};this.queue.forEach((r=>{((e,t,r)=>{const{obj:n,k:o}=c(e,t,Object);n[o]=n[o]||[],n[o].push(r)})(r.loaded,[o],i),((e,t)=>{void 0!==e.pending[t]&&(delete e.pending[t],e.pendingCount--)})(r,e),t&&r.errors.push(t),0!==r.pendingCount||r.done||(Object.keys(r.loaded).forEach((e=>{a[e]||(a[e]={});const t=r.loaded[e];t.length&&t.forEach((t=>{void 0===a[e][t]&&(a[e][t]=!0)}))})),r.done=!0,r.errors.length?r.callback(r.errors):r.callback())})),this.emit("loaded",a),this.queue=this.queue.filter((e=>!e.done))}read(e,t,r,n=0,o=this.retryTimeout,i){if(!e.length)return i(null,{});if(this.readingCalls>=this.maxParallelReads)return void this.waitingReads.push({lng:e,ns:t,fcName:r,tried:n,wait:o,callback:i});this.readingCalls++;const a=(a,s)=>{if(this.readingCalls--,this.waitingReads.length>0){const e=this.waitingReads.shift();this.read(e.lng,e.ns,e.fcName,e.tried,e.wait,e.callback)}a&&s&&n<this.maxRetries?setTimeout((()=>{this.read.call(this,e,t,r,n+1,2*o,i)}),o):i(a,s)},s=this.backend[r].bind(this.backend);if(2!==s.length)return s(e,t,a);try{const r=s(e,t);r&&"function"==typeof r.then?r.then((e=>a(null,e))).catch(a):a(null,r)}catch(e){a(e)}}prepareLoading(e,t,r={},n){if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),n&&n();o(e)&&(e=this.languageUtils.toResolveHierarchy(e)),o(t)&&(t=[t]);const i=this.queueLoad(e,t,r,n);if(!i.toLoad.length)return i.pending.length||n(),null;i.toLoad.forEach((e=>{this.loadOne(e)}))}load(e,t,r){this.prepareLoading(e,t,{},r)}reload(e,t,r){this.prepareLoading(e,t,{reload:!0},r)}loadOne(e,t=""){const r=e.split("|"),n=r[0],o=r[1];this.read(n,o,"read",void 0,void 0,((r,i)=>{r&&this.logger.warn(`${t}loading namespace ${o} for language ${n} failed`,r),!r&&i&&this.logger.log(`${t}loaded namespace ${o} for language ${n}`,i),this.loaded(e,r,i)}))}saveMissing(e,t,r,n,o,i={},a=()=>{}){if(!this.services?.utils?.hasLoadedNamespace||this.services?.utils?.hasLoadedNamespace(t)){if(null!=r&&""!==r){if(this.backend?.create){const s={...i,isUpdate:o},l=this.backend.create.bind(this.backend);if(l.length<6)try{let o;o=5===l.length?l(e,t,r,n,s):l(e,t,r,n),o&&"function"==typeof o.then?o.then((e=>a(null,e))).catch(a):a(null,o)}catch(e){a(e)}else l(e,t,r,n,a,s)}e&&e[0]&&this.store.addResource(e[0],t,r,n)}}else this.logger.warn(`did not save key "${r}" as the namespace "${t}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")}}const B=()=>({debug:!1,initAsync:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:e=>{let t={};if("object"==typeof e[1]&&(t=e[1]),o(e[1])&&(t.defaultValue=e[1]),o(e[2])&&(t.tDescription=e[2]),"object"==typeof e[2]||"object"==typeof e[3]){const r=e[3]||e[2];Object.keys(r).forEach((e=>{t[e]=r[e]}))}return t},interpolation:{escapeValue:!0,format:e=>e,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0},cacheInBuiltFormats:!0}),q=e=>(o(e.ns)&&(e.ns=[e.ns]),o(e.fallbackLng)&&(e.fallbackLng=[e.fallbackLng]),o(e.fallbackNS)&&(e.fallbackNS=[e.fallbackNS]),e.supportedLngs?.indexOf?.("cimode")<0&&(e.supportedLngs=e.supportedLngs.concat(["cimode"])),"boolean"==typeof e.initImmediate&&(e.initAsync=e.initImmediate),e),G=()=>{};class K extends T{constructor(e={},t){var r;if(super(),this.options=q(e),this.services={},this.logger=_,this.modules={external:[]},r=this,Object.getOwnPropertyNames(Object.getPrototypeOf(r)).forEach((e=>{"function"==typeof r[e]&&(r[e]=r[e].bind(r))})),t&&!this.isInitialized&&!e.isClone){if(!this.options.initAsync)return this.init(e,t),this;setTimeout((()=>{this.init(e,t)}),0)}}init(e={},t){this.isInitializing=!0,"function"==typeof e&&(t=e,e={}),null==e.defaultNS&&e.ns&&(o(e.ns)?e.defaultNS=e.ns:e.ns.indexOf("translation")<0&&(e.defaultNS=e.ns[0]));const r=B();this.options={...r,...this.options,...q(e)},this.options.interpolation={...r.interpolation,...this.options.interpolation},void 0!==e.keySeparator&&(this.options.userDefinedKeySeparator=e.keySeparator),void 0!==e.nsSeparator&&(this.options.userDefinedNsSeparator=e.nsSeparator);const n=e=>e?"function"==typeof e?new e:e:null;if(!this.options.isClone){let e;this.modules.logger?_.init(n(this.modules.logger),this.options):_.init(null,this.options),e=this.modules.formatter?this.modules.formatter:M;const t=new A(this.options);this.store=new R(this.options.resources,this.options);const o=this.services;o.logger=_,o.resourceStore=this.store,o.languageUtils=t,o.pluralResolver=new j(t,{prepend:this.options.pluralSeparator,simplifyPluralSuffix:this.options.simplifyPluralSuffix});this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format&&this.logger.warn("init: you are still using the legacy format function, please use the new approach: https://www.i18next.com/translation-function/formatting"),!e||this.options.interpolation.format&&this.options.interpolation.format!==r.interpolation.format||(o.formatter=n(e),o.formatter.init&&o.formatter.init(o,this.options),this.options.interpolation.format=o.formatter.format.bind(o.formatter)),o.interpolator=new k(this.options),o.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},o.backendConnector=new U(n(this.modules.backend),o.resourceStore,o,this.options),o.backendConnector.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.languageDetector&&(o.languageDetector=n(this.modules.languageDetector),o.languageDetector.init&&o.languageDetector.init(o,this.options.detection,this.options)),this.modules.i18nFormat&&(o.i18nFormat=n(this.modules.i18nFormat),o.i18nFormat.init&&o.i18nFormat.init(this)),this.translator=new C(this.services,this.options),this.translator.on("*",((e,...t)=>{this.emit(e,...t)})),this.modules.external.forEach((e=>{e.init&&e.init(this)}))}if(this.format=this.options.interpolation.format,t||(t=G),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const e=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);e.length>0&&"dev"!==e[0]&&(this.options.lng=e[0])}this.services.languageDetector||this.options.lng||this.logger.warn("init: no languageDetector is used and no lng is defined");["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach((e=>{this[e]=(...t)=>this.store[e](...t)}));["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach((e=>{this[e]=(...t)=>(this.store[e](...t),this)}));const a=i(),s=()=>{const e=(e,r)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),a.resolve(r),t(e,r)};if(this.languages&&!this.isInitialized)return e(null,this.t.bind(this));this.changeLanguage(this.options.lng,e)};return this.options.resources||!this.options.initAsync?s():setTimeout(s,0),a}loadResources(e,t=G){let r=t;const n=o(e)?e:this.language;if("function"==typeof e&&(r=e),!this.options.resources||this.options.partialBundledLanguages){if("cimode"===n?.toLowerCase()&&(!this.options.preload||0===this.options.preload.length))return r();const e=[],t=t=>{if(!t)return;if("cimode"===t)return;this.services.languageUtils.toResolveHierarchy(t).forEach((t=>{"cimode"!==t&&e.indexOf(t)<0&&e.push(t)}))};if(n)t(n);else{this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach((e=>t(e)))}this.options.preload?.forEach?.((e=>t(e))),this.services.backendConnector.load(e,this.options.ns,(e=>{e||this.resolvedLanguage||!this.language||this.setResolvedLanguage(this.language),r(e)}))}else r(null)}reloadResources(e,t,r){const n=i();return"function"==typeof e&&(r=e,e=void 0),"function"==typeof t&&(r=t,t=void 0),e||(e=this.languages),t||(t=this.options.ns),r||(r=G),this.services.backendConnector.reload(e,t,(e=>{n.resolve(),r(e)})),n}use(e){if(!e)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!e.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return"backend"===e.type&&(this.modules.backend=e),("logger"===e.type||e.log&&e.warn&&e.error)&&(this.modules.logger=e),"languageDetector"===e.type&&(this.modules.languageDetector=e),"i18nFormat"===e.type&&(this.modules.i18nFormat=e),"postProcessor"===e.type&&w.addPostProcessor(e),"formatter"===e.type&&(this.modules.formatter=e),"3rdParty"===e.type&&this.modules.external.push(e),this}setResolvedLanguage(e){if(e&&this.languages&&!(["cimode","dev"].indexOf(e)>-1)){for(let e=0;e<this.languages.length;e++){const t=this.languages[e];if(!(["cimode","dev"].indexOf(t)>-1)&&this.store.hasLanguageSomeTranslations(t)){this.resolvedLanguage=t;break}}!this.resolvedLanguage&&this.languages.indexOf(e)<0&&this.store.hasLanguageSomeTranslations(e)&&(this.resolvedLanguage=e,this.languages.unshift(e))}}changeLanguage(e,t){this.isLanguageChangingTo=e;const r=i();this.emit("languageChanging",e);const n=e=>{this.language=e,this.languages=this.services.languageUtils.toResolveHierarchy(e),this.resolvedLanguage=void 0,this.setResolvedLanguage(e)},a=(o,i)=>{i?this.isLanguageChangingTo===e&&(n(i),this.translator.changeLanguage(i),this.isLanguageChangingTo=void 0,this.emit("languageChanged",i),this.logger.log("languageChanged",i)):this.isLanguageChangingTo=void 0,r.resolve(((...e)=>this.t(...e))),t&&t(o,((...e)=>this.t(...e)))},s=t=>{e||t||!this.services.languageDetector||(t=[]);const r=o(t)?t:t&&t[0],i=this.store.hasLanguageSomeTranslations(r)?r:this.services.languageUtils.getBestMatchFromCodes(o(t)?[t]:t);i&&(this.language||n(i),this.translator.language||this.translator.changeLanguage(i),this.services.languageDetector?.cacheUserLanguage?.(i)),this.loadResources(i,(e=>{a(e,i)}))};return e||!this.services.languageDetector||this.services.languageDetector.async?!e&&this.services.languageDetector&&this.services.languageDetector.async?0===this.services.languageDetector.detect.length?this.services.languageDetector.detect().then(s):this.services.languageDetector.detect(s):s(e):s(this.services.languageDetector.detect()),r}getFixedT(e,t,r){const n=(e,t,...o)=>{let i;i="object"!=typeof t?this.options.overloadTranslationOptionHandler([e,t].concat(o)):{...t},i.lng=i.lng||n.lng,i.lngs=i.lngs||n.lngs,i.ns=i.ns||n.ns,""!==i.keyPrefix&&(i.keyPrefix=i.keyPrefix||r||n.keyPrefix);const a=this.options.keySeparator||".";let s;return s=i.keyPrefix&&Array.isArray(e)?e.map((e=>`${i.keyPrefix}${a}${e}`)):i.keyPrefix?`${i.keyPrefix}${a}${e}`:e,this.t(s,i)};return o(e)?n.lng=e:n.lngs=e,n.ns=t,n.keyPrefix=r,n}t(...e){return this.translator?.translate(...e)}exists(...e){return this.translator?.exists(...e)}setDefaultNamespace(e){this.options.defaultNS=e}hasLoadedNamespace(e,t={}){if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const r=t.lng||this.resolvedLanguage||this.languages[0],n=!!this.options&&this.options.fallbackLng,o=this.languages[this.languages.length-1];if("cimode"===r.toLowerCase())return!0;const i=(e,t)=>{const r=this.services.backendConnector.state[`${e}|${t}`];return-1===r||0===r||2===r};if(t.precheck){const e=t.precheck(this,i);if(void 0!==e)return e}return!!this.hasResourceBundle(r,e)||(!(this.services.backendConnector.backend&&(!this.options.resources||this.options.partialBundledLanguages))||!(!i(r,e)||n&&!i(o,e)))}loadNamespaces(e,t){const r=i();return this.options.ns?(o(e)&&(e=[e]),e.forEach((e=>{this.options.ns.indexOf(e)<0&&this.options.ns.push(e)})),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}loadLanguages(e,t){const r=i();o(e)&&(e=[e]);const n=this.options.preload||[],a=e.filter((e=>n.indexOf(e)<0&&this.services.languageUtils.isSupportedCode(e)));return a.length?(this.options.preload=n.concat(a),this.loadResources((e=>{r.resolve(),t&&t(e)})),r):(t&&t(),Promise.resolve())}dir(e){if(e||(e=this.resolvedLanguage||(this.languages?.length>0?this.languages[0]:this.language)),!e)return"rtl";try{const t=new Intl.Locale(e);if(t&&t.getTextInfo){const e=t.getTextInfo();if(e&&e.direction)return e.direction}}catch(e){}const t=this.services?.languageUtils||new A(B());return e.toLowerCase().indexOf("-latn")>1?"ltr":["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"].indexOf(t.getLanguagePartFromCode(e))>-1||e.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(e={},t){return new K(e,t)}cloneInstance(e={},t=G){const r=e.forkResourceStore;r&&delete e.forkResourceStore;const n={...this.options,...e,isClone:!0},o=new K(n);void 0===e.debug&&void 0===e.prefix||(o.logger=o.logger.clone(e));if(["store","services","language"].forEach((e=>{o[e]=this[e]})),o.services={...this.services},o.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},r){const e=Object.keys(this.store.data).reduce(((e,t)=>(e[t]={...this.store.data[t]},e[t]=Object.keys(e[t]).reduce(((r,n)=>(r[n]={...e[t][n]},r)),e[t]),e)),{});o.store=new R(e,n),o.services.resourceStore=o.store}return o.translator=new C(o.services,n),o.translator.on("*",((e,...t)=>{o.emit(e,...t)})),o.init(n,t),o.translator.options=n,o.translator.backendConnector.services.utils={hasLoadedNamespace:o.hasLoadedNamespace.bind(o)},o}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const $=K.createInstance();$.createInstance=K.createInstance;$.createInstance,$.dir,$.init,$.loadResources,$.reloadResources,$.use,$.changeLanguage,$.getFixedT,$.t,$.exists,$.setDefaultNamespace,$.hasLoadedNamespace,$.loadNamespaces,$.loadLanguages;const{slice:W,forEach:z}=[];let H=!1;try{document.cookie,H=!0}catch(e){}const Y=["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"];H||Y.splice(1,1);var J=r(5959),X=r(627),Q=r.n(X),Z=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function ee(e){var t={type:"tag",name:"",voidElement:!1,attrs:{},children:[]},r=e.match(/<\/?([^\s]+?)[/\s>]/);if(r&&(t.name=r[1],(Q()[r[1]]||"/"===e.charAt(e.length-2))&&(t.voidElement=!0),t.name.startsWith("!--"))){var n=e.indexOf("--\x3e");return{type:"comment",comment:-1!==n?e.slice(4,n):""}}for(var o=new RegExp(Z),i=null;null!==(i=o.exec(e));)if(i[0].trim())if(i[1]){var a=i[1].trim(),s=[a,""];a.indexOf("=")>-1&&(s=a.split("=")),t.attrs[s[0]]=s[1],o.lastIndex--}else i[2]&&(t.attrs[i[2]]=i[3].trim().substring(1,i[3].length-1));return t}var te=/<[a-zA-Z0-9\-\!\/](?:"[^"]*"|'[^']*'|[^'">])*>/g,re=/^\s*$/,ne=Object.create(null);function oe(e,t){switch(t.type){case"text":return e+t.content;case"tag":return e+="<"+t.name+(t.attrs?function(e){var t=[];for(var r in e)t.push(r+'="'+e[r]+'"');return t.length?" "+t.join(" "):""}(t.attrs):"")+(t.voidElement?"/>":">"),t.voidElement?e:e+t.children.reduce(oe,"")+"</"+t.name+">";case"comment":return e+"\x3c!--"+t.comment+"--\x3e"}}var ie={parse:function(e,t){t||(t={}),t.components||(t.components=ne);var r,n=[],o=[],i=-1,a=!1;if(0!==e.indexOf("<")){var s=e.indexOf("<");n.push({type:"text",content:-1===s?e:e.substring(0,s)})}return e.replace(te,(function(s,l){if(a){if(s!=="</"+r.name+">")return;a=!1}var u,c="/"!==s.charAt(1),p=s.startsWith("\x3c!--"),f=l+s.length,d=e.charAt(f);if(p){var v=ee(s);return i<0?(n.push(v),n):((u=o[i]).children.push(v),n)}if(c&&(i++,"tag"===(r=ee(s)).type&&t.components[r.name]&&(r.type="component",a=!0),r.voidElement||a||!d||"<"===d||r.children.push({type:"text",content:e.slice(f,e.indexOf("<",f))}),0===i&&n.push(r),(u=o[i-1])&&u.children.push(r),o[i]=r),(!c||r.voidElement)&&(i>-1&&(r.voidElement||r.name===s.slice(2,-1))&&(i--,r=-1===i?n:o[i]),!a&&"<"!==d&&d)){u=-1===i?n:o[i].children;var h=e.indexOf("<",f),g=e.slice(f,-1===h?void 0:h);re.test(g)&&(g=" "),(h>-1&&i+u.length>=0||" "!==g)&&u.push({type:"text",content:g})}})),n},stringify:function(e){return e.reduce((function(e,t){return e+oe("",t)}),"")}};const ae=ie,se=(e,t,r,n)=>{const o=[r,{code:t,...n||{}}];if(e?.services?.logger?.forward)return e.services.logger.forward(o,"warn","react-i18next::",!0);ce(o[0])&&(o[0]=`react-i18next:: ${o[0]}`),e?.services?.logger?.warn?e.services.logger.warn(...o):console?.warn&&console.warn(...o)},le={},ue=(e,t,r,n)=>{ce(r)&&le[r]||(ce(r)&&(le[r]=new Date),se(e,t,r,n))},ce=e=>"string"==typeof e,pe=e=>"object"==typeof e&&null!==e,fe=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,de={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},ve=e=>de[e];let he={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:e=>e.replace(fe,ve)};const ge=()=>he;let ye;const me=()=>ye,Oe=(e,t)=>{if(!e)return!1;const r=e.props?.children??e.children;return t?r.length>0:!!r},be=e=>{if(!e)return[];const t=e.props?.children??e.children;return e.props?.i18nIsDynamicList?Ee(t):t},Ee=e=>Array.isArray(e)?e:[e],Se=(e,t,r,n)=>{if(!e)return"";let o="";const i=Ee(e),a=t?.transSupportBasicHtmlNodes?t.transKeepBasicHtmlNodesFor??[]:[];return i.forEach(((e,i)=>{if(ce(e))o+=`${e}`;else if((0,J.isValidElement)(e)){const{props:s,type:l}=e,u=Object.keys(s).length,c=a.indexOf(l)>-1,p=s.children;if(!p&&c&&!u)return void(o+=`<${l}/>`);if(!p&&(!c||u)||s.i18nIsDynamicList)return void(o+=`<${i}></${i}>`);if(c&&1===u&&ce(p))return void(o+=`<${l}>${p}</${l}>`);const f=Se(p,t,r,n);o+=`<${i}>${f}</${i}>`}else if(null!==e)if(pe(e)){const{format:t,...i}=e,a=Object.keys(i);if(1===a.length){const e=t?`${a[0]}, ${t}`:a[0];return void(o+=`{{${e}}}`)}se(r,"TRANS_INVALID_OBJ","Invalid child - Object should only have keys {{ value, format }} (format is optional).",{i18nKey:n,child:e})}else se(r,"TRANS_INVALID_VAR","Passed in a variable like {number} - pass variables for interpolation as full objects like {{number}}.",{i18nKey:n,child:e});else se(r,"TRANS_NULL_VALUE","Passed in a null value as child",{i18nKey:n})})),o},_e=(e,t,r,n,o,i,a)=>{if(""===r)return[];const s=o.transKeepBasicHtmlNodesFor||[],l=r&&new RegExp(s.map((e=>`<${e}`)).join("|")).test(r);if(!(e||t||l||a))return[r];const u=t??{},c=e=>{Ee(e).forEach((e=>{ce(e)||(Oe(e)?c(be(e)):pe(e)&&!(0,J.isValidElement)(e)&&Object.assign(u,e))}))};c(e);const p=ae.parse(`<0>${r}</0>`),f={...u,...i},d=(e,t,r)=>{const n=be(e),o=h(n,t.children,r);return(e=>Array.isArray(e)&&e.every(J.isValidElement))(n)&&0===o.length||e.props?.i18nIsDynamicList?n:o},v=(e,t,r,n,o)=>{e.dummy?(e.children=t,r.push((0,J.cloneElement)(e,{key:n},o?void 0:t))):r.push(...J.Children.map([e],(e=>{const r={...e.props};return delete r.i18nIsDynamicList,(0,J.createElement)(e.type,{...r,key:n,ref:e.props.ref??e.ref},o?null:t)})))},h=(e,r,i)=>{const u=Ee(e);return Ee(r).reduce(((e,r,c)=>{const p=r.children?.[0]?.content&&n.services.interpolator.interpolate(r.children[0].content,f,n.language);if("tag"===r.type){let a=u[parseInt(r.name,10)];!a&&t&&(a=t[r.name]),1!==i.length||a||(a=i[0][r.name]),a||(a={});const g=0!==Object.keys(r.attrs).length?((e,t)=>{const r={...t};return r.props=Object.assign(e.props,t.props),r})({props:r.attrs},a):a,y=(0,J.isValidElement)(g),m=y&&Oe(r,!0)&&!r.voidElement,O=l&&pe(g)&&g.dummy&&!y,b=pe(t)&&Object.hasOwnProperty.call(t,r.name);if(ce(g)){const t=n.services.interpolator.interpolate(g,f,n.language);e.push(t)}else if(Oe(g)||m){const t=d(g,r,i);v(g,t,e,c)}else if(O){const t=h(u,r.children,i);v(g,t,e,c)}else if(Number.isNaN(parseFloat(r.name)))if(b){const t=d(g,r,i);v(g,t,e,c,r.voidElement)}else if(o.transSupportBasicHtmlNodes&&s.indexOf(r.name)>-1)if(r.voidElement)e.push((0,J.createElement)(r.name,{key:`${r.name}-${c}`}));else{const t=h(u,r.children,i);e.push((0,J.createElement)(r.name,{key:`${r.name}-${c}`},t))}else if(r.voidElement)e.push(`<${r.name} />`);else{const t=h(u,r.children,i);e.push(`<${r.name}>${t}</${r.name}>`)}else if(pe(g)&&!y){const t=r.children[0]?p:null;t&&e.push(t)}else v(g,p,e,c,1!==r.children.length||!p)}else if("text"===r.type){const t=o.transWrapTextNodes,i=a?o.unescape(n.services.interpolator.interpolate(r.content,f,n.language)):n.services.interpolator.interpolate(r.content,f,n.language);t?e.push((0,J.createElement)(t,{key:`${r.name}-${c}`},i)):e.push(i)}return e}),[])},g=h([{dummy:!0,children:e||[]}],p,Ee(e||[]));return be(g[0])},Te=(e,t,r)=>{const n=e.key||t,o=(0,J.cloneElement)(e,{key:n});if(!o.props||!o.props.children||r.indexOf(`${t}/>`)<0&&r.indexOf(`${t} />`)<0)return o;return(0,J.createElement)((function(){return(0,J.createElement)(J.Fragment,null,o)}),{key:n})},Re=(e,t,r,n)=>e?Array.isArray(e)?((e,t)=>e.map(((e,r)=>Te(e,r,t))))(e,t):pe(e)?((e,t)=>{const r={};return Object.keys(e).forEach((n=>{Object.assign(r,{[n]:Te(e[n],n,t)})})),r})(e,t):(ue(r,"TRANS_INVALID_COMPONENTS",'<Trans /> "components" prop expects an object or array',{i18nKey:n}),null):null,we=e=>!!pe(e)&&(!Array.isArray(e)&&Object.keys(e).reduce(((e,t)=>e&&Number.isNaN(Number.parseFloat(t))),!0));const Ie={type:"3rdParty",init(e){((e={})=>{he={...he,...e}})(e.options.react),(e=>{ye=e})(e)}},Le=(0,J.createContext)();function Ce({children:e,count:t,parent:r,i18nKey:n,context:o,tOptions:i={},values:a,defaults:s,components:l,ns:u,i18n:c,t:p,shouldUnescape:f,...d}){const{i18n:v,defaultNS:h}=(0,J.useContext)(Le)||{},g=c||v||me(),y=p||g?.t.bind(g);return function({children:e,count:t,parent:r,i18nKey:n,context:o,tOptions:i={},values:a,defaults:s,components:l,ns:u,i18n:c,t:p,shouldUnescape:f,...d}){const v=c||me();if(!v)return ue(v,"NO_I18NEXT_INSTANCE","Trans: You need to pass in an i18next instance using i18nextReactModule",{i18nKey:n}),e;const h=p||v.t.bind(v)||(e=>e),g={...ge(),...v.options?.react};let y=u||h.ns||v.options?.defaultNS;y=ce(y)?[y]:y||["translation"];const m=Se(e,g,v,n),O=s||m||g.transEmptyNodeValue||n,{hashTransKey:b}=g,E=n||(b?b(m||O):m||O);v.options?.interpolation?.defaultVariables&&(a=a&&Object.keys(a).length>0?{...a,...v.options.interpolation.defaultVariables}:{...v.options.interpolation.defaultVariables});const S=a||void 0!==t&&!v.options?.interpolation?.alwaysFormat||!e?i.interpolation:{interpolation:{...i.interpolation,prefix:"#$?",suffix:"?$#"}},_={...i,context:o||i.context,count:t,...a,...S,defaultValue:O,ns:y},T=E?h(E,_):O,R=Re(l,T,v,n);let w=R||e,I=null;we(R)&&(I=R,w=e);const L=_e(w,I,T,v,g,_,f),C=r??g.defaultTransParent;return C?(0,J.createElement)(C,d,L):L}({children:e,count:t,parent:r,i18nKey:n,context:o,tOptions:i,values:a,defaults:s,components:l,ns:u||y?.ns||h||g?.options?.defaultNS,i18n:g,t:p,shouldUnescape:f,...d})}var Ae=r(9556);function xe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ne(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){xe(e,t,r[t])}))}return e}let je,Fe;r(682).Y,Ae.wi;function Pe({id:e,ns:t}={}){if(e)return je=De().getFixedT(null,e),void(Fe=t=>(0,n.jsx)(Ce,Ne({shouldUnescape:!0,ns:e},t)));je=De().t,Fe=e=>(0,n.jsx)(Ce,Ne({shouldUnescape:!0,ns:t},e))}function ke(){var e;if((null===(e=De().options)||void 0===e?void 0:e.resources)&&"object"==typeof De().options.resources)return;const t=De().use(Ie).init({resources:{},returnEmptyString:!1,lng:Ae.Nm});return Pe(),t}function De(){return $}const Ve=(e,t,r)=>(ke(),je||(console.warn("t() was called before i18n was initialized. This is probably caused by calling t() in the root module scope, instead of lazily on render"),je=De().t),je(e,t,r));function Me(e){ke();const t=null!=Fe?Fe:Ce;return(0,n.jsx)(t,Ne({shouldUnescape:!0},e))}},682:(e,t,r)=>{"use strict";r.d(t,{Y:()=>o});var n=r(9556);const o=[{code:n.MB,name:"English"},{code:n.NY,name:"Franais"},{code:n.d_,name:"Espaol"},{code:n.rT,name:"Deutsch"},{code:n.fY,name:""},{code:n.jQ,name:"Portugus Brasileiro"},{code:n.AY,name:""},{code:n.bE,name:"Italiano"},{code:n.Hp,name:""},{code:n.IP,name:"Bahasa Indonesia"},{code:n.y6,name:""},{code:n.k8,name:""},{code:n.w2,name:"etina"},{code:n.wQ,name:"Nederlands"},{code:n.tv,name:"Magyar"},{code:n.LE,name:"Portugus"},{code:n.tS,name:"Polski"},{code:n.$0,name:"Svenska"},{code:n.mz,name:"Trke"}]},5976:(e,t,r)=>{"use strict";r.d(t,{C:()=>o});var n=r(8531);const o=()=>!!n.config.featureToggles.sqlDatasourceDatabaseSelection},5911:(e,t,r)=>{"use strict";r.d(t,{T:()=>l});var n=r(624),o=r(3108),i=r(3500);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function s(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function l(e){let t=(null==e?void 0:e.editorMode)||n.lX.Builder;var r;void 0===(null==e?void 0:e.editorMode)&&void 0!==(null==e?void 0:e.rawSql)&&(t=n.lX.Code);const l=s(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){a(e,t,r[t])}))}return e}({},e),{refId:(null==e?void 0:e.refId)||"A",format:void 0!==(null==e?void 0:e.format)?e.format:o.gv.Table,rawSql:(null==e?void 0:e.rawSql)||"",editorMode:t,sql:null!==(r=null==e?void 0:e.sql)&&void 0!==r?r:{columns:[(0,i.JD)()],groupBy:[(0,i.xG)()],limit:50}});return l}},1782:(e,t,r)=>{"use strict";r.d(t,{D:()=>n,_:()=>o});var n=function(e){return e.String="string",e}({}),o=function(e){return e.Property="property",e.Operator="operator",e.Or="or",e.And="and",e.GroupBy="groupBy",e.Function="function",e.FunctionParameter="functionParameter",e}({})},3108:(e,t,r)=>{"use strict";r.d(t,{cO:()=>i,gv:()=>o,zL:()=>a});var n=r(7781),o=function(e){return e.Timeseries="time_series",e.Table="table",e}({});const i=[{label:"Time series",value:"time_series"},{label:"Table",value:"table"}],a=null!==n.toOption&&void 0!==n.toOption?n.toOption:e=>({label:e,value:e})},4506:(e,t,r)=>{"use strict";r.d(t,{s:()=>o});var n=r(7409);function o(e){return n.Ay.format(e).replace(/(\$ \{ .* \})|(\$ __)|(\$ \w+)/g,(e=>e.replace(/\s/g,"")))}},3500:(e,t,r)=>{"use strict";r.d(t,{JD:()=>u,Kj:()=>l,YW:()=>a,oF:()=>i,oG:()=>c,xG:()=>s});var n=r(7781),o=r(1782);function i(e){return`SELECT ${e.map((e=>{let t="";var r;if(e.name&&e.alias)t+=`${e.name}(${null===(r=e.parameters)||void 0===r?void 0:r.map((e=>`${e.name}`))}) AS ${e.alias}`;else if(e.name){var n;t+=`${e.name}(${null===(n=e.parameters)||void 0===n?void 0:n.map((e=>`${e.name}`))})`}else if(e.alias){var o;t+=`${null===(o=e.parameters)||void 0===o?void 0:o.map((e=>`${e.name}`))} AS ${e.alias}`}else{var i;t+=`${null===(i=e.parameters)||void 0===i?void 0:i.map((e=>`${e.name}`))}`}return t})).join(", ")} `}const a=e=>{if(!e)return!1;const t=e.some((e=>{var t,r;return(null===(t=e.parameters)||void 0===t?void 0:t.length)||(null===(r=e.parameters)||void 0===r?void 0:r.some((e=>e.name)))})),r=e.some((e=>e.name));return t||r};function s(e){return{type:o._.GroupBy,property:{type:o.D.String,name:e}}}function l(e){return{type:o._.Property,property:{type:o.D.String,name:e}}}function u(e){return{type:o._.Function,name:e,parameters:[]}}function c(e){return(null==e?void 0:e.name)?(0,n.toOption)(e.name):null}},627:e=>{e.exports={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}},8300:(e,t,r)=>{var n={"./cs-CZ/grafana-sql.json":[6685,685],"./de-DE/grafana-sql.json":[3172,172],"./en-US/grafana-sql.json":[6343,343],"./es-ES/grafana-sql.json":[2654,654],"./fr-FR/grafana-sql.json":[5450,450],"./hu-HU/grafana-sql.json":[4852,852],"./id-ID/grafana-sql.json":[9236,855],"./it-IT/grafana-sql.json":[7236,236],"./ja-JP/grafana-sql.json":[5447,447],"./ko-KR/grafana-sql.json":[6961,961],"./nl-NL/grafana-sql.json":[290,290],"./pl-PL/grafana-sql.json":[30,30],"./pt-BR/grafana-sql.json":[2454,454],"./pt-PT/grafana-sql.json":[3166,166],"./ru-RU/grafana-sql.json":[880,880],"./sv-SE/grafana-sql.json":[1809,809],"./tr-TR/grafana-sql.json":[3630,630],"./zh-Hans/grafana-sql.json":[1540,540],"./zh-Hant/grafana-sql.json":[2501,501]};function o(e){if(!r.o(n,e))return Promise.resolve().then((()=>{var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}));var t=n[e],o=t[0];return r.e(t[1]).then((()=>r.t(o,19)))}o.keys=()=>Object.keys(n),o.id=8300,e.exports=o},6089:e=>{"use strict";e.exports=s},7781:e=>{"use strict";e.exports=t},8531:e=>{"use strict";e.exports=o},2007:e=>{"use strict";e.exports=l},3241:e=>{"use strict";e.exports=i},1308:t=>{"use strict";t.exports=e},2468:e=>{"use strict";e.exports=u},5959:e=>{"use strict";e.exports=a},200:e=>{"use strict";e.exports=p},7694:e=>{"use strict";e.exports=c},1269:e=>{"use strict";e.exports=r},3059:e=>{"use strict";e.exports=n},3486:e=>{e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},8355:(e,t,r)=>{var n=r(1108);function o(){var t,r,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function l(e,o,i,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return n(l,"_invoke",function(e,n,o){var i,a,s,l=0,c=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return i=e,a=0,s=t,f.n=r,u}};function d(e,n){for(a=e,s=n,r=0;!p&&l&&!o&&r<c.length;r++){var o,i=c[r],d=f.p,v=i[2];e>3?(o=v===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,f.v=n,f.n=i[1]):d<v&&(o=e<3||i[0]>n||n>v)&&(i[4]=e,i[5]=n,f.n=v,a=0))}if(o||e>1)return u;throw p=!0,n}return function(o,c,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===c&&d(c,v),a=c,s=v;(r=a<2?t:s)||!p;){i||(a?a<3?(a>1&&(f.n=-1),d(a,s)):f.n=s:f.v=s);try{if(l=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((r=(p=f.n<0)?s:e.call(n,f))!==u)break}catch(e){i=t,a=1,s=e}finally{l=1}}return{value:r,done:p}}}(e,i,a),!0),l}var u={};function c(){}function p(){}function f(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(n(r={},a,(function(){return this})),r),v=f.prototype=c.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e}return p.prototype=f,n(v,"constructor",f),n(f,"constructor",p),p.displayName="GeneratorFunction",n(f,s,"GeneratorFunction"),n(v),n(v,s,"Generator"),n(v,a,(function(){return this})),n(v,"toString",(function(){return"[object Generator]"})),(e.exports=o=function(){return{w:l,m:h}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},7791:(e,t,r)=>{var n=r(7453);e.exports=function(e,t,r,o,i){var a=n(e,t,r,o,i);return a.next().then((function(e){return e.done?e.value:a.next()}))},e.exports.__esModule=!0,e.exports.default=e.exports},7453:(e,t,r)=>{var n=r(8355),o=r(1853);e.exports=function(e,t,r,i,a){return new o(n().w(e,t,r,i),a||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},1853:(e,t,r)=>{var n=r(3486),o=r(1108);e.exports=function e(t,r){function i(e,o,a,s){try{var l=t[e](o),u=l.value;return u instanceof n?r.resolve(u.v).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):r.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}catch(e){s(e)}}var a;this.next||(o(e.prototype),o(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),o(this,"_invoke",(function(e,t,n){function o(){return new r((function(t,r){i(e,n,t,r)}))}return a=a?a.then(o,o):o()}),!0)},e.exports.__esModule=!0,e.exports.default=e.exports},1108:e=>{function t(r,n,o,i){var a=Object.defineProperty;try{a({},"",{})}catch(r){a=0}e.exports=t=function(e,r,n,o){if(r)a?a(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n;else{var i=function(r,n){t(e,r,(function(e){return this._invoke(r,n,e)}))};i("next",0),i("throw",1),i("return",2)}},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n,o,i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},5135:e=>{e.exports=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},7711:(e,t,r)=>{var n=r(3486),o=r(8355),i=r(7791),a=r(7453),s=r(1853),l=r(5135),u=r(7573);function c(){"use strict";var t=o(),r=t.m(c),p=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function f(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))}var d={throw:1,return:2,break:3,continue:3};function v(e){var t,r;return function(n){t||(t={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(e,t){return r(n.a,d[e],t)},delegateYield:function(e,o,i){return t.resultName=o,r(n.d,u(e),i)},finish:function(e){return r(n.f,e)}},r=function(e,r,o){n.p=t.prev,n.n=t.next;try{return e(r,o)}finally{t.next=n.n}}),t.resultName&&(t[t.resultName]=n.v,t.resultName=void 0),t.sent=n.v,t.next=n.n;try{return e.call(this,t)}finally{n.p=t.prev,n.n=t.next}}}return(e.exports=c=function(){return{wrap:function(e,r,n,o){return t.w(v(e),r,n,o&&o.reverse())},isGeneratorFunction:f,mark:t.m,awrap:function(e,t){return new n(e,t)},AsyncIterator:s,async:function(e,t,r,n,o){return(f(t)?a:i)(v(e),t,r,n,o)},keys:l,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports},7573:(e,t,r)=>{var n=r(2968).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(n(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},2968:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},5522:(e,t,r)=>{var n=r(7711)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},3699:e=>{e.exports=function(e,t){this.v=e,this.k=t},e.exports.__esModule=!0,e.exports.default=e.exports},390:(e,t,r)=>{var n=r(8605);function o(){var t,r,i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",s=i.toStringTag||"@@toStringTag";function l(e,o,i,a){var s=o&&o.prototype instanceof c?o:c,l=Object.create(s.prototype);return n(l,"_invoke",function(e,n,o){var i,a,s,l=0,c=o||[],p=!1,f={p:0,n:0,v:t,a:d,f:d.bind(t,4),d:function(e,r){return i=e,a=0,s=t,f.n=r,u}};function d(e,n){for(a=e,s=n,r=0;!p&&l&&!o&&r<c.length;r++){var o,i=c[r],d=f.p,v=i[2];e>3?(o=v===n)&&(s=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=t):i[0]<=d&&((o=e<2&&d<i[1])?(a=0,f.v=n,f.n=i[1]):d<v&&(o=e<3||i[0]>n||n>v)&&(i[4]=e,i[5]=n,f.n=v,a=0))}if(o||e>1)return u;throw p=!0,n}return function(o,c,v){if(l>1)throw TypeError("Generator is already running");for(p&&1===c&&d(c,v),a=c,s=v;(r=a<2?t:s)||!p;){i||(a?a<3?(a>1&&(f.n=-1),d(a,s)):f.n=s:f.v=s);try{if(l=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,s)))throw TypeError("iterator result is not an object");if(!r.done)return r;s=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(s=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=t}else if((r=(p=f.n<0)?s:e.call(n,f))!==u)break}catch(e){i=t,a=1,s=e}finally{l=1}}return{value:r,done:p}}}(e,i,a),!0),l}var u={};function c(){}function p(){}function f(){}r=Object.getPrototypeOf;var d=[][a]?r(r([][a]())):(n(r={},a,(function(){return this})),r),v=f.prototype=c.prototype=Object.create(d);function h(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,f):(e.__proto__=f,n(e,s,"GeneratorFunction")),e.prototype=Object.create(v),e}return p.prototype=f,n(v,"constructor",f),n(f,"constructor",p),p.displayName="GeneratorFunction",n(f,s,"GeneratorFunction"),n(v),n(v,s,"Generator"),n(v,a,(function(){return this})),n(v,"toString",(function(){return"[object Generator]"})),(e.exports=o=function(){return{w:l,m:h}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=o,e.exports.__esModule=!0,e.exports.default=e.exports},6460:(e,t,r)=>{var n=r(3648);e.exports=function(e,t,r,o,i){var a=n(e,t,r,o,i);return a.next().then((function(e){return e.done?e.value:a.next()}))},e.exports.__esModule=!0,e.exports.default=e.exports},3648:(e,t,r)=>{var n=r(390),o=r(774);e.exports=function(e,t,r,i,a){return new o(n().w(e,t,r,i),a||Promise)},e.exports.__esModule=!0,e.exports.default=e.exports},774:(e,t,r)=>{var n=r(3699),o=r(8605);e.exports=function e(t,r){function i(e,o,a,s){try{var l=t[e](o),u=l.value;return u instanceof n?r.resolve(u.v).then((function(e){i("next",e,a,s)}),(function(e){i("throw",e,a,s)})):r.resolve(u).then((function(e){l.value=e,a(l)}),(function(e){return i("throw",e,a,s)}))}catch(e){s(e)}}var a;this.next||(o(e.prototype),o(e.prototype,"function"==typeof Symbol&&Symbol.asyncIterator||"@asyncIterator",(function(){return this}))),o(this,"_invoke",(function(e,t,n){function o(){return new r((function(t,r){i(e,n,t,r)}))}return a=a?a.then(o,o):o()}),!0)},e.exports.__esModule=!0,e.exports.default=e.exports},8605:e=>{function t(r,n,o,i){var a=Object.defineProperty;try{a({},"",{})}catch(r){a=0}e.exports=t=function(e,r,n,o){if(r)a?a(e,r,{value:n,enumerable:!o,configurable:!o,writable:!o}):e[r]=n;else{var i=function(r,n){t(e,r,(function(e){return this._invoke(r,n,e)}))};i("next",0),i("throw",1),i("return",2)}},e.exports.__esModule=!0,e.exports.default=e.exports,t(r,n,o,i)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},4630:e=>{e.exports=function(e){var t=Object(e),r=[];for(var n in t)r.unshift(n);return function e(){for(;r.length;)if((n=r.pop())in t)return e.value=n,e.done=!1,e;return e.done=!0,e}},e.exports.__esModule=!0,e.exports.default=e.exports},4112:(e,t,r)=>{var n=r(3699),o=r(390),i=r(6460),a=r(3648),s=r(774),l=r(4630),u=r(368);function c(){"use strict";var t=o(),r=t.m(c),p=(Object.getPrototypeOf?Object.getPrototypeOf(r):r.__proto__).constructor;function f(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===p||"GeneratorFunction"===(t.displayName||t.name))}var d={throw:1,return:2,break:3,continue:3};function v(e){var t,r;return function(n){t||(t={stop:function(){return r(n.a,2)},catch:function(){return n.v},abrupt:function(e,t){return r(n.a,d[e],t)},delegateYield:function(e,o,i){return t.resultName=o,r(n.d,u(e),i)},finish:function(e){return r(n.f,e)}},r=function(e,r,o){n.p=t.prev,n.n=t.next;try{return e(r,o)}finally{t.next=n.n}}),t.resultName&&(t[t.resultName]=n.v,t.resultName=void 0),t.sent=n.v,t.next=n.n;try{return e.call(this,t)}finally{n.p=t.prev,n.n=t.next}}}return(e.exports=c=function(){return{wrap:function(e,r,n,o){return t.w(v(e),r,n,o&&o.reverse())},isGeneratorFunction:f,mark:t.m,awrap:function(e,t){return new n(e,t)},AsyncIterator:s,async:function(e,t,r,n,o){return(f(t)?a:i)(v(e),t,r,n,o)},keys:l,values:u}},e.exports.__esModule=!0,e.exports.default=e.exports)()}e.exports=c,e.exports.__esModule=!0,e.exports.default=e.exports},368:(e,t,r)=>{var n=r(1751).default;e.exports=function(e){if(null!=e){var t=e["function"==typeof Symbol&&Symbol.iterator||"@@iterator"],r=0;if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}}}throw new TypeError(n(e)+" is not iterable")},e.exports.__esModule=!0,e.exports.default=e.exports},1751:e=>{function t(r){return e.exports=t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e.exports.__esModule=!0,e.exports.default=e.exports,t(r)}e.exports=t,e.exports.__esModule=!0,e.exports.default=e.exports},9471:(e,t,r)=>{var n=r(4112)();e.exports=n;try{regeneratorRuntime=n}catch(e){"object"==typeof globalThis?globalThis.regeneratorRuntime=n:Function("r","regeneratorRuntime = r")(n)}},2584:(e,t)=>{var r;!function(){"use strict";var n={}.hasOwnProperty;function o(){for(var e="",t=0;t<arguments.length;t++){var r=arguments[t];r&&(e=a(e,i(r)))}return e}function i(e){if("string"==typeof e||"number"==typeof e)return e;if("object"!=typeof e)return"";if(Array.isArray(e))return o.apply(null,e);if(e.toString!==Object.prototype.toString&&!e.toString.toString().includes("[native code]"))return e.toString();var t="";for(var r in e)n.call(e,r)&&e[r]&&(t=a(t,r));return t}function a(e,t){return t?e?e+" "+t:e+t:e}e.exports?(o.default=o,e.exports=o):void 0===(r=function(){return o}.apply(t,[]))||(e.exports=r)}()},5910:(e,t,r)=>{"use strict";r.d(t,{C:()=>i});var n=r(5959),o=r(2007);r(7781);const i=({children:e,wrap:t=!0,...r})=>{var i,a;return n.createElement(o.Stack,{wrap:t?"wrap":void 0,direction:null!=(i=r.direction)?i:"row",gap:null!=(a=r.gap)?a:2,...r},e)}},624:(e,t,r)=>{"use strict";r.d(t,{lX:()=>i});r(2381);var n,o=r(7781),i=(r(3241),r(2007),r(5959),r(8531),(e=>(e.Builder="builder",e.Code="code",e))(i||{}));n=o.toOption},3247:(e,t,r)=>{"use strict";r.d(t,{N:()=>a});r(2007);var n=r(8056);r(7781);const o="column",i=[{id:"$__timeFilter(dateColumn)",name:"$__timeFilter(dateColumn)",text:"$__timeFilter",args:[o],type:n.hh.Filter,description:"Will be replaced by a time range filter using the specified column name. For example, dateColumn BETWEEN FROM_UNIXTIME(1494410783) AND FROM_UNIXTIME(1494410983)"},{id:"$__timeFrom()",name:"$__timeFrom()",text:"$__timeFrom",args:[],type:n.hh.Filter,description:"Will be replaced by the start of the currently active time selection. For example, FROM_UNIXTIME(1494410783)"},{id:"$__timeTo()",name:"$__timeTo()",text:"$__timeTo",args:[],type:n.hh.Filter,description:"Will be replaced by the end of the currently active time selection. For example, FROM_UNIXTIME(1494410983)"},{id:"$__timeGroup(dateColumn, '5m')",name:"$__timeGroup(dateColumn, '5m')",text:"$__timeGroup",args:[o,"'5m'"],type:n.hh.Value,description:"Will be replaced by an expression usable in GROUP BY clause. For example, *cast(cast(UNIX_TIMESTAMP(dateColumn)/(300) as signed)*300 as signed),*"},{id:"$__table",name:"$__table",text:"$__table",args:[],type:n.hh.Table,description:"Will be replaced by the query table."},{id:"$__column",name:"$__column",text:"$__column",args:[],type:n.hh.Column,description:"Will be replaced by the query column."}];function a(e,t){var r,o,a;const s={triggerCharacters:["."," ","$",",","(","'"]};t&&Array.isArray(t.builtinFunctions)&&(s.supportedFunctions=()=>t.builtinFunctions.map((e=>({id:e,name:e}))));const l=[];return(null==(r=null==t?void 0:t.comparisonOperators)?void 0:r.length)&&l.push(...t.comparisonOperators.map((e=>({id:e.toLocaleLowerCase(),operator:e,type:n.hu.Comparison})))),t.logicalOperators=null!=(o=t.logicalOperators)?o:t.operators,(null==(a=null==t?void 0:t.logicalOperators)?void 0:a.length)&&l.push(...t.logicalOperators.map((e=>({id:e.toLocaleLowerCase(),operator:e,type:n.hu.Logical})))),s.supportedOperators=()=>l,s.supportedMacros=()=>i,s}},8056:(e,t,r)=>{"use strict";r.d(t,{Io:()=>u,X7:()=>a,_E:()=>c,hh:()=>o,hu:()=>n,ks:()=>i,mY:()=>l,ng:()=>s});r(2007),r(7781);var n=(e=>(e[e.Comparison=0]="Comparison",e[e.Logical=1]="Logical",e))(n||{}),o=(e=>(e[e.Value=0]="Value",e[e.Filter=1]="Filter",e[e.Group=2]="Group",e[e.Column=3]="Column",e[e.Table=4]="Table",e))(o||{}),i=(e=>(e.Parenthesis="delimiter.parenthesis.sql",e.Whitespace="white.sql",e.Keyword="keyword.sql",e.Delimiter="delimiter.sql",e.Operator="operator.sql",e.Identifier="identifier.sql",e.IdentifierQuote="identifier.quote.sql",e.Type="type.sql",e.Function="predefined.sql",e.Number="number.sql",e.String="string.sql",e.Variable="variable.sql",e))(i||{}),a=(e=>(e.Unknown="unknown",e.SelectKeyword="selectKeyword",e.WithKeyword="withKeyword",e.AfterSelectKeyword="afterSelectKeyword",e.AfterSelectArguments="afterSelectArguments",e.AfterSelectFuncFirstArgument="afterSelectFuncFirstArgument",e.SelectAlias="selectAlias",e.AfterFromKeyword="afterFromKeyword",e.AfterTable="afterTable",e.SchemaFuncFirstArgument="schemaFuncFirstArgument",e.SchemaFuncExtraArgument="schemaFuncExtraArgument",e.FromKeyword="fromKeyword",e.AfterFrom="afterFrom",e.WhereKeyword="whereKeyword",e.WhereComparisonOperator="whereComparisonOperator",e.WhereValue="whereValue",e.AfterWhereFunctionArgument="afterWhereFunctionArgument",e.AfterGroupByFunctionArgument="afterGroupByFunctionArgument",e.AfterWhereValue="afterWhereValue",e.AfterGroupByKeywords="afterGroupByKeywords",e.AfterGroupBy="afterGroupBy",e.AfterOrderByKeywords="afterOrderByKeywords",e.AfterOrderByFunction="afterOrderByFunction",e.AfterOrderByDirection="afterOrderByDirection",e.AfterIsOperator="afterIsOperator",e.AfterIsNotOperator="afterIsNotOperator",e.AfterSchema="afterSchema",e))(a||{}),s=(e=>(e.Schemas="schemas",e.Tables="tables",e.Columns="columns",e.SelectKeyword="selectKeyword",e.WithKeyword="withKeyword",e.FunctionsWithArguments="functionsWithArguments",e.FromKeyword="fromKeyword",e.WhereKeyword="whereKeyword",e.GroupByKeywords="groupByKeywords",e.OrderByKeywords="orderByKeywords",e.FunctionsWithoutArguments="functionsWithoutArguments",e.LimitKeyword="limitKeyword",e.SortOrderDirectionKeyword="sortOrderDirectionKeyword",e.ComparisonOperators="comparisonOperators",e.LogicalOperators="logicalOperators",e.SelectMacro="selectMacro",e.TableMacro="tableMacro",e.FilterMacro="filterMacro",e.GroupMacro="groupMacro",e.BoolValues="boolValues",e.NullValue="nullValue",e.NotKeyword="notKeyword",e.TemplateVariables="templateVariables",e.StarWildCard="starWildCard",e))(s||{}),l=(e=>(e.High="a",e.MediumHigh="d",e.Medium="g",e.MediumLow="k",e.Low="q",e))(l||{}),u=(e=>(e[e.Method=0]="Method",e[e.Function=1]="Function",e[e.Constructor=2]="Constructor",e[e.Field=3]="Field",e[e.Variable=4]="Variable",e[e.Class=5]="Class",e[e.Struct=6]="Struct",e[e.Interface=7]="Interface",e[e.Module=8]="Module",e[e.Property=9]="Property",e[e.Event=10]="Event",e[e.Operator=11]="Operator",e[e.Unit=12]="Unit",e[e.Value=13]="Value",e[e.Constant=14]="Constant",e[e.Enum=15]="Enum",e[e.EnumMember=16]="EnumMember",e[e.Keyword=17]="Keyword",e[e.Text=18]="Text",e[e.Color=19]="Color",e[e.File=20]="File",e[e.Reference=21]="Reference",e[e.Customcolor=22]="Customcolor",e[e.Folder=23]="Folder",e[e.TypeParameter=24]="TypeParameter",e[e.User=25]="User",e[e.Issue=26]="Issue",e[e.Snippet=27]="Snippet",e))(u||{}),c=(e=>(e[e.KeepWhitespace=1]="KeepWhitespace",e[e.InsertAsSnippet=4]="InsertAsSnippet",e))(c||{})},6373:(e,t,r)=>{"use strict";r.d(t,{A:()=>l});const n={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};let o;const i=new Uint8Array(16);const a=[];for(let e=0;e<256;++e)a.push((e+256).toString(16).slice(1));function s(e,t=0){return(a[e[t+0]]+a[e[t+1]]+a[e[t+2]]+a[e[t+3]]+"-"+a[e[t+4]]+a[e[t+5]]+"-"+a[e[t+6]]+a[e[t+7]]+"-"+a[e[t+8]]+a[e[t+9]]+"-"+a[e[t+10]]+a[e[t+11]]+a[e[t+12]]+a[e[t+13]]+a[e[t+14]]+a[e[t+15]]).toLowerCase()}const l=function(e,t,r){if(n.randomUUID&&!t&&!e)return n.randomUUID();const a=(e=e||{}).random??e.rng?.()??function(){if(!o){if("undefined"==typeof crypto||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");o=crypto.getRandomValues.bind(crypto)}return o(i)}();if(a.length<16)throw new Error("Random bytes length must be >= 16");if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){if((r=r||0)<0||r+16>t.length)throw new RangeError(`UUID byte range ${r}:${r+15} is out of buffer bounds`);for(let e=0;e<16;++e)t[r+e]=a[e];return t}return s(a)}}},y={};function m(e){var t=y[e];if(void 0!==t)return t.exports;var r=y[e]={id:e,loaded:!1,exports:{}};return g[e].call(r.exports,r,r.exports,m),r.loaded=!0,r.exports}m.m=g,m.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return m.d(t,{a:t}),t},d=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,m.t=function(e,t){if(1&t&&(e=this(e)),8&t)return e;if("object"==typeof e&&e){if(4&t&&e.__esModule)return e;if(16&t&&"function"==typeof e.then)return e}var r=Object.create(null);m.r(r);var n={};f=f||[null,d({}),d([]),d(d)];for(var o=2&t&&e;"object"==typeof o&&!~f.indexOf(o);o=d(o))Object.getOwnPropertyNames(o).forEach((t=>n[t]=()=>e[t]));return n.default=()=>e,m.d(r,n),r},m.d=(e,t)=>{for(var r in t)m.o(t,r)&&!m.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},m.f={},m.e=e=>Promise.all(Object.keys(m.f).reduce(((t,r)=>(m.f[r](e,t),t)),[])),m.u=e=>(168===e?"sql-query-editor":e)+".js",m.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),m.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),v={},h="mysql:",m.l=(e,t,r,n)=>{if(v[e])v[e].push(t);else{var o,i;if(void 0!==r)for(var a=document.getElementsByTagName("script"),s=0;s<a.length;s++){var l=a[s];if(l.getAttribute("src")==e||l.getAttribute("data-webpack")==h+r){o=l;break}}o||(i=!0,(o=document.createElement("script")).charset="utf-8",o.timeout=120,m.nc&&o.setAttribute("nonce",m.nc),o.setAttribute("data-webpack",h+r),o.src=e),v[e]=[t];var u=(t,r)=>{o.onerror=o.onload=null,clearTimeout(c);var n=v[e];if(delete v[e],o.parentNode&&o.parentNode.removeChild(o),n&&n.forEach((e=>e(r))),t)return t(r)},c=setTimeout(u.bind(null,void 0,{type:"timeout",target:o}),12e4);o.onerror=u.bind(null,o.onerror),o.onload=u.bind(null,o.onload),i&&document.head.appendChild(o)}},m.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},m.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),m.p="public/plugins/mysql/",(()=>{var e={231:0};m.f.j=(t,r)=>{var n=m.o(e,t)?e[t]:void 0;if(0!==n)if(n)r.push(n[2]);else{var o=new Promise(((r,o)=>n=e[t]=[r,o]));r.push(n[2]=o);var i=m.p+m.u(t),a=new Error;m.l(i,(r=>{if(m.o(e,t)&&(0!==(n=e[t])&&(e[t]=void 0),n)){var o=r&&("load"===r.type?"missing":r.type),i=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+o+": "+i+")",a.name="ChunkLoadError",a.type=o,a.request=i,n[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var n,o,[i,a,s]=r,l=0;if(i.some((t=>0!==e[t]))){for(n in a)m.o(a,n)&&(m.m[n]=a[n]);if(s)s(m)}for(t&&t(r);l<i.length;l++)o=i[l],m.o(e,o)&&e[o]&&e[o][0](),e[o]=0},r=globalThis.webpackChunkmysql=globalThis.webpackChunkmysql||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var O={};return(()=>{"use strict";m.r(O),m.d(O,{plugin:()=>Me});var e=m(1308),t=m.n(e);m.p=t()&&t().uri?t().uri.slice(0,t().uri.lastIndexOf("/")+1):"public/plugins/mysql/";var r=m(7781),n=m(3108);const o=[{name:"AVG"},{name:"COUNT"},{name:"MAX"},{name:"MIN"},{name:"SUM"}],i={name:"Interval",required:!0,options:()=>Promise.resolve([{label:"$__interval",value:"$__interval"}])},a={name:"Fill",required:!1,options:()=>Promise.resolve([{label:"0",value:"0"},{label:"NULL",value:"NULL"},{label:"previous",value:"previous"}])},s=e=>[{name:"$__timeGroup",description:"Time grouping function",parameters:[e,i,a]},{name:"$__timeGroupAlias",description:"Time grouping function with time as alias",parameters:[e,i,a]},{name:"$__time",description:"An expression to rename the column to time",parameters:[e]},{name:"$__timeEpoch",parameters:[e]},{name:"$__unixEpochGroup",parameters:[e,i,a]},{name:"$__unixEpochGroupAlias",parameters:[e,i,a]}],l=["$__time","$__timeEpoch","$__timeFilter","$__timeFrom","$__timeTo","$__timeGroup","$__timeGroupAlias","$__unixEpochFilter","$__unixEpochNanoFilter","$__unixEpochNanoFrom","$__unixEpochNanoTo","$__unixEpochGroup","$__unixEpochGroupAlias"];var u=m(1269),c=m(3059),p=m(624),f=m(8531),d=m(3241);class v{transformMetricFindResponse(e){const t=[],r=e.fields.find((e=>"__text"===e.name)),n=e.fields.find((e=>"__value"===e.name));if(r&&n)for(let e=0;e<r.values.length;e++)t.push({text:""+r.values[e],value:""+n.values[e]});else for(const r of e.fields)for(const e of r.values)t.push({text:e});return(0,d.uniqBy)(t,"text")}}var h=m(9728),g=m(6089),y=m(5959),b=m(7314),E=m(2007);function S(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){S(e,t,r[t])}))}return e}const T=(0,y.lazy)((()=>Promise.all([m.e(823),m.e(168)]).then(m.bind(m,8110))));function R(e){const t=(0,E.useStyles2)(w);return(0,h.jsx)(y.Suspense,{fallback:(0,h.jsx)(E.LoadingPlaceholder,{text:(0,b.t)("grafana-sql.components.sql-query-editor-lazy.text-loading-editor","Loading editor"),className:t.container}),children:(0,h.jsx)(T,_({},e))})}const w=e=>({container:(0,g.css)({marginBottom:"unset",marginLeft:e.spacing(1)})});var I=m(5911);function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){L(e,t,r[t])}))}return e}function A(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function x(e){const t="string"==typeof e.rawQuery?e.rawQuery:null;if(!t)return e;var r;const n=(0,I.T)(A(C({refId:"Annotation"},null!==(r=e.target)&&void 0!==r?r:{}),{rawSql:t}));return A(C({},e),{rawQuery:void 0,workspace:void 0,subscription:void 0,queryType:void 0,target:n})}var N=m(5976);function j(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function F(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){j(i,n,o,a,s,"next",e)}function s(e){j(i,n,o,a,s,"throw",e)}a(void 0)}))}}function P(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function k(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){P(e,t,r[t])}))}return e}function D(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}class V extends f.DataSourceWithBackend{getResponseParser(){return this.responseParser}interpolateVariablesInQueries(e,t){let r=e;return e&&e.length>0&&(r=e.map((e=>D(k({},e),{datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),rawQuery:!0})))),r}filterQuery(e){return!e.hide}applyTemplateVariables(e,t){return{refId:e.refId,datasource:this.getRef(),rawSql:this.templateSrv.replace(e.rawSql,t,this.interpolateVariable),format:e.format}}query(e){if((0,N.C)()){const t=this.checkForDatabaseIssue(e);if(t){const e=new Error(t);return(0,u.throwError)((()=>e))}}return e.targets.forEach((t=>{var n;e.app!==r.CoreApp.Dashboard&&e.app!==r.CoreApp.PanelViewer&&(0,f.reportInteraction)("grafana_sql_query_executed",{datasource:null===(n=t.datasource)||void 0===n?void 0:n.type,editorMode:t.editorMode,format:t.format,app:e.app})})),super.query(e)}checkForDatabaseIssue(e){if("grafana-postgresql-datasource"===this.type&&!this.preconfiguredDatabase)return"You do not currently have a default database configured for this data source. Postgres requires a default\n             database with which to connect. Please configure one through the Data Sources Configuration page, or if you\n             are using a provisioning file, update that configuration file with a default database.";if(e.app!==r.CoreApp.Explore&&this.preconfiguredDatabase)for(const t of e.targets)if(t.editorMode===p.lX.Builder&&t.dataset&&t.dataset!==this.preconfiguredDatabase)return"The configuration for this panel's data source has been modified. The previous database used in this panel's\n                   saved query is no longer available. Please update the query to use the new database option.\n                   Previous query parameters will be preserved until the query is updated."}metricFindQuery(e,t){var o=this;return F((function*(){const i=null==t?void 0:t.range;if(null==i)return[];let a="tempvar";t&&t.variable&&t.variable.name&&(a=t.variable.name);const s=k({},null==t?void 0:t.scopedVars,(0,r.getSearchFilterScopedVar)({query:e,wildcardChar:"%",options:t})),l=o.templateSrv.replace(e,s,o.interpolateVariable),u={refId:a,datasource:o.getRef(),rawSql:l,format:n.gv.Table};let c;try{c=yield o.runMetaQuery(u,i)}catch(e){throw console.error(e),new Error("error when executing the sql query")}return o.getResponseParser().transformMetricFindResponse(c)}))()}runSql(e,t){var o=this;return F((function*(){const i=(0,r.getDefaultTimeRange)(),a=yield o.runMetaQuery({rawSql:e,format:n.gv.Table,refId:null==t?void 0:t.refId},i);return new r.DataFrameView(a)}))()}runMetaQuery(e,t){const r=e.refId||"meta",n=[D(k({},e),{datasource:e.datasource||this.getRef(),refId:r})];return(0,u.lastValueFrom)((0,f.getBackendSrv)().fetch({url:"/api/ds/query",method:"POST",headers:this.getRequestHeaders(),data:{from:t.from.valueOf().toString(),to:t.to.valueOf().toString(),queries:n},requestId:r}).pipe((0,c.map)((e=>{var t;return null!==(t=(0,f.toDataQueryResponse)(e,n).data[0])&&void 0!==t?t:{fields:[]}}))))}targetContainsTemplate(e){let t=e.rawSql;return l.forEach((e=>{t=(null==t?void 0:t.replace(e,""))||""})),this.templateSrv.containsTemplate(t)}constructor(e,t=(0,f.getTemplateSrv)()){super(e),P(this,"templateSrv",void 0),P(this,"id",void 0),P(this,"responseParser",void 0),P(this,"name",void 0),P(this,"interval",void 0),P(this,"db",void 0),P(this,"preconfiguredDatabase",void 0),P(this,"interpolateVariable",void 0),this.templateSrv=t,this.interpolateVariable=(e,t)=>{if("string"==typeof e)return t.multi||t.includeAll?this.getQueryModel().quoteLiteral(e):String(e).replace(/'/g,"''");if("number"==typeof e)return e;if(Array.isArray(e)){return e.map((e=>this.getQueryModel().quoteLiteral(e))).join(",")}return e},this.name=e.name,this.responseParser=new v,this.id=e.id;const r=e.jsonData||{};var n;this.interval=r.timeInterval||"1m",this.db=this.getDB(),this.preconfiguredDatabase=null!==(n=r.database)&&void 0!==n?n:"",this.annotations={prepareAnnotation:x,QueryEditor:R}}}var M=m(4506);const U=({children:e,title:t,description:r,isCollapsible:n=!1,isInitiallyOpen:o=!0,kind:i="section",className:a})=>{const{colors:s,typography:l,spacing:u}=(0,E.useTheme2)(),[c,p]=(0,y.useState)(!n||o),f=c?"angle-up":"angle-down",d="sub-section"===i,v=`${c?"Collapse":"Expand"} section ${t}`,h={header:(0,g.css)({display:"flex",justifyContent:"space-between",alignItems:"center"}),title:(0,g.css)({margin:0}),subtitle:(0,g.css)({margin:0,fontWeight:l.fontWeightRegular}),descriptionText:(0,g.css)({marginTop:u(d?.25:.5),marginBottom:0,...l.bodySmall,color:s.text.secondary}),content:(0,g.css)({marginTop:u(2)})};return y.createElement("div",{className:a},y.createElement("div",{className:h.header},"section"===i?y.createElement("h3",{className:h.title},t):y.createElement("h6",{className:h.subtitle},t),n&&y.createElement(E.IconButton,{name:f,onClick:()=>p(!c),type:"button",size:"xl","aria-label":v})),r&&y.createElement("p",{className:h.descriptionText},r),c&&y.createElement("div",{className:h.content},e))},B=({children:e,...t})=>y.createElement(U,{...t,kind:"sub-section"},e);function q({value:e,defaultValue:t,onChange:r,width:n}){const[o,i]=(0,y.useState)(!1);return(0,h.jsx)(E.Input,{type:"number",placeholder:String(t),value:o?"":e,onChange:e=>{var n;if(""===(null===(n=e.currentTarget.value)||void 0===n?void 0:n.trim()))i(!0),r(t);else{i(!1);const t=Number(e.currentTarget.value);Number.isNaN(t)||r(t)}},width:n})}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function K(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){G(e,t,r[t])}))}return e}function $(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const W=e=>{const{onOptionsChange:t,options:r}=e,n=r.jsonData,o=void 0!==n.maxIdleConnsAuto&&n.maxIdleConnsAuto,i=e=>{const o=$(K({},r),{jsonData:K({},n,e)});return t(o)},a=e=>t=>{i({[e]:t})};return(0,h.jsxs)(B,{title:(0,b.t)("grafana-sql.components.connection-limits.title-connection-limits","Connection limits"),children:[(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.max-open",children:"Max open"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsxs)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.content-max-open",children:["The maximum number of open connections to the database. If ",(0,h.jsx)("i",{children:"Max idle connections"})," is greater than 0 and the ",(0,h.jsx)("i",{children:"Max open connections"})," is less than ",(0,h.jsx)("i",{children:"Max idle connections"}),", then",(0,h.jsx)("i",{children:"Max idle connections"})," will be reduced to match the ",(0,h.jsx)("i",{children:"Max open connections"})," limit. If set to 0, there is no limit on the number of open connections."]})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(q,{value:n.maxOpenConns,defaultValue:f.config.sqlConnectionLimits.maxOpenConns,onChange:e=>{var t;t=e,i(o&&t?{maxOpenConns:t,maxIdleConns:t}:{maxOpenConns:t})},width:40})}),(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.auto-max-idle",children:"Auto max idle"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsxs)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.content-auto-max-idle",values:{defaultMaxIdle:f.config.sqlConnectionLimits.maxIdleConns},children:["If enabled, automatically set the number of ",(0,h.jsx)("i",{children:"Maximum idle connections"})," to the same value as",(0,h.jsx)("i",{children:" Max open connections"}),". If the number of maximum open connections is not set it will be set to the default (","{{defaultMaxIdle}}",")."]})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(E.Switch,{value:o,onChange:()=>{let e,t;o?(t=n.maxOpenConns,e=n.maxIdleConns):void 0!==n.maxOpenConns&&(t=n.maxOpenConns,e=n.maxOpenConns),i({maxIdleConnsAuto:!o,maxIdleConns:e,maxOpenConns:t})}})}),(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.max-idle",children:"Max idle"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsxs)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.content-max-idle",children:["The maximum number of connections in the idle connection pool.If ",(0,h.jsx)("i",{children:"Max open connections"})," is greater than 0 but less than the ",(0,h.jsx)("i",{children:"Max idle connections"}),", then the ",(0,h.jsx)("i",{children:"Max idle connections"})," ","will be reduced to match the ",(0,h.jsx)("i",{children:"Max open connections"})," limit. If set to 0, no idle connections are retained."]})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:o?(0,h.jsx)(E.InlineLabel,{width:40,children:r.jsonData.maxIdleConns}):(0,h.jsx)(q,{value:n.maxIdleConns,defaultValue:f.config.sqlConnectionLimits.maxIdleConns,onChange:e=>{a("maxIdleConns")(e)},width:40})}),(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.max-lifetime",children:"Max lifetime"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.connection-limits.content-max-lifetime",children:"The maximum amount of time in seconds a connection may be reused. If set to 0, connections are reused forever."})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(q,{value:n.connMaxLifetime,defaultValue:f.config.sqlConnectionLimits.connMaxLifetime,onChange:e=>{a("connMaxLifetime")(e)},width:40})})]})},z=()=>{const e=(0,E.useStyles2)(H);return(0,h.jsx)("hr",{className:e.horizontalDivider})},H=e=>({horizontalDivider:(0,g.css)({borderTop:`1px solid ${e.colors.border.weak}`,margin:e.spacing(2,0),width:"100%"})}),Y=e=>{const{editorProps:t,showCACert:n,showKeyPair:o=!0}=e,{secureJsonFields:i}=t.options;return(0,h.jsxs)(h.Fragment,{children:[o?(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-client-certificate",children:"TLS/SSL Client Certificate"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-client-certificate",children:"To authenticate with an TLS/SSL client certificate, provide the client certificate here."})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(E.SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:i&&i.tlsClientCert,onChange:(0,r.onUpdateDatasourceSecureJsonDataOption)(t,"tlsClientCert"),onReset:()=>{(0,r.updateDatasourcePluginResetOption)(t,"tlsClientCert")}})}):null,n?(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-root-certificate",children:"TLS/SSL Root Certificate"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-root-certificate",children:"If the selected TLS/SSL mode requires a server root certificate, provide it here"})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(E.SecretTextArea,{placeholder:"-----BEGIN CERTIFICATE-----",cols:45,rows:7,isConfigured:i&&i.tlsCACert,onChange:(0,r.onUpdateDatasourceSecureJsonDataOption)(t,"tlsCACert"),onReset:()=>{(0,r.updateDatasourcePluginResetOption)(t,"tlsCACert")}})}):null,o?(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(E.Stack,{gap:.5,children:[(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.tlsssl-client-key",children:"TLS/SSL Client Key"})}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsx)("span",{children:(0,h.jsx)(b.x6,{i18nKey:"grafana-sql.components.tlssecrets-config.content-tlsssl-client-key",children:"To authenticate with a client TLS/SSL certificate, provide the key here."})}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(E.SecretTextArea,{placeholder:"-----BEGIN RSA PRIVATE KEY-----",cols:45,rows:7,isConfigured:i&&i.tlsClientKey,onChange:(0,r.onUpdateDatasourceSecureJsonDataOption)(t,"tlsClientKey"),onReset:()=>{(0,r.updateDatasourcePluginResetOption)(t,"tlsClientKey")}})}):null]})},J=(0,f.createMonitoringLogger)("features.plugins.sql");function X(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){X(e,t,r[t])}))}return e}function Z(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}var ee=m(3500);m(1782);function te(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function re(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){te(i,n,o,a,s,"next",e)}function s(e){te(i,n,o,a,s,"throw",e)}a(void 0)}))}}m(682).Y.reduce(((e,t)=>(e[t.code]=re((function*(){return yield m(8300)(`./${t.code}/grafana-sql.json`)})),e)),{});function ne(e){return{ulPadding:(0,g.css)({margin:e.spacing(1,0),paddingLeft:e.spacing(5)})}}var oe=m(6373),ie=m(8056);function ae(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function se(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){ae(e,t,r[t])}))}return e}function le(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}function ue(e){switch(e){case"TIME":case"DATETIME":case"TIMESTAMP":return"clock-nine";case"BOOLEAN":return"toggle-off";case"INTEGER":case"FLOAT":case"FLOAT64":case"INT":case"SMALLINT":case"BIGINT":case"TINYINT":case"BYTEINT":case"INT64":case"NUMERIC":case"DECIMAL":return"calculator-alt";case"CHAR":case"VARCHAR":case"STRING":case"BYTES":case"TEXT":case"TINYTEXT":case"MEDIUMTEXT":case"LONGTEXT":return"text";case"GEOGRAPHY":return"map";default:return}}function ce({sql:e,dataset:t,table:r}){var n,o,i,a;let s="";if(!e||!(0,ee.YW)(e.columns))return s;if(s+=(0,ee.oF)(e.columns),t&&r&&(s+=`FROM ${t}.${r} `),e.whereString&&(s+=`WHERE ${e.whereString} `),null===(o=e.groupBy)||void 0===o||null===(n=o[0])||void 0===n?void 0:n.property.name){s+=`GROUP BY ${e.groupBy.map((e=>e.property.name)).filter((e=>!(0,d.isEmpty)(e))).join(", ")} `}return(null===(i=e.orderBy)||void 0===i?void 0:i.property.name)&&(s+=`ORDER BY ${e.orderBy.property.name} `),(null===(a=e.orderBy)||void 0===a?void 0:a.property.name)&&e.orderByDirection&&(s+=`${e.orderByDirection} `),void 0!==e.limit&&e.limit>=0&&(s+=`LIMIT ${e.limit} `),s}function pe(e){return function(e){const t=/^[a-zA-Z_][a-zA-Z0-9_$]*$/g.test(e);return!de.includes(e.toUpperCase())&&t}(e)?e:`\`${e}\``}function fe(e){return"'"+e.replace(/'/g,"''")+"'"}const de=["ACCESSIBLE","ADD","ALL","ALTER","ANALYZE","AND","AS","ASC","ASENSITIVE","BEFORE","BETWEEN","BIGINT","BINARY","BLOB","BOTH","BY","CALL","CASCADE","CASE","CHANGE","CHAR","CHARACTER","CHECK","COLLATE","COLUMN","CONDITION","CONSTRAINT","CONTINUE","CONVERT","CREATE","CROSS","CUBE","CUME_DIST","CURRENT_DATE","CURRENT_TIME","CURRENT_TIMESTAMP","CURRENT_USER","CURSOR","DATABASE","DATABASES","DAY_HOUR","DAY_MICROSECOND","DAY_MINUTE","DAY_SECOND","DEC","DECIMAL","DECLARE","DEFAULT","DELAYED","DELETE","DENSE_RANK","DESC","DESCRIBE","DETERMINISTIC","DISTINCT","DISTINCTROW","DIV","DOUBLE","DROP","DUAL","EACH","ELSE","ELSEIF","EMPTY","ENCLOSED","ESCAPED","EXCEPT","EXISTS","EXIT","EXPLAIN","FALSE","FETCH","FIRST_VALUE","FLOAT","FLOAT4","FLOAT8","FOR","FORCE","FOREIGN","FROM","FULLTEXT","FUNCTION","GENERATED","GET","GRANT","GROUP","GROUPING","GROUPS","HAVING","HIGH_PRIORITY","HOUR_MICROSECOND","HOUR_MINUTE","HOUR_SECOND","IF","IGNORE","IN","INDEX","INFILE","INNER","INOUT","INSENSITIVE","INSERT","INT","INT1","INT2","INT3","INT4","INT8","INTEGER","INTERSECT","INTERVAL","INTO","IO_AFTER_GTIDS","IO_BEFORE_GTIDS","IS","ITERATE","JOIN","JSON_TABLE","KEY","KEYS","KILL","LAG","LAST_VALUE","LATERAL","LEAD","LEADING","LEAVE","LEFT","LIKE","LIMIT","LINEAR","LINES","LOAD","LOCALTIME","LOCALTIMESTAMP","LOCK","LONG","LONGBLOB","LONGTEXT","LOOP","LOW_PRIORITY","MASTER_BIND","MASTER_SSL_VERIFY_SERVER_CERT","MATCH","MAXVALUE","MEDIUMBLOB","MEDIUMINT","MEDIUMTEXT","MIDDLEINT","MINUTE_MICROSECOND","MINUTE_SECOND","MOD","MODIFIES","NATURAL","NOT","NO_WRITE_TO_BINLOG","NTH_VALUE","NTILE","NULL","NUMERIC","OF","ON","OPTIMIZE","OPTIMIZER_COSTS","OPTION","OPTIONALLY","OR","ORDER","OUT","OUTER","OUTFILE","OVER","PARTITION","PERCENT_RANK","PRECISION","PRIMARY","PROCEDURE","PURGE","RANGE","RANK","READ","READS","READ_WRITE","REAL","RECURSIVE","REFERENCES","REGEXP","RELEASE","RENAME","REPEAT","REPLACE","REQUIRE","RESIGNAL","RESTRICT","RETURN","REVOKE","RIGHT","RLIKE","ROW","ROWS","ROW_NUMBER","SCHEMA","SCHEMAS","SECOND_MICROSECOND","SELECT","SENSITIVE","SEPARATOR","SET","SHOW","SIGNAL","SMALLINT","SPATIAL","SPECIFIC","SQL","SQLEXCEPTION","SQLSTATE","SQLWARNING","SQL_BIG_RESULT","SQL_CALC_FOUND_ROWS","SQL_SMALL_RESULT","SSL","STARTING","STORED","STRAIGHT_JOIN","SYSTEM","TABLE","TERMINATED","THEN","TINYBLOB","TINYINT","TINYTEXT","TO","TRAILING","TRIGGER","TRUE","UNDO","UNION","UNIQUE","UNLOCK","UNSIGNED","UPDATE","USAGE","USE","USING","UTC_DATE","UTC_TIME","UTC_TIMESTAMP","VALUES","VARBINARY","VARCHAR","VARCHARACTER","VARYING","VIRTUAL","WHEN","WHERE","WHILE","WINDOW","WITH","WRITE","XOR","YEAR_MONTH","ZEROFILL"];function ve(e,t){let r="SELECT column_name, data_type FROM information_schema.columns WHERE ";return r+=function(e,t){let r="";if(e.includes(".")){const t=e.split(".");return r="table_schema = "+he(t[0]),r+=" AND table_name = "+he(t[1]),r}return r=`table_schema = ${void 0!==t?he(t):"database()"} AND table_name = `+he(e),r}(e,t),r+=" ORDER BY column_name",r}function he(e){return fe(function(e){return'"'===e[0]&&'"'===e[e.length-1]?e.substring(1,e.length-1).replace(/""/g,'"'):"`"===e[0]&&"`"===e[e.length-1]?e.substring(1,e.length-1):e}(e))}var ge=m(3247);function ye(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function me(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){ye(i,n,o,a,s,"next",e)}function s(e){ye(i,n,o,a,s,"throw",e)}a(void 0)}))}}function Oe(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function be(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Oe(e,t,r[t])}))}return e}function Ee(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Se=({getMeta:e})=>(t,r)=>Ee(be({},r&&(0,ge.N)(t,r)),{customStatementPlacement:we,customSuggestionKinds:Ie(e)}),_e="afterDatabase",Te="tablesWithinDatabase",Re="FROM",we=()=>[{id:_e,resolve:(e,t,r)=>{var n;return Boolean((null==e?void 0:e.is(ie.ks.Delimiter,"."))&&(null==t?void 0:t.value)===Re&&((null==r?void 0:r.is(ie.ks.IdentifierQuote))||(null==r?void 0:r.isIdentifier()))&&1===(null==e||null===(n=e.getPreviousUntil(ie.ks.Keyword,[ie.ks.IdentifierQuote],Re))||void 0===n?void 0:n.filter((e=>e.isIdentifier())).length))}}],Ie=e=>()=>[{id:ie.ng.Tables,overrideDefault:!0,suggestionsResolver:function(){var t=me((function*(t){const r=Ce(t.currentToken);return(yield e({schema:r})).map(Le(t))}));return function(e){return t.apply(this,arguments)}}()},{id:ie.ng.Columns,overrideDefault:!0,suggestionsResolver:function(){var t=me((function*(t){const r=Ae(t.currentToken),n=Ce(r),o=function(e){const t=null==e?void 0:e.getNextOfType(ie.ks.Identifier);return null==t?void 0:t.value}(r);if(!n||!o)return[];return(yield e({schema:n,table:o})).map(Le(t))}));return function(e){return t.apply(this,arguments)}}()},{id:Te,applyTo:[_e],suggestionsResolver:function(){var t=me((function*(t){const r=Ce(t.currentToken);return(yield e({schema:r})).map(Le(t))}));return function(e){return t.apply(this,arguments)}}()}];function Le(e){return function(t){var r;return{label:t.name,insertText:null!==(r=t.completion)&&void 0!==r?r:t.name,command:{id:"editor.action.triggerSuggest",title:""},kind:ie.Io.Field,sortText:ie.mY.High,range:Ee(be({},e.range),{startColumn:e.range.endColumn,endColumn:e.range.endColumn})}}}function Ce(e){return(null==e?void 0:e.isIdentifier())&&"."!==e.value[e.value.length-1]?e.value:(null==e?void 0:e.is(ie.ks.Delimiter,"."))?null===(t=e.getPreviousOfType(ie.ks.Identifier))||void 0===t?void 0:t.value:(null==e?void 0:e.is(ie.ks.IdentifierQuote))?(null===(r=e.getPreviousOfType(ie.ks.Identifier))||void 0===r?void 0:r.value)||(null===(n=e.getNextOfType(ie.ks.Identifier))||void 0===n?void 0:n.value):void 0;var t,r,n}const Ae=e=>{var t;const r=(e=>{var t;const r=null!==(t=null==e?void 0:e.getPreviousOfType(ie.ks.Keyword,"SELECT"))&&void 0!==t?t:null;return null==r?void 0:r.getNextOfType(ie.ks.Keyword,Re)})(e),n=null==r?void 0:r.getNextOfType(ie.ks.Identifier);return(null==n?void 0:n.isKeyword())&&(null===(t=n.next)||void 0===t?void 0:t.is(ie.ks.Parenthesis,"("))?null:n};function xe(e,t,r,n,o,i,a){try{var s=e[i](a),l=s.value}catch(e){return void r(e)}s.done?t(l):Promise.resolve(l).then(n,o)}function Ne(e){return function(){var t=this,r=arguments;return new Promise((function(n,o){var i=e.apply(t,r);function a(e){xe(i,n,o,a,s,"next",e)}function s(e){xe(i,n,o,a,s,"throw",e)}a(void 0)}))}}function je(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Fe(e,t){return t=null!=t?t:{},Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):function(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))})),e}const Pe=({dataSourceName:e,docsLink:t,hasRequiredFields:r=!0,className:n})=>{const o=(0,E.useTheme2)(),i={container:(0,g.css)({p:{margin:0},"p + p":{marginTop:o.spacing(2)}}),text:(0,g.css)({...o.typography.body,color:o.colors.text.secondary,a:(0,g.css)({color:o.colors.text.link,textDecoration:"underline","&:hover":{textDecoration:"none"}})})};return y.createElement("div",{className:(0,g.cx)(i.container,n)},y.createElement("p",{className:i.text},"Before you can use the ",e," data source, you must configure it below or in the config file. For detailed instructions,"," ",y.createElement("a",{href:t,target:"_blank",rel:"noreferrer"},"view the documentation"),"."),r&&y.createElement("p",{className:i.text},y.createElement("i",null,"Fields marked with * are required")))},ke=({children:e,...t})=>y.createElement(U,{...t,kind:"section"},e);var De=m(5910);function Ve(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}const Me=new r.DataSourcePlugin(class extends V{getQueryModel(){return{quoteLiteral:fe}}getSqlLanguageDefinition(){if(void 0!==this.sqlLanguageDefinition)return this.sqlLanguageDefinition;const e={getMeta:e=>this.fetchMeta(e)};return this.sqlLanguageDefinition={id:"mysql",completionProvider:Se(e),formatter:M.s},this.sqlLanguageDefinition}fetchDatasets(){var e=this;return Ne((function*(){return(yield e.runSql("SELECT DISTINCT TABLE_SCHEMA from information_schema.TABLES where TABLE_TYPE != 'SYSTEM VIEW' ORDER BY TABLE_SCHEMA",{refId:"datasets"})).map((e=>pe(e[0])))}))()}fetchTables(e){var t=this;return Ne((function*(){const r=yield t.runSql(function(e){return`SELECT table_name FROM information_schema.tables WHERE table_schema = ${void 0!==e?he(e):"database()"} ORDER BY table_name`}(e),{refId:"tables"});return r.map((e=>pe(e[0])))}))()}fetchFields(e){var t=this;return Ne((function*(){if(!e.dataset||!e.table)return[];const r=ve(e.table,e.dataset);return function(e){const t=[];for(const n of e){var r;let e="text";switch(null===(r=n.type)||void 0===r?void 0:r.toUpperCase()){case"BOOLEAN":case"BOOL":e="boolean";break;case"BYTES":case"VARCHAR":case"GEOGRAPHY":e="text";break;case"FLOAT":case"FLOAT64":case"INT":case"INTEGER":case"INT64":case"NUMERIC":case"BIGNUMERIC":e="number";break;case"DATE":e="date";break;case"DATETIME":case"TIMESTAMP":e="datetime";break;case"TIME":e="time"}t.push(le(se({},n),{raqbFieldType:e,icon:ue(n.type.toUpperCase())}))}return t}((yield t.runSql(r,{refId:`fields-${(0,oe.A)()}`})).map((e=>({name:e[0],text:e[0],value:pe(e[0]),type:e[1],label:e[0]}))))}))()}fetchMeta(e){var t=this;return Ne((function*(){const r=t.instanceSettings.jsonData.database;if(!(null==e?void 0:e.schema)&&r){return(yield t.fetchTables(r)).map((e=>({name:e,completion:`${r}.${e}`,kind:ie.Io.Class})))}if((null==e?void 0:e.schema)||r){if((null==e?void 0:e.table)||r&&!(null==e?void 0:e.schema)){if((null==e?void 0:e.table)&&e.schema){return(yield t.fetchFields({dataset:e.schema,table:e.table})).map((e=>({name:e.name,completion:e.value,kind:ie.Io.Field})))}return[]}return(yield t.fetchTables(null==e?void 0:e.schema)).map((e=>({name:e,completion:e,kind:ie.Io.Class})))}return(yield t.fetchDatasets()).map((e=>({name:e,completion:`${e}.`,kind:ie.Io.Module})))}))()}getDB(){return void 0!==this.db?this.db:{datasets:()=>this.fetchDatasets(),tables:e=>this.fetchTables(e),fields:e=>this.fetchFields(e),validateQuery:(e,t)=>Promise.resolve({query:e,error:"",isError:!1,isValid:!0}),dsID:()=>this.id,toRawSql:ce,functions:()=>this.getFunctions(),getEditorLanguageDefinition:()=>this.getSqlLanguageDefinition()}}constructor(e){super(e),je(this,"instanceSettings",void 0),je(this,"sqlLanguageDefinition",void 0),je(this,"getFunctions",void 0),this.instanceSettings=e,this.getFunctions=()=>{const e=[...o,{name:"VARIANCE"},{name:"STDDEV"}],t={name:"Column",required:!0,options:e=>this.fetchFields(e)};return[...s(t),...e.map((e=>Fe(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){je(e,t,r[t])}))}return e}({},e),{parameters:[t]})))]}}}).setQueryEditor(R).setQueryEditorHelp((function(){const e=(0,E.useStyles2)(ne);return(0,h.jsxs)("div",{children:[(0,h.jsx)("h2",{children:"MySQL cheat sheet"}),"Time series:",(0,h.jsxs)("ul",{className:e.ulPadding,children:[(0,h.jsx)("li",{children:"return column named time or time_sec (in UTC), as a unix time stamp or any sql native date data type. You can use the macros below."}),(0,h.jsx)("li",{children:"return column(s) with numeric datatype as values"})]}),"Optional:",(0,h.jsxs)("ul",{className:e.ulPadding,children:[(0,h.jsxs)("li",{children:["return column named ",(0,h.jsx)("i",{children:"metric"})," to represent the series name."]}),(0,h.jsx)("li",{children:"If multiple value columns are returned the metric column is used as prefix."}),(0,h.jsx)("li",{children:"If no column named metric is found the column name of the value column is used as series name"})]}),(0,h.jsx)("p",{children:"Resultsets of time series queries need to be sorted by time."}),"Table:",(0,h.jsx)("ul",{className:e.ulPadding,children:(0,h.jsx)("li",{children:"return any set of columns"})}),"Macros:",(0,h.jsxs)("ul",{className:e.ulPadding,children:[(0,h.jsx)("li",{children:"$__time(column) -> UNIX_TIMESTAMP(column) as time_sec"}),(0,h.jsx)("li",{children:"$__timeEpoch(column) -> UNIX_TIMESTAMP(column) as time_sec"}),(0,h.jsx)("li",{children:"$__timeFilter(column) -> column BETWEEN FROM_UNIXTIME(1492750877) AND FROM_UNIXTIME(1492750877)"}),(0,h.jsx)("li",{children:"$__unixEpochFilter(column) -> time_unix_epoch > 1492750877 AND time_unix_epoch < 1492750877"}),(0,h.jsx)("li",{children:"$__unixEpochNanoFilter(column) -> column >= 1494410783152415214 AND column <= 1494497183142514872"}),(0,h.jsx)("li",{children:"$__timeGroup(column,'5m'[, fillvalue]) -> cast(cast(UNIX_TIMESTAMP(column)/(300) as signed)*300 as signed) by setting fillvalue grafana will fill in missing values according to the interval fillvalue can be either a literal value, NULL or previous; previous will fill in the previous seen value or NULL if none has been seen yet"}),(0,h.jsx)("li",{children:"$__timeGroupAlias(column,'5m') -> cast(cast(UNIX_TIMESTAMP(column)/(300) as signed)*300 as signed) AS \"time\""}),(0,h.jsx)("li",{children:"$__unixEpochGroup(column,'5m') -> column DIV 300 * 300"}),(0,h.jsx)("li",{children:"$__unixEpochGroupAlias(column,'5m') -> column DIV 300 * 300 AS \"time\""})]}),(0,h.jsx)("p",{children:"Example of group by and order by with $__timeGroup:"}),(0,h.jsx)("pre",{children:(0,h.jsxs)("code",{children:["$__timeGroupAlias(timestamp_col, '1h'), sum(value_double) as value",(0,h.jsx)("br",{}),"FROM yourtable",(0,h.jsx)("br",{}),"GROUP BY 1",(0,h.jsx)("br",{}),"ORDER BY 1",(0,h.jsx)("br",{})]})}),"Or build your own conditionals using these macros which just return the values:",(0,h.jsxs)("ul",{className:e.ulPadding,children:[(0,h.jsx)("li",{children:"$__timeFrom() -> FROM_UNIXTIME(1492750877)"}),(0,h.jsx)("li",{children:"$__timeTo() -> FROM_UNIXTIME(1492750877)"}),(0,h.jsx)("li",{children:"$__unixEpochFrom() -> 1492750877"}),(0,h.jsx)("li",{children:"$__unixEpochTo() -> 1492750877"}),(0,h.jsx)("li",{children:"$__unixEpochNanoFrom() -> 1494410783152415214"}),(0,h.jsx)("li",{children:"$__unixEpochNanoTo() -> 1494497183142514872"})]})]})})).setConfigEditor((e=>{const[t,n]=(0,y.useState)(!0),{options:o,onOptionsChange:i}=e,a=o.jsonData;!function({onOptionsChange:e,options:t}){(0,y.useEffect)((()=>{const r=t.jsonData;let n=Q({},t),o=!1;if(t.database&&(J.logDebug(`Migrating from options.database with value ${t.database} for ${t.name}`),n.database="",n.jsonData=Z(Q({},r),{database:t.database}),o=!0),void 0===r.maxOpenConns&&void 0===r.maxIdleConns&&void 0===r.maxIdleConnsAuto){const{maxOpenConns:e,maxIdleConns:t}=f.config.sqlConnectionLimits;J.logDebug(`Setting default max open connections to ${e} and setting max idle connection to ${t}`),n.jsonData=Z(Q({},n.jsonData),{maxOpenConns:e,maxIdleConns:t,maxIdleConnsAuto:!0}),o=!0}if(void 0===r.connMaxLifetime){const{connMaxLifetime:e}=f.config.sqlConnectionLimits;n.jsonData=Z(Q({},n.jsonData),{connMaxLifetime:e}),o=!0}o&&e(n)}),[e,t])}(e);const s=e=>t=>{i(function(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter((function(e){return Object.getOwnPropertyDescriptor(r,e).enumerable})))),n.forEach((function(t){Ve(e,t,r[t])}))}return e}({},o,{[e]:t.currentTarget.value}))},l=t=>n=>{(0,r.updateDatasourcePluginJsonDataOption)(e,t,n.currentTarget.checked)},u=40;return(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(Pe,{dataSourceName:"MySQL",docsLink:"https://grafana.com/docs/grafana/latest/datasources/mysql/",hasRequiredFields:!0}),(0,h.jsx)(z,{}),(0,h.jsxs)(E.Collapse,{collapsible:!0,label:"User Permission",isOpen:t,onToggle:()=>n((e=>!e)),children:["The database user should only be granted SELECT permissions on the specified database & tables you want to query. ",(0,h.jsx)("br",{}),"Grafana does not validate that queries are safe so queries can contain any SQL statement. For example, statements like ",(0,h.jsx)("code",{children:"USE otherdb;"})," and ",(0,h.jsx)("code",{children:"DROP TABLE user;"})," would be executed. ",(0,h.jsx)("br",{}),"To protect against this we ",(0,h.jsx)("strong",{children:"Highly"})," recommend you create a specific MySQL user with restricted permissions. Check out the docs for more information."]}),(0,h.jsx)(z,{}),(0,h.jsxs)(ke,{title:"Connection",children:[(0,h.jsx)(E.Field,{label:"Host URL",required:!0,children:(0,h.jsx)(E.Input,{width:u,name:"host",type:"text",value:o.url||"",placeholder:"localhost:3306",onChange:s("url")})}),(0,h.jsx)(E.Field,{label:"Database name",children:(0,h.jsx)(E.Input,{width:u,name:"database",value:a.database||"",placeholder:"Database",onChange:(0,r.onUpdateDatasourceJsonDataOption)(e,"database")})})]}),(0,h.jsx)(z,{}),(0,h.jsxs)(ke,{title:"Authentication",children:[(0,h.jsx)(E.Field,{label:"Username",required:!0,children:(0,h.jsx)(E.Input,{width:u,value:o.user||"",placeholder:"Username",onChange:s("user")})}),(0,h.jsx)(E.Field,{label:"Password",children:(0,h.jsx)(E.SecretInput,{width:u,placeholder:"Password",isConfigured:o.secureJsonFields&&o.secureJsonFields.password,onReset:()=>{(0,r.updateDatasourcePluginResetOption)(e,"password")},onBlur:(0,r.onUpdateDatasourceSecureJsonDataOption)(e,"password")})}),(0,h.jsx)(E.Field,{label:"Use TLS Client Auth",description:"Enables TLS authentication using client cert configured in secure json data.",children:(0,h.jsx)(E.Switch,{onChange:l("tlsAuth"),value:a.tlsAuth||!1})}),(0,h.jsx)(E.Field,{label:"With CA Cert",description:"Needed for verifying self-signed TLS Certs.",children:(0,h.jsx)(E.Switch,{onChange:l("tlsAuthWithCACert"),value:a.tlsAuthWithCACert||!1})}),(0,h.jsx)(E.Field,{label:"Skip TLS Verification",description:"When enabled, skips verification of the MySQL server's TLS certificate chain and host name.",children:(0,h.jsx)(E.Switch,{onChange:l("tlsSkipVerify"),value:a.tlsSkipVerify||!1})}),(0,h.jsx)(E.Field,{label:"Allow Cleartext Passwords",description:"Allows using the cleartext client side plugin if required by an account.",children:(0,h.jsx)(E.Switch,{onChange:l("allowCleartextPasswords"),value:a.allowCleartextPasswords||!1})})]}),a.tlsAuth||a.tlsAuthWithCACert?(0,h.jsxs)(h.Fragment,{children:[(0,h.jsx)(z,{}),(0,h.jsx)(ke,{title:"TLS/SSL Auth Details",children:a.tlsAuth||a.tlsAuthWithCACert?(0,h.jsx)(Y,{showCACert:a.tlsAuthWithCACert,showKeyPair:a.tlsAuth,editorProps:e,labelWidth:u}):null})]}):null,(0,h.jsx)(z,{}),(0,h.jsxs)(ke,{title:"Additional settings",isCollapsible:!0,children:[(0,h.jsxs)(B,{title:"MySQL Options",children:[(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(De.C,{gap:.5,children:[(0,h.jsx)("span",{children:"Session timezone"}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsxs)("span",{children:["Specify the timezone used in the database session, such as ",(0,h.jsx)("code",{children:"Europe/Berlin"})," or",(0,h.jsx)("code",{children:"+02:00"}),". Required if the timezone of the database (or the host of the database) is set to something other than UTC. Set this to ",(0,h.jsx)("code",{children:"+00:00"})," so Grafana can handle times properly. Set the value used in the session with ",(0,h.jsx)("code",{children:"SET time_zone='...'"}),". If you leave this field empty, the timezone will not be updated. You can find more information in the MySQL documentation."]}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),children:(0,h.jsx)(E.Input,{width:u,value:a.timezone||"",onChange:(0,r.onUpdateDatasourceJsonDataOption)(e,"timezone"),placeholder:"Europe/Berlin or +02:00"})}),(0,h.jsx)(E.Field,{label:(0,h.jsx)(E.Label,{children:(0,h.jsxs)(De.C,{gap:.5,children:[(0,h.jsx)("span",{children:"Min time interval"}),(0,h.jsx)(E.Tooltip,{content:(0,h.jsxs)("span",{children:["A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example",(0,h.jsx)("code",{children:"1m"})," if your data is written every minute."]}),children:(0,h.jsx)(E.Icon,{name:"info-circle",size:"sm"})})]})}),description:"A lower limit for the auto group by time interval. Recommended to be set to write frequency, for example 1m if your data is written every minute.",children:(0,h.jsx)(E.Input,{width:u,placeholder:"1m",value:a.timeInterval||"",onChange:(0,r.onUpdateDatasourceJsonDataOption)(e,"timeInterval")})})]}),(0,h.jsx)(W,{options:o,onOptionsChange:i}),f.config.secureSocksDSProxyEnabled&&(0,h.jsx)(E.SecureSocksProxySettings,{options:o,onOptionsChange:i})]})]})}))})(),O})()));
//# sourceMappingURL=module.js.map